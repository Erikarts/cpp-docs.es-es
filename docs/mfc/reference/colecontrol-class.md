---
title: COleControl (clase)
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 8e931b03dc09926d44fa5cb4125dd2ffa41c5813
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/14/2020
ms.locfileid: "81366194"
---
# <a name="colecontrol-class"></a>COleControl (clase)

Una clase base eficaz para desarrollar controles OLE.

## <a name="syntax"></a>Sintaxis

```
class COleControl : public CWnd
```

## <a name="members"></a>Miembros

### <a name="public-constructors"></a>Constructores públicos

|Nombre|Descripción|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Crea un objeto `COleControl` .|

### <a name="public-methods"></a>Métodos públicos

|Nombre|Descripción|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Recupera la apariencia actual del control.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Devuelve el valor de la propiedad BackColor ambiente.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Devuelve el nombre del control según lo especificado por el contenedor.|
|[COleControl::AmbientFont](#ambientfont)|Devuelve el valor de la propiedad Ambient Font.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Devuelve el valor de la propiedad Ambient ForeColor.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Devuelve el identificador de configuración regional del contenedor.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Devuelve el tipo de unidades utilizadas por el contenedor.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Determina si se deben mostrar las asas de agarre.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Determina si se debe mostrar el sombreado.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Devuelve el tipo de alineación de texto especificado por el contenedor.|
|[COleControl::AmbientUIDead](#ambientuidead)|Determina si el control debe responder a las acciones de la interfaz de usuario.|
|[COleControl::AmbientUserMode](#ambientusermode)|Determina el modo del contenedor.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Notifica al contenedor que se ha cambiado una propiedad enlazada.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Solicita permiso para editar el valor de la propiedad.|
|[COleControl::ClientToParent](#clienttoparent)|Traduce un punto relativo al origen del control a un punto relativo al origen de su contenedor.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Ajusta un rectángulo de intercalación si un control lo superpone.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Llame a esta función después de que haya cambiado el conjunto de mnemotécnicos controlados por el control.|
|[COleControl::DisplayError](#displayerror)|Muestra eventos de error de stock al usuario del control.|
|[COleControl::DoClick](#doclick)|Implementación del `DoClick` método de stock.|
|[COleControl::DoPropExchange](#dopropexchange)|Serializa las propiedades `COleControl` de un objeto.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Redibuja un control OLE que se ha subclase desde un control de Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Permite la compatibilidad de fotogramas simple para un control.|
|[COleControl::ExchangeExtent](#exchangeextent)|Serializa el ancho y el alto del control.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serializa las propiedades de stock del control.|
|[COleControl::ExchangeVersion](#exchangeversion)|Serializa el número de versión del control.|
|[COleControl::FireClick](#fireclick)|Activa el `Click` evento de stock.|
|[COleControl::FireDblClick](#firedblclick)|Activa el `DblClick` evento de stock.|
|[COleControl::FireError](#fireerror)|Activa el `Error` evento de stock.|
|[COleControl::FireEvent](#fireevent)|Activa un evento personalizado.|
|[COleControl::FireKeyDown](#firekeydown)|Activa el `KeyDown` evento de stock.|
|[COleControl::FireKeyPress](#firekeypress)|Activa el `KeyPress` evento de stock.|
|[COleControl::FireKeyUp](#firekeyup)|Activa el `KeyUp` evento de stock.|
|[COleControl::FireMouseDown](#firemousedown)|Activa el `MouseDown` evento de stock.|
|[COleControl::FireMouseMove](#firemousemove)|Activa el `MouseMove` evento de stock.|
|[COleControl::FireMouseUp](#firemouseup)|Activa el `MouseUp` evento de stock.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Desencadena un evento cuando cambia el estado listo del control.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Altera el comportamiento de activación predeterminado `IPointerInactive` de un control que admite la interfaz.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Devuelve el valor de la propiedad ambiente especificada.|
|[COleControl::GetAppearance](#getappearance)|Devuelve el valor de la propiedad apariencia de stock.|
|[COleControl::GetBackColor](#getbackcolor)|Devuelve el valor de la propiedad BackColor de stock.|
|[COleControl::GetBorderStyle](#getborderstyle)|Devuelve el valor de la propiedad BorderStyle de stock.|
|[COleControl::GetCapture](#getcapture)|Determina si un objeto de control activado sin ventanas tiene la captura del mouse.|
|[COleControl::GetClassID](#getclassid)|Recupera el identificador de clase OLE del control.|
|[COleControl::GetClientOffset](#getclientoffset)|Recupera la diferencia entre la esquina superior izquierda del área rectangular del control y la esquina superior izquierda de su área de cliente.|
|[COleControl::GetClientRect](#getclientrect)|Recupera el tamaño del área de cliente del control.|
|[COleControl::GetClientSite](#getclientsite)|Consulta un objeto para el puntero a su sitio de cliente actual dentro de su contenedor.|
|[COleControl::GetControlFlags](#getcontrolflags)|Recupera la configuración del indicador de control.|
|[COleControl::GetControlSize](#getcontrolsize)|Devuelve la posición y el tamaño del control OLE.|
|[COleControl::GetDC](#getdc)|Proporciona un medio para que un control sin ventanas obtenga un contexto de dispositivo de su contenedor.|
|[COleControl::GetEnabled](#getenabled)|Devuelve el valor de la propiedad Enabled de stock.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Recupera un puntero a un objeto de control extendido que pertenece al contenedor.|
|[COleControl::GetFocus](#getfocus)|Determina si el control tiene el foco.|
|[COleControl::GetFont](#getfont)|Devuelve el valor de la propiedad Font de stock.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Devuelve las métricas `CFontHolder` de un objeto.|
|[COleControl::GetForeColor](#getforecolor)|Devuelve el valor de la propiedad ForeColor de stock.|
|[COleControl::GetHwnd](#gethwnd)|Devuelve el valor de la propiedad hWnd de stock.|
|[COleControl::GetMessageString](#getmessagestring)|Proporciona texto de barra de estado para un elemento de menú.|
|[COleControl::GetNotSupported](#getnotsupported)|Impide el acceso al valor de propiedad de un control por parte del usuario.|
|[COleControl::GetReadyState](#getreadystate)|Devuelve el estado de preparación del control.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Devuelve el rectángulo del control en relación con su contenedor.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Devuelve las métricas de la propiedad Font de stock.|
|[COleControl::GetText](#gettext)|Devuelve el valor de la propiedad Text o Caption de stock.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Reemplazar para permitir que un control sin ventanas sea el destino de las operaciones de arrastrar y colocar.|
|[COleControl::InitializeIIDs](#initializeiids)|Informa a la clase base de los IDE que utilizará el control.|
|[COleControl::InternalGetFont](#internalgetfont)|Devuelve `CFontHolder` un objeto para la propiedad Font de stock.|
|[COleControl::InternalGetText](#internalgettext)|Recupera la propiedad stock Caption o Text.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Establece el estado de preparación del control y desencadena el evento ready-state-change.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Invalida un área del control mostrado, lo que hace que se vuelva a dibujar.|
|[COleControl::InvalidateRgn](#invalidatergn)|Invalida el área de cliente de la ventana contenedora dentro de la región dada. Se puede utilizar para redibujar controles sin ventanas en la región.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Permite la carga especializada de un control OLE.|
|[COleControl::IsModified](#ismodified)|Determina si el estado del control ha cambiado.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Indica si el contenedor admite el dibujo optimizado para la operación de dibujo actual.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Se llama para determinar si el control subclases un control de Windows.|
|[COleControl::Carga](#load)|Restablece los datos asincrónicos anteriores e inicia una nueva carga de la propiedad asincrónica del control.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Determina si el contenedor puede desactivar el control.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Se llama cuando se cambia una propiedad ambiente.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Se llama cuando se cambia la propiedad Apariencia de stock.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Se llama cuando se cambia la propiedad BackColor de stock.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Se llama cuando se cambia la propiedad BorderStyle de stock.|
|[COleControl::OnClick](#onclick)|Se llama para activar el evento Click de stock.|
|[COleControl::Onclose](#onclose)|Notifica al control `IOleControl::Close` al que se ha llamado.|
|[COleControl::Ondoverb](#ondoverb)|Se llama después de ejecutar un verbo de control.|
|[COleControl::OnDraw](#ondraw)|Se llama cuando se solicita un control para volver a dibujarse a sí mismo.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Llamado por el contenedor cuando se solicita un control para volver a dibujarse a sí mismo mediante un contexto de dispositivo de metarchivo.|
|[COleControl::OnEdit](#onedit)|Llamado por el contenedor para la interfaz de usuario Activar un control OLE.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Se llama cuando se cambia la propiedad Enabled de stock.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Llamado por el contenedor para enumerar los verbos de un control.|
|[COleControl::OnEventAdvise](#oneventadvise)|Se llama cuando los controladores de eventos están conectados o desconectados de un control.|
|[COleControl::OnFontChanged](#onfontchanged)|Se llama cuando se cambia la propiedad Font de stock.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Se llama cuando se cambia la propiedad ForeColor de stock.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Se llama cuando los eventos de un control se congelan o se descongelan.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Notifica al control `IOleObject::GetColorSet` al que se ha llamado.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Proporciona información mnemotécnica al contenedor.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Se llama para obtener una cadena para representar un valor de propiedad.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Solicita el identificador del menú del control que se combinará con el menú contenedor.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Reemplazar para recuperar el tamaño de visualización del control más cercano al tamaño y el modo de extensión propuestos.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Devuelve cadenas que representan valores posibles para una propiedad.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Devuelve el valor correspondiente a una cadena predefinida.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Reemplazar para recuperar el tamaño de las áreas de visualización del control (se puede utilizar para habilitar el dibujo de dos pasadas).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Reemplazar para convertir el tamaño del control en un rectángulo a partir de una posición específica.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Reemplazar para recuperar el estado de vista del control.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Llamado por el contenedor cuando se desactiva la interfaz de usuario del control.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Reemplazar para que el contenedor para el control inactivo bajo el puntero del mouse envíe WM_MOUSEMOVE mensajes al control.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Reemplazar para que el contenedor para el control inactivo bajo el puntero del mouse envíe WM_SETCURSOR mensajes al control.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Se llama después de que se haya desencadenado el evento KeyDown de stock.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Se llama después de que se haya activado el evento KeyPress de stock.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Se llama después de que se haya activado el evento KeyUp de stock.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Indica qué página de propiedades se va a utilizar para editar una propiedad.|
|[COleControl::Onmnemonic](#onmnemonic)|Se llama cuando se ha presionado una tecla mnemotécnica del control.|
|[COleControl::OnProperties](#onproperties)|Se llama cuando se ha invocado el verbo "Propiedades" del control.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Reemplazar para consultar si la visualización de un control se superpone a un punto determinado.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Reemplazar para consultar si la visualización de un control se superpone a cualquier punto de un rectángulo determinado.|
|[COleControl::OnRenderData](#onrenderdata)|Llamado por el marco de trabajo para recuperar datos en el formato especificado.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Llamado por el marco de trabajo para recuperar datos de un archivo en el formato especificado.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Llamado por el marco de trabajo para recuperar datos de la memoria global en el formato especificado.|
|[COleControl::OnResetState](#onresetstate)|Restablece las propiedades de un control a los valores predeterminados.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Notifica al control `IOleControl::SetClientSite` al que se ha llamado.|
|[COleControl::OnSetData](#onsetdata)|Reemplaza los datos del control por otro valor.|
|[COleControl::OnSetExtent](#onsetextent)|Se llama después de que la extensión del control haya cambiado.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Se llama después de que se hayan cambiado las dimensiones del control.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Se llama cuando se ha activado la interfaz de usuario del control.|
|[COleControl::OnTextChanged](#ontextchanged)|Se llama cuando se cambia la propiedad Text o Caption de stock.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Procesa los mensajes de ventana (que no sean los mensajes de mouse y teclado) para los controles sin ventanas.|
|[COleControl::ParentToClient](#parenttoclient)|Traduce un punto relativo al origen del contenedor a un punto relativo al origen del control.|
|[COleControl::PostModalDialog](#postmodaldialog)|Notifica al contenedor que se ha cerrado un cuadro de diálogo modal.|
|[COleControl::PreModalDialog](#premodaldialog)|Notifica al contenedor que un cuadro de diálogo modal está a punto de mostrarse.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Destruye y vuelve a crear la ventana del control.|
|[COleControl::Refresh](#refresh)|Fuerza un repintado de la apariencia de un control.|
|[COleControl::ReleaseCapture](#releasecapture)|Libera la captura del ratón.|
|[COleControl::ReleaseDC](#releasedc)|Libera el contexto del dispositivo de visualización de un contenedor de un control sin ventanas.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Restablece el elemento primario de la ventana de control.|
|[COleControl::ResetStockProps](#resetstockprops)|Inicializa `COleControl` las propiedades de stock a sus valores predeterminados.|
|[COleControl::ResetVersion](#resetversion)|Inicializa el número de versión en un valor determinado.|
|[COleControl::ScrollWindow](#scrollwindow)|Permite que un control sin ventanas desplace un área dentro de su imagen activa in situ en la pantalla.|
|[COleControl::SelectFontObject](#selectfontobject)|Selecciona una propiedad Font personalizada en un contexto de dispositivo.|
|[COleControl::SelectStockFont](#selectstockfont)|Selecciona la propiedad Font de stock en un contexto de dispositivo.|
|[COleControl::SerializeExtent](#serializeextent)|Serializa o inicializa el espacio de visualización para el control.|
|[COleControl::SerializeStockProps](#serializestockprops)|Serializa o inicializa `COleControl` las propiedades de stock.|
|[COleControl::SerializeVersion](#serializeversion)|Serializa o inicializa la información de versión del control.|
|[COleControl::SetAppearance](#setappearance)|Establece el valor de la propiedad Apariencia de stock.|
|[COleControl::SetBackColor](#setbackcolor)|Establece el valor de la propiedad BackColor de stock.|
|[COleControl::SetBorderStyle](#setborderstyle)|Establece el valor de la propiedad BorderStyle de stock.|
|[COleControl::SetCapture](#setcapture)|Hace que la ventana contenedora del control tome posesión de la captura del mouse en nombre del control.|
|[COleControl::SetControlSize](#setcontrolsize)|Establece la posición y el tamaño del control OLE.|
|[COleControl::SetEnabled](#setenabled)|Establece el valor de la propiedad stock Enabled.|
|[COleControl::SetFocus](#setfocus)|Hace que la ventana contenedora del control tome posesión del foco de entrada en nombre del control.|
|[COleControl::SetFont](#setfont)|Establece el valor de la propiedad Font de stock.|
|[COleControl::SetForeColor](#setforecolor)|Establece el valor de la propiedad ForeColor de stock.|
|[COleControl::SetInitialSize](#setinitialsize)|Establece el tamaño de un control OLE cuando se muestra por primera vez en un contenedor.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Cambia el estado modificado de un control.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Indica que se ha producido un error en una solicitud de edición.|
|[COleControl::SetNotSupported](#setnotsupported)|Impide la modificación del valor de propiedad de un control por parte del usuario.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Establece el rectángulo del control en relación con su contenedor.|
|[COleControl::SetText](#settext)|Establece el valor de la propiedad Text o Caption.|
|[COleControl::ThrowError](#throwerror)|Indica que se ha producido un error en un control OLE.|
|[COleControl::TransformCoords](#transformcoords)|Transforma los valores de coordenadas entre un contenedor y el control.|
|[COleControl::TranslateColor](#translatecolor)|Convierte un valor de OLE_COLOR en un valor COLORREF.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Determina si las propiedades ambientales estarán disponibles la próxima vez que se cargue el control.|
|[COleControl::WindowProc](#windowproc)|Proporciona un procedimiento `COleControl` de Windows para un objeto.|

### <a name="protected-methods"></a>Métodos protegidos

|Nombre|Descripción|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Llamado por el marco de trabajo cuando la apariencia del control debe actualizarse.|
|[COleControl::DrawMetafile](#drawmetafile)|Llamado por el marco de trabajo cuando se utiliza el contexto del dispositivo de metarchivo.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Habilita la invocación de métodos de automatización.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Llamado por el marco de trabajo para inicializar la lista de formatos de datos admitidos por el control.|

## <a name="remarks"></a>Observaciones

Derivado de `CWnd`, esta clase hereda toda la funcionalidad de un objeto de ventana de Windows más funcionalidad adicional específica de OLE, como la activación de eventos y la capacidad de admitir métodos y propiedades.

Los controles OLE se pueden insertar en aplicaciones de contenedor OLE y comunicarse con el contenedor mediante un sistema bidireccional de desencadenamiento de eventos y exponer métodos y propiedades al contenedor. Tenga en cuenta que los contenedores OLE estándar solo admiten la funcionalidad básica de un control OLE. No pueden admitir características extendidas de un control OLE. La activación de eventos se produce cuando los eventos se envían al contenedor como resultado de ciertas acciones que tienen lugar en el control. A su vez, el contenedor se comunica con el control mediante un conjunto expuesto de métodos y propiedades análogos a las funciones miembro y los miembros de datos de una clase C++. Este enfoque permite al desarrollador controlar la apariencia del control y notificar al contenedor cuando se producen ciertas acciones.

## <a name="windowless-controls"></a>Controles sin ventana

Los controles OLE se pueden usar activos in situ sin una ventana. Los controles sin ventanas tienen ventajas significativas:

- Los controles sin ventanas pueden ser transparentes y no rectangulares

- Los controles sin ventanas reducen el tamaño de la instancia y el tiempo de creación del objeto

Los controles no necesitan una ventana. Los servicios que ofrece una ventana se pueden proporcionar fácilmente a través de una única ventana compartida (normalmente la del contenedor) y un poco de código de envío. Tener una ventana es principalmente una complicación innecesaria en el objeto.

Cuando se utiliza la activación sin ventanas, el contenedor (que tiene una ventana) es responsable de proporcionar servicios que, de lo contrario, habrían sido proporcionados por la propia ventana del control. Por ejemplo, si el control necesita consultar el foco del teclado, consultar la captura del mouse u obtener un contexto de dispositivo, el contenedor administra estas operaciones. Las `COleControl` funciones miembro de operación sin ventanas invocan estas operaciones en el contenedor.

Cuando se habilita la activación sin ventanas, el `IOleInPlaceObjectWindowless` contenedor delega los mensajes de entrada en la interfaz del control (una extensión de [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) para la compatibilidad sin ventanas). `COleControl`'s implementación de esta interfaz enviará estos mensajes a través del mapa de mensajes de su control, después de ajustar las coordenadas del ratón adecuadamente. Puede procesar estos mensajes como mensajes de ventana ordinarios, agregando las entradas correspondientes al mapa de mensajes.

En un control sin ventanas, siempre debe usar las `COleControl` funciones miembro en lugar de las funciones miembro correspondientes `CWnd` o sus funciones de API de Windows relacionadas.

Los objetos de control OLE también pueden crear una ventana solo cuando se activan, pero la cantidad de trabajo necesario para la transición inactiva-activa aumenta y la velocidad de la transición baja. Hay casos en los que se trata de un problema: como ejemplo, considere una cuadrícula de cuadros de texto. Al desplazar el cursor hacia arriba y hacia abajo a través de la columna, cada control debe activarse in situ y, a continuación, desactivarse. La velocidad de la transición inactiva/activa afectará directamente a la velocidad de desplazamiento.

Para obtener más información sobre el desarrollo de un marco de control OLE, vea los artículos [Controles ActiveX](../../mfc/mfc-activex-controls.md) de MFC y Información general: creación de un programa de [control ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Para obtener información sobre cómo optimizar los controles OLE, incluidos los controles sin ventanas y sin parpadeos, vea Controles ActiveX de [MFC: optimización](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Jerarquía de herencia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Requisitos

**Encabezado:** afxctl.h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>COleControl::AmbientBackColor

Devuelve el valor de la propiedad BackColor ambiente.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Valor devuelto

El valor actual de la propiedad BackColor ambiental del contenedor, si existe. Si no se admite la propiedad, esta función devuelve el color de fondo de Windows definido por el sistema.

### <a name="remarks"></a>Observaciones

El ambiente BackColor propiedad está disponible para todos los controles y se define mediante el contenedor. Tenga en cuenta que el contenedor no es necesario para admitir esta propiedad.

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>COleControl::AmbientDisplayName

El nombre que el contenedor ha asignado al control se puede utilizar en los mensajes de error que se muestran al usuario.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Valor devuelto

El nombre del control OLE. El valor predeterminado es una cadena de longitud cero.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que el contenedor no es necesario para admitir esta propiedad.

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>COleControl::AmbientFont

Devuelve el valor de la propiedad Ambient Font.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Valor devuelto

Un puntero a la interfaz de distribución de fuente ambiente del contenedor. El valor predeterminado es NULL. Si el valor devuelto no es igual a NULL, es responsable de liberar la fuente llamando a su [IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) función miembro.

### <a name="remarks"></a>Observaciones

El contenedor define la propiedad Font ambiente y está disponible para todos los controles. Tenga en cuenta que el contenedor no es necesario para admitir esta propiedad.

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>COleControl::AmbientForeColor

Devuelve el valor de la propiedad Ambient ForeColor.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Valor devuelto

El valor actual de la propiedad ForeColor ambiental del contenedor, si existe. Si no se admite, esta función devuelve el color de texto de Windows definido por el sistema.

### <a name="remarks"></a>Observaciones

El ambiente ForeColor propiedad está disponible para todos los controles y se define por el contenedor. Tenga en cuenta que el contenedor no es necesario para admitir esta propiedad.

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>COleControl::AmbientLocaleID

Devuelve el identificador de configuración regional del contenedor.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Valor devuelto

El valor de la propiedad LocaleID del contenedor, si existe. Si no se admite esta propiedad, esta función devuelve 0.

### <a name="remarks"></a>Observaciones

El control puede usar el LocaleID para adaptar su interfaz de usuario para configuraciones regionales específicas. Tenga en cuenta que el contenedor no es necesario para admitir esta propiedad.

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>COleControl::AmbientAppearance

Recupera la configuración de apariencia actual para el objeto de control.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Valor devuelto

La apariencia del control:

- **0** Aspecto plano

- **1** Apariencia 3D

### <a name="remarks"></a>Observaciones

Llame a esta función para recuperar el valor actual de la propiedad DISPID_AMBIENT_APPEARANCE para el control.

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits

Devuelve el tipo de unidades utilizadas por el contenedor.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Valor devuelto

Cadena que contiene el ambiente ScaleUnits del contenedor. Si no se admite esta propiedad, esta función devuelve una cadena de longitud cero.

### <a name="remarks"></a>Observaciones

La propiedad ScaleUnits ambiente del contenedor se puede utilizar para mostrar posiciones o dimensiones, etiquetadas con la unidad elegida, como twips o centímetros. Tenga en cuenta que el contenedor no es necesario para admitir esta propiedad.

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles

Determina si el contenedor permite que el control muestre identificadores de agarre por sí mismo cuando está activo.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se deben mostrar las asas de agarre; de lo contrario 0. Si no se admite esta propiedad, esta función devuelve distinto de cero.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que el contenedor no es necesario para admitir esta propiedad.

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>COleControl::AmbientShowHatching

Determina si el contenedor permite que el control se muestre con un patrón sombreado cuando la interfaz de usuario está activa.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se debe mostrar el patrón sombreado; de lo contrario 0. Si no se admite esta propiedad, esta función devuelve distinto de cero.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que el contenedor no es necesario para admitir esta propiedad.

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>COleControl::AmbientTextAlign

Determina la alineación de texto ambiente preferida por el contenedor de control.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Valor devuelto

El estado de la propiedad TextAlign ambiente del contenedor. Si no se admite esta propiedad, esta función devuelve 0.

A continuación se muestra una lista de valores devueltos válidos:

|Valor devuelto|Significado|
|------------------|-------------|
|0|Alineación general (números a la derecha, texto a la izquierda).|
|1|Justificar a la izquierda|
|2|Center|
|3|Justificación correcta|

### <a name="remarks"></a>Observaciones

Esta propiedad está disponible para todos los controles incrustados y se define mediante el contenedor. Tenga en cuenta que el contenedor no es necesario para admitir esta propiedad.

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>COleControl::AmbientUIDead

Determina si el contenedor desea que el control responda a las acciones de la interfaz de usuario.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el control debe responder a las acciones de la interfaz de usuario; de lo contrario 0. Si no se admite esta propiedad, esta función devuelve 0.

### <a name="remarks"></a>Observaciones

Por ejemplo, un contenedor podría establecer esto en TRUE en modo de diseño.

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>COleControl::AmbientUserMode

Determina si el contenedor está en modo de diseño o modo de usuario.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el contenedor está en modo de usuario; 0 (en modo de diseño). Si no se admite esta propiedad, esta función devuelve TRUE.

### <a name="remarks"></a>Observaciones

Por ejemplo, un contenedor podría establecer esto en FALSE en modo de diseño.

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>COleControl::BoundPropertyChanged

Indica que el valor de la propiedad enlazada ha cambiado.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parámetros

*dispid*<br/>
El identificador de envío de una propiedad enlazada del control.

### <a name="remarks"></a>Observaciones

Esto debe llamarse cada vez que cambia el valor de la propiedad, incluso en los casos en que el cambio no se realizó a través de la propiedad Set método. Tenga en cuenta especialmente las propiedades enlazadas que se asignan a las variables miembro. Cada vez que una `BoundPropertyChanged` variable miembro cambia, debe llamarse.

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdit

Solicita permiso de `IPropertyNotifySink` la interfaz para cambiar un valor de propiedad enlazado proporcionado por el control.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parámetros

*dispid*<br/>
El identificador de envío de una propiedad enlazada del control.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se permite el cambio; de lo contrario 0. El valor predeterminado es distinto de cero.

### <a name="remarks"></a>Observaciones

Si se deniega el permiso, el control no debe dejar que cambie el valor de la propiedad. Esto se puede hacer ignorando o fallando la acción que intentó cambiar el valor de la propiedad.

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>COleControl::ClientToParent

Traduce las coordenadas de *pPoint* en coordenadas primarias.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parámetros

*lprcBounds*<br/>
Puntero a los límites del control OLE dentro del contenedor. No el área de cliente, sino el área de todo el control, incluidos los bordes y las barras de desplazamiento.

*pPoint*<br/>
Puntero al punto de área de cliente OLE que se va a traducir en las coordenadas del elemento primario (contenedor).

### <a name="remarks"></a>Observaciones

En *pPoint* de entrada es relativo al origen del área de cliente del control OLE (esquina superior izquierda del área de cliente del control). En *el pPoint* de salida es relativo al origen del elemento primario (esquina superior izquierda del contenedor).

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>COleControl::ClipCaretRect

Ajusta un rectángulo de símbolo de intercalación si está cubierto total o parcialmente por objetos opacos superpuestos.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*lpRect*<br/>
En la entrada, un puntero a una estructura [RECT](/windows/win32/api/windef/ns-windef-rect) que contiene el área de intercalación que se va a ajustar. En la salida, el área de intercalación ajustada o NULL si el rectángulo del intercalador está completamente cubierto.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Un símbolo de intercalación es una línea, bloque o mapa de bits parpadeante que normalmente indica dónde se insertará texto o gráficos.

Un objeto sin ventana no puede mostrar de forma segura un símbolo de intercalación sin comprobar primero si el símbolo de intercalación está parcial o totalmente oculto por objetos superpuestos. Para que eso sea posible, `ClipCaretRect` un objeto puede utilizar para ajustar el cuidado de intercalación (reducido) para asegurarse de que se ajusta en la región de recorte.

Los objetos que crean un símbolo `ClipCaretRect` de intercalación deben enviar el rectángulo de intercalación y usar el rectángulo ajustado para el símbolo de intercalación. Si el intercalador está completamente oculto, este método devolverá FALSE y el intercalador no debe mostrarse en absoluto en este caso.

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>COleControl::COleControl

Construye un objeto `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Observaciones

Normalmente, esta función no se llama directamente. En su lugar, el control OLE suele crearse por su generador de clases.

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>COleControl::ControlInfoChanged

Llame a esta función cuando haya cambiado el conjunto de mnemotécnicos admitidos por el control.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Observaciones

Al recibir esta notificación, el contenedor del control obtiene el nuevo conjunto de mnemotécnicas realizando una llamada a [IOleControl::GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Tenga en cuenta que el contenedor no es necesario para responder a esta notificación.

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>COleControl::DisplayError

Llamado por el marco de trabajo después de que se haya controlado el evento error de stock (a menos que el controlador de eventos haya suprimido la visualización del error).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parámetros

*scode*<br/>
El valor del código de estado que se va a notificar. Para obtener una lista completa de los códigos posibles, consulte el artículo [Controles ActiveX: Temas avanzados](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
La descripción del error que se notifica.

*lpszSource*<br/>
El nombre del módulo que genera el error (normalmente, el nombre del módulo de control OLE).

*lpszHelpFile*<br/>
El nombre del archivo de ayuda que contiene una descripción del error.

*nHelpID*<br/>
El identificador de contexto de ayuda del error que se notifica.

### <a name="remarks"></a>Observaciones

El comportamiento predeterminado muestra un cuadro de mensaje que contiene la descripción del error, contenido en *lpszDescription*.

Reemplace esta función para personalizar cómo se muestran los errores.

## <a name="colecontroldoclick"></a><a name="doclick"></a>COleControl::DoClick

Simula una acción de clic del mouse en el control.

```
void DoClick();
```

### <a name="remarks"></a>Observaciones

Se llamará `COleControl::OnClick` a la función miembro reemplazable y se desencadenará un evento Click de stock, si es compatible con el control.

Esta función es `COleControl` compatible con la clase base como un método de stock, denominado DoClick. Para obtener más información, consulte el artículo [Controles ActiveX: Métodos](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>COleControl::DoPropExchange

Llamado por el marco de trabajo al cargar o almacenar un control desde una representación de almacenamiento persistente, como una secuencia o un conjunto de propiedades.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parámetros

*pPX*<br/>
Puntero a un objeto `CPropExchange` . El marco de trabajo proporciona este objeto para establecer el contexto del intercambio de propiedades, incluida su dirección.

### <a name="remarks"></a>Observaciones

Esta función normalmente realiza llamadas a **la** PX_ familia de funciones para cargar o almacenar propiedades específicas definidas por el usuario de un control OLE.

Si se ha utilizado el Asistente para control para crear el proyecto de control `COleControl` OLE, la versión `COleControl::DoPropExchange`invalidada de esta función serializará las propiedades de stock admitidas con una llamada a la función de clase base, . A medida que agregue propiedades definidas por el usuario al control OLE, deberá modificar esta función para serializar las nuevas propiedades. Para obtener más información sobre la serialización, vea el artículo [Controles ActiveX: serialización](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint

Redibuja un control OLE que se ha subclase desde un control de Windows.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Puntero al contexto del dispositivo del contenedor de control.

*rcBounds*<br/>
El área en la que se va a dibujar el control.

### <a name="remarks"></a>Observaciones

Llame a esta función para controlar correctamente la pintura de un control OLE no activo. Esta función solo se debe usar si el control OLE `OnDraw` subclases un control de Windows y debe llamarse en la función del control.

Para obtener más información sobre esta función y subclases de un control de Windows, vea el artículo [Controles ActiveX: Subclase](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)de un control de Windows .

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>COleControl::DrawContent

Llamado por el marco de trabajo cuando la apariencia del control debe actualizarse.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Puntero al contexto del dispositivo.

*Rc*<br/>
Zona rectangular a dibujar.

### <a name="remarks"></a>Observaciones

Esta función llama directamente a la función reemplazable. `OnDraw`

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>COleControl::DrawMetafile

Llamado por el marco de trabajo cuando se utiliza el contexto del dispositivo de metarchivo.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Puntero al contexto del dispositivo de metarchivo.

*Rc*<br/>
Zona rectangular a dibujar.

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>COleControl::EnableSimpleFrame

Habilita la característica de marco simple para un control OLE.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Observaciones

Esta característica permite que un control admita la contención visual de otros controles, pero no la contención OLE verdadera. Un ejemplo sería un cuadro de grupo con varios controles dentro. Estos controles no están contenidos en OLE, pero están en el mismo cuadro de grupo.

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>COleControl::ExchangeExtent

Serializa o inicializa el estado de la extensión del control (sus dimensiones en unidades HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parámetros

*pPX*<br/>
Un puntero a un [CPropExchange](../../mfc/reference/cpropexchange-class.md) objeto. El marco de trabajo proporciona este objeto para establecer el contexto del intercambio de propiedades, incluida su dirección.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la función se realizó correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

Normalmente, la implementación predeterminada `COleControl::DoPropExchange`de .

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>COleControl::ExchangeStockProps

Serializa o inicializa el estado de las propiedades de stock del control.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parámetros

*pPX*<br/>
Un puntero a un [CPropExchange](../../mfc/reference/cpropexchange-class.md) objeto. El marco de trabajo proporciona este objeto para establecer el contexto del intercambio de propiedades, incluida su dirección.

### <a name="remarks"></a>Observaciones

Normalmente, la implementación predeterminada `COleControl::DoPropExchange`de .

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>COleControl::ExchangeVersion

Serializa o inicializa el estado de la información de versión de un control.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parámetros

*pPX*<br/>
Puntero a un objeto `CPropExchange` . El marco de trabajo proporciona este objeto para establecer el contexto del intercambio de propiedades, incluida su dirección.

*dwVersionDefault*<br/>
El número de versión actual del control.

*bConvertir*<br/>
Indica si los datos persistentes se deben convertir al formato más reciente cuando se guardan o se mantienen en el mismo formato que se cargó.

### <a name="return-value"></a>Valor devuelto

Distinto de cero de la función se realizó correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

Normalmente, esta será la primera función a `COleControl::DoPropExchange`la que llama la invalidación de un control de . Al cargar, esta función lee el número de versión de los datos persistentes y establece el atributo version del objeto [CPropExchange](../../mfc/reference/cpropexchange-class.md) en consecuencia. Al guardar, esta función escribe el número de versión de los datos persistentes.

Para obtener más información sobre la persistencia y el control de versiones, consulte el artículo [Controles ActiveX: serialización](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>COleControl::FireClick

Llamado por el marco de trabajo cuando se hace clic en el mouse sobre un control activo.

```
void FireClick();
```

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento Click, el mapa de eventos del control debe tener definido un evento Click de stock.

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>COleControl::FireDblClick

Llamado por el marco de trabajo cuando se hace doble clic en el mouse sobre un control activo.

```
void FireDblClick();
```

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento DblClick, el mapa de eventos del control debe tener definido un evento DblClick de stock.

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>COleControl::FireError

Activa el evento Error de stock.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parámetros

*scode*<br/>
El valor del código de estado que se va a notificar. Para obtener una lista completa de los códigos posibles, consulte el artículo [Controles ActiveX: Temas avanzados](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
La descripción del error que se notifica.

*nHelpID*<br/>
El identificador de ayuda del error que se notifica.

### <a name="remarks"></a>Observaciones

Este evento proporciona una forma de señalar, en los lugares adecuados del código, que se ha producido un error dentro del control. A diferencia de otros eventos de stock, como Click o MouseMove, Error nunca se desencadena por el marco de trabajo.

Para notificar un error que se produce durante una función get de propiedad, una función de conjunto de propiedades o un método de automatización, llame a [COleControl::ThrowError](#throwerror).

La implementación de un control OLE Stock Error eventos utiliza un SCODE valor. Si el control usa este evento y está pensado para usarse en Visual Basic 4.0, recibirá errores porque el valor SCODE no se admite en Visual Basic.

Para solucionar este problema, cambie manualmente el parámetro SCODE en el control . ODL a un **archivo largo**. Además, cualquier evento personalizado, método o propiedad que usa un parámetro SCODE también causa el mismo problema.

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>COleControl::FireEvent

Desencadena un evento definido por el usuario desde el control con cualquier número de argumentos opcionales,.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parámetros

*dispid*<br/>
El id de envío del evento que se va a desencadenar.

*pbParams*<br/>
Un descriptor para los tipos de parámetros del evento.

### <a name="remarks"></a>Observaciones

Por lo general, esta función no debe llamarse directamente. En su lugar, llamará a las funciones de desencadenamiento de eventos en la sección de mapa de eventos de la declaración de clase del control.

El argumento *pbParams* es una lista separada por espacios de **VTS_**. Uno o varios de estos valores, separados por espacios (no por comas), especifican la lista de parámetros de la función. Los valores posibles son los siguientes:

|Símbolo|Tipo de parámetro|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> Se han definido constantes de variante adicionales para todos los tipos de variante, con la excepción de VTS_FONT y VTS_PICTURE, que proporcionan un puntero a la constante de datos de variante. Estas constantes se denominan mediante la convención **VTS_P.** `constantname` Por ejemplo, VTS_PCOLOR es un puntero a una constante VTS_COLOR.

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>COleControl::FireKeyDown

Llamado por el marco de trabajo cuando se presiona una tecla mientras el control está activo.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parámetros

*pnChar*<br/>
Puntero al valor del código de tecla virtual de la tecla pulsada. Para obtener una lista de códigos de clave virtuales estándar, consulte Winuser.h

*nShiftState*<br/>
Contiene una combinación de los siguientes indicadores:

- SHIFT_MASK Se ha pulsado la tecla Mayús durante la acción.

- CTRL_MASK Se ha presionado la tecla CTRL durante la acción.

- ALT_MASK Se ha presionado la tecla ALT durante la acción.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento KeyDown, el mapa de eventos del control debe tener un evento KeyDown de stock definido.

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>COleControl::FireKeyPress

Llamado por el marco de trabajo cuando se presiona y libera una tecla mientras el control personalizado es UI Active dentro del contenedor.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parámetros

*pnChar*<br/>
Un puntero al valor de carácter de la tecla presionada.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

El destinatario del evento puede modificar *pnChar*, por ejemplo, convertir todos los caracteres en minúsculas a mayúsculas. Si desea examinar el carácter `OnKeyPressEvent`modificado, reemplace .

Para que se produzca la activación automática de un evento KeyPress, el mapa de eventos del control debe tener un evento KeyPress definido.

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>COleControl::FireKeyUp

Llamado por el marco de trabajo cuando se libera una clave mientras el control personalizado es UI Active dentro del contenedor.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parámetros

*pnChar*<br/>
Puntero al valor de código de clave virtual de la clave liberada. Para obtener una lista de códigos de clave virtuales estándar, consulte Winuser.h

*nShiftState*<br/>
Contiene una combinación de los siguientes indicadores:

- SHIFT_MASK Se ha pulsado la tecla Mayús durante la acción.

- CTRL_MASK Se ha presionado la tecla CTRL durante la acción.

- ALT_MASK Se ha presionado la tecla ALT durante la acción.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento KeyUp, el mapa de eventos del control debe tener definido un evento KeyUp de stock.

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>COleControl::FireMouseDown

Llamado por el marco de trabajo cuando se presiona un botón del mouse sobre un control personalizado activo.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parámetros

*nButton*<br/>
El valor numérico del botón del ratón pulsado. Puede contener uno de los siguientes valores:

- LEFT_BUTTON Se ha pulsado el botón izquierdo del ratón.

- MIDDLE_BUTTON Se ha pulsado el botón central del ratón.

- RIGHT_BUTTON Se ha pulsado el botón derecho del ratón.

*nShiftState*<br/>
Contiene una combinación de los siguientes indicadores:

- SHIFT_MASK Se ha pulsado la tecla Mayús durante la acción.

- CTRL_MASK Se ha presionado la tecla CTRL durante la acción.

- ALT_MASK Se ha presionado la tecla ALT durante la acción.

*X*<br/>
Coordenada x del cursor cuando se presiona un botón del ratón hacia abajo. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

*y y*<br/>
Coordenada y del cursor cuando se presiona un botón del ratón hacia abajo. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento MouseDown, el mapa de eventos del control debe tener un evento MouseDown definido.

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>COleControl::FireMouseMove

Llamado por el marco de trabajo cuando el cursor se mueve sobre un control personalizado activo.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parámetros

*nButton*<br/>
El valor numérico de los botones del ratón presionado. Contiene una combinación de los siguientes valores:

- LEFT_BUTTON Se ha pulsado el botón izquierdo del ratón durante la acción.

- MIDDLE_BUTTON El botón central del ratón se ha pulsado pulsado durante la acción.

- RIGHT_BUTTON Se ha pulsado el botón derecho del ratón durante la acción.

*nShiftState*<br/>
Contiene una combinación de los siguientes indicadores:

- SHIFT_MASK Se ha pulsado la tecla Mayús durante la acción.

- CTRL_MASK Se ha presionado la tecla CTRL durante la acción.

- ALT_MASK Se ha presionado la tecla ALT durante la acción.

*X*<br/>
Coordenada x del cursor. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

*y y*<br/>
Coordenada y del cursor. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento MouseMove, el mapa de eventos del control debe tener definido un evento MouseMove de stock.

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>COleControl::FireMouseUp

Llamado por el marco de trabajo cuando se suelta un botón del mouse sobre un control personalizado activo.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parámetros

*nButton*<br/>
El valor numérico del botón del ratón liberado. Puede tener uno de los siguientes valores:

- LEFT_BUTTON Se ha soltado el botón izquierdo del ratón.

- MIDDLE_BUTTON Se soltó el botón central del ratón.

- RIGHT_BUTTON Se ha soltado el botón derecho del ratón.

*nShiftState*<br/>
Contiene una combinación de los siguientes indicadores:

- SHIFT_MASK Se ha pulsado la tecla Mayús durante la acción.

- CTRL_MASK Se ha presionado la tecla CTRL durante la acción.

- ALT_MASK Se ha presionado la tecla ALT durante la acción.

*X*<br/>
Coordenada x del cursor cuando se soltó un botón del ratón. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

*y y*<br/>
Coordenada y de un cursor cuando se suelta un botón del ratón. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento MouseUp, el mapa de eventos del control debe tener definido un evento MouseUp de stock.

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>COleControl::FireReadyStateChange

Desencadena un evento con el valor actual del estado de control listo.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Observaciones

El estado ready puede ser uno de los siguientes valores:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialización predeterminado|
|READYSTATE_LOADING|Control está cargando sus propiedades|
|READYSTATE_LOADED|Se ha inicializado el control|
|READYSTATE_INTERACTIVE|Control tiene suficientes datos para ser interactivo, pero no todos los datos asincrónicos aún están cargados|
|READYSTATE_COMPLETE|Control tiene todos sus datos|

Use [GetReadyState](#getreadystate) para determinar la preparación actual del control.

[InternalSetReadyState](#internalsetreadystate) cambia el estado ready al `FireReadyStateChange`valor proporcionado y, a continuación, llama a .

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>COleControl::GetActivationPolicy

Altera el comportamiento de activación predeterminado `IPointerInactive` de un control que admite la interfaz.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Valor devuelto

Combinación de indicadores de la enumeración POINTERINACTIVE. Las banderas posibles son:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|El objeto debe activarse in situ cuando el ratón lo introduce durante una operación de movimiento del ratón.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|El objeto debe desactivarse cuando el ratón deja el objeto durante una operación de movimiento del mouse.|
|POINTERINACTIVE_ACTIVATEONDRAG|El objeto debe activarse in situ cuando se arrastra el ratón sobre él durante una operación de arrastrar y soltar.|

### <a name="remarks"></a>Observaciones

Cuando `IPointerInactive` la interfaz está habilitada, el contenedor delegará WM_SETCURSOR y WM_MOUSEMOVE mensajes en él. `COleControl`'s implementación de esta interfaz enviará estos mensajes a través del mapa de mensajes de su control, después de ajustar las coordenadas del ratón adecuadamente.

Siempre que el contenedor recibe un WM_SETCURSOR o WM_MOUSEMOVE mensaje con `IPointerInactive`el puntero `GetActivationPolicy` del mouse sobre un objeto inactivo que admite , debe llamar a la interfaz y devolver indicadores de la enumeración POINTERINACTIVE.

Puede procesar estos mensajes al igual que los mensajes de ventana normales, agregando las entradas correspondientes al mapa de mensajes. En los controladores, `m_hWnd` evite usar la variable miembro (o cualquier función miembro que la use) sin comprobar primero que su valor no es NULL.

Cualquier objeto destinado a hacer más que establecer el cursor del mouse y/o desencadenar un evento de movimiento del mouse, como proporcionar comentarios visuales especiales, debe devolver el POINTERINACTIVE_ACTIVATEONENTRY marca y dibujar los comentarios solo cuando está activo. Si el objeto devuelve esta marca, el contenedor debe activarlo inmediatamente en su `GetActivationPolicy`lugar y, a continuación, reenviarlo el mismo mensaje que desencadenó la llamada a .

Si se devuelven los indicadores POINTERINACTIVE_ACTIVATEONENTRY y POINTERINACTIVE_DEACTIVATEONLEAVE, el objeto solo se activará cuando el mouse esté sobre el objeto. Si solo se devuelve el indicador POINTERINACTIVE_ACTIVATEONENTRY, el objeto solo se activará una vez cuando el mouse entre por primera vez en el objeto.

También puede desear que un control inactivo sea el destino de una operación ole de arrastrar y colocar. Esto requiere activar el control en el momento en que el usuario arrastra un objeto sobre él, de modo que la ventana del control se puede registrar como un destino de colocación. Para hacer que la activación se produzca durante un arrastre, devuelva la marca POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

La información comunicada `GetActivationPolicy` por un contenedor no debe almacenarse en caché. En su lugar, se debe llamar a este método cada vez que el mouse entra en un objeto inactivo.

Si un objeto inactivo no solicita que se active en contexto cuando el mouse entra en él, su contenedor debe distribuir mensajes WM_SETCURSOR posteriores a este objeto llamando a [OnInactiveSetCursor](#oninactivesetcursor) siempre y cuando el puntero del mouse permanezca sobre el objeto.

Habilitar `IPointerInactive` la interfaz normalmente significa que desea que el control sea capaz de procesar mensajes del mouse en todo momento. Para obtener este comportamiento en un contenedor `IPointerInactive` que no admite la interfaz, necesitará tener el control siempre activado cuando sea visible, lo que significa que el control debe tener la bandera OLEMISC_ACTIVATEWHENVISIBLE entre sus banderas diversas. Sin embargo, para evitar que esta marca `IPointerInactive`surta efecto en un contenedor que admita , también puede especificar el OLEMISC_IGNOREACTIVATEWHENVISIBLE marca:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>COleControl::GetAmbientProperty

Obtiene el valor de una propiedad ambiente del contenedor.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parámetros

*dwDispid*<br/>
El ID de envío de la propiedad ambiental deseada.

*vtProp*<br/>
Una etiqueta de tipo de variante que especifica el tipo del valor que se devolverá en *pvProp*.

*pvProp*<br/>
Puntero a la dirección de la variable que recibirá el valor de propiedad o valor devuelto. El tipo real de este puntero debe coincidir con el tipo especificado por *vtProp*.

|vtProp|Tipo de pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se admite la propiedad ambiente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Si utiliza `GetAmbientProperty` para recuperar las propiedades ambient DisplayName y ScaleUnits, establezca `CString*` *vtProp* en VT_BSTR y *pvProp* en . Si va a recuperar la propiedad Ambient Font, establezca *vtProp en* VT_FONT y *pvProp* en LPFONTDISP*.

Tenga en cuenta que ya se han proporcionado funciones para propiedades ambientales comunes, como [AmbientBackColor](#ambientbackcolor) y [AmbientFont](#ambientfont).

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>COleControl::GetAppearance

Implementa la función Get de la propiedad Apariencia de stock del control.

```
short GetAppearance ();
```

### <a name="return-value"></a>Valor devuelto

El valor devuelto especifica la configuración de apariencia actual como un valor **corto** (VT_I2), si se realiza correctamente. Este valor es cero si la apariencia del control es plana y 1 si la apariencia del control es 3D.

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>COleControl::GetBackColor

Implementa la función Get de la propiedad BackColor del control.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Valor devuelto

El valor devuelto especifica el color de fondo actual como un valor OLE_COLOR, si se realiza correctamente. Este valor se puede traducir a un valor `TranslateColor`COLORREF con una llamada a .

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>COleControl::GetBorderStyle

Implementa la función Get de la propiedad BorderStyle de stock del control.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Valor devuelto

1 si el control tiene un borde normal; 0 si el control no tiene borde.

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>COleControl::GetCapture

Determina si `COleControl` el objeto tiene la captura del mouse.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Valor devuelto

Si el control está activado y sin ventanas, devuelve **esto** si el control tiene actualmente la captura del mouse (según lo determinado por el contenedor del control), o NULL si no tiene la captura.

De lo `CWnd` contrario, devuelve el objeto `CWnd::GetCapture`que tiene la captura del mouse (igual que ).

### <a name="remarks"></a>Observaciones

Un control sin ventanaactivado recibe la captura del mouse cuando [setCapture](#setcapture) se llama.

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>COleControl::GetClassID

Llamado por el marco de trabajo para recuperar el identificador de clase OLE del control.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parámetros

*pclsid*<br/>
Puntero a la ubicación del identificador de clase.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada no se realizó correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Normalmente implementado por el [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>COleControl::GetClientOffset

Recupera la diferencia entre la esquina superior izquierda del área rectangular del control y la esquina superior izquierda de su área de cliente.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parámetros

*pdxOffset*<br/>
Puntero al desplazamiento horizontal del área de cliente del control OLE.

*pdyOffset*<br/>
Puntero al desplazamiento vertical del área de cliente del control OLE.

### <a name="remarks"></a>Observaciones

El control OLE tiene un área rectangular dentro de su contenedor. El área de cliente del control es el área de control excluyendo bordes y barras de desplazamiento. El desplazamiento recuperado `GetClientOffset` por es la diferencia entre la esquina superior izquierda del área rectangular del control y la esquina superior izquierda de su área de cliente. Si el control tiene elementos que no son clientes distintos de los bordes estándar y barras de desplazamiento, reemplace esta función miembro para especificar el desplazamiento.

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>COleControl::GetClientRect

Recupera el tamaño del área de cliente del control.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parámetros

*lpRect*<br/>
Puntero a `RECT` una estructura que contiene las dimensiones del área de cliente del control sin ventanas; es decir, el tamaño del control menos bordes de ventana, marcos, barras de desplazamiento, etc. El parámetro *lpRect* indica el tamaño del rectángulo de cliente del control, no su posición.

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>COleControl::GetClientSite

Consulta un objeto para el puntero a su sitio de cliente actual dentro de su contenedor.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Valor devuelto

Puntero al sitio de cliente actual del control en su contenedor.

### <a name="remarks"></a>Observaciones

El puntero devuelto apunta `IOleClientSite`a una instancia de . La `IOleClientSite` interfaz, implementada por contenedores, es la vista del objeto de su contexto: donde está anclada en el documento, donde obtiene su almacenamiento, interfaz de usuario y otros recursos.

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>COleControl::GetControlFlags

Recupera la configuración del indicador de control.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Valor devuelto

Una combinación ORed de los indicadores en el ControlFlags enumeración:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Observaciones

De manera predeterminada, `GetControlFlags` devuelve `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Si se establece, usa una función begin-paint adaptada a los controles OLE en lugar de la [API BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) (establecida de forma predeterminada).|
|`clipPaintDC`|Si no se establece, `IntersectClipRect` deshabilita `COleControl` la llamada a realizado por y gana una pequeña ventaja de velocidad. Si está utilizando la activación sin ventanas, la marca no tiene ningún efecto.|
|`pointerInactive`|Si se establece, proporciona la interacción `COleControl`del mouse mientras el control está inactivo habilitando la implementación de la `IPointerInactive` interfaz, que está deshabilitada de forma predeterminada.|
|`noFlickerActivate`|Si se establece, elimina las operaciones de dibujo adicionales y el parpadeo visual que lo acompaña. Utilícelo cuando el control se dibuje de forma idéntica en los estados inactivo y activo. Si está utilizando la activación sin ventanas, la marca no tiene ningún efecto.|
|`windowlessActivate`|Si se establece, indica que el control utiliza la activación sin ventanas.|
|`canOptimizeDraw`|Si se establece, indica que el control realizará un dibujo optimizado, si el contenedor lo admite.|

Para obtener `GetControlFlags` más información y otras optimizaciones de controles OLE, vea [Controles ActiveX: optimización](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>COleControl::GetControlSize

Recupera el tamaño de la ventana de control OLE.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parámetros

*Pcx*<br/>
Especifica el ancho del control en píxeles.

*pcy*<br/>
Especifica la altura del control en píxeles.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que todas las coordenadas de las ventanas de control son relativas a la esquina superior izquierda del control.

## <a name="colecontrolgetdc"></a><a name="getdc"></a>COleControl::GetDC

Proporciona un objeto sin ventanapara obtener un contexto de dispositivo de pantalla (o compatible) de su contenedor.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parámetros

*lprcRect*<br/>
Un puntero al rectángulo que el control sin ventana sin ventana desea volver a dibujar, en las coordenadas de cliente del control. NULL significa la extensión del objeto completo.

*dwFlags*<br/>
Atributos de dibujo del contexto del dispositivo. Las opciones son:

- OLEDC_NODRAW Indica que el objeto no utilizará el contexto del dispositivo para realizar ningún dibujo, sino simplemente para obtener información sobre el dispositivo de visualización. El contenedor simplemente debe pasar el controlador de dominio de la ventana sin procesamiento adicional.

- OLEDC_PAINTBKGND solicita que el contenedor pinte el fondo antes de devolver el controlador de dominio. Un objeto debe utilizar esta marca si está solicitando un controlador de dominio para volver a dibujar un área con fondo transparente.

- OLEDC_OFFSCREEN informa al contenedor que el objeto desea representar en un mapa de bits fuera de la pantalla que, a continuación, se debe copiar en la pantalla. Un objeto debe utilizar esta marca cuando la operación de dibujo que está a punto de realizar genera una gran cantidad de parpadeo. El contenedor es libre de cumplir con esta solicitud o no. Sin embargo, si no se establece esta marca, el contenedor debe devolver un controlador de dominio en pantalla. Esto permite a los objetos realizar operaciones de pantalla directa, como mostrar una selección (mediante una operación **XOR).**

### <a name="return-value"></a>Valor devuelto

Puntero al contexto del dispositivo `CWnd` de visualización para el área de cliente de contenedor si se realiza correctamente; de lo contrario, el valor devuelto es NULL. El contexto del dispositivo de visualización se puede utilizar en funciones GDI posteriores para dibujar en el área de cliente de la ventana del contenedor.

### <a name="remarks"></a>Observaciones

El [ReleaseDC](#releasedc) función miembro debe llamarse para liberar el contexto después de pintar. Al `GetDC`llamar a , los objetos pasan el rectángulo en el que desean dibujar en sus propias coordenadas de cliente. `GetDC`traduce estos a coordenadas del área de cliente contenedor. El objeto no debe solicitar un rectángulo de dibujo deseado mayor que su propio rectángulo de área de cliente, cuyo tamaño se puede recuperar con [GetClientRect](#getclientrect). Esto evita que los objetos se dibujen inadvertidamente donde no se supone que lo hagan.

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>COleControl::GetEnabled

Implementa la función Get de la propiedad Enabled de stock del control.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el control está habilitado; de lo contrario 0.

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>COleControl::GetExtendedControl

Obtiene un puntero a un objeto mantenido por el contenedor que representa el control con un conjunto extendido de propiedades.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto de control extendido del contenedor. Si no hay ningún objeto disponible, el valor es NULL.

Este objeto puede ser `IDispatch` manipulado a través de su interfaz. También puede `QueryInterface` utilizar para obtener otras interfaces disponibles proporcionadas por el objeto. Sin embargo, el objeto no es necesario para admitir un conjunto específico de interfaces. Tenga en cuenta que confiar en las características específicas del objeto de control extendido de un contenedor limita la portabilidad del control a otros contenedores arbitrarios.

### <a name="remarks"></a>Observaciones

La función que llama a esta función es responsable de liberar el puntero cuando termine con el objeto. Tenga en cuenta que el contenedor no es necesario para admitir este objeto.

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>COleControl::GetFocus

Determina si `COleControl` el objeto tiene el foco.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Valor devuelto

Si el control está activado y sin ventanas, devuelve **esto** si el control tiene actualmente el foco del teclado (según lo determinado por el contenedor del control) o NULL si no tiene el foco.

De lo `CWnd` contrario, devuelve el objeto `CWnd::GetFocus`que tiene el foco (igual que ).

### <a name="remarks"></a>Observaciones

Un control sin ventanaactivado recibe el foco cuando [setFocus](#setfocus) se llama.

## <a name="colecontrolgetfont"></a><a name="getfont"></a>COleControl::GetFont

Implementa la función Get de la propiedad Font de stock.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Valor devuelto

Un puntero a la interfaz de envío de fuentes de la propiedad Font de stock del control.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que el autor de la llamada debe liberar el objeto cuando haya terminado. Dentro de la implementación `InternalGetFont` del control, se utiliza para tener acceso al objeto Font de stock del control. Para obtener más información sobre el uso de fuentes en el control, consulte el artículo [Controles ActiveX: Uso](../../mfc/mfc-activex-controls-using-fonts.md)de fuentes en un control ActiveX .

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics

Mide las métricas `CFontHolder` de texto para cualquier objeto que pertenece al control.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parámetros

*lptm*<br/>
Puntero a una estructura [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

*fontHolder*<br/>
Referencia a un [CFontHolder](../../mfc/reference/cfontholder-class.md) objeto.

### <a name="remarks"></a>Observaciones

Dicha fuente se puede seleccionar con la función [COleControl::SelectFontObject.](#selectfontobject) `GetFontTextMetrics`inicializará `TEXTMETRIC` la estructura señalada por *lptm* `fontHolder`con información de métricas válidas sobre la fuente de 's si se realiza correctamente, o rellenará la estructura con ceros si no se realiza correctamente. Debe usar esta función en lugar de [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) al pintar el control porque los controles, como cualquier objeto OLE incrustado, pueden ser necesarios para representarse a sí mismos en un metarchivo.

La `TEXTMETRIC` estructura de la fuente predeterminada se actualiza cuando se llama a la función [SelectFontObject.](#selectfontobject) Solo debe `GetFontTextMetrics` llamar después de seleccionar la propiedad Font para asegurarse de que la información que proporciona es válida.

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>COleControl::GetForeColor

Implementa la función Get de la propiedad ForeColor de stock.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Valor devuelto

El valor devuelto especifica el color de primer plano actual como un valor OLE_COLOR, si se realiza correctamente. Este valor se puede traducir a un valor `TranslateColor` [COLORREF](/windows/win32/gdi/colorref) con una llamada a .

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>COleControl::GetHwnd

Implementa la función Get de la propiedad hWnd de stock.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Valor devuelto

Identificador de ventana del control OLE, si existe; NULL.

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>COleControl::GetMessageString

Llamado por el marco de trabajo para obtener una cadena corta que describe el propósito del elemento de menú identificado por *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Un identificador de elemento de menú.

*rMessage*<br/>
Una referencia a un [CString](../../atl-mfc-shared/reference/cstringt-class.md) objeto a través del cual se devolverá una cadena.

### <a name="remarks"></a>Observaciones

Esto se puede utilizar para obtener un mensaje para mostrar en una barra de estado mientras se resalta el elemento de menú. La implementación predeterminada intenta cargar un recurso de cadena identificado por *nID*.

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>COleControl::GetNotSupported

Impide el acceso al valor de propiedad de un control por parte del usuario.

```
void GetNotSupported();
```

### <a name="remarks"></a>Observaciones

Llame a esta función en lugar de la Función Get de cualquier propiedad donde no se admite la recuperación de la propiedad por el usuario del control. Un ejemplo sería una propiedad que es solo escritura.

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>COleControl::GetReadyState

Devuelve el estado de preparación del control.

```
long GetReadyState();
```

### <a name="return-value"></a>Valor devuelto

El estado de preparación del control, uno de los siguientes valores:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialización predeterminado|
|READYSTATE_LOADING|Control está cargando sus propiedades|
|READYSTATE_LOADED|Se ha inicializado el control|
|READYSTATE_INTERACTIVE|Control tiene suficientes datos para ser interactivo, pero no todos los datos asincrónicos aún están cargados|
|READYSTATE_COMPLETE|Control tiene todos sus datos|

### <a name="remarks"></a>Observaciones

La mayoría de los controles simples nunca necesitan diferenciar entre LOADED y INTERACTIVE. Sin embargo, es posible que los controles que admiten propiedades de ruta de acceso de datos no estén listos para ser interactivos hasta que al menos algunos datos se reciban de forma asincrónica. Un control debe intentar ser interactivo tan pronto como sea posible.

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>COleControl::GetRectInContainer

Obtiene las coordenadas del rectángulo del control en relación con el contenedor, expresado en unidades de dispositivo.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*lpRect*<br/>
Puntero a la estructura del rectángulo en la que se copiarán las coordenadas del control.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el control está activo en el lugar; de lo contrario 0.

### <a name="remarks"></a>Observaciones

El rectángulo solo es válido si el control está activo en su lugar.

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics

Mide las métricas de texto para la propiedad Font de stock del control, que se puede seleccionar con la función [SelectStockFont.](#selectstockfont)

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parámetros

*lptm*<br/>
Puntero a una estructura [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

### <a name="remarks"></a>Observaciones

La `GetStockTextMetrics` función `TEXTMETRIC` inicializará la estructura señalada por *lptm* con información de métricas válida si se realiza correctamente, o rellenará la estructura con ceros si no se realiza correctamente. Utilice esta función en lugar de [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) al pintar el control porque los controles, como cualquier objeto OLE incrustado, pueden ser necesarios para representarse a sí mismos en un metarchivo.

La `TEXTMETRIC` estructura de la fuente predeterminada `SelectStockFont` se actualiza cuando se llama a la función. Debe llamar a esta función solo después de seleccionar la fuente de stock para asegurarse de que la información que proporciona es válida.

## <a name="colecontrolgettext"></a><a name="gettext"></a>COleControl::GetText

Implementa la función Get de la propiedad Text o Caption.

```
BSTR GetText();
```

### <a name="return-value"></a>Valor devuelto

El valor actual de la cadena de texto de control o una cadena de longitud cero si no hay ninguna cadena presente.

> [!NOTE]
> Para obtener más información sobre el tipo de datos BSTR, consulte [Tipos de datos](../../mfc/reference/data-types-mfc.md) en la sección Macros y globales.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que el `SysFreeString` llamador de esta función debe llamar a la cadena devuelta para liberar el recurso. Dentro de la implementación `InternalGetText` del control, se usa para tener acceso a la propiedad Text o Caption del control.

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>COleControl::GetWindowlessDropTarget

Reemplazar `GetWindowlessDropTarget` cuando desee que un control sin ventanas sea el destino de una operación ole de arrastrar y colocar.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Valor devuelto

Puntero a la `IDropTarget` interfaz del objeto. Puesto que no tiene una ventana, un `IDropTarget` objeto sin ventana no puede registrar una interfaz. Sin embargo, para participar en arrastrar y soltar, un objeto `GetWindowlessDropTarget`sin ventanas todavía puede implementar la interfaz y devolverla en .

### <a name="remarks"></a>Observaciones

Normalmente, esto requeriría que la ventana del control se registre como un destino de colocación. Pero dado que el control no tiene ninguna ventana propia, el contenedor usará su propia ventana como destino de colocación. El control simplemente necesita proporcionar `IDropTarget` una implementación de la interfaz a la que el contenedor puede delegar llamadas en el momento adecuado. Por ejemplo:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>COleControl::InitializeIIDs

Informa a la clase base de los IDE que utilizará el control.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parámetros

*piidPrimary*<br/>
Puntero al identificador de interfaz de la interfaz de envío principal del control.

*piidEvents*<br/>
Puntero al identificador de interfaz de la interfaz de eventos del control.

### <a name="remarks"></a>Observaciones

Llame a esta función en el constructor del control para informar a la clase base de los controladores de interfaz que usará el control.

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>COleControl::InternalGetFont

Accede a la propiedad Font de su control

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Valor devuelto

Una referencia a un [CFontHolder](../../mfc/reference/cfontholder-class.md) objeto que contiene el stock Font objeto.

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>COleControl::InternalGetText

Accede a la propiedad Text o Caption del control.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Valor devuelto

Una referencia a la cadena de texto del control.

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>COleControl::InternalSetReadyState

Establece el estado de preparación del control.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parámetros

*lNewReadyState*<br/>
El estado de preparación que se establece para el control, uno de los siguientes valores:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialización predeterminado|
|READYSTATE_LOADING|Control está cargando sus propiedades|
|READYSTATE_LOADED|Se ha inicializado el control|
|READYSTATE_INTERACTIVE|Control tiene suficientes datos para ser interactivo, pero no todos los datos asincrónicos aún están cargados|
|READYSTATE_COMPLETE|Control tiene todos sus datos|

### <a name="remarks"></a>Observaciones

La mayoría de los controles simples nunca necesitan diferenciar entre LOADED y INTERACTIVE. Sin embargo, es posible que los controles que admiten propiedades de ruta de acceso de datos no estén listos para ser interactivos hasta que al menos algunos datos se reciban de forma asincrónica. Un control debe intentar ser interactivo tan pronto como sea posible.

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>COleControl::InvalidateControl

Obliga al control a redibujarse.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parámetros

*lpRect*<br/>
Puntero a la región del control que se va a invalidar.

*bErase*<br/>
Especifica si el fondo dentro de la región de actualización se va a borrar cuando se procesa la región de actualización.

### <a name="remarks"></a>Observaciones

Si *lpRect* tiene un valor NULL, se redibujará todo el control. Si *lpRect* no es NULL, esto indica la parte del rectángulo del control que se va a invalidar. En los casos donde el control no tiene ninguna ventana o actualmente no está activo, se omite el rectángulo y se realiza una llamada a la función miembro [IAdviseSink::OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) del sitio cliente. Utilice esta función en lugar de `CWnd::InvalidateRect` o `InvalidateRect`.

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>COleControl::InvalidateRgn

Invalida el área de cliente de la ventana contenedora dentro de la región dada.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parámetros

*pRgn*<br/>
Puntero a un [CRgn](../../mfc/reference/crgn-class.md) objeto que identifica la región de visualización del objeto OLE para invalidar, en las coordenadas de cliente de la ventana contenedora. Si este parámetro es NULL, la extensión es todo el objeto.

*bErase*<br/>
Especifica si se va a borrar el fondo dentro de la región invalidada. Si es TRUE, se borra el fondo. Si FALSE, el fondo permanece sin cambios.

### <a name="remarks"></a>Observaciones

Esto se puede utilizar para volver a dibujar controles sin ventanas dentro del contenedor. La región invalidada, junto con todas las demás áreas de la región de actualización, se marca para pintar cuando se envía el siguiente [mensaje de WM_PAINT.](/windows/win32/gdi/wm-paint)

Si *bBorrar* es TRUE para cualquier parte de la región de actualización, se borra el fondo de toda la región, no solo en la parte dada.

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>COleControl::IsConvertingVBX

Permite la carga especializada de un control OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el control se está convirtiendo; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Al convertir un formulario que usa controles VBX en uno que usa controles OLE, puede ser necesario un código de carga especial para los controles OLE. Por ejemplo, si está cargando una instancia del control [PX_Font](persistence-of-ole-controls.md#px_font) OLE, `DoPropExchange`es posible que tenga una llamada a PX_Font en :

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Sin embargo, los controles VBX no tenían un Font objeto; cada propiedad de fuente se guardó individualmente. En este caso, `IsConvertingVBX` usaría para distinguir entre estos dos casos:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Otro caso sería si el control VBX guarda datos binarios propietarios (en su VBM_SAVEPROPERTY controlador de mensajes) y el control OLE guarda sus datos binarios en un formato diferente. Si desea que el control OLE sea compatible con versiones anteriores con el `IsConvertingVBX` control VBX, puede leer los formatos antiguo y nuevo mediante la función distinguiendo si se estaba cargando el control VBX o el control OLE.

En la función del `DoPropExchange` control, puede comprobar esta condición y, si es true, ejecutar código de carga específico para esta conversión (como los ejemplos anteriores). Si el control no se está convirtiendo, puede ejecutar código de carga normal. Esta habilidad solo es aplicable a los controles que se convierten desde contrapartes de VBX.

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed

Habilita la invocación de métodos de automatización.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se ha inicializado el control; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Implementación del marco `IDispatch::Invoke` `IsInvokeAllowed` de trabajo de llamadas `dispid`para determinar si se puede invocar una función determinada (identificada por ) . El comportamiento predeterminado de un control OLE es permitir que se invoquen métodos de automatización solo si se ha inicializado el control; sin `IsInvokeAllowed` embargo, es una función virtual y se puede invalidar si es necesario (por ejemplo, cuando el control se utiliza como servidor de automatización).

## <a name="colecontrolismodified"></a><a name="ismodified"></a>COleControl::IsModified

Determina si se ha modificado el estado del control.

```
BOOL IsModified();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el estado del control se ha modificado desde la última vez que se guardó; de lo contrario 0.

### <a name="remarks"></a>Observaciones

El estado de un control se modifica cuando una propiedad cambia de valor.

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>COleControl::IsOptimizedDraw

Determina si el contenedor admite el dibujo optimizado para la operación de dibujo actual.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Valor devuelto

TRUESi el contenedor admite el dibujo optimizado para la operación de dibujo actual; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

Si se admite el dibujo optimizado, el control no necesita seleccionar objetos antiguos (lápices, pinceles, fuentes, etc.) en el contexto del dispositivo cuando finaliza el dibujo.

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl

Llamado por el marco de trabajo para determinar si el control subclases un control de Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el control está subclase; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Debe invalidar esta función y devolver TRUE si el control OLE subclases un control de Windows.

## <a name="colecontrolload"></a><a name="load"></a>COleControl::Carga

Restablece los datos anteriores cargados de forma asincrónica e inicia una nueva carga de la propiedad asincrónica del control.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parámetros

*strNewPath*<br/>
Puntero a una cadena que contiene la ruta de acceso que hace referencia a la ubicación absoluta de la propiedad de control asincrónico.

*Apoyo*<br/>
Un [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) objeto que implementa una propiedad de control asincrónico.

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>COleControl::LockInPlaceActive

Impide que el contenedor desactive el control.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parámetros

*Bloquear*<br/>
TRUESi se va a bloquear el estado activo in situ del control; FALSE si se va a desbloquear.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el bloqueo se realizó correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que cada bloqueo del control debe estar emparejado con un desbloqueo del control cuando haya terminado. Solo debe bloquear el control durante períodos cortos, como al activar un evento.

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange

Llamado por el marco de trabajo cuando una propiedad ambiente del contenedor ha cambiado el valor.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parámetros

*dispID*<br/>
El identificador de envío de la propiedad ambiente que ha cambiado o DISPID_UNKNOWN si han cambiado varias propiedades.

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>COleControl::OnAppearanceChanged

Llamado por el marco de trabajo cuando el valor de la propiedad Apariencia de stock ha cambiado.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Observaciones

Invalide esta función si desea una notificación después de que cambie esta propiedad. La implementación `InvalidateControl`predeterminada llama a .

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>COleControl::OnBackColorChanged

Llamado por el marco de trabajo cuando el stock BackColor valor de propiedad ha cambiado.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Observaciones

Invalide esta función si desea una notificación después de que cambie esta propiedad. La implementación `InvalidateControl`predeterminada llama a .

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>COleControl::OnBorderStyleChanged

Llamado por el marco de trabajo cuando el stock BorderStyle valor de propiedad ha cambiado.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Observaciones

La implementación `InvalidateControl`predeterminada llama a .

Invalide esta función si desea una notificación después de que cambie esta propiedad.

## <a name="colecontrolonclick"></a><a name="onclick"></a>COleControl::OnClick

Llamado por el marco de trabajo cuando se ha hecho clic en un botón del mouse o se ha invocado el método de stock DoClick.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parámetros

*Ibutton*<br/>
Indice de un botón del ratón. Puede tener uno de los siguientes valores:

- LEFT_BUTTON Se ha pulsado el botón izquierdo del ratón.

- MIDDLE_BUTTON Se ha pulsado el botón central del ratón.

- RIGHT_BUTTON Se ha pulsado el botón derecho del ratón.

### <a name="remarks"></a>Observaciones

La implementación `COleControl::FireClick`predeterminada llama a .

Invalide esta función miembro para modificar o extender el control predeterminado.

## <a name="colecontrolonclose"></a><a name="onclose"></a>COleControl::Onclose

Llamado por el marco de trabajo cuando `IOleControl::Close` el contenedor ha llamado a la función del control.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parámetros

*dwSaveOption*<br/>
Marcador que indica si el objeto debe guardarse antes de cargarlo. Los valores válidos son:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Observaciones

De forma `OnClose` predeterminada, guarda el objeto de control si se ha modificado y *dwSaveOption* es OLECLOSE_SAVEIFDIRTY o OLECLOSE_PROMPTSAVE.

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>COleControl::Ondoverb

Llamado por el marco de `IOleObject::DoVerb` trabajo cuando el contenedor llama a la función miembro.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*iVerb*<br/>
El índice del verbo de control que se va a invocar.

*lpMsg*<br/>
Puntero al mensaje de Windows que provocó la invocación del verbo.

*hWndParent*<br/>
El identificador de la ventana primaria del control. Si la ejecución del verbo crea una ventana (o ventanas), *hWndParent* debe utilizarse como elemento primario.

*lpRect*<br/>
Puntero a una estructura RECT en la que se copiarán las coordenadas del control, en relación con el contenedor.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada se realizó correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada utiliza las entradas de mapa de mensajes ON_OLEVERB y ON_STDOLEVERB para determinar la función adecuada que se va a invocar.

Reemplace esta función para cambiar el control predeterminado del verbo.

## <a name="colecontrolondraw"></a><a name="ondraw"></a>COleControl::OnDraw

Llamado por el marco de trabajo para dibujar el control OLE en el rectángulo delimitador especificado mediante el contexto de dispositivo especificado.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
El contexto del dispositivo en el que se produce el dibujo.

*rcBounds*<br/>
El área rectangular del control, incluido el borde.

*rcInvalid*<br/>
El área rectangular del control que no es válida.

### <a name="remarks"></a>Observaciones

`OnDraw`normalmente se llama para la visualización de pantalla, pasando un contexto de dispositivo de pantalla como *pDC*. El parámetro *rcBounds* identifica el rectángulo en el contexto del dispositivo de destino (en relación con su modo de asignación actual). El parámetro *rcInvalid* es el rectángulo real que no es válido. En algunos casos, se trata de un área más pequeña que *rcBounds*.

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>COleControl::OnDrawMetafile

Llamado por el marco de trabajo para dibujar el control OLE en el rectángulo delimitador especificado mediante el contexto de dispositivo de metarchivo especificado.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
El contexto del dispositivo en el que se produce el dibujo.

*rcBounds*<br/>
El área rectangular del control, incluido el borde.

### <a name="remarks"></a>Observaciones

La implementación predeterminada llama a la función [OnDraw.](#ondraw)

## <a name="colecontrolonedit"></a><a name="onedit"></a>COleControl::OnEdit

Hace que se active la interfaz de usuario del control.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*lpMsg*<br/>
Puntero al mensaje de Windows que invocó el verbo.

*hWndParent*<br/>
Identificador de la ventana primaria del control.

*lpRect*<br/>
Puntero al rectángulo utilizado por el control en el contenedor.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada es correcta; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Esto tiene el mismo efecto que invocar el verbo OLEIVERB_UIACTIVATE del control.

Esta función se utiliza normalmente como la función de controlador para una entrada de mapa de mensajes ON_OLEVERB. Esto hace que un verbo "Editar" esté disponible en el menú "Objeto" del control. Por ejemplo:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>COleControl::OnEnabledChanged

Llamado por el marco de trabajo cuando el valor de la propiedad Enabled de stock ha cambiado.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Observaciones

Invalide esta función si desea una notificación después de que cambie esta propiedad. La implementación predeterminada llama a [InvalidateControl](#invalidatecontrol).

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>COleControl::OnEnumVerbs

Llamado por el marco de `IOleObject::EnumVerbs` trabajo cuando el contenedor llama a la función miembro.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parámetros

*ppenumOleVerb*<br/>
Puntero al `IEnumOLEVERB` objeto que enumera los verbos del control.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si los verbos están disponibles; de lo contrario 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada enumera las entradas ON_OLEVERB en el mapa de mensajes.

Invalide esta función para cambiar la forma predeterminada de enumerar verbos.

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>COleControl::OnEventAdvise

Llamado por el marco de trabajo cuando un controlador de eventos está conectado o desconectado de un control OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parámetros

*bAdvise*<br/>
TRUE indica que se ha conectado un controlador de eventos al control. FALSE indica que se ha desconectado un controlador de eventos del control.

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>COleControl::OnFontChanged

Llamado por el marco de trabajo cuando el valor de la propiedad Font de stock ha cambiado.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Observaciones

La implementación `COleControl::InvalidateControl`predeterminada llama a . Si el control está subclases un control de Windows, la implementación predeterminada también envía un mensaje de WM_SETFONT a la ventana del control.

Invalide esta función si desea una notificación después de que cambie esta propiedad.

### <a name="example"></a>Ejemplo

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>COleControl::OnForeColorChanged

Llamado por el marco de trabajo cuando el stock ForeColor valor de propiedad ha cambiado.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Observaciones

La implementación `InvalidateControl`predeterminada llama a .

Invalide esta función si desea una notificación después de que cambie esta propiedad.

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>COleControl::OnFreezeEvents

Llamado por el marco `IOleControl::FreezeEvents`de trabajo después de que el contenedor llama .

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parámetros

*bFreeze*<br/>
TRUESi se inmoviliza el control de eventos del control; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

La implementación predeterminada no hace nada.

Invalide esta función si desea un comportamiento adicional cuando el control de eventos está inmovilizado o descongelado.

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>COleControl::OnGetColorSet

Llamado por el marco de `IViewObject::GetColorSet` trabajo cuando el contenedor llama a la función miembro.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parámetros

*Dpt*<br/>
Apunta al dispositivo de destino para el que se debe renderizar la imagen. Si este valor es NULL, la imagen se debe representar para un dispositivo de destino predeterminado, normalmente un dispositivo de visualización.

*hicTargetDev*<br/>
Especifica el contexto de información en el dispositivo de destino indicado por *ptd*. Este parámetro puede ser un contexto de dispositivo, pero no es uno necesariamente. Si *ptd* es NULL, *hicTargetDev* también debe ser NULL.

*ppColorSet*<br/>
Un puntero a la ubicación en la que se debe copiar el conjunto de colores que se utilizaría. Si la función no devuelve el conjunto de colores, se devuelve NULL.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se devuelve un conjunto de colores válido; de lo contrario 0.

### <a name="remarks"></a>Observaciones

El contenedor llama a esta función para obtener todos los colores necesarios para dibujar el control OLE. El contenedor puede utilizar los conjuntos de colores obtenidos junto con los colores que necesita para establecer la paleta de colores general. La implementación predeterminada devuelve FALSE.

Reemplace esta función para realizar cualquier procesamiento especial de esta solicitud.

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo

Llamado por el marco de trabajo cuando el contenedor del control ha solicitado información sobre el control.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parámetros

*pControlInfo*<br/>
Puntero a una estructura [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) que se va a rellenar.

### <a name="remarks"></a>Observaciones

Esta información consiste principalmente en una descripción de las claves mnemotécnicas del control. La implementación predeterminada rellena *pControlInfo* con información predeterminada.

Invalide esta función si el control necesita procesar claves mnemotécnicas.

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString

Llamado por el marco de trabajo para obtener una cadena que representa el valor actual de la propiedad identificada por *dispid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parámetros

*dispid*<br/>
Identificador de envío de una propiedad del control.

*strValue*<br/>
Una referencia a un [CString](../../atl-mfc-shared/reference/cstringt-class.md) objeto a través del cual se devolverá una cadena.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se ha devuelto una cadena en *strValue;* en caso contrario 0.

### <a name="remarks"></a>Observaciones

Invalide esta función si el control tiene una propiedad cuyo valor no se puede convertir directamente en una cadena y desea que el valor de la propiedad se muestre en un explorador de propiedades proporcionado por el contenedor.

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>COleControl::OnGetInPlaceMenu

Llamado por el marco de trabajo cuando se activa la interfaz de usuario del control para obtener el menú que se va a combinar en el menú existente del contenedor.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Valor devuelto

El identificador del menú del control, o NULL si el control no tiene ninguno. La implementación predeterminada devuelve NULL.

### <a name="remarks"></a>Observaciones

Para obtener más información sobre la combinación de recursos OLE, vea el artículo [Menús y recursos (OLE)](../../mfc/menus-and-resources-ole.md).

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent

Llamado por el marco de trabajo `IViewObjectEx::GetNaturalExtent` en respuesta a la solicitud de un contenedor.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parámetros

*dwAspect*<br/>
Especifica cómo se va a representar el objeto. Las representaciones incluyen contenido, un icono, una miniatura o un documento impreso. Los valores válidos se toman de la enumeración [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*Lindex*<br/>
La parte del objeto que es de interés. Actualmente sólo -1 es válido.

*Dpt*<br/>
Apunta a la estructura [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) que define el dispositivo de destino para el que se debe devolver el tamaño del objeto.

*hicTargetDev*<br/>
Especifica el contexto de información para el dispositivo de destino indicado por el parámetro *ptd* del que el objeto puede extraer métricas de dispositivo y probar las capacidades del dispositivo. Si *ptd* es NULL, el objeto debe omitir el valor del parámetro *hicTargetDev.*

*pExtentInfo*<br/>
Apunta a `DVEXTENTINFO` la estructura que especifica los datos de tamaño. La `DVEXTENTINFO` estructura es:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

El miembro `dwExtentMode` de estructura puede tomar uno de los dos valores:

- DVEXTENT_CONTENT Pregunte qué tan grande debe ser el control para ajustarse exactamente al contenido (snap-to-size)

- DVEXTENT_INTEGRAL Al cambiar el tamaño, pase el tamaño propuesto para controlar

*psizel*<br/>
Apunta a los datos de tamaño devueltos por el control. Los datos de tamaño devueltos se establecen en -1 para cualquier dimensión que no se haya ajustado.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si devuelve o ajusta correctamente el tamaño; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Reemplace esta función para devolver el tamaño de visualización del objeto `DVEXTENTINFO` más cercano al tamaño y el modo de extensión propuestos en la estructura. La implementación predeterminada devuelve FALSE y no realiza ningún ajuste en el tamaño.

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings

Llamado por el marco de trabajo para obtener un conjunto de cadenas predefinidas que representan los valores posibles para una propiedad.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parámetros

*dispid*<br/>
Identificador de envío de una propiedad del control.

*pStringArray*<br/>
Matriz de cadenas que se rellenará con valores devueltos.

*pCookieArray*<br/>
Matriz DWORD que se rellenará con valores devueltos.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se han agregado elementos a *pStringArray* y *pCookieArray*.

### <a name="remarks"></a>Observaciones

Invalide esta función si el control tiene una propiedad con un conjunto de valores posibles que se pueden representar mediante cadenas. Para cada elemento agregado a *pStringArray*, debe agregar un elemento "cookie" correspondiente a *pCookieArray.* Estos valores "cookie" pueden pasarmás adelante `COleControl::OnGetPredefinedValue` el marco de trabajo a la función.

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue

Llamado por el marco de trabajo para obtener el valor correspondiente `COleControl::OnGetPredefinedStrings`a una de las cadenas predefinidas previamente devueltas por una invalidación de .

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parámetros

*dispid*<br/>
Identificador de envío de una propiedad del control.

*dwCookie*<br/>
Un valor de cookie devuelto `COleControl::OnGetPredefinedStrings`previamente por una invalidación de .

*lpvarOut*<br/>
Puntero a `VARIANT` una estructura a través de la cual se devolverá un valor de propiedad.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se ha devuelto un valor en *lpvarOut*; de lo contrario 0.

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>COleControl::OnGetViewExtent

Llamado por el marco de trabajo en respuesta a la solicitud [IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) de un contenedor.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parámetros

*dwDrawAspect*<br/>
DWORD que describe qué forma, o aspecto, de un objeto se debe mostrar. Los valores válidos se toman de la enumeración [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*Lindex*<br/>
La parte del objeto que es de interés. Actualmente sólo -1 es válido.

*Dpt*<br/>
Apunta a la estructura [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) que define el dispositivo de destino para el que se debe devolver el tamaño del objeto.

*lpsizel*<br/>
Apunta a la ubicación donde se devuelve el tamaño del objeto.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la información de extensión se devuelve correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Invalide esta función si el control utiliza un dibujo de dos pasadas y sus partes opacas y transparentes tienen dimensiones diferentes.

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>COleControl::OnGetViewRect

Llamado por el marco de trabajo `IViewObjectEx::GetRect` en respuesta a la solicitud de un contenedor.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parámetros

*dwAspect*<br/>
DWORD que describe qué forma, o aspecto, de un objeto se debe mostrar. Los valores válidos se toman de la enumeración [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2:

- DVASPECT_CONTENT rectángulo delimitador de todo el objeto. Esquina superior izquierda en el origen del objeto y `GetViewExtent`el tamaño igual a la extensión devuelta por *.*

- DVASPECT_OPAQUE Objetos con una región rectangular opaca devuelven ese rectángulo. Otros fracasan.

- DVASPECT_TRANSPARENT Rectángulo que cubra todas las partes transparentes o irregulares.

*pRect*<br/>
Apunta a la estructura [RECTL](/previous-versions/dd162907\(v=vs.85\)) especificando el rectángulo en el que se debe dibujar el objeto. Este parámetro controla el posicionamiento y el estiramiento del objeto.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el rectángulo de tamaño para el objeto se devuelve correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

El tamaño del objeto `OnGetViewRect` se convierte en un rectángulo que comienza en una posición específica (el valor predeterminado es la esquina superior izquierda de la pantalla). Invalide esta función si el control utiliza un dibujo de dos pasadas y sus partes opacas y transparentes tienen dimensiones diferentes.

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>COleControl::OnGetViewStatus

Llamado por el marco de trabajo `IViewObjectEx::GetViewStatus` en respuesta a la solicitud de un contenedor.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Valor devuelto

Uno de los valores de la enumeración VIEWSTATUS si se realiza correctamente; de lo contrario 0. Los valores posibles son cualquier combinación de lo siguiente:

|||
|-|-|
|VIEWSTATUS_OPAQUE|El objeto es completamente opaco. Si no se establece este bit, el objeto contiene partes transparentes. Este bit solo se aplica a los aspectos relacionados con el contenido y no a DVASPECT_ICON o DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|El objeto tiene un fondo sólido (que consiste en un color sólido, no en un patrón de pincel). Este bit sólo es significativo si VIEWSTATUS_OPAQUE se establece y solo se aplica a los aspectos relacionados con el contenido y no a DVASPECT_ICON o DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|El objeto admite DVASPECT_OPAQUE. Todos los métodos IViewObjectEx que toman un aspecto de dibujo como parámetro se pueden llamar con este aspecto.|
|VIEWSTATUS_DVASPECTTRANSPARENT|El objeto admite DVASPECT_TRANSPARENT. Todos `IViewObjectEx` los métodos que toman un aspecto de dibujo como parámetro se pueden llamar con este aspecto.|

### <a name="remarks"></a>Observaciones

Invalide esta función si el control utiliza el dibujo de dos pasadas. La implementación predeterminada devuelve VIEWSTATUS_OPAQUE.

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>COleControl::OnHideToolBars

Llamado por el marco de trabajo cuando se desactiva la interfaz de usuario del control.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Observaciones

La implementación debe ocultar todas `OnShowToolbars`las barras de herramientas mostradas por .

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove

Llamado por el contenedor para el objeto inactivo bajo el puntero del mouse al recibir un mensaje de WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parámetros

*lprcBounds*<br/>
El rectángulo delimitador del objeto, en las coordenadas de cliente de la ventana contenedora. Indica al objeto su posición y tamaño exactos en la pantalla cuando se recibió el mensaje de WM_MOUSEMOVE.

*X*<br/>
Coordenada x de la ubicación del ratón en las coordenadas de cliente de la ventana contenedora.

*y y*<br/>
Coordenada y de la ubicación del ratón en las coordenadas de cliente de la ventana contenedora.

*dwKeyState*<br/>
Identifica el estado actual de las teclas modificadoras del teclado en el teclado. Los valores válidos pueden ser una combinación de cualquiera de los indicadores MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON y MK_RBUTTON.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que las coordenadas de cliente de ventana (píxeles) se utilizan para pasar la posición del cursor del ratón. Esto es posible pasando también el rectángulo delimitador del objeto en el mismo sistema de coordenadas.

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor

Llamado por el contenedor para el objeto inactivo bajo el puntero del mouse al recibir un mensaje WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parámetros

*lprcBounds*<br/>
El rectángulo delimitador del objeto, en las coordenadas de cliente de la ventana contenedora. Indica al objeto su posición y tamaño exactos en la pantalla cuando se recibió el mensaje WM_SETCURSOR.

*X*<br/>
Coordenada x de la ubicación del ratón en las coordenadas de cliente de la ventana contenedora.

*y y*<br/>
Coordenada y de la ubicación del ratón en las coordenadas de cliente de la ventana contenedora.

*dwMouseMsg*<br/>
Identificador del mensaje del mouse para el que se produjo un WM_SETCURSOR.

*bSetAlways*<br/>
Especifica si el objeto debe establecer o no el cursor. Si ES TRUE, el objeto debe establecer el cursor; si FALSE, el cursor no está obligado a establecer el cursor y debe devolver S_FALSE en ese caso.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que las coordenadas de cliente de ventana (píxeles) se utilizan para pasar la posición del cursor del ratón. Esto es posible pasando también el rectángulo delimitador del objeto en el mismo sistema de coordenadas.

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>COleControl::OnKeyDownEvent

Llamado por el marco de trabajo después de un stock KeyDown eventos se ha procesado.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parámetros

*Nchar*<br/>
El valor del código de tecla virtual de la tecla pulsada. Para obtener una lista de códigos de clave virtuales estándar, consulte Winuser.h

*nShiftState*<br/>
Contiene una combinación de los siguientes indicadores:

- SHIFT_MASK Se ha pulsado la tecla Mayús durante la acción.

- CTRL_MASK Se ha presionado la tecla CTRL durante la acción.

- ALT_MASK Se ha presionado la tecla ALT durante la acción.

### <a name="remarks"></a>Observaciones

Invalide esta función si el control necesita acceso a la información de clave después de que se haya desencadenado el evento.

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>COleControl::OnKeyPressEvent

Llamado por el marco de trabajo después de que se ha desencadenado el evento KeyPress de stock.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parámetros

*Nchar*<br/>
Contiene el valor del código de tecla virtual de la tecla pulsada. Para obtener una lista de códigos de clave virtuales estándar, consulte Winuser.h

### <a name="remarks"></a>Observaciones

Tenga en cuenta que el valor *nChar* puede haber sido modificado por el contenedor.

Invalide esta función si desea una notificación después de que se produzca este evento.

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>COleControl::OnKeyUpEvent

Llamado por el marco de trabajo después de un stock KeyDown eventos se ha procesado.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parámetros

*Nchar*<br/>
El valor del código de tecla virtual de la tecla pulsada. Para obtener una lista de códigos de clave virtuales estándar, consulte Winuser.h

*nShiftState*<br/>
Contiene una combinación de los siguientes indicadores:

- SHIFT_MASK Se ha pulsado la tecla Mayús durante la acción.

- CTRL_MASK Se ha presionado la tecla CTRL durante la acción.

- ALT_MASK Se ha presionado la tecla ALT durante la acción.

### <a name="remarks"></a>Observaciones

Invalide esta función si el control necesita acceso a la información de clave después de que se haya desencadenado el evento.

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>COleControl::OnMapPropertyToPage

Llamado por el marco de trabajo para obtener el identificador de clase de una página de propiedades que implementa la edición de la propiedad especificada.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parámetros

*dispid*<br/>
Identificador de envío de una propiedad del control.

*Lpclsid*<br/>
Puntero a `CLSID` una estructura a través de la cual se devolverá un identificador de clase.

*pbPageOpcional*<br/>
Devuelve un indicador de si el uso de la página de propiedades especificada es opcional.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se ha devuelto un identificador de clase en *lpclsid*; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Invalide esta función para proporcionar una manera de invocar las páginas de propiedades del control desde el explorador de propiedades del contenedor.

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>COleControl::Onmnemonic

Llamado por el marco de trabajo cuando el contenedor ha detectado que se ha presionado una clave mnemotécnica del control OLE.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parámetros

*Pmsg*<br/>
Puntero al mensaje de Windows generado por la presión de una tecla mnemónica.

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>COleControl::OnProperties

Llamado por el marco de trabajo cuando el contenedor ha invocado el verbo de propiedades del control.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*lpMsg*<br/>
Puntero al mensaje de Windows que invocó el verbo.

*hWndParent*<br/>
Identificador de la ventana primaria del control.

*lpRect*<br/>
Puntero al rectángulo utilizado por el control en el contenedor.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada es correcta; de lo contrario 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada muestra un cuadro de diálogo de propiedad modal.

También puede usar esta función para provocar la visualización de las páginas de propiedades del control. Realice una llamada `OnProperties` a la función, pasando el identificador del elemento primario del control en el *hWndParent* parámetro. En este caso, se omiten los valores de los parámetros *lpMsg* y *lpRect.*

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint

Llamado por el marco de trabajo `IViewObjectEx::QueryHitPoint` en respuesta a la solicitud de un contenedor.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parámetros

*dwAspect*<br/>
Especifica cómo se representa el objeto. Los valores válidos se toman de la enumeración [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*pRectBounds*<br/>
Puntero a `RECT` una estructura que especifica el rectángulo delimitador del área de cliente de control OLE.

*ptlLoc*<br/>
Puntero a `POINT` la estructura que especifica el punto que se va a comprobar para un hit. El punto se especifica en coordenadas de área de cliente OLE.

*lCloseHint*<br/>
La distancia que define "cerrar" al punto se comprueba para un golpe.

*pHitResult*<br/>
Puntero al resultado de la consulta de posicionación. Uno de los valores siguientes:

- HITRESULT_OUTSIDE *ptlLoc* está fuera del objeto OLE y no se cierra.

- HITRESULT_TRANSPARENT *ptlLoc* está dentro de los límites del objeto OLE, pero no cerca de la imagen. Por ejemplo, un punto en medio de un círculo transparente podría ser HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* está dentro o fuera del objeto OLE, pero lo suficientemente cerca del objeto para ser considerado dentro. Los objetos pequeños, delgados o detallados pueden utilizar este valor. Incluso si un punto está fuera del rectángulo delimitador de un objeto, todavía puede estar cerca (esto es necesario para golpear objetos pequeños).

- HITRESULT_HIT *ptlLoc* está dentro de la imagen del objeto.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se devuelve correctamente un resultado de hit; de lo contrario 0. Un hit es una superposición con el área de visualización del control OLE.

### <a name="remarks"></a>Observaciones

Consulta si el rectángulo de visualización de un objeto se superpone al punto especificado (golpea el punto). `QueryHitPoint`se puede reemplazar para probar los golpes de los objetos no rectangulares.

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>COleControl::OnQueryHitRect

Llamado por el marco de trabajo `IViewObjectEx::QueryHitRect` en respuesta a la solicitud de un contenedor.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parámetros

*dwAspect*<br/>
Especifica cómo se va a representar el objeto. Los valores válidos se toman de la enumeración [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*pRectBounds*<br/>
Puntero a `RECT` una estructura que especifica el rectángulo delimitador del área de cliente de control OLE.

*prcLoc*<br/>
Puntero a `RECT` la estructura que especifica el rectángulo que se va a comprobar para un hit (superposición con el rectángulo del objeto), en relación con la esquina superior izquierda del objeto.

*lCloseHint*<br/>
No se usa.

*pHitResult*<br/>
Puntero al resultado de la consulta de posicionación. Uno de los valores siguientes:

- HITRESULT_OUTSIDE el objeto OLE no alcanza ningún punto del rectángulo.

- HITRESULT_HIT al menos un punto del rectángulo sería un golpe en el objeto.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se devuelve correctamente un resultado de hit; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Consulta si el rectángulo de visualización de un objeto se superpone a cualquier punto del rectángulo especificado (golpea el rectángulo). `QueryHitRect`se puede reemplazar para probar los golpes de los objetos no rectangulares.

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>COleControl::OnRenderData

Llamado por el marco de trabajo para recuperar datos en el formato especificado.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parámetros

*lpFormatEtc*<br/>
Señala a la estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) especificando el formato en el que se solicita la información.

*lpStgMedium*<br/>
Apunta a una estructura [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) en la que se van a devolver los datos.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

El formato especificado es uno colocado previamente en el objeto de control mediante el [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) o [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) funciones miembro para la representación retrasada. La implementación predeterminada `OnRenderFileData` de `OnRenderGlobalData`esta función llama o , respectivamente, si el medio de almacenamiento proporcionado es un archivo o memoria. Si el formato solicitado es CF_METAFILEPICT o el formato de conjunto de propiedades persistentes, la implementación predeterminada representa los datos adecuados y devuelve distinto de cero. De lo contrario, devuelve 0 y no hace nada.

Si *se TYMED_NULL lpStgMedium->tymed,* el STGMEDIUM debe asignarse y rellenarse según lo especificado por *lpFormatEtc->tymed*. Si no TYMED_NULL, el STGMEDIUM debe rellenarse con los datos.

Reemplace esta función para proporcionar los datos en el formato y medio solicitados. Dependiendo de los datos, es posible que desee invalidar una de las otras versiones de esta función en su lugar. Si los datos son pequeños `OnRenderGlobalData`y de tamaño fijo, invalide . Si los datos están en un archivo o `OnRenderFileData`tienen un tamaño variable, invalide .

Para obtener más `FORMATETC` información, consulte las estructuras y `STGMEDIUM` en el Windows SDK.

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>COleControl::OnRenderFileData

Llamado por el marco de trabajo para recuperar datos en el formato especificado cuando el medio de almacenamiento es un archivo.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parámetros

*lpFormatEtc*<br/>
Señala a la estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) especificando el formato en el que se solicita la información.

*pFile*<br/>
Apunta a un [CFile](../../mfc/reference/cfile-class.md) objeto en el que se van a representar los datos.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

El formato especificado es uno colocado previamente en el objeto de control mediante el [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) función miembro para la representación retrasada. La implementación predeterminada de esta función simplemente devuelve FALSE.

Reemplace esta función para proporcionar los datos en el formato y medio solicitados. Dependiendo de los datos, es posible que desee invalidar una de las otras versiones de esta función en su lugar. Si desea controlar varios medios de `OnRenderData`almacenamiento, invalide . Si los datos están en un archivo o `OnRenderFileData`tienen un tamaño variable, invalide .

Para obtener más `FORMATETC` información, consulte la estructura en el Windows SDK.

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData

Llamado por el marco de trabajo para recuperar datos en el formato especificado cuando el medio de almacenamiento especificado es memoria global.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parámetros

*lpFormatEtc*<br/>
Señala a la estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) especificando el formato en el que se solicita la información.

*phGlobal*<br/>
Apunta a un identificador de memoria global en la que se van a devolver los datos. Si no se ha asignado ninguna memoria, este parámetro puede ser NULL.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

El formato especificado es uno colocado previamente en el objeto de control mediante el [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) función miembro para la representación retrasada. La implementación predeterminada de esta función simplemente devuelve FALSE.

Si *phGlobal* es NULL, se debe asignar y devolver un nuevo HGLOBAL en *phGlobal*. De lo contrario, el HGLOBAL especificado por *phGlobal* debe rellenarse con los datos. La cantidad de datos colocados en el HGLOBAL no debe exceder el tamaño actual del bloque de memoria. Además, el bloque no se puede reasignar a un tamaño mayor.

Reemplace esta función para proporcionar los datos en el formato y medio solicitados. Dependiendo de los datos, es posible que desee invalidar una de las otras versiones de esta función en su lugar. Si desea controlar varios medios de `OnRenderData`almacenamiento, invalide . Si los datos están en un archivo o `OnRenderFileData`tienen un tamaño variable, invalide .

Para obtener más `FORMATETC` información, consulte la estructura en el Windows SDK.

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>COleControl::OnResetState

Llamado por el marco de trabajo cuando las propiedades del control deben establecerse en sus valores predeterminados.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada llama a `CPropExchange` [DoPropExchange](#dopropexchange), pasando un objeto que hace que las propiedades se establezcan en sus valores predeterminados.

El escritor de controles puede insertar código de inicialización para el control OLE en este reemplazable. Se llama a esta función cuando se produce un error [en IPersistStream::Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) o [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) o [IPersistStreamInit::InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) o [IPersistStorage::InitNew,](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) sin llamar primero a cualquiera `IPersistStream::Load` o `IPersistStorage::Load`.

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>COleControl::OnSetClientSite

Llamado por el marco de trabajo cuando `IOleControl::SetClientSite` el contenedor ha llamado a la función del control.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Observaciones

De forma `OnSetClientSite` predeterminada, comprueba si se cargan las `DoDataPathPropExchange`propiedades de la ruta de acceso de datos y, si lo están, llama a .

Reemplace esta función para realizar cualquier procesamiento especial de esta notificación. En particular, las invalidaciones de esta función deben llamar a la clase base.

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>COleControl::OnSetData

Llamado por el marco de trabajo para reemplazar los datos del control con los datos especificados.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parámetros

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) que especifica el formato de los datos.

*lpStgMedium*<br/>
Puntero a una estructura [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) en la que residen los datos.

*bRelease*<br/>
TRUESi el control debe liberar el medio de almacenamiento; FALSE si el control no debe liberar el medio de almacenamiento.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Si los datos están en el formato de conjunto de propiedades persistentes, la implementación predeterminada modifica el estado del control en consecuencia. De lo contrario, la implementación predeterminada no hace nada. Si *bRelease* es TRUE, `ReleaseStgMedium` se realiza una llamada a; de lo contrario, no.

Reemplace esta función para reemplazar los datos del control con los datos especificados.

Para obtener más `FORMATETC` información, consulte las estructuras y `STGMEDIUM` en el Windows SDK.

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>COleControl::OnSetExtent

Llamado por el marco de trabajo cuando la extensión del control debe cambiarse, como resultado de una llamada a [IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parámetros

*lpSizeL*<br/>
Puntero a `SIZEL` la estructura que utiliza enteros largos para representar el ancho y alto del control, expresado en unidades HIMETRIC.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se aceptó el cambio de tamaño; de lo contrario 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada controla el cambio de tamaño de la extensión del control. Si el control está activo en el lugar, `OnPosRectChanged` se realiza una llamada al contenedor.

Invalide esta función para modificar el cambio de tamaño predeterminado del control.

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>COleControl::OnSetObjectRects

Llamado por el marco de trabajo para implementar una llamada a [IOleInPlaceObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parámetros

*lpRectPos*<br/>
Puntero a `RECT` una estructura que indica la nueva posición y el tamaño del control en relación con el contenedor.

*lpRectClip*<br/>
Puntero a `RECT` una estructura que indica un área rectangular a la que se va a recortar el control.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se aceptó el reposicionamiento; de lo contrario 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada controla automáticamente el cambio de tamaño y el cambio de tamaño de la ventana de control y devuelve TRUE.

Invalide esta función para modificar el comportamiento predeterminado de esta función.

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>COleControl::OnShowToolBars

Llamado por el marco de trabajo cuando se ha activado la interfaz de usuario del control.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada no hace nada.

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>COleControl::OnTextChanged

Llamado por el marco de trabajo cuando el valor de la propiedad stock Caption o Text ha cambiado.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Observaciones

La implementación `InvalidateControl`predeterminada llama a .

Invalide esta función si desea una notificación después de que cambie esta propiedad.

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage

Llamado por el marco de trabajo `IOleInPlaceObjectWindowless::OnWindowMessage` en respuesta a la solicitud de un contenedor.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parámetros

*Msg*<br/>
Identificador de mensaje pasado por Windows.

*wParam*<br/>
Según lo aprobado por Windows. Especifica información adicional específica del mensaje. El contenido de este parámetro depende del valor del parámetro *msg.*

*lParam*<br/>
Según lo aprobado por Windows. Especifica información adicional específica del mensaje. El contenido de este parámetro depende del valor del parámetro *msg.*

*plResult*<br/>
Código de resultado de Windows. Especifica el resultado del procesamiento de mensajes y depende del mensaje enviado.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Procesa los mensajes de ventana para los controles sin ventanas. `COleControl`'s `OnWindowlessMessage` se debe utilizar para mensajes de ventana que no sean mensajes del ratón y mensajes de teclado. `COleControl`proporciona [SetCapture](#setcapture) y [SetFocus](#setfocus) específicamente para obtener la captura del mouse y el foco del teclado para los objetos OLE sin ventanas.

Dado que los objetos sin ventana no tienen una ventana, necesitan un mecanismo para permitir que el contenedor les envíe mensajes. Un objeto OLE sin ventanas obtiene `OnWindowMessage` mensajes de `IOleInPlaceObjectWindowless` su contenedor, a través del método en la interfaz (una extensión de [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) para la compatibilidad sin ventanas). `OnWindowMessage`no toma `HWND` un parámetro.

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>COleControl::ParentToClient

Traduce las coordenadas de *pPoint* en coordenadas de cliente.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parámetros

*lprcBounds*<br/>
Puntero a los límites del control OLE dentro del contenedor. No el área de cliente, sino el área de todo el control, incluidos los bordes y las barras de desplazamiento.

*pPoint*<br/>
Puntero al punto primario (contenedor) que se va a traducir en las coordenadas del área de cliente del control.

*bHitTest*<br/>
Especifica si se deben realizar o no pruebas de posicionación en el punto.

### <a name="return-value"></a>Valor devuelto

Si *bHitTest* es FALSE, devuelve HTNOWHERE. Si *bHitTest* es TRUE, devuelve la ubicación en la que el punto primario (contenedor) aterrizó en el área de cliente del control OLE y es uno de los siguientes valores de prueba de posicionamiento del mouse:

- HTBORDER En el borde de una ventana que no tiene un borde de tamaño.

- HTBOTTOM En el borde horizontal inferior de la ventana.

- HTBOTTOMLEFT En la esquina inferior izquierda del borde de la ventana.

- HTBOTTOMRIGHT En la esquina inferior derecha del borde de la ventana.

- HTCAPTION En un área de barra de título.

- HTCLIENT En un área de cliente.

- HTERROR En el fondo de la pantalla o en una línea `DefWndProc` divisoria entre ventanas (igual que HTNOWHERE excepto que la función de Windows produce un pitido del sistema para indicar un error).

- HTGROWBOX En una caja de tamaño.

- HTHSCROLL En la barra de desplazamiento horizontal.

- HTLEFT En el borde izquierdo de la ventana.

- HTMAXBUTTON En un botón Maximizar.

- HTMENU En un área de menú.

- HTMINBUTTON En un botón Minimizar.

- HTNOWHERE En el fondo de la pantalla o en una línea divisoria entre ventanas.

- HTREDUCE En un botón Minimizar.

- HTRIGHT En el borde derecho de la ventana.

- HTSIZE En un cuadro de tamaño (igual que HTGROWBOX).

- HTSYSMENU En un menú Control o en un botón Cerrar de una ventana secundaria.

- HTTOP En el borde horizontal superior de la ventana.

- HTTOPLEFT En la esquina superior izquierda del borde de la ventana.

- HTTOPRIGHT En la esquina superior derecha del borde de la ventana.

- HTTRANSPARENT En una ventana cubierta actualmente por otra ventana.

- HTVSCROLL En la barra de desplazamiento vertical.

- HTZOOM En un botón Maximizar.

### <a name="remarks"></a>Observaciones

En *pPoint* de entrada es relativo al origen del elemento primario (esquina superior izquierda del contenedor). En la salida *pPoint* es relativo al origen del área de cliente del control OLE (esquina superior izquierda del área de cliente del control).

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>COleControl::PostModalDialog

Notifica al contenedor que se ha cerrado un cuadro de diálogo modal.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parámetros

*hWndParent*<br/>
Controle la ventana primaria del cuadro de diálogo modal.

### <a name="remarks"></a>Observaciones

Llame a esta función después de mostrar cualquier cuadro de diálogo modal. Debe llamar a esta función para que el contenedor `PreModalDialog`pueda habilitar las ventanas de nivel superior deshabilitadas por . Esta función debe estar emparejada con una llamada a `PreModalDialog`.

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>COleControl::PreModalDialog

Notifica al contenedor que un cuadro de diálogo modal está a punto de mostrarse.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parámetros

*hWndParent*<br/>
Controle la ventana primaria del cuadro de diálogo modal.

### <a name="remarks"></a>Observaciones

Llame a esta función antes de mostrar cualquier cuadro de diálogo modal. Debe llamar a esta función para que el contenedor pueda deshabilitar todas sus ventanas de nivel superior. Una vez que se ha mostrado el `PostModalDialog`cuadro de diálogo modal, debe llamar a .

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>COleControl::RecreateControlWindow

Destruye y vuelve a crear la ventana del control.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Observaciones

Esto puede ser necesario si necesita cambiar los bits de estilo de la ventana.

## <a name="colecontrolrefresh"></a><a name="refresh"></a>COleControl::Refresh

Fuerza un repintado del control OLE.

```
void Refresh();
```

### <a name="remarks"></a>Observaciones

Esta función es `COleControl` compatible con la clase base como un método de stock, denominado Refresh. Esto permite a los usuarios del control OLE volver a pintar el control en un momento específico. Para obtener más información sobre este método, vea el artículo [Controles ActiveX: Métodos](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>COleControl::ReleaseCapture

Libera la captura del ratón.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Si el control tiene actualmente la captura del mouse, se libera la captura. De lo contrario, esta función no tiene ningún efecto.

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>COleControl::ReleaseDC

Libera el contexto del dispositivo de visualización de un contenedor de un control sin ventanas, liberando el contexto del dispositivo para su uso por otras aplicaciones.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Identifica el contexto del dispositivo contenedor que se va a liberar.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

La aplicación `ReleaseDC` debe llamar para cada llamada a [GetDC](#getdc).

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow

Establece el elemento primario del control.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parámetros

*hWndOuter*<br/>
El identificador de la ventana de control.

*hWndParent*<br/>
El identificador de la nueva ventana primaria.

### <a name="remarks"></a>Observaciones

Llame a esta función para restablecer el elemento primario de la ventana de control.

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>COleControl::ResetStockProps

Inicializa el estado `COleControl` de las propiedades de stock a sus valores predeterminados.

```
void ResetStockProps();
```

### <a name="remarks"></a>Observaciones

Las propiedades son: Appearance, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, hWnd y Text. Para obtener una descripción de las propiedades de stock, consulte [Controles ActiveX: Adición](../../mfc/mfc-activex-controls-adding-stock-properties.md)de propiedades de stock .

Puede mejorar el rendimiento de inicialización `ResetStockProps` `ResetVersion` binaria `COleControl::OnResetState`de un control mediante el uso y la invalidación . Observe el ejemplo siguiente. Para obtener más información sobre cómo optimizar la inicialización, consulte [Controles ActiveX: Optimización](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Ejemplo

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>COleControl::ResetVersion

Inicializa el número de versión en el valor especificado.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parámetros

*dwVersionDefault*<br/>
El número de versión que se asignará al control.

### <a name="remarks"></a>Observaciones

Puede mejorar el rendimiento de inicialización `ResetVersion` `ResetStockProps` binaria `COleControl::OnResetState`de un control mediante el uso y la invalidación . Vea el ejemplo en [ResetStockProps](#resetstockprops). Para obtener más información sobre cómo optimizar la inicialización, consulte [Controles ActiveX: Optimización](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>COleControl::ScrollWindow

Permite que un objeto OLE sin ventanas desplace un área dentro de su imagen activa in situ en la pantalla.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parámetros

*xAmount*<br/>
Especifica la cantidad, en unidades de dispositivo, del desplazamiento horizontal. Este parámetro debe ser un valor negativo para desplazarse hacia la izquierda.

*yAmount*<br/>
Especifica la cantidad, en unidades de dispositivo, de desplazamiento vertical. Este parámetro debe ser un valor negativo para desplazarse hacia arriba.

*lpRect*<br/>
Apunta a un [CRect](../../atl-mfc-shared/reference/crect-class.md) objeto o RECT estructura que especifica la parte del área de cliente del objeto OLE para desplazarse, en las coordenadas de cliente de la ventana contenedora. Si *lpRect* es NULL, se desplaza todo el área de cliente del objeto OLE.

*lpClipRect*<br/>
Apunta a `CRect` un `RECT` objeto o estructura que especifica el rectángulo al que se va a recortar. Solo se desplazan los píxeles dentro del rectángulo. Los bits fuera del rectángulo no se ven afectados aunque estén en el rectángulo *lpRect.* Si *lpClipRect* es NULL, no se realiza ningún recorte en el rectángulo de desplazamiento.

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>COleControl::SelectFontObject

Selecciona una fuente en un contexto de dispositivo.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Puntero a un objeto de contexto de dispositivo.

*fontHolder*<br/>
Referencia al objeto [CFontHolder](../../mfc/reference/cfontholder-class.md) que representa la fuente que se va a seleccionar.

### <a name="return-value"></a>Valor devuelto

Un puntero a la fuente seleccionada anteriormente. Cuando el autor de la llamada haya terminado todas las operaciones de dibujo que utilizan *fontHolder,* debe volver a seleccionar la fuente seleccionada anteriormente pasándola como parámetro a [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>COleControl::SelectStockFont

Selecciona la propiedad Font de stock en un contexto de dispositivo.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
El contexto del dispositivo en el que se seleccionará la fuente.

### <a name="return-value"></a>Valor devuelto

Un puntero al `CFont` objeto seleccionado anteriormente. Debe usar [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) para volver a seleccionar esta fuente en el contexto del dispositivo cuando haya terminado.

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>COleControl::SerializeExtent

Serializa o inicializa el estado del espacio de visualización asignado al control.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parámetros

*ar*<br/>
Objeto `CArchive` desde o hacia el que serializar.

### <a name="remarks"></a>Observaciones

Puede mejorar el rendimiento de persistencia `SerializeExtent`binaria `SerializeVersion` de `COleControl::Serialize`un control mediante , `SerializeStockProps`, y para invalidar . Observe el ejemplo siguiente. Para obtener más información sobre cómo optimizar la inicialización, consulte [Controles ActiveX: Optimización](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Ejemplo

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>COleControl::SerializeStockProps

Serializa o inicializa el estado `COleControl` de las propiedades de stock: Apariencia, BackColor, BorderStyle, Subtítulo, Habilitado, Fuente, ForeColor y Texto.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parámetros

*ar*<br/>
Objeto `CArchive` desde o hacia el que serializar.

### <a name="remarks"></a>Observaciones

Para obtener una descripción de las propiedades de stock, consulte [Controles ActiveX: Adición](../../mfc/mfc-activex-controls-adding-stock-properties.md)de propiedades de stock .

Puede mejorar el rendimiento de persistencia `SerializeStockProps`binaria `SerializeVersion` de `COleControl::Serialize`un control mediante , `SerializeExtent`, y para invalidar . Para obtener un ejemplo, vea el código en [SerializeExtent](#serializeextent). Para obtener más información sobre cómo optimizar la inicialización, consulte [Controles ActiveX: Optimización](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>COleControl::SerializeVersion

Serializa o inicializa el estado de la información de versión de un control.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parámetros

*ar*<br/>
Objeto `CArchive` desde o hacia el que serializar.

*dwVersionDefault*<br/>
El número de versión actual del control.

*bConvertir*<br/>
Indica si los datos persistentes se deben convertir al formato más reciente cuando se guardan o se mantienen en el mismo formato que tenían cuando se cargaron.

### <a name="return-value"></a>Valor devuelto

El número de versión del control. Si se está cargando `SerializeVersion` el archivo especificado, devuelve la versión cargada desde ese archivo. De lo contrario, devuelve la versión cargada actualmente.

### <a name="remarks"></a>Observaciones

Puede mejorar el rendimiento de persistencia `SerializeVersion`binaria `SerializeStockProps` de `COleControl::Serialize`un control mediante , `SerializeExtent`, y para invalidar . Para obtener un ejemplo, vea el código en [SerializeExtent](#serializeextent). Para obtener más información sobre cómo optimizar la inicialización, consulte [Controles ActiveX: Optimización](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>COleControl::SetAppearance

Establece el valor de la propiedad Apariencia de stock del control.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parámetros

*sAppearance*<br/>
Un valor **corto** (VT_I2) que se utilizará para la apariencia del control. Un valor de cero establece la apariencia del control en plana y un valor de 1 establece la apariencia del control en 3D.

### <a name="remarks"></a>Observaciones

Para obtener más información sobre las propiedades de stock, consulte [Controles ActiveX: Propiedades](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>COleControl::SetBackColor

Establece el valor de la propiedad BackColor del control.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parámetros

*dwBackColor*<br/>
Un valor OLE_COLOR que se utilizará para el dibujo en segundo plano del control.

### <a name="remarks"></a>Observaciones

Para obtener más información sobre el uso de esta propiedad y otras propiedades relacionadas, vea el artículo [Controles ActiveX: Propiedades](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>COleControl::SetBorderStyle

Establece el valor de la propiedad BorderStyle de stock del control.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parámetros

*sBorderStyle*<br/>
El nuevo estilo de borde para el control; 0 indica que no hay borde y 1 indica un borde normal.

### <a name="remarks"></a>Observaciones

La ventana de control se `OnBorderStyleChanged` volverá a crear y se llamará.

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>COleControl::SetCapture

Hace que la ventana contenedora del control tome posesión de la captura del mouse en nombre del control.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Valor devuelto

Puntero al `CWnd` objeto de ventana que recibió previamente la entrada del mouse.

### <a name="remarks"></a>Observaciones

Si el control está activado y sin ventanas, esta función hace que la ventana contenedora del control tome posesión de la captura del mouse, en nombre del control. De lo contrario, esta función hace que el `CWnd::SetCapture`propio control tome posesión de la captura del mouse (igual que ).

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>COleControl::SetControlSize

Establece el tamaño de la ventana de control OLE y notifica al contenedor que el sitio de control está cambiando.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parámetros

*Cx*<br/>
Especifica el nuevo ancho del control en píxeles.

*Cy*<br/>
Especifica la nueva altura del control en píxeles.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada se realizó correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Esta función no se debe usar en el constructor del control.

Tenga en cuenta que todas las coordenadas de las ventanas de control son relativas a la esquina superior izquierda del control.

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>COleControl::SetEnabled

Establece el valor de la propiedad Enabled de la acción del control.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parámetros

*bHabilitado*<br/>
TRUESi se va a habilitar el control; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

Después de `OnEnabledChange` establecer esta propiedad, se llama.

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>COleControl::SetFocus

Hace que la ventana contenedora del control tome posesión del foco de entrada en nombre del control.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Valor devuelto

Puntero al `CWnd` objeto de ventana que anteriormente tenía el foco de entrada, o NULL si no existe dicha ventana.

### <a name="remarks"></a>Observaciones

Si el control está activado y sin ventanas, esta función hace que la ventana contenedora del control tome posesión del foco de entrada, en nombre del control. El foco de entrada dirige la entrada del teclado a la ventana del contenedor y `SetFocus`el contenedor distribuye todos los mensajes de teclado subsiguientes al objeto OLE que llama a . Cualquier ventana que anteriormente tenía el foco de entrada lo pierde.

Si el control no es sin ventanas, esta función hace `CWnd::SetFocus`que el propio control tome posesión del foco de entrada (igual que ).

## <a name="colecontrolsetfont"></a><a name="setfont"></a>COleControl::SetFont

Establece la propiedad Font de stock del control.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parámetros

*pFontDisp*<br/>
Un puntero a una interfaz de envío de fuentes.

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>COleControl::SetForeColor

Establece el valor de la propiedad ForeColor de stock del control.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parámetros

*dwForeColor*<br/>
Un valor OLE_COLOR que se utilizará para el dibujo en primer plano del control.

### <a name="remarks"></a>Observaciones

Para obtener más información sobre el uso de esta propiedad y otras propiedades relacionadas, vea el artículo [Controles ActiveX: Propiedades](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats

Llamado por el marco de trabajo para inicializar la lista de formatos de datos admitidos por el control.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada especifica dos formatos: CF_METAFILEPICT y el conjunto de propiedades persistentes.

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>COleControl::SetInitialSize

Establece el tamaño de un control OLE cuando se muestra por primera vez en un contenedor.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parámetros

*Cx*<br/>
El ancho inicial del control OLE en píxeles.

*Cy*<br/>
La altura inicial del control OLE en píxeles.

### <a name="remarks"></a>Observaciones

Llame a esta función en el constructor para establecer el tamaño inicial del control. El tamaño inicial se mide en unidades de dispositivo o píxeles. Se recomienda que esta llamada se realice en el constructor del control.

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>COleControl::SetModifiedFlag

Cambia el estado modificado de un control.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parámetros

*bModificado*<br/>
El nuevo valor para el indicador modificado del control. TRUE indica que se ha modificado el estado del control; FALSE indica que el estado del control se acaba de guardar.

### <a name="remarks"></a>Observaciones

Llame a esta función siempre que se produzca un cambio que afecte al estado persistente del control. Por ejemplo, si cambia el valor de una propiedad persistente, llame a esta función con *bModified* **TRUE**.

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>COleControl::SetNotPermitted

Indica que se ha producido un error en una solicitud de edición.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Observaciones

Llame a `BoundPropertyRequestEdit` esta función cuando se produzca un error. Esta función produce una `COleDispScodeException` excepción de tipo para indicar que no se permitió la operación de conjunto.

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>COleControl::SetNotSupported

Impide la modificación del valor de propiedad de un control por parte del usuario.

```
void SetNotSupported();
```

### <a name="remarks"></a>Observaciones

Llame a esta función en lugar de la Set función de cualquier propiedad donde no se admite la modificación del valor de propiedad por el usuario del control. Un ejemplo sería una propiedad que es de solo lectura.

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>COleControl::SetRectInContainer

Establece las coordenadas del rectángulo del control en relación con el contenedor, expresado en unidades de dispositivo.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*lpRect*<br/>
Puntero a un rectángulo que contiene las nuevas coordenadas del control en relación con el contenedor.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada se realizó correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Si el control está abierto, se cambia el tamaño; de lo contrario `OnPosRectChanged` se llama a la función del contenedor.

## <a name="colecontrolsettext"></a><a name="settext"></a>COleControl::SetText

Establece el valor de la propiedad subtitulado o texto del control.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parámetros

*pszText*<br/>
Un puntero a una cadena de caracteres.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que las propiedades stock Caption y Text se asignan al mismo valor. Esto significa que los cambios realizados en cualquiera de las propiedades cambiarán automáticamente ambas propiedades. En general, un control debe admitir la propiedad stock Caption o Text, pero no ambos.

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>COleControl::ThrowError

Indica la aparición de un error en el control.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parámetros

*Sc*<br/>
El valor del código de estado que se va a notificar. Para obtener una lista completa de los códigos posibles, consulte el artículo [Controles ActiveX: Temas avanzados](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
El identificador de recurso de cadena de la excepción que se va a notificar.

*nHelpID*<br/>
El identificador de ayuda del tema que se va a informar.

*pszDescription*<br/>
Cadena que contiene una explicación de la excepción que se va a notificar.

### <a name="remarks"></a>Observaciones

Esta función solo se debe llamar desde dentro de un Get o Set función para un OLE propiedad o la implementación de un método de automatización OLE. Si necesita indicar errores que se producen en otros momentos, debe activar el evento error de stock.

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>COleControl::TransformCoords

Transforma los valores de coordenadas entre las unidades HIMETRIC y las unidades nativas del contenedor.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parámetros

*lpptlHimetric*<br/>
Puntero a `POINTL` una estructura que contenga coordenadas en unidades HIMETRIC.

*lpptfContainer*<br/>
Puntero a `POINTF` una estructura que contenga coordenadas en el tamaño de la unidad del contenedor.

*Banderas*<br/>
Una combinación de los siguientes valores:

- XFORMCOORDS_POSITION Posición A en el contenedor.

- XFORMCOORDS_SIZE Tamaño A en el contenedor.

- XFORMCOORDS_HIMETRICTOCONTAINER Transformar unidades HIMETRIC en las unidades del contenedor.

- XFORMCOORDS_CONTAINERTOHIMETRIC Transforme las unidades del contenedor en unidades HIMETRIC.

### <a name="remarks"></a>Observaciones

Los dos primeros indicadores, XFORMCOORDS_POSITION y XFORMCOORDS_SIZE, indican si las coordenadas deben tratarse como una posición o un tamaño. Las dos banderas restantes indican la dirección de la transformación.

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>COleControl::TranslateColor

Convierte un valor de color del tipo de datos OLE_COLOR al tipo de datos [COLORREF.](/windows/win32/gdi/colorref)

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parámetros

*clrColor*<br/>
Un tipo de datos OLE_COLOR. Para obtener más información, vea la función [OleTranslateColor de](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) Windows.

*hpal*<br/>
Un identificador de una paleta opcional; puede ser NULL.

### <a name="return-value"></a>Valor devuelto

Un valor de color RGB (rojo, verde, azul) de 32 bits que define el color sólido más cercano al valor *clrColor* que puede representar el dispositivo.

### <a name="remarks"></a>Observaciones

Esta función es útil para traducir el stock ForeColor y BackColor propiedades a COLORREF tipos utilizados por las funciones miembro [CDC.](../../mfc/reference/cdc-class.md)

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDuringLoad

Determina si el control debe usar los valores de las propiedades ambientales como valores predeterminados, cuando posteriormente se carga desde su estado persistente.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero indica que las propiedades ambientales serán válidas; de lo contrario, las propiedades ambientales no serán válidas.

### <a name="remarks"></a>Observaciones

En algunos contenedores, es posible que el control no tenga `COleControl::DoPropExchange`acceso a sus propiedades ambientales durante la llamada inicial a la invalidación de . Este es el caso si el contenedor llama a [IPersistStreamInit::Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) o [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) antes de llamar a [IOleObject::SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (es decir, si no respeta el bit de estado de OLEMISC_SETCLIENTSITEFIRST).

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>COleControl::WindowProc

Proporciona un procedimiento `COleControl` de Windows para un objeto.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parámetros

*Mensaje*<br/>
Especifica el mensaje de Windows que se va a procesar.

*wParam*<br/>
Proporciona información adicional utilizada para procesar el mensaje. El valor del parámetro depende del mensaje.

*lParam*<br/>
Proporciona información adicional utilizada para procesar el mensaje. El valor del parámetro depende del mensaje.

### <a name="return-value"></a>Valor devuelto

El valor devuelto del mensaje distribuido.

### <a name="remarks"></a>Observaciones

Llame a esta función para distribuir mensajes específicos a través del mapa de mensajes del control.

## <a name="see-also"></a>Consulte también

[Ejemplo de MFC CIRC3](../../overview/visual-cpp-samples.md)<br/>
[PRUEBA DE MUESTRA DE MFC](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage (clase)](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd (clase)](../../mfc/reference/cwnd-class.md)<br/>
[Gráfico de jerarquías](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder (clase)](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder (clase)](../../mfc/reference/cpictureholder-class.md)<br/>
