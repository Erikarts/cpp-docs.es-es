---
title: COleControl (clase)
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 97c605426ed0ac869714f0f83d4957f7f6ce7d87
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/16/2020
ms.locfileid: "79426916"
---
# <a name="colecontrol-class"></a>COleControl (clase)

Una clase base eficaz para desarrollar controles OLE.

## <a name="syntax"></a>Sintaxis

```
class COleControl : public CWnd
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>Constructores públicos

|Nombre|Descripción|
|----------|-----------------|
|[COleControl:: COleControl](#colecontrol)|Crea un objeto `COleControl`.|

### <a name="public-methods"></a>Métodos públicos

|Nombre|Descripción|
|----------|-----------------|
|[COleControl:: AmbientAppearance](#ambientappearance)|Recupera la apariencia actual del control.|
|[COleControl:: AmbientBackColor](#ambientbackcolor)|Devuelve el valor de la propiedad BackColor ambiente.|
|[COleControl:: AmbientDisplayName](#ambientdisplayname)|Devuelve el nombre del control especificado por el contenedor.|
|[COleControl:: AmbientFont](#ambientfont)|Devuelve el valor de la propiedad de fuente ambiente.|
|[COleControl:: AmbientForeColor](#ambientforecolor)|Devuelve el valor de la propiedad ForeColor ambiente.|
|[COleControl:: AmbientLocaleID](#ambientlocaleid)|Devuelve el identificador de configuración regional del contenedor.|
|[COleControl:: AmbientScaleUnits](#ambientscaleunits)|Devuelve el tipo de unidades utilizadas por el contenedor.|
|[COleControl:: AmbientShowGrabHandles](#ambientshowgrabhandles)|Determina si deben mostrarse los controladores de arrastre.|
|[COleControl:: AmbientShowHatching](#ambientshowhatching)|Determina si se debe mostrar el sombreado.|
|[COleControl:: AmbientTextAlign](#ambienttextalign)|Devuelve el tipo de alineación del texto especificado por el contenedor.|
|[COleControl:: AmbientUIDead](#ambientuidead)|Determina si el control debe responder a las acciones de la interfaz de usuario.|
|[COleControl:: AmbientUserMode](#ambientusermode)|Determina el modo del contenedor.|
|[COleControl:: BoundPropertyChanged](#boundpropertychanged)|Notifica al contenedor que se ha cambiado una propiedad enlazada.|
|[COleControl:: BoundPropertyRequestEdit](#boundpropertyrequestedit)|Solicita permiso para editar el valor de la propiedad.|
|[COleControl:: ClientToParent](#clienttoparent)|Convierte un punto con respecto al origen del control en un punto relativo al origen de su contenedor.|
|[COleControl:: ClipCaretRect](#clipcaretrect)|Ajusta un rectángulo de símbolo de intercalación si se superpone mediante un control.|
|[COleControl:: ControlInfoChanged](#controlinfochanged)|Llame a esta función después de que haya cambiado el conjunto de teclas de método administrado por el control.|
|[COleControl::D isplayError](#displayerror)|Muestra eventos de error de existencias al usuario del control.|
|[COleControl::D oClick](#doclick)|Implementación del método stock `DoClick`.|
|[COleControl::D oPropExchange](#dopropexchange)|Serializa las propiedades de un objeto `COleControl`.|
|[COleControl::D oSuperclassPaint](#dosuperclasspaint)|Vuelve a dibujar un control OLE que se ha subclase de un control de Windows.|
|[COleControl:: EnableSimpleFrame](#enablesimpleframe)|Habilita la compatibilidad con fotogramas sencillos para un control.|
|[COleControl:: ExchangeExtent](#exchangeextent)|Serializa el ancho y el alto del control.|
|[COleControl:: ExchangeStockProps](#exchangestockprops)|Serializa las propiedades estándar del control.|
|[COleControl:: ExchangeVersion](#exchangeversion)|Serializa el número de versión del control.|
|[COleControl:: FireClick](#fireclick)|Activa el evento stock `Click`.|
|[COleControl:: FireDblClick](#firedblclick)|Activa el evento stock `DblClick`.|
|[COleControl:: FireError (](#fireerror)|Activa el evento stock `Error`.|
|[COleControl:: FireEvent](#fireevent)|Desencadena un evento personalizado.|
|[COleControl:: FireKeyDown](#firekeydown)|Activa el evento stock `KeyDown`.|
|[COleControl:: FireKeyPress](#firekeypress)|Activa el evento stock `KeyPress`.|
|[COleControl:: FireKeyUp](#firekeyup)|Activa el evento stock `KeyUp`.|
|[COleControl:: FireMouseDown](#firemousedown)|Activa el evento stock `MouseDown`.|
|[COleControl:: FireMouseMove](#firemousemove)|Activa el evento stock `MouseMove`.|
|[COleControl:: FireMouseUp](#firemouseup)|Activa el evento stock `MouseUp`.|
|[COleControl:: FireReadyStateChange](#firereadystatechange)|Desencadena un evento cuando cambia el estado listo del control.|
|[COleControl:: GetActivationPolicy](#getactivationpolicy)|Modifica el comportamiento de activación predeterminado de un control que admite la interfaz `IPointerInactive`.|
|[COleControl:: GetAmbientProperty](#getambientproperty)|Devuelve el valor de la propiedad de ambiente especificada.|
|[COleControl:: GetAppearance](#getappearance)|Devuelve el valor de la propiedad de aspecto bursátil.|
|[COleControl:: GetBackColor](#getbackcolor)|Devuelve el valor de la propiedad BackColor de stock.|
|[COleControl:: GetBorderStyle](#getborderstyle)|Devuelve el valor de la propiedad BorderStyle de stock.|
|[COleControl:: GetCapture](#getcapture)|Determina si un objeto de control activado sin ventanas tiene la captura del mouse.|
|[COleControl:: GetClassID](#getclassid)|Recupera el identificador de clase OLE del control.|
|[COleControl:: GetClientOffset](#getclientoffset)|Recupera la diferencia entre la esquina superior izquierda del área rectangular del control y la esquina superior izquierda de su área de cliente.|
|[COleControl:: GetClientRect](#getclientrect)|Recupera el tamaño del área cliente del control.|
|[COleControl:: GetClientSite](#getclientsite)|Consulta un objeto para el puntero a su sitio de cliente actual dentro de su contenedor.|
|[COleControl:: GetControlFlags](#getcontrolflags)|Recupera la configuración de la marca de control.|
|[COleControl:: GetControlSize](#getcontrolsize)|Devuelve la posición y el tamaño del control OLE.|
|[COleControl:: GetDC](#getdc)|Proporciona un medio para que un control sin ventana obtenga un contexto de dispositivo de su contenedor.|
|[COleControl:: GetEnabled](#getenabled)|Devuelve el valor de la propiedad stock enabled.|
|[COleControl:: GetExtendedControl](#getextendedcontrol)|Recupera un puntero a un objeto de control extendido que pertenece al contenedor.|
|[COleControl:: GetFocus](#getfocus)|Determina si el control tiene el foco.|
|[COleControl:: GetFont](#getfont)|Devuelve el valor de la propiedad Font estándar.|
|[COleControl:: GetFontTextMetrics](#getfonttextmetrics)|Devuelve las métricas de un objeto `CFontHolder`.|
|[COleControl:: GetForeColor](#getforecolor)|Devuelve el valor de la propiedad ForeColor estándar.|
|[COleControl:: GetHwnd](#gethwnd)|Devuelve el valor de la propiedad hWnd de stock.|
|[COleControl:: GetMessageString](#getmessagestring)|Proporciona texto de la barra de estado para un elemento de menú.|
|[COleControl:: GetNotSupported](#getnotsupported)|Impide el acceso al valor de propiedad de un control por parte del usuario.|
|[COleControl:: GetReadyState](#getreadystate)|Devuelve el estado de preparación del control.|
|[COleControl:: GetRectInContainer](#getrectincontainer)|Devuelve el rectángulo del control con respecto a su contenedor.|
|[COleControl:: GetStockTextMetrics](#getstocktextmetrics)|Devuelve las métricas de la propiedad Font estándar.|
|[COleControl:: GetText](#gettext)|Devuelve el valor de la propiedad texto o título estándar.|
|[COleControl:: GetWindowlessDropTarget](#getwindowlessdroptarget)|Invalide para permitir que un control sin ventanas sea el destino de las operaciones de arrastrar y colocar.|
|[COleControl:: InitializeIIDs](#initializeiids)|Informa a la clase base de los identificadores IID que va a utilizar el control.|
|[COleControl:: InternalGetFont](#internalgetfont)|Devuelve un objeto `CFontHolder` para la propiedad Font estándar.|
|[COleControl:: InternalGetText](#internalgettext)|Recupera el título o la propiedad de texto.|
|[COleControl:: InternalSetReadyState](#internalsetreadystate)|Establece el estado de disponibilidad del control y activa el evento ready-State-Change.|
|[COleControl:: InvalidateControl](#invalidatecontrol)|Invalida un área del control que se muestra, lo que hace que se vuelva a dibujar.|
|[COleControl:: InvalidateRgn](#invalidatergn)|Invalida el área cliente de la ventana contenedor dentro de la región especificada. Se puede usar para volver a dibujar controles sin ventana en la región.|
|[COleControl:: IsConvertingVBX](#isconvertingvbx)|Permite la carga especializada de un control OLE.|
|[COleControl:: IsModified](#ismodified)|Determina si el estado del control ha cambiado.|
|[COleControl:: IsOptimizedDraw](#isoptimizeddraw)|Indica si el contenedor admite el dibujo optimizado para la operación de dibujo actual.|
|[COleControl:: IsSubclassedControl](#issubclassedcontrol)|Se llama para determinar si el control subclases de un control de Windows.|
|[COleControl:: Load](#load)|Restablece los datos asincrónicos anteriores e inicia una nueva carga de la propiedad asincrónica del control.|
|[COleControl:: LockInPlaceActive](#lockinplaceactive)|Determina si el contenedor puede desactivar el control.|
|[COleControl:: OnAmbientPropertyChange](#onambientpropertychange)|Se llama cuando se cambia una propiedad de ambiente.|
|[COleControl:: OnAppearanceChanged](#onappearancechanged)|Se le llama cuando cambia la propiedad de aspecto de las acciones.|
|[COleControl:: OnBackColorChanged](#onbackcolorchanged)|Se llama cuando se cambia la propiedad BackColor de stock.|
|[COleControl:: OnBorderStyleChanged](#onborderstylechanged)|Se llama cuando se cambia la propiedad BorderStyle de stock.|
|[COleControl:: OnClick](#onclick)|Se llama para desencadenar el evento de clic estándar.|
|[COleControl:: OnClose](#onclose)|Notifica al control que se ha llamado a `IOleControl::Close`.|
|[COleControl:: OnDoVerb](#ondoverb)|Se llama después de ejecutar un verbo de control.|
|[COleControl:: OnDraw](#ondraw)|Se le llama cuando se solicita a un control que vuelva a dibujarse.|
|[COleControl:: OnDrawMetafile](#ondrawmetafile)|Lo llama el contenedor cuando se solicita a un control que vuelva a dibujarse mediante un contexto de dispositivo de metarchivo.|
|[COleControl:: aleditar](#onedit)|Lo llama el contenedor para activar un control OLE.|
|[COleControl:: OnEnabledChanged](#onenabledchanged)|Se llama cuando se cambia la propiedad stock enabled.|
|[COleControl:: OnEnumVerbs](#onenumverbs)|Lo llama el contenedor para enumerar los verbos de un control.|
|[COleControl:: OnEventAdvise](#oneventadvise)|Se llama cuando los controladores de eventos se conectan o se desconectan de un control.|
|[COleControl:: OnFontChanged](#onfontchanged)|Se llama cuando se cambia la propiedad Font estándar.|
|[COleControl:: OnForeColorChanged](#onforecolorchanged)|Se llama cuando se cambia la propiedad ForeColor de stock.|
|[COleControl:: OnFreezeEvents](#onfreezeevents)|Se le llama cuando los eventos de un control se inmovilizan o inmovilizan.|
|[COleControl:: OnGetColorSet](#ongetcolorset)|Notifica al control que se ha llamado a `IOleObject::GetColorSet`.|
|[COleControl:: OnGetControlInfo](#ongetcontrolinfo)|Proporciona información de la tecla de tecla del contenedor.|
|[COleControl:: OnGetDisplayString](#ongetdisplaystring)|Se llama para obtener una cadena que represente un valor de propiedad.|
|[COleControl:: OnGetInPlaceMenu](#ongetinplacemenu)|Solicita el identificador del menú del control que se combinará con el menú contenedor.|
|[COleControl:: OnGetNaturalExtent](#ongetnaturalextent)|Invalide para recuperar el tamaño de presentación del control más próximo al modo de extensión y tamaño propuesto.|
|[COleControl:: OnGetPredefinedStrings](#ongetpredefinedstrings)|Devuelve cadenas que representan los valores posibles de una propiedad.|
|[COleControl:: OnGetPredefinedValue](#ongetpredefinedvalue)|Devuelve el valor correspondiente a una cadena predefinida.|
|[COleControl:: OnGetViewExtent](#ongetviewextent)|Invalide para recuperar el tamaño de las áreas de presentación del control (se puede usar para habilitar el dibujo de dos pasos).|
|[COleControl:: OnGetViewRect](#ongetviewrect)|Invalide para convertir el tamaño del control en un rectángulo empezando en una posición específica.|
|[COleControl:: OnGetViewStatus](#ongetviewstatus)|Invalide para recuperar el estado de vista del control.|
|[COleControl:: OnHideToolBars](#onhidetoolbars)|Lo llama el contenedor cuando el control es la interfaz de usuario desactivada.|
|[COleControl:: OnInactiveMouseMove](#oninactivemousemove)|Invalide para que el contenedor para el control inactivo bajo el puntero del mouse envíe WM_MOUSEMOVE mensajes al control.|
|[COleControl:: OnInactiveSetCursor](#oninactivesetcursor)|Invalide para que el contenedor para el control inactivo bajo el puntero del mouse envíe WM_SETCURSOR mensajes al control.|
|[COleControl:: OnKeyDownEvent](#onkeydownevent)|Se llama después de que se haya activado el evento stock.|
|[COleControl:: OnKeyPressEvent](#onkeypressevent)|Se llama después de que se haya activado el evento stock KeyPress.|
|[COleControl:: OnKeyUpEvent](#onkeyupevent)|Se llama después de que se haya desencadenado el evento KeyUp de stock.|
|[COleControl:: OnMapPropertyToPage](#onmappropertytopage)|Indica la página de propiedades que se va a utilizar para editar una propiedad.|
|[COleControl:: mnemónicos](#onmnemonic)|Se le llama cuando se ha presionado una tecla de tecla de método del control.|
|[COleControl:: propiedades](#onproperties)|Se le llama cuando se ha invocado el verbo "propiedades" del control.|
|[COleControl:: OnQueryHitPoint](#onqueryhitpoint)|Invalide para consultar si la presentación de un control se superpone a un punto determinado.|
|[COleControl:: OnQueryHitRect](#onqueryhitrect)|Invalide para consultar si la presentación de un control se superpone a cualquier punto de un rectángulo determinado.|
|[COleControl:: OnRenderData](#onrenderdata)|Lo llama el marco de trabajo para recuperar los datos en el formato especificado.|
|[COleControl:: OnRenderFileData](#onrenderfiledata)|Lo llama el marco de trabajo para recuperar datos de un archivo con el formato especificado.|
|[COleControl:: OnRenderGlobalData](#onrenderglobaldata)|Lo llama el marco de trabajo para recuperar datos de la memoria global en el formato especificado.|
|[COleControl:: OnResetState](#onresetstate)|Restablece los valores predeterminados de las propiedades de un control.|
|[COleControl:: OnSetClientSite](#onsetclientsite)|Notifica al control que se ha llamado a `IOleControl::SetClientSite`.|
|[COleControl:: OnSetData](#onsetdata)|Reemplaza los datos del control por otro valor.|
|[COleControl:: OnSetExtent](#onsetextent)|Se llama después de que la extensión del control haya cambiado.|
|[COleControl:: OnSetObjectRects](#onsetobjectrects)|Se llama después de cambiar las dimensiones del control.|
|[COleControl:: OnShowToolBars](#onshowtoolbars)|Se llama cuando el control se ha activado en la interfaz de usuario.|
|[COleControl:: OnTextChanged](#ontextchanged)|Se le llama cuando se cambia el texto o la propiedad de la leyenda.|
|[COleControl:: OnWindowlessMessage](#onwindowlessmessage)|Procesa los mensajes de ventana (excepto los mensajes del mouse y del teclado) para los controles sin ventana.|
|[COleControl::P arentToClient](#parenttoclient)|Convierte un punto en relación con el origen del contenedor en un punto relativo al origen del control.|
|[COleControl::P ostModalDialog](#postmodaldialog)|Notifica al contenedor que se ha cerrado un cuadro de diálogo modal.|
|[COleControl::P reModalDialog](#premodaldialog)|Notifica al contenedor que un cuadro de diálogo modal está a punto de mostrarse.|
|[COleControl:: RecreateControlWindow](#recreatecontrolwindow)|Destruye y vuelve a crear la ventana del control.|
|[COleControl:: Refresh](#refresh)|Fuerza un redibujado de la apariencia de un control.|
|[COleControl:: ReleaseCapture](#releasecapture)|Libera la captura del mouse.|
|[COleControl:: ReleaseDC](#releasedc)|Libera el contexto de dispositivo de presentación de un contenedor de un control sin ventana.|
|[COleControl:: ReparentControlWindow](#reparentcontrolwindow)|Restablece el elemento primario de la ventana de control.|
|[COleControl:: ResetStockProps](#resetstockprops)|Inicializa `COleControl` propiedades estándar en sus valores predeterminados.|
|[COleControl:: ResetVersion](#resetversion)|Inicializa el número de versión en un valor determinado.|
|[COleControl:: ScrollWindow](#scrollwindow)|Permite a un control sin ventana desplazarse por un área dentro de su imagen activa en contexto en la pantalla.|
|[COleControl:: SelectFontObject](#selectfontobject)|Selecciona una propiedad de fuente personalizada en un contexto de dispositivo.|
|[COleControl:: SelectStockFont](#selectstockfont)|Selecciona la propiedad fuente estándar en un contexto de dispositivo.|
|[COleControl:: SerializeExtent](#serializeextent)|Serializa o inicializa el espacio de presentación del control.|
|[COleControl:: SerializeStockProps](#serializestockprops)|Serializa o inicializa las propiedades estándar de `COleControl`.|
|[COleControl:: SerializeVersion](#serializeversion)|Serializa o inicializa la información de versión del control.|
|[COleControl:: SetAppearance](#setappearance)|Establece el valor de la propiedad de aspecto bursátil.|
|[COleControl:: SetBackColor](#setbackcolor)|Establece el valor de la propiedad BackColor de stock.|
|[COleControl:: SetBorderStyle](#setborderstyle)|Establece el valor de la propiedad BorderStyle de stock.|
|[COleControl:: SetCapture](#setcapture)|Hace que la ventana contenedora del control tome posesión de la captura del mouse en nombre del control.|
|[COleControl:: SetControlSize](#setcontrolsize)|Establece la posición y el tamaño del control OLE.|
|[COleControl:: SetEnabled](#setenabled)|Establece el valor de la propiedad stock enabled.|
|[COleControl:: SetFocus](#setfocus)|Hace que la ventana contenedora del control tome posesión del foco de entrada en nombre del control.|
|[COleControl:: SetFont](#setfont)|Establece el valor de la propiedad fuente estándar.|
|[COleControl:: SetForeColor](#setforecolor)|Establece el valor de la propiedad ForeColor estándar.|
|[COleControl:: SetInitialSize](#setinitialsize)|Establece el tamaño de un control OLE cuando se muestra por primera vez en un contenedor.|
|[COleControl:: SetModifiedFlag](#setmodifiedflag)|Cambia el estado modificado de un control.|
|[COleControl:: SetNotPermitted](#setnotpermitted)|Indica que se ha producido un error en una solicitud de edición.|
|[COleControl:: SetNotSupported](#setnotsupported)|Impide que el usuario modifique el valor de la propiedad de un control.|
|[COleControl:: SetRectInContainer](#setrectincontainer)|Establece el rectángulo del control con respecto a su contenedor.|
|[COleControl:: SetText](#settext)|Establece el valor de la propiedad texto estándar o leyenda.|
|[COleControl:: ThrowError](#throwerror)|Indica que se ha producido un error en un control OLE.|
|[COleControl:: TransformCoords](#transformcoords)|Transforma los valores de coordenadas entre un contenedor y el control.|
|[COleControl:: TranslateColor](#translatecolor)|Convierte un valor de OLE_COLOR en un valor de COLORREF.|
|[COleControl:: WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Determina si las propiedades de ambiente estarán disponibles la próxima vez que se cargue el control.|
|[COleControl:: WindowProc](#windowproc)|Proporciona un procedimiento de Windows para un objeto `COleControl`.|

### <a name="protected-methods"></a>Métodos protegidos

|Nombre|Descripción|
|----------|-----------------|
|[COleControl::D rawContent](#drawcontent)|Lo llama el marco de trabajo cuando es necesario actualizar la apariencia del control.|
|[COleControl::D rawMetafile](#drawmetafile)|Lo llama el marco de trabajo cuando se usa el contexto de dispositivo de metarchivo.|
|[COleControl:: IsInvokeAllowed](#isinvokeallowed)|Habilita la invocación de métodos de automatización.|
|[COleControl:: SetInitialDataFormats](#setinitialdataformats)|Lo llama el marco de trabajo para inicializar la lista de formatos de datos admitidos por el control.|

## <a name="remarks"></a>Observaciones

Derivada de `CWnd`, esta clase hereda toda la funcionalidad de un objeto Windows Window más la funcionalidad adicional específica de OLE, como el desencadenamiento de eventos y la capacidad de admitir métodos y propiedades.

Los controles OLE se pueden insertar en aplicaciones de contenedor OLE y comunicarse con el contenedor mediante un sistema bidireccional de activación de eventos y exponer métodos y propiedades en el contenedor. Tenga en cuenta que los contenedores OLE estándar solo admiten la funcionalidad básica de un control OLE. No pueden admitir características extendidas de un control OLE. La activación de eventos se produce cuando se envían eventos al contenedor como resultado de ciertas acciones que tienen lugar en el control. A su vez, el contenedor se comunica con el control mediante el uso de un conjunto expuesto de métodos y propiedades análogos a las funciones miembro y C++ miembros de datos de una clase. Este enfoque permite al desarrollador controlar el aspecto del control y notificar al contenedor cuando se producen ciertas acciones.

## <a name="windowless-controls"></a>Controles sin ventana

Los controles OLE se pueden usar de forma local en contexto sin una ventana. Los controles sin ventana tienen ventajas importantes:

- Los controles sin ventana pueden ser transparentes y no rectangulares.

- Los controles sin ventana reducen el tamaño de la instancia y la hora de creación del objeto

Los controles no necesitan una ventana. Los servicios que ofrece una ventana se pueden proporcionar fácilmente a través de una única ventana compartida (normalmente, el contenedor) y un poco de código de distribución. Tener una ventana es principalmente una complicación innecesaria en el objeto.

Cuando se usa la activación sin ventana, el contenedor (que tiene una ventana) es responsable de proporcionar servicios que, de lo contrario, se habrían proporcionado en la ventana del control. Por ejemplo, si el control necesita consultar el foco del teclado, consultar la captura del mouse u obtener un contexto de dispositivo, el contenedor administra estas operaciones. Las funciones miembro de la operación `COleControl` sin ventana invocan estas operaciones en el contenedor.

Cuando la activación sin ventanas está habilitada, el contenedor delega los mensajes de entrada en la interfaz de `IOleInPlaceObjectWindowless` del control (una extensión de [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) para la compatibilidad sin ventanas). la implementación de `COleControl`de esta interfaz enviará estos mensajes a través del mapa de mensajes del control, después de ajustar las coordenadas del mouse adecuadamente. Puede procesar estos mensajes como los mensajes de ventana normales agregando las entradas correspondientes al mapa de mensajes.

En un control sin ventana, siempre debe usar las funciones miembro `COleControl` en lugar de las funciones miembro `CWnd` correspondientes o sus funciones de API de Windows relacionadas.

Los objetos de control OLE también pueden crear una ventana cuando se activan, pero la cantidad de trabajo necesaria para la transición inactiva-activa aumenta y la velocidad de la transición deja de funcionar. Hay casos en los que se trata de un problema: por ejemplo, una cuadrícula de cuadros de texto. Cuando se realiza el cursor hacia arriba y hacia abajo por la columna, cada control se debe activar en contexto y, a continuación, desactivarse. La velocidad de la transición inactiva/activa afectará directamente a la velocidad de desplazamiento.

Para obtener más información sobre el desarrollo de un marco de control OLE, vea los artículos [controles ActiveX de MFC](../../mfc/mfc-activex-controls.md) e [información general: crear un programa de control ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Para obtener información sobre cómo optimizar los controles OLE, incluidos los controles sin ventanas y sin parpadeo, vea [controles ActiveX MFC: optimización](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Jerarquía de herencia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Requisitos

**Encabezado:** afxctl. h

##  <a name="ambientbackcolor"></a>COleControl:: AmbientBackColor

Devuelve el valor de la propiedad BackColor ambiente.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Valor devuelto

Valor actual de la propiedad de BackColor ambiente del contenedor, si existe. Si no se admite la propiedad, esta función devuelve el color de fondo de Windows definido por el sistema.

### <a name="remarks"></a>Observaciones

La propiedad BackColor ambiente está disponible para todos los controles y está definida por el contenedor. Tenga en cuenta que no es necesario que el contenedor admita esta propiedad.

##  <a name="ambientdisplayname"></a>COleControl:: AmbientDisplayName

El nombre que el contenedor ha asignado al control se puede usar en los mensajes de error que se muestran al usuario.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Valor devuelto

Nombre del control OLE. El valor predeterminado es una cadena de longitud cero.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que no es necesario que el contenedor admita esta propiedad.

##  <a name="ambientfont"></a>COleControl:: AmbientFont

Devuelve el valor de la propiedad de fuente ambiente.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Valor devuelto

Puntero a la interfaz de envío de fuentes ambiente del contenedor. El valor predeterminado es NULL. Si el valor devuelto no es igual a NULL, es responsable de liberar la fuente llamando a su función miembro [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) .

### <a name="remarks"></a>Observaciones

La propiedad fuente ambiente la define el contenedor y está disponible para todos los controles. Tenga en cuenta que no es necesario que el contenedor admita esta propiedad.

##  <a name="ambientforecolor"></a>COleControl:: AmbientForeColor

Devuelve el valor de la propiedad ForeColor ambiente.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Valor devuelto

Valor actual de la propiedad ForeColor de ambiente del contenedor, si existe. Si no se admite, esta función devuelve el color del texto de Windows definido por el sistema.

### <a name="remarks"></a>Observaciones

La propiedad ForeColor ambiente está disponible para todos los controles y está definida por el contenedor. Tenga en cuenta que no es necesario que el contenedor admita esta propiedad.

##  <a name="ambientlocaleid"></a>COleControl:: AmbientLocaleID

Devuelve el identificador de configuración regional del contenedor.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Valor devuelto

Valor de la propiedad LocaleID del contenedor, si existe. Si no se admite esta propiedad, esta función devuelve 0.

### <a name="remarks"></a>Observaciones

El control puede utilizar el LocaleID para adaptar su interfaz de usuario para las configuraciones regionales específicas. Tenga en cuenta que no es necesario que el contenedor admita esta propiedad.

##  <a name="ambientappearance"></a>COleControl:: AmbientAppearance

Recupera el valor de apariencia actual del objeto de control.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Valor devuelto

Apariencia del control:

- **0** apariencia plana

- **1** apariencia 3D

### <a name="remarks"></a>Observaciones

Llame a esta función para recuperar el valor actual de la propiedad DISPID_AMBIENT_APPEARANCE del control.

##  <a name="ambientscaleunits"></a>COleControl:: AmbientScaleUnits

Devuelve el tipo de unidades utilizadas por el contenedor.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Valor devuelto

Cadena que contiene el ScaleUnits ambiente del contenedor. Si no se admite esta propiedad, esta función devuelve una cadena de longitud cero.

### <a name="remarks"></a>Observaciones

La propiedad ScaleUnits ambiente del contenedor se puede usar para mostrar las posiciones o las dimensiones, etiquetadas con la unidad seleccionada, como twips o centímetros. Tenga en cuenta que no es necesario que el contenedor admita esta propiedad.

##  <a name="ambientshowgrabhandles"></a>COleControl:: AmbientShowGrabHandles

Determina si el contenedor permite que el control muestre controladores de arrastre para sí mismo cuando esté activo.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se deben mostrar los controladores de arrastre; de lo contrario, es 0. Si no se admite esta propiedad, esta función devuelve un valor distinto de cero.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que no es necesario que el contenedor admita esta propiedad.

##  <a name="ambientshowhatching"></a>COleControl:: AmbientShowHatching

Determina si el contenedor permite que el control se muestre con un patrón sombreado cuando la interfaz de usuario está activa.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se debe mostrar el patrón sombreado; de lo contrario, es 0. Si no se admite esta propiedad, esta función devuelve un valor distinto de cero.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que no es necesario que el contenedor admita esta propiedad.

##  <a name="ambienttextalign"></a>COleControl:: AmbientTextAlign

Determina la alineación del texto ambiente preferida por el contenedor del control.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Valor devuelto

El estado de la propiedad TextAlign de ambiente del contenedor. Si no se admite esta propiedad, esta función devuelve 0.

A continuación se muestra una lista de valores devueltos válidos:

|Valor devuelto|Significado|
|------------------|-------------|
|0|Alineación general (números a la derecha, texto a la izquierda).|
|1|Justificar a la izquierda|
|2|Center|
|3|Justificar a la derecha|

### <a name="remarks"></a>Observaciones

Esta propiedad está disponible para todos los controles incrustados y está definida por el contenedor. Tenga en cuenta que no es necesario que el contenedor admita esta propiedad.

##  <a name="ambientuidead"></a>COleControl:: AmbientUIDead

Determina si el contenedor desea que el control responda a las acciones de la interfaz de usuario.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el control debe responder a las acciones de la interfaz de usuario; de lo contrario, es 0. Si no se admite esta propiedad, esta función devuelve 0.

### <a name="remarks"></a>Observaciones

Por ejemplo, un contenedor podría establecer este valor en TRUE en el modo de diseño.

##  <a name="ambientusermode"></a>COleControl:: AmbientUserMode

Determina si el contenedor está en modo de diseño o en modo de usuario.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el contenedor está en modo de usuario; en caso contrario, 0 (en modo de diseño). Si no se admite esta propiedad, esta función devuelve TRUE.

### <a name="remarks"></a>Observaciones

Por ejemplo, un contenedor puede establecer este valor en FALSE en el modo de diseño.

##  <a name="boundpropertychanged"></a>COleControl:: BoundPropertyChanged

Indica que el valor de propiedad enlazado ha cambiado.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parámetros

*DISPID*<br/>
IDENTIFICADOR de envío de una propiedad enlazada del control.

### <a name="remarks"></a>Observaciones

Se debe llamar a este método cada vez que cambie el valor de la propiedad, incluso en los casos en los que el cambio no se realizó a través del método de conjunto de propiedades. Ser especialmente consciente de las propiedades enlazadas que se asignan a las variables de miembro. Cada vez que se cambia una variable miembro de este tipo, se debe llamar a `BoundPropertyChanged`.

##  <a name="boundpropertyrequestedit"></a>COleControl:: BoundPropertyRequestEdit

Solicita permiso de la interfaz `IPropertyNotifySink` para cambiar un valor de propiedad enlazado proporcionado por el control.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parámetros

*DISPID*<br/>
IDENTIFICADOR de envío de una propiedad enlazada del control.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se permite el cambio; de lo contrario, es 0. El valor predeterminado es distinto de cero.

### <a name="remarks"></a>Observaciones

Si se deniega el permiso, el control no debe permitir que cambie el valor de la propiedad. Esto se puede hacer si se omite o se produce un error en la acción que intentó cambiar el valor de la propiedad.

##  <a name="clienttoparent"></a>COleControl:: ClientToParent

Convierte las coordenadas de *PPoint* en coordenadas primarias.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parámetros

*lprcBounds*<br/>
Puntero a los límites del control OLE dentro del contenedor. No es el área cliente sino el área del control completo, incluidos los bordes y las barras de desplazamiento.

*pPoint*<br/>
Puntero al punto de área del cliente OLE que se va a convertir en las coordenadas del elemento primario (contenedor).

### <a name="remarks"></a>Observaciones

En la entrada *PPoint* es relativa al origen del área cliente del control OLE (esquina superior izquierda del área cliente del control). En la salida *PPoint* es relativa al origen del elemento primario (esquina superior izquierda del contenedor).

##  <a name="clipcaretrect"></a>COleControl:: ClipCaretRect

Ajusta un rectángulo del símbolo de intercalación si está totalmente o parcialmente incluido en objetos opacos superpuestos.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*lpRect*<br/>
En la entrada, puntero a una estructura [Rect](/windows/win32/api/windef/ns-windef-rect) que contiene el área del símbolo de intercalación que se va a ajustar. En la salida, el área de símbolo de intercalación ajustada, o NULL si el rectángulo del símbolo de intercalación está completamente incluido.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Un símbolo de intercalación es una línea, un bloque o un mapa de bits intermitentes que normalmente indica dónde se insertará el texto o los gráficos.

Un objeto sin ventana no puede mostrar de forma segura un símbolo de intercalación sin comprobar primero si el símbolo de intercalación está parcial o totalmente oculto por objetos superpuestos. Para que esto sea posible, un objeto puede usar `ClipCaretRect` para obtener el símbolo de intercalación (reducido) para asegurarse de que quepa en la región de recorte.

Los objetos que crean un símbolo de intercalación deben enviar el rectángulo del símbolo de intercalación a `ClipCaretRect` y usar el rectángulo ajustado para el símbolo de intercalación. Si el símbolo de intercalación está completamente oculto, este método devolverá FALSE y el símbolo de intercalación no debe mostrarse en absoluto en este caso.

##  <a name="colecontrol"></a>COleControl:: COleControl

Construye un objeto `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Observaciones

Normalmente, esta función no se llama directamente. En su lugar, el control OLE lo crea normalmente su generador de clases.

##  <a name="controlinfochanged"></a>COleControl:: ControlInfoChanged

Llame a esta función cuando haya cambiado el conjunto de teclas de método que admite el control.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Observaciones

Al recibir esta notificación, el contenedor del control obtiene el nuevo conjunto de teclas de método realizando una llamada a [IOleControl:: GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Tenga en cuenta que no es necesario que el contenedor responda a esta notificación.

##  <a name="displayerror"></a>COleControl::D isplayError

Lo llama el marco de trabajo una vez que se ha controlado el evento de error bursátil (a menos que el controlador de eventos haya suprimido la presentación del error).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parámetros

*SCODE*<br/>
Valor del código de estado que se va a informar. Para obtener una lista completa de los posibles códigos, vea el artículo [controles ActiveX: temas avanzados](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Descripción del error que se va a informar.

*lpszSource*<br/>
Nombre del módulo que genera el error (normalmente, el nombre del módulo de control OLE).

*lpszHelpFile*<br/>
Nombre del archivo de ayuda que contiene una descripción del error.

*nHelpID*<br/>
IDENTIFICADOR del contexto de ayuda del error que se va a informar.

### <a name="remarks"></a>Observaciones

El comportamiento predeterminado muestra un cuadro de mensaje que contiene la descripción del error, que se encuentra en *lpszDescription*.

Invalide esta función para personalizar el modo en que se muestran los errores.

##  <a name="doclick"></a>COleControl::D oClick

Simula una acción de clic del mouse en el control.

```
void DoClick();
```

### <a name="remarks"></a>Observaciones

Se llamará a la función miembro de `COleControl::OnClick` reemplazable y se desencadenará un evento de clic bursátil, si lo admite el control.

Esta función es compatible con la clase base `COleControl` como un método estándar, denominado click. Para obtener más información, vea el artículo [controles ActiveX: métodos](../../mfc/mfc-activex-controls-methods.md).

##  <a name="dopropexchange"></a>COleControl::D oPropExchange

Lo llama el marco de trabajo al cargar o almacenar un control a partir de una representación de almacenamiento persistente, como una secuencia o un conjunto de propiedades.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parámetros

*pPX*<br/>
Puntero a un objeto `CPropExchange` . El marco de trabajo proporciona este objeto para establecer el contexto del intercambio de propiedades, incluida su dirección.

### <a name="remarks"></a>Observaciones

Normalmente, esta función realiza llamadas a la familia de funciones de **PX_** para cargar o almacenar propiedades específicas definidas por el usuario de un control OLE.

Si se ha utilizado el Asistente para controles para crear el proyecto de control OLE, la versión invalidada de esta función serializará las propiedades estándar admitidas por `COleControl` con una llamada a la función de clase base, `COleControl::DoPropExchange`. A medida que agrega propiedades definidas por el usuario al control OLE, tendrá que modificar esta función para serializar las nuevas propiedades. Para obtener más información sobre la serialización, vea el artículo [controles ActiveX: serialización](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="dosuperclasspaint"></a>COleControl::D oSuperclassPaint

Vuelve a dibujar un control OLE que se ha subclase de un control de Windows.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Un puntero al contexto de dispositivo del contenedor de control.

*rcBounds*<br/>
Área en la que se va a dibujar el control.

### <a name="remarks"></a>Observaciones

Llame a esta función para administrar correctamente el dibujo de un control OLE no activo. Esta función solo se debe usar si el control OLE subclases de un control de Windows y debe llamarse en la función `OnDraw` del control.

Para obtener más información sobre esta función y la subclase de un control de Windows, vea el artículo [controles ActiveX: subclase de un control de Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

##  <a name="drawcontent"></a>COleControl::D rawContent

Lo llama el marco de trabajo cuando es necesario actualizar la apariencia del control.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Puntero en el contexto del dispositivo.

*CR*<br/>
Área rectangular en la que se va a dibujar.

### <a name="remarks"></a>Observaciones

Esta función llama directamente a la función Overridable `OnDraw`.

##  <a name="drawmetafile"></a>COleControl::D rawMetafile

Lo llama el marco de trabajo cuando se usa el contexto de dispositivo de metarchivo.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Puntero al contexto de dispositivo de metarchivo.

*CR*<br/>
Área rectangular en la que se va a dibujar.

##  <a name="enablesimpleframe"></a>COleControl:: EnableSimpleFrame

Habilita la característica fotograma simple para un control OLE.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Observaciones

Esta característica permite a un control admitir la contención visual de otros controles, pero no contención de OLE verdadera. Un ejemplo sería un cuadro de grupo con varios controles dentro de. Estos controles no se incluyen en OLE, pero están en el mismo grupo.

##  <a name="exchangeextent"></a>COleControl:: ExchangeExtent

Serializa o inicializa el estado de la extensión del control (sus dimensiones en unidades HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parámetros

*pPX*<br/>
Un puntero a un objeto [CPropExchange](../../mfc/reference/cpropexchange-class.md) . El marco de trabajo proporciona este objeto para establecer el contexto del intercambio de propiedades, incluida su dirección.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la función se realizó correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

Normalmente, la implementación predeterminada de `COleControl::DoPropExchange`llama a esta función.

##  <a name="exchangestockprops"></a>COleControl:: ExchangeStockProps

Serializa o inicializa el estado de las propiedades estándar del control.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parámetros

*pPX*<br/>
Un puntero a un objeto [CPropExchange](../../mfc/reference/cpropexchange-class.md) . El marco de trabajo proporciona este objeto para establecer el contexto del intercambio de propiedades, incluida su dirección.

### <a name="remarks"></a>Observaciones

Normalmente, la implementación predeterminada de `COleControl::DoPropExchange`llama a esta función.

##  <a name="exchangeversion"></a>COleControl:: ExchangeVersion

Serializa o inicializa el estado de la información de versión de un control.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parámetros

*pPX*<br/>
Puntero a un objeto `CPropExchange` . El marco de trabajo proporciona este objeto para establecer el contexto del intercambio de propiedades, incluida su dirección.

*dwVersionDefault*<br/>
Número de versión actual del control.

*bConvert*<br/>
Indica si los datos persistentes se deben convertir al formato más reciente cuando se guardan o se mantienen en el mismo formato que se cargó.

### <a name="return-value"></a>Valor devuelto

Un valor distinto de cero de la función se realizó correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

Normalmente, será la primera función a la que llama la invalidación de un control de `COleControl::DoPropExchange`. Al cargar, esta función lee el número de versión de los datos persistentes y establece el atributo version del objeto [CPropExchange](../../mfc/reference/cpropexchange-class.md) en consecuencia. Al guardar, esta función escribe el número de versión de los datos persistentes.

Para obtener más información sobre la persistencia y el control de versiones, vea el artículo [controles ActiveX: serialización](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="fireclick"></a>COleControl:: FireClick

Lo llama el marco de trabajo cuando se hace clic con el mouse sobre un control activo.

```
void FireClick();
```

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento click, el mapa de eventos del control debe tener definido un evento click bursátil.

##  <a name="firedblclick"></a>COleControl:: FireDblClick

Lo llama el marco de trabajo cuando se hace doble clic en el mouse sobre un control activo.

```
void FireDblClick();
```

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento DblClick, el mapa de eventos del control debe tener definido un evento DblClick de stock.

##  <a name="fireerror"></a>COleControl:: FireError (

Desencadena el evento de error de stock.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parámetros

*SCODE*<br/>
Valor del código de estado que se va a informar. Para obtener una lista completa de los posibles códigos, vea el artículo [controles ActiveX: temas avanzados](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Descripción del error que se va a informar.

*nHelpID*<br/>
IDENTIFICADOR de la ayuda del error que se va a informar.

### <a name="remarks"></a>Observaciones

Este evento proporciona una forma de señalar, en los lugares adecuados del código, que se ha producido un error en el control. A diferencia de otros eventos estándar, como click o MouseMove, el marco de trabajo nunca activa el error.

Para notificar un error que se produce durante una función get de propiedad, una función de conjunto de propiedades o un método de automatización, llame a [COleControl:: ThrowError](#throwerror).

La implementación de un evento de error de acciones de un control OLE usa un valor SCODE. Si el control usa este evento y está pensado para utilizarse en Visual Basic 4,0, recibirá errores porque el valor SCODE no se admite en Visual Basic.

Para corregirlo, cambie manualmente el parámetro SCODE en el del control. ODL a **Long**. Además, cualquier evento, método o propiedad personalizados que use un parámetro SCODE también provoca el mismo problema.

##  <a name="fireevent"></a>COleControl:: FireEvent

Desencadena un evento definido por el usuario desde el control con cualquier número de argumentos opcionales,.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parámetros

*DISPID*<br/>
IDENTIFICADOR de envío del evento que se va a desencadenar.

*pbParams*<br/>
Un descriptor para los tipos de parámetro del evento.

### <a name="remarks"></a>Observaciones

Normalmente, esta función no se debe llamar directamente. En su lugar, llamará a las funciones de activación de eventos en la sección mapa de eventos de la declaración de clase del control.

El argumento *pbParams* es una lista separada por espacios de **VTS_** . Uno o varios de estos valores, separados por espacios (no por comas), especifican la lista de parámetros de la función. Los valores posibles son los siguientes:

|Símbolo|Tipo de parámetro|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Se han definido constantes variantes adicionales para todos los tipos Variant, a excepción de VTS_FONT y VTS_PICTURE, que proporcionan un puntero a la constante de datos Variant. Estas constantes se denominan mediante la Convención de`constantname` de **VTS_P** . Por ejemplo, VTS_PCOLOR es un puntero a una constante de VTS_COLOR.

##  <a name="firekeydown"></a>COleControl:: FireKeyDown

Lo llama el marco de trabajo cuando se presiona una tecla mientras el control está activo en la interfaz de usuario.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parámetros

*pnChar*<br/>
Puntero al valor de código de tecla virtual de la tecla presionada. Para obtener una lista de códigos de tecla virtual estándar, vea Winuser. h

*nShiftState*<br/>
Contiene una combinación de las marcas siguientes:

- SHIFT_MASK se presionó la tecla Mayús durante la acción.

- CTRL_MASK se presionó la tecla CTRL durante la acción.

- ALT_MASK se presionó la tecla ALT durante la acción.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento KeyDown, el mapa de eventos del control debe tener definido un evento KeyDown stock.

##  <a name="firekeypress"></a>COleControl:: FireKeyPress

Lo llama el marco de trabajo cuando se presiona y se suelta una tecla mientras el control personalizado está activo en la interfaz de usuario dentro del contenedor.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parámetros

*pnChar*<br/>
Puntero al valor de carácter de la tecla presionada.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

El destinatario del evento puede modificar *pnChar*, por ejemplo, convertir todos los caracteres en minúsculas a mayúsculas. Si desea examinar el carácter modificado, invalide `OnKeyPressEvent`.

Para que se produzca la activación automática de un evento KeyPress, el mapa de eventos del control debe tener definido un evento KeyPress.

##  <a name="firekeyup"></a>COleControl:: FireKeyUp

Lo llama el marco de trabajo cuando se suelta una tecla mientras el control personalizado está activo en la interfaz de usuario dentro del contenedor.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parámetros

*pnChar*<br/>
Puntero al valor de código de tecla virtual de la clave liberada. Para obtener una lista de códigos de tecla virtual estándar, vea Winuser. h

*nShiftState*<br/>
Contiene una combinación de las marcas siguientes:

- SHIFT_MASK se presionó la tecla Mayús durante la acción.

- CTRL_MASK se presionó la tecla CTRL durante la acción.

- ALT_MASK se presionó la tecla ALT durante la acción.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento KeyUp, el mapa de eventos del control debe tener definido un evento KeyUp de stock.

##  <a name="firemousedown"></a>COleControl:: FireMouseDown

Lo llama el marco de trabajo cuando se presiona un botón del mouse sobre un control personalizado activo.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parámetros

*Nbotón*<br/>
Valor numérico del botón del mouse presionado. Puede contener uno de los siguientes valores:

- LEFT_BUTTON se presionó el botón primario del mouse.

- MIDDLE_BUTTON el botón central del mouse se presionó.

- RIGHT_BUTTON se presionó el botón secundario del mouse.

*nShiftState*<br/>
Contiene una combinación de las marcas siguientes:

- SHIFT_MASK se presionó la tecla Mayús durante la acción.

- CTRL_MASK se presionó la tecla CTRL durante la acción.

- ALT_MASK se presionó la tecla ALT durante la acción.

*x*<br/>
Coordenada x del cursor cuando se presiona un botón del mouse. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

*y*<br/>
Coordenada y del cursor cuando se presiona un botón del mouse. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento MouseDown, el mapa de eventos del control debe tener definido un evento MouseDown de acción.

##  <a name="firemousemove"></a>COleControl:: FireMouseMove

Lo llama el marco de trabajo cuando el cursor se mueve sobre un control personalizado activo.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parámetros

*Nbotón*<br/>
Valor numérico de los botones del mouse presionados. Contiene una combinación de los siguientes valores:

- LEFT_BUTTON se presionó el botón primario del mouse durante la acción.

- MIDDLE_BUTTON el botón central del mouse se presionó hacia abajo durante la acción.

- RIGHT_BUTTON el botón secundario del mouse se presionó hacia abajo durante la acción.

*nShiftState*<br/>
Contiene una combinación de las marcas siguientes:

- SHIFT_MASK se presionó la tecla Mayús durante la acción.

- CTRL_MASK se presionó la tecla CTRL durante la acción.

- ALT_MASK se presionó la tecla ALT durante la acción.

*x*<br/>
Coordenada x del cursor. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

*y*<br/>
Coordenada y del cursor. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento MouseMove, el mapa de eventos del control debe tener definido un evento de MouseMove stock.

##  <a name="firemouseup"></a>COleControl:: FireMouseUp

Lo llama el marco de trabajo cuando se suelta un botón del mouse sobre un control personalizado activo.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parámetros

*Nbotón*<br/>
Valor numérico del botón del mouse liberado. Puede tener uno de los siguientes valores:

- LEFT_BUTTON se soltó el botón primario del mouse.

- MIDDLE_BUTTON se liberó el botón central del mouse.

- RIGHT_BUTTON se liberó el botón secundario del mouse.

*nShiftState*<br/>
Contiene una combinación de las marcas siguientes:

- SHIFT_MASK se presionó la tecla Mayús durante la acción.

- CTRL_MASK se presionó la tecla CTRL durante la acción.

- ALT_MASK se presionó la tecla ALT durante la acción.

*x*<br/>
Coordenada x del cursor cuando se suelta un botón del mouse. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

*y*<br/>
Coordenada y de un cursor cuando se suelta un botón del mouse. La coordenada es relativa a la esquina superior izquierda de la ventana de control.

### <a name="remarks"></a>Observaciones

Si este evento se define como un evento personalizado, se determina cuándo se desencadena el evento.

Para que se produzca la activación automática de un evento MouseUp, el mapa de eventos del control debe tener definido un evento MouseUp de acciones.

##  <a name="firereadystatechange"></a>COleControl:: FireReadyStateChange

Desencadena un evento con el valor actual del estado de control listo.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Observaciones

El estado listo puede ser uno de los valores siguientes:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialización predeterminado|
|READYSTATE_LOADING|El control está cargando sus propiedades actualmente|
|READYSTATE_LOADED|Se ha inicializado el control|
|READYSTATE_INTERACTIVE|El control tiene suficientes datos para ser interactivos, pero no se han cargado todos los datos asincrónicos|
|READYSTATE_COMPLETE|El control tiene todos sus datos|

Use [GetReadyState](#getreadystate) para determinar la preparación actual del control.

[InternalSetReadyState](#internalsetreadystate) cambia el estado Ready al valor proporcionado y, a continuación, llama a `FireReadyStateChange`.

##  <a name="getactivationpolicy"></a>COleControl:: GetActivationPolicy

Modifica el comportamiento de activación predeterminado de un control que admite la interfaz `IPointerInactive`.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Valor devuelto

Combinación de marcas de la enumeración POINTERINACTIVE. Las marcas posibles son:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|El objeto se debe activar en contexto cuando el Mouse entra en él durante una operación de movimiento del mouse.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|El objeto se debe desactivar cuando el mouse sale del objeto durante una operación de movimiento del mouse.|
|POINTERINACTIVE_ACTIVATEONDRAG|El objeto se debe activar en contexto cuando se arrastra el mouse sobre él durante una operación de arrastrar y colocar.|

### <a name="remarks"></a>Observaciones

Cuando la interfaz de `IPointerInactive` está habilitada, el contenedor delegará WM_SETCURSOR y WM_MOUSEMOVE mensajes en ella. la implementación de `COleControl`de esta interfaz enviará estos mensajes a través del mapa de mensajes del control, después de ajustar las coordenadas del mouse adecuadamente.

Siempre que el contenedor recibe un WM_SETCURSOR o WM_MOUSEMOVE mensaje con el puntero del mouse sobre un objeto inactivo compatible con `IPointerInactive`, debe llamar a `GetActivationPolicy` en la interfaz y devolver marcas de la enumeración POINTERINACTIVE.

Puede procesar estos mensajes al igual que los mensajes de ventana normales, agregando las entradas correspondientes al mapa de mensajes. En los controladores, evite usar el `m_hWnd` variable miembro (o cualquier función miembro que lo use) sin comprobar primero que su valor no es NULL.

Cualquier objeto diseñado para hacer más que establecer el cursor del mouse o desencadenar un evento de movimiento del mouse, como proporcionar comentarios visuales especiales, debe devolver la marca de POINTERINACTIVE_ACTIVATEONENTRY y dibujar los comentarios solo cuando esté activo. Si el objeto devuelve esta marca, el contenedor debe activarlo en contexto inmediatamente y, a continuación, reenviarlo el mismo mensaje que desencadenó la llamada a `GetActivationPolicy`.

Si se devuelven las marcas POINTERINACTIVE_ACTIVATEONENTRY y POINTERINACTIVE_DEACTIVATEONLEAVE, el objeto solo se activará cuando el mouse esté sobre el objeto. Si solo se devuelve la marca POINTERINACTIVE_ACTIVATEONENTRY, el objeto solo se activará una vez cuando el mouse entre en primer lugar con el objeto.

También puede que desee que un control inactivo sea el destino de una operación de arrastrar y colocar de OLE. Esto requiere activar el control en el momento en que el usuario arrastra un objeto sobre él, de modo que la ventana del control se puede registrar como destino de colocación. Para que se produzca la activación durante un arrastre, devuelva la marca POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Un contenedor no debe almacenar en caché la información comunicada por `GetActivationPolicy`. En su lugar, se debe llamar a este método cada vez que el Mouse entra en un objeto inactivo.

Si un objeto inactivo no solicita que se active en contexto cuando el Mouse entra en él, su contenedor debe enviar los mensajes WM_SETCURSOR subsiguientes a este objeto llamando a [OnInactiveSetCursor](#oninactivesetcursor) siempre que el puntero del mouse permanezca sobre el objeto.

La habilitación de la interfaz de `IPointerInactive` normalmente significa que desea que el control sea capaz de procesar los mensajes del mouse en todo momento. Para obtener este comportamiento en un contenedor que no admite la interfaz `IPointerInactive`, deberá hacer que el control se active siempre cuando esté visible, lo que significa que el control debe tener el OLEMISC_ACTIVATEWHENVISIBLE marca entre sus marcas misceláneas. Sin embargo, para evitar que esta marca surta efecto en un contenedor que admite `IPointerInactive`, también puede especificar la marca de OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>COleControl:: GetAmbientProperty

Obtiene el valor de una propiedad de ambiente del contenedor.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parámetros

*dwDispid*<br/>
El identificador de envío de la propiedad de ambiente deseada.

*vtProp*<br/>
Una etiqueta de tipo variante que especifica el tipo del valor que se va a devolver en *pvProp*.

*pvProp*<br/>
Puntero a la dirección de la variable que recibirá el valor de propiedad o el valor devuelto. El tipo real de este puntero debe coincidir con el tipo especificado por *vtProp*.

|vtProp|Tipo de pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se admite la propiedad de ambiente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Si usa `GetAmbientProperty` para recuperar las propiedades de ScaleUnits y DisplayName de ambiente, establezca *vtProp* en VT_BSTR y *pvProp* en `CString*`. Si va a recuperar la propiedad de fuente ambiente, establezca *vtProp* en VT_FONT y *pvProp* en LPFONTDISP *.

Tenga en cuenta que ya se han proporcionado funciones para las propiedades de ambiente comunes, como [AmbientBackColor](#ambientbackcolor) y [AmbientFont](#ambientfont).

##  <a name="getappearance"></a>COleControl:: GetAppearance

Implementa la función get de la propiedad de aspecto bursátil del control.

```
short GetAppearance ();
```

### <a name="return-value"></a>Valor devuelto

El valor devuelto especifica la configuración de aspecto actual como un valor **corto** (VT_I2), si es correcto. Este valor es cero si el aspecto del control es plano y 1 si la apariencia del control es 3D.

##  <a name="getbackcolor"></a>COleControl:: GetBackColor

Implementa la función get de la propiedad BackColor stock del control.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Valor devuelto

El valor devuelto especifica el color de fondo actual como un valor OLE_COLOR, si es correcto. Este valor se puede traducir en un valor COLORREF con una llamada a `TranslateColor`.

##  <a name="getborderstyle"></a>COleControl:: GetBorderStyle

Implementa la función get de la propiedad BorderStyle de stock del control.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Valor devuelto

1 si el control tiene un borde normal; 0 si el control no tiene borde.

##  <a name="getcapture"></a>COleControl:: GetCapture

Determina si el objeto `COleControl` tiene la captura del mouse.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Valor devuelto

Si el control está activado y sin ventanas, devuelve **este** valor si el control tiene actualmente la captura del mouse (según lo determinado por el contenedor del control) o null si no tiene la captura.

De lo contrario, devuelve el objeto `CWnd` que tiene la captura del mouse (igual que `CWnd::GetCapture`).

### <a name="remarks"></a>Observaciones

Un control sin ventana activado recibe la captura del mouse cuando se llama a [SetCapture](#setcapture) .

##  <a name="getclassid"></a>COleControl:: GetClassID

Lo llama el marco de trabajo para recuperar el identificador de clase OLE del control.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parámetros

*pclsid*<br/>
Puntero a la ubicación del identificador de clase.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada no se realizó correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Normalmente implementado por el [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

##  <a name="getclientoffset"></a>COleControl:: GetClientOffset

Recupera la diferencia entre la esquina superior izquierda del área rectangular del control y la esquina superior izquierda de su área de cliente.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parámetros

*pdxOffset*<br/>
Puntero al desplazamiento horizontal del área cliente del control OLE.

*pdyOffset*<br/>
Puntero al desplazamiento vertical del área cliente del control OLE.

### <a name="remarks"></a>Observaciones

El control OLE tiene un área rectangular dentro de su contenedor. El área cliente del control es el área de control excluyendo los bordes y las barras de desplazamiento. El desplazamiento recuperado por `GetClientOffset` es la diferencia entre la esquina superior izquierda del área rectangular del control y la esquina superior izquierda de su área de cliente. Si el control tiene elementos que no son de cliente distintos de los bordes y las barras de desplazamiento estándar, invalide esta función miembro para especificar el desplazamiento.

##  <a name="getclientrect"></a>COleControl:: GetClientRect

Recupera el tamaño del área cliente del control.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parámetros

*lpRect*<br/>
Puntero a una estructura de `RECT` que contiene las dimensiones del área cliente del control sin ventanas; es decir, el tamaño del control menos los bordes de la ventana, los fotogramas, las barras de desplazamiento, etc. El parámetro *lpRect* indica el tamaño del rectángulo cliente del control, no su posición.

##  <a name="getclientsite"></a>COleControl:: GetClientSite

Consulta un objeto para el puntero a su sitio de cliente actual dentro de su contenedor.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Valor devuelto

Puntero al sitio de cliente actual del control en su contenedor.

### <a name="remarks"></a>Observaciones

El puntero devuelto apunta a una instancia de `IOleClientSite`. La interfaz de `IOleClientSite`, implementada por los contenedores, es la vista del objeto de su contexto: Dónde se delimita en el documento, donde obtiene su almacenamiento, interfaz de usuario y otros recursos.

##  <a name="getcontrolflags"></a>COleControl:: GetControlFlags

Recupera la configuración de la marca de control.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Valor devuelto

Una combinación de ORed de las marcas de la enumeración ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Observaciones

De manera predeterminada, `GetControlFlags` devuelve `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Si se establece, utiliza una función Begin-Paint adaptada a los controles OLE en lugar de a la API [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) (establecida de forma predeterminada).|
|`clipPaintDC`|Si no se establece, deshabilita la llamada a `IntersectClipRect` realizada por `COleControl` y obtiene una pequeña ventaja de velocidad. Si usa la activación sin ventanas, la marca no tiene ningún efecto.|
|`pointerInactive`|Si se establece, proporciona interacción con el mouse mientras el control está inactivo habilitando la implementación de `COleControl`de la interfaz `IPointerInactive`, que está deshabilitada de forma predeterminada.|
|`noFlickerActivate`|Si se establece, elimina las operaciones de dibujo adicionales y el parpadeo visual que lo acompaña. Use cuando el control se dibuje de forma idéntica en los Estados inactivo y activo. Si usa la activación sin ventanas, la marca no tiene ningún efecto.|
|`windowlessActivate`|Si se establece, indica que el control usa la activación sin ventanas.|
|`canOptimizeDraw`|Si se establece, indica que el control realizará el dibujo optimizado, si el contenedor lo admite.|

Para obtener más información sobre `GetControlFlags` y otras optimizaciones de controles OLE, vea [controles ActiveX: optimización](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="getcontrolsize"></a>COleControl:: GetControlSize

Recupera el tamaño de la ventana de control OLE.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parámetros

*PCX*<br/>
Especifica el ancho del control en píxeles.

*pcy*<br/>
Especifica el alto del control en píxeles.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que todas las coordenadas de las ventanas de control son relativas a la esquina superior izquierda del control.

##  <a name="getdc"></a>COleControl:: GetDC

Proporciona a un objeto sin ventana para obtener un contexto de dispositivo de pantalla (o compatible) de su contenedor.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parámetros

*lprcRect*<br/>
Puntero al rectángulo que el control sin ventana desea volver a dibujar, en coordenadas de cliente del control. NULL significa la extensión del objeto completo.

*dwFlags*<br/>
Atributos de dibujo del contexto del dispositivo. Las opciones son:

- OLEDC_NODRAW indica que el objeto no utilizará el contexto de dispositivo para realizar ningún dibujo, sino simplemente obtener información sobre el dispositivo de pantalla. El contenedor simplemente debe pasar el controlador de dominio de la ventana sin más procesamiento.

- OLEDC_PAINTBKGND solicita que el contenedor pinte el fondo antes de devolver el controlador de dominio. Un objeto debe utilizar esta marca si solicita un controlador de dominio para volver a dibujar un área con un fondo transparente.

- OLEDC_OFFSCREEN informa al contenedor que el objeto desea representar en un mapa de bits fuera de la pantalla que se debe copiar en la pantalla. Un objeto debe utilizar esta marca cuando la operación de dibujo que va a realizar genera mucho parpadeo. El contenedor es gratuito para respetar esta solicitud o no. Sin embargo, si no se establece esta marca, el contenedor debe volver a entregar un controlador de dominio en pantalla. Esto permite que los objetos realicen operaciones de pantalla directa, como mostrar una selección (a través de una operación **XOR** ).

### <a name="return-value"></a>Valor devuelto

Puntero al contexto de dispositivo de pantalla para el contenedor `CWnd` área cliente si se realiza correctamente; de lo contrario, el valor devuelto es NULL. El contexto de dispositivo de pantalla se puede usar en las funciones GDI subsiguientes para dibujar en el área cliente de la ventana del contenedor.

### <a name="remarks"></a>Observaciones

Se debe llamar a la función miembro [ReleaseDC](#releasedc) para liberar el contexto después de dibujar. Al llamar a `GetDC`, los objetos pasan el rectángulo en el que quieren dibujar en sus propias coordenadas de cliente. `GetDC` traduce estas a coordenadas del área cliente del contenedor. El objeto no debe solicitar un rectángulo de dibujo deseado mayor que su propio rectángulo de área cliente, cuyo tamaño se puede recuperar con [GetClientRect](#getclientrect). Esto evita que los objetos dibujen accidentalmente dónde no se supone.

##  <a name="getenabled"></a>COleControl:: GetEnabled

Implementa la función get de la propiedad stock Enabled del control.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el control está habilitado; de lo contrario, es 0.

##  <a name="getextendedcontrol"></a>COleControl:: GetExtendedControl

Obtiene un puntero a un objeto mantenido por el contenedor que representa el control con un conjunto extendido de propiedades.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto de control extendido del contenedor. Si no hay ningún objeto disponible, el valor es NULL.

Este objeto se puede manipular a través de su interfaz `IDispatch`. También puede usar `QueryInterface` para obtener otras interfaces disponibles proporcionadas por el objeto. Sin embargo, no es necesario que el objeto admita un conjunto específico de interfaces. Tenga en cuenta que confiar en las características específicas del objeto de control extendido de un contenedor limita la portabilidad del control a otros contenedores arbitrarios.

### <a name="remarks"></a>Observaciones

La función que llama a esta función es responsable de liberar el puntero cuando finaliza con el objeto. Tenga en cuenta que no es necesario que el contenedor admita este objeto.

##  <a name="getfocus"></a>COleControl:: GetFocus

Determina si el objeto `COleControl` tiene el foco.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Valor devuelto

Si el control está activado y sin ventanas, devuelve **este** valor si el control tiene actualmente el foco de teclado (según lo determinado por el contenedor del control) o null si no tiene el foco.

De lo contrario, devuelve el objeto `CWnd` que tiene el foco (igual que `CWnd::GetFocus`).

### <a name="remarks"></a>Observaciones

Un control sin ventana activado recibe el foco cuando se llama a [SetFocus](#setfocus) .

##  <a name="getfont"></a>COleControl:: GetFont

Implementa la función get de la propiedad Font estándar.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Valor devuelto

Puntero a la interfaz de envío de fuente de la propiedad de fuente estándar del control.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que el llamador debe liberar el objeto cuando termine. Dentro de la implementación del control, utilice `InternalGetFont` para tener acceso al objeto de fuente stock del control. Para obtener más información sobre el uso de fuentes en el control, vea el artículo [controles ActiveX: usar fuentes en un control ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

##  <a name="getfonttextmetrics"></a>COleControl:: GetFontTextMetrics

Mide las métricas de texto de cualquier `CFontHolder` objeto propiedad del control.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parámetros

*lptm*<br/>
Puntero a una estructura [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

*fontHolder*<br/>
Referencia a un objeto [CFontHolder](../../mfc/reference/cfontholder-class.md) .

### <a name="remarks"></a>Observaciones

Este tipo de fuente se puede seleccionar con la función [COleControl:: SelectFontObject](#selectfontobject) . `GetFontTextMetrics` inicializará la estructura de `TEXTMETRIC` a la que apunta *lptm* con información de métricas válidas sobre la fuente de `fontHolder`si se realiza correctamente, o si se rellena la estructura con ceros si no se realiza correctamente. Debe usar esta función en lugar de [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) al dibujar el control, ya que es posible que se necesiten controles, como cualquier objeto OLE incrustado, para representarse en un metarchivo.

La estructura de `TEXTMETRIC` de la fuente predeterminada se actualiza cuando se llama a la función [SelectFontObject](#selectfontobject) . Solo debe llamar a `GetFontTextMetrics` después de seleccionar la propiedad fuente estándar para asegurarse de que la información que proporciona es válida.

##  <a name="getforecolor"></a>COleControl:: GetForeColor

Implementa la función get de la propiedad estándar ForeColor.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Valor devuelto

El valor devuelto especifica el color de primer plano actual como un valor de OLE_COLOR, si se realiza correctamente. Este valor se puede traducir en un valor [COLORREF](/windows/win32/gdi/colorref) con una llamada a `TranslateColor`.

##  <a name="gethwnd"></a>COleControl:: GetHwnd

Implementa la función get de la propiedad hWnd de stock.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Valor devuelto

Identificador de ventana del control OLE, si existe; de lo contrario, NULL.

##  <a name="getmessagestring"></a>COleControl:: GetMessageString

Lo llama el marco de trabajo para obtener una cadena corta que describa el propósito del elemento de menú identificado por *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Un identificador de elemento de menú.

*rMessage*<br/>
Referencia a un objeto [CString](../../atl-mfc-shared/reference/cstringt-class.md) a través del cual se devolverá una cadena.

### <a name="remarks"></a>Observaciones

Se puede usar para obtener un mensaje para mostrarlo en una barra de estado mientras se resalta el elemento de menú. La implementación predeterminada intenta cargar un recurso de cadena identificado por *nID*.

##  <a name="getnotsupported"></a>COleControl:: GetNotSupported

Impide el acceso al valor de propiedad de un control por parte del usuario.

```
void GetNotSupported();
```

### <a name="remarks"></a>Observaciones

Llame a esta función en lugar de la función get de cualquier propiedad en la que no se admita la recuperación de la propiedad por parte del usuario del control. Un ejemplo sería una propiedad que es de solo escritura.

##  <a name="getreadystate"></a>COleControl:: GetReadyState

Devuelve el estado de disponibilidad del control.

```
long GetReadyState();
```

### <a name="return-value"></a>Valor devuelto

El estado de disponibilidad del control, uno de los siguientes valores:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialización predeterminado|
|READYSTATE_LOADING|El control está cargando sus propiedades actualmente|
|READYSTATE_LOADED|Se ha inicializado el control|
|READYSTATE_INTERACTIVE|El control tiene suficientes datos para ser interactivos, pero no se han cargado todos los datos asincrónicos|
|READYSTATE_COMPLETE|El control tiene todos sus datos|

### <a name="remarks"></a>Observaciones

La mayoría de los controles simples nunca necesitan diferenciar entre CARGAdos e interactivos. Sin embargo, es posible que los controles que admiten propiedades de ruta de acceso a datos no estén listos para ser interactivos hasta que se reciban asincrónicamente algunos datos. Un control debe intentar convertirse en interactivo lo antes posible.

##  <a name="getrectincontainer"></a>COleControl:: GetRectInContainer

Obtiene las coordenadas del rectángulo del control en relación con el contenedor, expresado en unidades de dispositivo.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*lpRect*<br/>
Puntero a la estructura de rectángulo en la que se copiarán las coordenadas del control.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si el control está activo en contexto; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

El rectángulo solo es válido si el control está activo en contexto.

##  <a name="getstocktextmetrics"></a>COleControl:: GetStockTextMetrics

Mide las métricas de texto de la propiedad Font estándar del control, que se puede seleccionar con la función [SelectStockFont](#selectstockfont) .

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parámetros

*lptm*<br/>
Puntero a una estructura [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

### <a name="remarks"></a>Observaciones

La función `GetStockTextMetrics` inicializará la estructura de `TEXTMETRIC` a la que apunta *lptm* con información de métricas válida si se realiza correctamente, o bien rellenará la estructura con ceros si no se realiza correctamente. Utilice esta función en lugar de [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) al dibujar el control, ya que es posible que los controles, como cualquier objeto OLE incrustado, se representen en un metarchivo.

La estructura de `TEXTMETRIC` de la fuente predeterminada se actualiza cuando se llama a la función `SelectStockFont`. Solo debe llamar a esta función después de seleccionar la fuente estándar para asegurarse de que la información que proporciona es válida.

##  <a name="gettext"></a>COleControl:: GetText

Implementa la función get de la propiedad stock Text o Caption.

```
BSTR GetText();
```

### <a name="return-value"></a>Valor devuelto

El valor actual de la cadena de texto del control o una cadena de longitud cero si no hay ninguna cadena presente.

> [!NOTE]
>  Para obtener más información sobre el tipo de datos BSTR, vea [tipos de datos](../../mfc/reference/data-types-mfc.md) en la sección macros y variables globales.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que el llamador de esta función debe llamar a `SysFreeString` en la cadena devuelta para liberar el recurso. Dentro de la implementación del control, utilice `InternalGetText` para tener acceso a la propiedad de título o el texto estándar del control.

##  <a name="getwindowlessdroptarget"></a>COleControl:: GetWindowlessDropTarget

Invalide `GetWindowlessDropTarget` cuando desee que un control sin ventana sea el destino de una operación OLE de arrastrar y colocar.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Valor devuelto

Puntero a la interfaz de `IDropTarget` del objeto. Como no tiene una ventana, un objeto sin ventana no puede registrar una interfaz `IDropTarget`. Sin embargo, para participar en la función de arrastrar y colocar, un objeto sin ventana puede implementar la interfaz y devolverla en `GetWindowlessDropTarget`.

### <a name="remarks"></a>Observaciones

Normalmente, esto requeriría que la ventana del control se registre como un destino de colocación. Pero como el control no tiene ninguna ventana propia, el contenedor usará su propia ventana como destino de colocación. El control simplemente debe proporcionar una implementación de la interfaz `IDropTarget` en la que el contenedor puede delegar llamadas en el momento adecuado. Por ejemplo:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>COleControl:: InitializeIIDs

Informa a la clase base de los identificadores IID que va a utilizar el control.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parámetros

*piidPrimary*<br/>
Puntero al identificador de interfaz de la interfaz de envío principal del control.

*piidEvents*<br/>
Puntero al identificador de interfaz de la interfaz de eventos del control.

### <a name="remarks"></a>Observaciones

Llame a esta función en el constructor del control para informar a la clase base de los identificadores de interfaz que va a usar el control.

##  <a name="internalgetfont"></a>COleControl:: InternalGetFont

Obtiene acceso a la propiedad Font estándar del control.

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Valor devuelto

Referencia a un objeto [CFontHolder](../../mfc/reference/cfontholder-class.md) que contiene el objeto de fuente estándar.

##  <a name="internalgettext"></a>COleControl:: InternalGetText

Obtiene acceso a la propiedad texto o título de las acciones del control.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Valor devuelto

Referencia a la cadena de texto del control.

##  <a name="internalsetreadystate"></a>COleControl:: InternalSetReadyState

Establece el estado de disponibilidad del control.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parámetros

*lNewReadyState*<br/>
Estado de preparación que se va a establecer para el control, uno de los valores siguientes:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialización predeterminado|
|READYSTATE_LOADING|El control está cargando sus propiedades actualmente|
|READYSTATE_LOADED|Se ha inicializado el control|
|READYSTATE_INTERACTIVE|El control tiene suficientes datos para ser interactivos, pero no se han cargado todos los datos asincrónicos|
|READYSTATE_COMPLETE|El control tiene todos sus datos|

### <a name="remarks"></a>Observaciones

La mayoría de los controles simples nunca necesitan diferenciar entre CARGAdos e interactivos. Sin embargo, es posible que los controles que admiten propiedades de ruta de acceso a datos no estén listos para ser interactivos hasta que se reciban asincrónicamente algunos datos. Un control debe intentar convertirse en interactivo lo antes posible.

##  <a name="invalidatecontrol"></a>COleControl:: InvalidateControl

Obliga al control a que se vuelva a dibujar.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parámetros

*lpRect*<br/>
Puntero a la región del control que se va a invalidar.

*bErase*<br/>
Especifica si se debe borrar el fondo de la región de actualización cuando se procesa la región de actualización.

### <a name="remarks"></a>Observaciones

Si *lpRect* tiene un valor null, se volverá a dibujar todo el control. Si *lpRect* no es null, indica la parte del rectángulo del control que se va a invalidar. En los casos en los que el control no tiene ninguna ventana, o actualmente no está activo, se omite el rectángulo y se realiza una llamada a la función miembro [IAdviseSink:: OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) del sitio del cliente. Utilice esta función en lugar de `CWnd::InvalidateRect` o `InvalidateRect`.

##  <a name="invalidatergn"></a>COleControl:: InvalidateRgn

Invalida el área cliente de la ventana contenedor dentro de la región especificada.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parámetros

*pRgn*<br/>
Un puntero a un objeto [crgn (](../../mfc/reference/crgn-class.md) que identifica el área de presentación del objeto OLE que se va a invalidar, en coordenadas de cliente de la ventana contenedora. Si este parámetro es NULL, la extensión es el objeto completo.

*bErase*<br/>
Especifica si se va a borrar el fondo dentro de la región invalidada. Si es TRUE, se borra el fondo. Si es FALSE, el fondo permanece inalterado.

### <a name="remarks"></a>Observaciones

Se puede usar para volver a dibujar controles sin ventana dentro del contenedor. La región invalidada, junto con todas las demás áreas de la región de actualización, se marca para pintar cuando se envía el siguiente [WM_PAINT](/windows/win32/gdi/wm-paint) mensaje.

Si *bErase* es true para cualquier parte de la región de actualización, se borra el fondo de toda la región, no solo en el elemento determinado.

##  <a name="isconvertingvbx"></a>COleControl:: IsConvertingVBX

Permite la carga especializada de un control OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se está convirtiendo el control; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Al convertir un formulario que usa los controles VBX a uno que utiliza controles OLE, puede ser necesario un código de carga especial para los controles OLE. Por ejemplo, si va a cargar una instancia del control OLE, es posible que tenga una llamada a [PX_Font](persistence-of-ole-controls.md#px_font) en el `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Sin embargo, los controles VBX no tienen un objeto de fuente; cada propiedad de fuente se guardó individualmente. En este caso, usaría `IsConvertingVBX` para distinguir entre estos dos casos:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Otro caso sería si el control VBX guardase datos binarios de propiedad (en su controlador de mensajes VBM_SAVEPROPERTY) y el control OLE guarda los datos binarios en un formato diferente. Si desea que el control OLE sea compatible con el control VBX, puede leer los formatos antiguos y nuevos mediante la función `IsConvertingVBX` al distinguir si se estaba cargando el control VBX o el control OLE.

En la función de `DoPropExchange` del control, puede comprobar esta condición y, si es true, ejecutar código de carga específico para esta conversión (como los ejemplos anteriores). Si el control no se va a convertir, puede ejecutar el código de carga normal. Esta capacidad solo es aplicable a los controles que se van a convertir desde homólogos de VBX.

##  <a name="isinvokeallowed"></a>COleControl:: IsInvokeAllowed

Habilita la invocación de métodos de automatización.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se ha inicializado el control; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

La implementación del marco de `IDispatch::Invoke` llama a `IsInvokeAllowed` para determinar si se puede invocar una función determinada (identificada mediante `dispid`). El comportamiento predeterminado de un control OLE consiste en permitir que se invoquen los métodos de automatización solo si se ha inicializado el control; sin embargo, `IsInvokeAllowed` es una función virtual y se puede invalidar si es necesario (por ejemplo, cuando el control se utiliza como servidor de automatización).

##  <a name="ismodified"></a>COleControl:: IsModified

Determina si el estado del control se ha modificado.

```
BOOL IsModified();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el estado del control se ha modificado desde la última vez que se guardó; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

El estado de un control se modifica cuando cambia el valor de una propiedad.

##  <a name="isoptimizeddraw"></a>COleControl:: IsOptimizedDraw

Determina si el contenedor admite el dibujo optimizado para la operación de dibujo actual.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Valor devuelto

TRUE si el contenedor admite el dibujo optimizado para la operación de dibujo actual; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

Si se admite el dibujo optimizado, el control no necesita seleccionar objetos antiguos (lápices, pinceles, fuentes, etc.) en el contexto del dispositivo cuando el dibujo ha finalizado.

##  <a name="issubclassedcontrol"></a>COleControl:: IsSubclassedControl

Lo llama el marco de trabajo para determinar si el control subclases de un control de Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el control tiene subclases; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Debe reemplazar esta función y devolver TRUE si el control OLE subclases de un control de Windows.

##  <a name="load"></a>COleControl:: Load

Restablece los datos anteriores cargados de forma asincrónica e inicia una nueva carga de la propiedad asincrónica del control.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parámetros

*strNewPath*<br/>
Puntero a una cadena que contiene la ruta de acceso que hace referencia a la ubicación absoluta de la propiedad de control asincrónica.

*propuestas*<br/>
Objeto [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) que implementa una propiedad de control asincrónica.

##  <a name="lockinplaceactive"></a>COleControl:: LockInPlaceActive

Impide que el contenedor desactive el control.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parámetros

*Sin*<br/>
TRUE si el estado activo en contexto del control se va a bloquear; FALSE si se va a desbloquear.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el bloqueo se realizó correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que cada bloqueo del control debe emparejarse con un desbloqueo del control cuando termine. Solo debe bloquear el control durante períodos breves, como al activar un evento.

##  <a name="onambientpropertychange"></a>COleControl:: OnAmbientPropertyChange

Lo llama el marco de trabajo cuando una propiedad de ambiente del contenedor ha cambiado de valor.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parámetros

*dispID*<br/>
El identificador de envío de la propiedad de ambiente que cambió o DISPID_UNKNOWN si varias propiedades han cambiado.

##  <a name="onappearancechanged"></a>COleControl:: OnAppearanceChanged

Lo llama el marco de trabajo cuando ha cambiado el valor de la propiedad de aspecto bursátil.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Observaciones

Invalide esta función si desea recibir una notificación después de que cambie esta propiedad. La implementación predeterminada llama a `InvalidateControl`.

##  <a name="onbackcolorchanged"></a>COleControl:: OnBackColorChanged

Lo llama el marco de trabajo cuando el valor de propiedad BackColor de stock ha cambiado.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Observaciones

Invalide esta función si desea recibir una notificación después de que cambie esta propiedad. La implementación predeterminada llama a `InvalidateControl`.

##  <a name="onborderstylechanged"></a>COleControl:: OnBorderStyleChanged

Lo llama el marco de trabajo cuando el valor de la propiedad BorderStyle de stock ha cambiado.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada llama a `InvalidateControl`.

Invalide esta función si desea recibir una notificación después de que cambie esta propiedad.

##  <a name="onclick"></a>COleControl:: OnClick

Lo llama el marco de trabajo cuando se hace clic en un botón del mouse o se invoca el método de existencias.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parámetros

*iButton*<br/>
Índice de un botón del mouse. Puede tener uno de los siguientes valores:

- LEFT_BUTTON se hizo clic en el botón primario del mouse.

- MIDDLE_BUTTON se hizo clic en el botón central del mouse.

- RIGHT_BUTTON se hizo clic con el botón secundario del mouse.

### <a name="remarks"></a>Observaciones

La implementación predeterminada llama a `COleControl::FireClick`.

Invalide esta función miembro para modificar o extender el control predeterminado.

##  <a name="onclose"></a>COleControl:: OnClose

Lo llama el marco de trabajo cuando el contenedor ha llamado a la función `IOleControl::Close` del control.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parámetros

*dwSaveOption*<br/>
Marca que indica si el objeto debe guardarse antes de cargarse. Los valores válidos son:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Observaciones

De forma predeterminada, `OnClose` guarda el objeto de control si se ha modificado y *dwSaveOption* es OLECLOSE_SAVEIFDIRTY o OLECLOSE_PROMPTSAVE.

##  <a name="ondoverb"></a>COleControl:: OnDoVerb

Lo llama el marco de trabajo cuando el contenedor llama a la función miembro `IOleObject::DoVerb`.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*iVerb*<br/>
Índice del verbo de control que se va a invocar.

*lpMsg*<br/>
Un puntero al mensaje de Windows que provocó la invocación del verbo.

*hWndParent*<br/>
Identificador de la ventana primaria del control. Si la ejecución del verbo crea una ventana (o Windows), se debe usar *hWndParent* como elemento primario.

*lpRect*<br/>
Puntero a una estructura RECT en la que se copiarán las coordenadas del control en relación con el contenedor.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada se realizó correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada utiliza las entradas de asignación de mensajes ON_OLEVERB y ON_STDOLEVERB para determinar la función adecuada que se va a invocar.

Invalide esta función para cambiar el control predeterminado del verbo.

##  <a name="ondraw"></a>COleControl:: OnDraw

Lo llama el marco de trabajo para dibujar el control OLE en el rectángulo delimitador especificado mediante el contexto de dispositivo especificado.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Contexto de dispositivo en el que se produce el dibujo.

*rcBounds*<br/>
Área rectangular del control, incluido el borde.

*rcInvalid*<br/>
Área rectangular del control que no es válida.

### <a name="remarks"></a>Observaciones

normalmente se llama a `OnDraw` para la presentación en pantalla y pasar un contexto de dispositivo de pantalla como *pDC*. El parámetro *rcBounds* identifica el rectángulo en el contexto del dispositivo de destino (en relación con su modo de asignación actual). El parámetro *rcInvalid* es el rectángulo real que no es válido. En algunos casos, será un área más pequeña que *rcBounds*.

##  <a name="ondrawmetafile"></a>COleControl:: OnDrawMetafile

Lo llama el marco de trabajo para dibujar el control OLE en el rectángulo delimitador especificado mediante el contexto de dispositivo de metarchivo especificado.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Contexto de dispositivo en el que se produce el dibujo.

*rcBounds*<br/>
Área rectangular del control, incluido el borde.

### <a name="remarks"></a>Observaciones

La implementación predeterminada llama a la función [OnDraw](#ondraw) .

##  <a name="onedit"></a>COleControl:: aleditar

Hace que el control esté activado para la interfaz de usuario.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*lpMsg*<br/>
Puntero al mensaje de Windows que invocó el verbo.

*hWndParent*<br/>
Identificador de la ventana primaria del control.

*lpRect*<br/>
Puntero al rectángulo utilizado por el control en el contenedor.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada se realiza correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Esto tiene el mismo efecto que invocar el verbo OLEIVERB_UIACTIVATE del control.

Esta función se utiliza normalmente como la función de controlador para una entrada de mapa de mensajes de ON_OLEVERB. Esto hace que un verbo "Editar" esté disponible en el menú "objeto" del control. Por ejemplo:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>COleControl:: OnEnabledChanged

Lo llama el marco de trabajo cuando el valor de la propiedad stock Enabled ha cambiado.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Observaciones

Invalide esta función si desea recibir una notificación después de que cambie esta propiedad. La implementación predeterminada llama a [InvalidateControl](#invalidatecontrol).

##  <a name="onenumverbs"></a>COleControl:: OnEnumVerbs

Lo llama el marco de trabajo cuando el contenedor llama a la función miembro `IOleObject::EnumVerbs`.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parámetros

*ppenumOleVerb*<br/>
Puntero al objeto `IEnumOLEVERB` que enumera los verbos del control.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si los verbos están disponibles; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada enumera las entradas de ON_OLEVERB en el mapa de mensajes.

Invalide esta función para cambiar la forma predeterminada de enumerar los verbos.

##  <a name="oneventadvise"></a>COleControl:: OnEventAdvise

Lo llama el marco de trabajo cuando un controlador de eventos está conectado o desconectado de un control OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parámetros

*bAdvise*<br/>
TRUE indica que un controlador de eventos se ha conectado al control. FALSE indica que un controlador de eventos se ha desconectado del control.

##  <a name="onfontchanged"></a>COleControl:: OnFontChanged

Lo llama el marco de trabajo cuando el valor de la propiedad Font estándar ha cambiado.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada llama a `COleControl::InvalidateControl`. Si el control está subclase de un control de Windows, la implementación predeterminada también envía un mensaje de WM_SETFONT a la ventana del control.

Invalide esta función si desea recibir una notificación después de que cambie esta propiedad.

### <a name="example"></a>Ejemplo

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>COleControl:: OnForeColorChanged

Lo llama el marco de trabajo cuando el valor de la propiedad ForeColor estándar ha cambiado.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada llama a `InvalidateControl`.

Invalide esta función si desea recibir una notificación después de que cambie esta propiedad.

##  <a name="onfreezeevents"></a>COleControl:: OnFreezeEvents

Lo llama el marco de trabajo después de que el contenedor llame a `IOleControl::FreezeEvents`.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parámetros

*bFreeze*<br/>
TRUE si el control de eventos del control está inmovilizado; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

La implementación predeterminada no hace nada.

Invalide esta función si desea tener un comportamiento adicional cuando el control de eventos esté inmovilizado o inmovilizado.

##  <a name="ongetcolorset"></a>COleControl:: OnGetColorSet

Lo llama el marco de trabajo cuando el contenedor llama a la función miembro `IViewObject::GetColorSet`.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parámetros

*fichero*<br/>
Apunta al dispositivo de destino para el que se debe representar la imagen. Si este valor es NULL, la imagen se debe representar para un dispositivo de destino predeterminado, normalmente un dispositivo de pantalla.

*hicTargetDev*<br/>
Especifica el contexto de información en el dispositivo de destino indicado por *PTD*. Este parámetro puede ser un contexto de dispositivo, pero no es necesariamente. Si *PTD* es null, *hicTargetDev* también debe ser null.

*ppColorSet*<br/>
Puntero a la ubicación en la que se debe copiar el conjunto de colores que se va a utilizar. Si la función no devuelve el conjunto de colores, se devuelve NULL.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se devuelve un conjunto de colores válido; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

El contenedor llama a esta función para obtener todos los colores necesarios para dibujar el control OLE. El contenedor puede utilizar los conjuntos de colores obtenidos junto con los colores que necesita para establecer la paleta de colores general. La implementación predeterminada devuelve FALSE.

Invalide esta función para realizar cualquier procesamiento especial de esta solicitud.

##  <a name="ongetcontrolinfo"></a>COleControl:: OnGetControlInfo

Lo llama el marco de trabajo cuando el contenedor del control ha solicitado información sobre el control.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parámetros

*pControlInfo*<br/>
Puntero a una estructura [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) que se va a rellenar.

### <a name="remarks"></a>Observaciones

Esta información consta principalmente de una descripción de las teclas de mnemotécnico del control. La implementación predeterminada rellena *pControlInfo* con la información predeterminada.

Invalide esta función si el control necesita procesar las teclas de tecla de teclas.

##  <a name="ongetdisplaystring"></a>COleControl:: OnGetDisplayString

Lo llama el marco de trabajo para obtener una cadena que representa el valor actual de la propiedad identificada por el *DISPID*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parámetros

*DISPID*<br/>
Identificador de envío de una propiedad del control.

*strValue*<br/>
Referencia a un objeto [CString](../../atl-mfc-shared/reference/cstringt-class.md) a través del cual se devolverá una cadena.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si se ha devuelto una cadena en *strValue;* de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Invalide esta función si el control tiene una propiedad cuyo valor no se puede convertir directamente en una cadena y desea que el valor de la propiedad se muestre en un explorador de propiedades proporcionado por el contenedor.

##  <a name="ongetinplacemenu"></a>COleControl:: OnGetInPlaceMenu

Lo llama el marco de trabajo cuando se activa la interfaz de usuario para obtener el menú que se va a combinar en el menú existente del contenedor.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Valor devuelto

Identificador del menú del control o NULL si el control no tiene ninguno. La implementación predeterminada devuelve NULL.

### <a name="remarks"></a>Observaciones

Para obtener más información sobre cómo combinar recursos OLE, vea el artículo [menús y recursos (OLE)](../../mfc/menus-and-resources-ole.md).

##  <a name="ongetnaturalextent"></a>COleControl:: OnGetNaturalExtent

Lo llama el marco de trabajo en respuesta a la solicitud de `IViewObjectEx::GetNaturalExtent` de un contenedor.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parámetros

*dwAspect*<br/>
Especifica cómo se va a representar el objeto. Las representaciones incluyen contenido, un icono, una miniatura o un documento impreso. Los valores válidos se toman de la enumeración [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*lindex*<br/>
Parte del objeto que es de interés. Actualmente solo es válido-1.

*fichero*<br/>
Apunta a la estructura [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) que define el dispositivo de destino para el que se debe devolver el tamaño del objeto.

*hicTargetDev*<br/>
Especifica el contexto de información para el dispositivo de destino indicado por el parámetro *PTD* desde el que el objeto puede extraer las métricas del dispositivo y probar las funciones del dispositivo. Si *PTD* es null, el objeto debe omitir el valor en el parámetro *hicTargetDev* .

*pExtentInfo*<br/>
Apunta a la estructura `DVEXTENTINFO` que especifica los datos de ajuste de tamaño. La estructura `DVEXTENTINFO` es:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

El miembro de estructura `dwExtentMode` puede tomar uno de dos valores:

- DVEXTENT_CONTENT consultar el grado de importancia del control para ajustarse al contenido (ajuste al tamaño)

- DVEXTENT_INTEGRAL al cambiar el tamaño, pasar el tamaño propuesto al control

*psizel*<br/>
Apunta a los datos de ajuste de tamaño devueltos por el control. Los datos de ajuste de tamaño devueltos se establecen en-1 para cualquier dimensión que no se haya ajustado.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si devuelve o ajusta correctamente el tamaño; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Invalide esta función para devolver el tamaño de presentación del objeto más cercano al modo de extensión y tamaño propuesto en la estructura `DVEXTENTINFO`. La implementación predeterminada devuelve FALSE y no realiza ningún ajuste en el tamaño.

##  <a name="ongetpredefinedstrings"></a>COleControl:: OnGetPredefinedStrings

Lo llama el marco de trabajo para obtener un conjunto de cadenas predefinidas que representan los valores posibles de una propiedad.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parámetros

*DISPID*<br/>
Identificador de envío de una propiedad del control.

*pStringArray*<br/>
Matriz de cadenas que se va a rellenar con los valores devueltos.

*pCookieArray*<br/>
Matriz DWORD que se va a rellenar con valores devueltos.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se han agregado elementos a *pStringArray* y *pCookieArray*.

### <a name="remarks"></a>Observaciones

Invalide esta función si el control tiene una propiedad con un conjunto de valores posibles que se pueden representar mediante cadenas. Para cada elemento agregado a *pStringArray*, debe agregar el elemento "cookie" correspondiente a *pCookieArray.* El marco de trabajo puede pasar posteriormente estos valores "cookie" a la función `COleControl::OnGetPredefinedValue`.

##  <a name="ongetpredefinedvalue"></a>COleControl:: OnGetPredefinedValue

Lo llama el marco de trabajo para obtener el valor correspondiente a una de las cadenas predefinidas previamente devueltas por una invalidación de `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parámetros

*DISPID*<br/>
Identificador de envío de una propiedad del control.

*dwCookie*<br/>
Un valor de cookie devuelto anteriormente por una invalidación de `COleControl::OnGetPredefinedStrings`.

*lpvarOut*<br/>
Puntero a una estructura de `VARIANT` a través de la cual se devolverá un valor de propiedad.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se ha devuelto un valor en *lpvarOut*; de lo contrario, es 0.

##  <a name="ongetviewextent"></a>COleControl:: OnGetViewExtent

Lo llama el marco de trabajo en respuesta a la solicitud [IViewObject2:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) de un contenedor.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parámetros

*dwDrawAspect*<br/>
DWORD que describe qué formulario o aspecto de un objeto se va a mostrar. Los valores válidos se toman de la enumeración [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*lindex*<br/>
Parte del objeto que es de interés. Actualmente solo es válido-1.

*fichero*<br/>
Apunta a la estructura [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) que define el dispositivo de destino para el que se debe devolver el tamaño del objeto.

*lpsizel*<br/>
Apunta a la ubicación donde se devuelve el tamaño del objeto.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la información de la extensión se devuelve correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Invalide esta función si el control usa un dibujo de dos pasos y sus partes opacas y transparentes tienen dimensiones diferentes.

##  <a name="ongetviewrect"></a>COleControl:: OnGetViewRect

Lo llama el marco de trabajo en respuesta a la solicitud de `IViewObjectEx::GetRect` de un contenedor.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parámetros

*dwAspect*<br/>
DWORD que describe qué formulario o aspecto de un objeto se va a mostrar. Los valores válidos se toman de la enumeración [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2:

- DVASPECT_CONTENT rectángulo delimitador del objeto completo. Esquina superior izquierda en el origen y el tamaño del objeto igual a la extensión devuelta por `GetViewExtent` *.*

- DVASPECT_OPAQUE objetos con una región opaca rectangular devuelven ese rectángulo. Otros errores.

- DVASPECT_TRANSPARENT rectángulo que cubre todas las partes transparentes o irregulares.

*pRect*<br/>
Apunta a la estructura [RecTL](/previous-versions/dd162907\(v=vs.85\)) que especifica el rectángulo en el que se debe dibujar el objeto. Este parámetro controla la posición y la ampliación del objeto.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el tamaño del rectángulo en el objeto se devuelve correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

`OnGetViewRect` convierte el tamaño del objeto en un rectángulo que comienza en una posición específica (el valor predeterminado es la esquina superior izquierda de la pantalla). Invalide esta función si el control usa un dibujo de dos pasos y sus partes opacas y transparentes tienen dimensiones diferentes.

##  <a name="ongetviewstatus"></a>COleControl:: OnGetViewStatus

Lo llama el marco de trabajo en respuesta a la solicitud de `IViewObjectEx::GetViewStatus` de un contenedor.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Valor devuelto

Uno de los valores de la enumeración VIEWSTATUS si se realiza correctamente; de lo contrario, es 0. Los valores posibles son cualquier combinación de lo siguiente:

|||
|-|-|
|VIEWSTATUS_OPAQUE|El objeto es completamente opaco. Si no se establece este bit, el objeto contiene partes transparentes. Este bit solo se aplica a los aspectos relacionados con el contenido y no a DVASPECT_ICON ni DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|El objeto tiene un fondo sólido (compuesto por un color sólido, no un patrón de pincel). Este bit solo es significativo si se establece VIEWSTATUS_OPAQUE y se aplica solo a los aspectos relacionados con el contenido y no a DVASPECT_ICON ni DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|El objeto admite DVASPECT_OPAQUE. Se puede llamar a todos los métodos IViewObjectEx que toman un aspecto de dibujo como parámetro con este aspecto.|
|VIEWSTATUS_DVASPECTTRANSPARENT|El objeto admite DVASPECT_TRANSPARENT. Se puede llamar a todos los métodos `IViewObjectEx` que toman un aspecto de dibujo como parámetro con este aspecto.|

### <a name="remarks"></a>Observaciones

Invalide esta función si el control usa un dibujo de dos pasos. La implementación predeterminada devuelve VIEWSTATUS_OPAQUE.

##  <a name="onhidetoolbars"></a>COleControl:: OnHideToolBars

Lo llama el marco de trabajo cuando el control está desactivada la interfaz de usuario.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Observaciones

La implementación debe ocultar todas las barras de herramientas mostradas por `OnShowToolbars`.

##  <a name="oninactivemousemove"></a>COleControl:: OnInactiveMouseMove

Lo llama el contenedor para el objeto inactivo bajo el puntero del mouse en la recepción de un mensaje de WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parámetros

*lprcBounds*<br/>
Rectángulo delimitador del objeto, en coordenadas de cliente de la ventana contenedora. Indica al objeto su posición y tamaño exactos en la pantalla cuando se recibió el mensaje de WM_MOUSEMOVE.

*x*<br/>
Coordenada x de la ubicación del mouse en coordenadas de cliente de la ventana contenedora.

*y*<br/>
Coordenada y de la ubicación del mouse en coordenadas de cliente de la ventana contenedora.

*dwKeyState*<br/>
Identifica el estado actual de las teclas modificadoras del teclado en el teclado. Los valores válidos pueden ser una combinación de cualquiera de las marcas MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON y MK_RBUTTON.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que las coordenadas de cliente de ventana (píxeles) se usan para pasar la posición del cursor del mouse. Esto se hace posible pasando también el rectángulo delimitador del objeto en el mismo sistema de coordenadas.

##  <a name="oninactivesetcursor"></a>COleControl:: OnInactiveSetCursor

Lo llama el contenedor para el objeto inactivo bajo el puntero del mouse en la recepción de un mensaje de WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parámetros

*lprcBounds*<br/>
Rectángulo delimitador del objeto, en coordenadas de cliente de la ventana contenedora. Indica al objeto su posición y tamaño exactos en la pantalla cuando se recibió el mensaje de WM_SETCURSOR.

*x*<br/>
Coordenada x de la ubicación del mouse en coordenadas de cliente de la ventana contenedora.

*y*<br/>
Coordenada y de la ubicación del mouse en coordenadas de cliente de la ventana contenedora.

*dwMouseMsg*<br/>
Identificador del mensaje de mouse para el que se ha producido un WM_SETCURSOR.

*bSetAlways*<br/>
Especifica si el objeto debe establecer o no el cursor. Si es TRUE, el objeto debe establecer el cursor; Si es FALSE, el cursor no está obligado a establecer el cursor y debe devolver S_FALSE en ese caso.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que las coordenadas de cliente de ventana (píxeles) se usan para pasar la posición del cursor del mouse. Esto se hace posible pasando también el rectángulo delimitador del objeto en el mismo sistema de coordenadas.

##  <a name="onkeydownevent"></a>COleControl:: OnKeyDownEvent

Lo llama el marco de trabajo después de que se haya procesado un evento KeyDown de stock.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parámetros

*nChar*<br/>
Valor del código de tecla virtual de la tecla presionada. Para obtener una lista de códigos de tecla virtual estándar, vea Winuser. h

*nShiftState*<br/>
Contiene una combinación de las marcas siguientes:

- SHIFT_MASK se presionó la tecla Mayús durante la acción.

- CTRL_MASK se presionó la tecla CTRL durante la acción.

- ALT_MASK se presionó la tecla ALT durante la acción.

### <a name="remarks"></a>Observaciones

Invalide esta función si el control necesita tener acceso a la información de clave una vez que se ha desencadenado el evento.

##  <a name="onkeypressevent"></a>COleControl:: OnKeyPressEvent

Lo llama el marco de trabajo después de que se haya activado el evento stock KeyPress.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parámetros

*nChar*<br/>
Contiene el valor del código de tecla virtual de la tecla presionada. Para obtener una lista de códigos de tecla virtual estándar, vea Winuser. h

### <a name="remarks"></a>Observaciones

Tenga en cuenta que el contenedor puede haber modificado el valor *nChar* .

Invalide esta función si desea recibir una notificación cuando se produzca este evento.

##  <a name="onkeyupevent"></a>COleControl:: OnKeyUpEvent

Lo llama el marco de trabajo después de que se haya procesado un evento KeyDown de stock.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parámetros

*nChar*<br/>
Valor del código de tecla virtual de la tecla presionada. Para obtener una lista de códigos de tecla virtual estándar, vea Winuser. h

*nShiftState*<br/>
Contiene una combinación de las marcas siguientes:

- SHIFT_MASK se presionó la tecla Mayús durante la acción.

- CTRL_MASK se presionó la tecla CTRL durante la acción.

- ALT_MASK se presionó la tecla ALT durante la acción.

### <a name="remarks"></a>Observaciones

Invalide esta función si el control necesita tener acceso a la información de clave una vez que se ha desencadenado el evento.

##  <a name="onmappropertytopage"></a>COleControl:: OnMapPropertyToPage

Lo llama el marco de trabajo para obtener el identificador de clase de una página de propiedades que implementa la edición de la propiedad especificada.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parámetros

*DISPID*<br/>
Identificador de envío de una propiedad del control.

*lpclsid*<br/>
Puntero a una estructura de `CLSID` a través de la cual se devolverá un identificador de clase.

*pbPageOptional*<br/>
Devuelve un indicador de si el uso de la página de propiedades especificada es opcional.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se ha devuelto un identificador de clase en *lpclsid*; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Invalide esta función para proporcionar una manera de invocar las páginas de propiedades del control desde el explorador de propiedades del contenedor.

##  <a name="onmnemonic"></a>COleControl:: mnemónicos

Lo llama el marco de trabajo cuando el contenedor ha detectado que se ha presionado una tecla de mnemotécnico del control OLE.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parámetros

*pMsg*<br/>
Puntero al mensaje de Windows generado por la presión de una tecla mnemónica.

##  <a name="onproperties"></a>COleControl:: propiedades

Lo llama el marco de trabajo cuando el contenedor invoca el verbo de propiedades del control.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*lpMsg*<br/>
Puntero al mensaje de Windows que invocó el verbo.

*hWndParent*<br/>
Identificador de la ventana primaria del control.

*lpRect*<br/>
Puntero al rectángulo utilizado por el control en el contenedor.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada se realiza correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada muestra un cuadro de diálogo de propiedades modal.

También puede usar esta función para que se muestren las páginas de propiedades del control. Realice una llamada a la función `OnProperties`, pasando el identificador del elemento primario del control en el parámetro *hWndParent* . En este caso, se omiten los valores de los parámetros *lpMsg* y *lpRect* .

##  <a name="onqueryhitpoint"></a>COleControl:: OnQueryHitPoint

Lo llama el marco de trabajo en respuesta a la solicitud de `IViewObjectEx::QueryHitPoint` de un contenedor.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parámetros

*dwAspect*<br/>
Especifica cómo se representa el objeto. Los valores válidos se toman de la enumeración [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*pRectBounds*<br/>
Puntero a una estructura de `RECT` que especifica el rectángulo delimitador del área cliente del control OLE.

*ptlLoc*<br/>
Puntero a la estructura de `POINT` que especifica el punto en el que se va a comprobar un acierto. El punto se especifica en las coordenadas del área del cliente OLE.

*lCloseHint*<br/>
Distancia que define "CLOSE" hasta el punto en el que se ha comprobado un acierto.

*pHitResult*<br/>
Puntero al resultado de la consulta de posicionamiento. Uno de los valores siguientes:

- HITRESULT_OUTSIDE *ptlLoc* está fuera del objeto OLE y no se cierra.

- HITRESULT_TRANSPARENT *ptlLoc* se encuentra dentro de los límites del objeto OLE, pero no se aproxima a la imagen. Por ejemplo, un punto en medio de un círculo transparente podría ser HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* está dentro o fuera del objeto OLE, pero lo suficientemente cerca del objeto que se va a considerar dentro de. Los objetos pequeños, finos o detallados pueden utilizar este valor. Incluso si un punto está fuera del rectángulo delimitador de un objeto, es posible que todavía esté cerca (esto es necesario para golpear los objetos pequeños).

- HITRESULT_HIT *ptlLoc* está dentro de la imagen del objeto.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se devuelve correctamente un resultado de aciertos; de lo contrario, es 0. Un acierto es una superposición con el área de visualización del control OLE.

### <a name="remarks"></a>Observaciones

Consulta si el rectángulo de presentación de un objeto se superpone al punto determinado (alcanza el punto). `QueryHitPoint` se pueden invalidar para probar los aciertos de objetos no rectangulares.

##  <a name="onqueryhitrect"></a>COleControl:: OnQueryHitRect

Lo llama el marco de trabajo en respuesta a la solicitud de `IViewObjectEx::QueryHitRect` de un contenedor.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parámetros

*dwAspect*<br/>
Especifica cómo se va a representar el objeto. Los valores válidos se toman de la enumeración [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) o DVASPECT2.

*pRectBounds*<br/>
Puntero a una estructura de `RECT` que especifica el rectángulo delimitador del área cliente del control OLE.

*prcLoc*<br/>
Puntero a la estructura de `RECT` que especifica el rectángulo que se va a comprobar para obtener un acierto (superpuesto al rectángulo del objeto) con respecto a la esquina superior izquierda del objeto.

*lCloseHint*<br/>
No se usa.

*pHitResult*<br/>
Puntero al resultado de la consulta de posicionamiento. Uno de los valores siguientes:

- HITRESULT_OUTSIDE no se alcanza ningún punto del rectángulo en el objeto OLE.

- HITRESULT_HIT al menos un punto del rectángulo sería un acierto en el objeto.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se devuelve correctamente un resultado de aciertos; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Consulta si el rectángulo de presentación de un objeto se superpone a cualquier punto del rectángulo determinado (alcanza el rectángulo). `QueryHitRect` se pueden invalidar para probar los aciertos de objetos no rectangulares.

##  <a name="onrenderdata"></a>COleControl:: OnRenderData

Lo llama el marco de trabajo para recuperar los datos en el formato especificado.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parámetros

*lpFormatEtc*<br/>
Apunta a la estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) especificando el formato en el que se solicita información.

*lpStgMedium*<br/>
Apunta a una estructura [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) en la que se van a devolver los datos.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

El formato especificado se colocó previamente en el objeto de control mediante las funciones miembro [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) o [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) para la representación diferida. La implementación predeterminada de esta función llama a `OnRenderFileData` o `OnRenderGlobalData`, respectivamente, si el medio de almacenamiento proporcionado es un archivo o una memoria. Si el formato solicitado es CF_METAFILEPICT o el formato del conjunto de propiedades persistentes, la implementación predeterminada representa los datos adecuados y devuelve un valor distinto de cero. De lo contrario, devuelve 0 y no hace nada.

Si *lpStgMedium-> tymed* es TYMED_NULL, se debe asignar y rellenar el STGMEDIUM según lo especificado por *lpFormatEtc-> tymed*. Si no TYMED_NULL, se debe rellenar el STGMEDIUM con los datos.

Invalide esta función para proporcionar los datos en el formato y medio solicitados. En función de los datos, puede que desee reemplazar una de las otras versiones de esta función en su lugar. Si los datos son pequeños y tienen un tamaño fijo, invalide `OnRenderGlobalData`. Si los datos están en un archivo o tiene un tamaño variable, invalide `OnRenderFileData`.

Para obtener más información, vea las estructuras `FORMATETC` y `STGMEDIUM` en la Windows SDK.

##  <a name="onrenderfiledata"></a>COleControl:: OnRenderFileData

Lo llama el marco de trabajo para recuperar los datos en el formato especificado cuando el medio de almacenamiento es un archivo.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parámetros

*lpFormatEtc*<br/>
Apunta a la estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) especificando el formato en el que se solicita información.

*pFile*<br/>
Señala a un objeto [CFile](../../mfc/reference/cfile-class.md) en el que se van a representar los datos.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

El formato especificado es el que se colocó previamente en el objeto de control mediante la función miembro [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) para la representación diferida. La implementación predeterminada de esta función simplemente devuelve FALSE.

Invalide esta función para proporcionar los datos en el formato y medio solicitados. En función de los datos, es posible que desee invalidar una de las otras versiones de esta función en su lugar. Si desea administrar varios medios de almacenamiento, invalide `OnRenderData`. Si los datos están en un archivo o tiene un tamaño variable, invalide `OnRenderFileData`.

Para obtener más información, vea la estructura `FORMATETC` en el Windows SDK.

##  <a name="onrenderglobaldata"></a>COleControl:: OnRenderGlobalData

Lo llama el marco de trabajo para recuperar los datos en el formato especificado cuando el medio de almacenamiento especificado es una memoria global.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parámetros

*lpFormatEtc*<br/>
Apunta a la estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) especificando el formato en el que se solicita información.

*phGlobal*<br/>
Apunta a un identificador de la memoria global en la que se van a devolver los datos. Si no se ha asignado ninguna memoria, este parámetro puede ser NULL.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

El formato especificado es el que se colocó previamente en el objeto de control mediante la función miembro [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) para la representación diferida. La implementación predeterminada de esta función simplemente devuelve FALSE.

Si *phGlobal* es null, se debe asignar y devolver un nuevo hglobal en *phGlobal*. De lo contrario, el HGLOBAL especificado por *phGlobal* se debe rellenar con los datos. La cantidad de datos que se colocan en el HGLOBAL no debe superar el tamaño actual del bloque de memoria. Además, el bloque no se puede reasignar a un tamaño mayor.

Invalide esta función para proporcionar los datos en el formato y medio solicitados. En función de los datos, puede que desee reemplazar una de las otras versiones de esta función en su lugar. Si desea administrar varios medios de almacenamiento, invalide `OnRenderData`. Si los datos están en un archivo o tiene un tamaño variable, invalide `OnRenderFileData`.

Para obtener más información, vea la estructura `FORMATETC` en el Windows SDK.

##  <a name="onresetstate"></a>COleControl:: OnResetState

Lo llama el marco de trabajo cuando las propiedades del control se deben establecer en sus valores predeterminados.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada llama a [DoPropExchange](#dopropexchange), pasando un objeto `CPropExchange` que hace que las propiedades se establezcan en sus valores predeterminados.

El escritor de control puede insertar código de inicialización para el control OLE en este Overridable. Se llama a esta función cuando se produce un error en [IPersistStream:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) o [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) , o se llama a [IPersistStreamInit:: InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) o [IPersistStorage:: InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) , sin llamar primero a `IPersistStream::Load` o a `IPersistStorage::Load`.

##  <a name="onsetclientsite"></a>COleControl:: OnSetClientSite

Lo llama el marco de trabajo cuando el contenedor ha llamado a la función `IOleControl::SetClientSite` del control.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Observaciones

De forma predeterminada, `OnSetClientSite` comprueba si se cargan las propiedades de ruta de acceso de datos y, si es así, llama a `DoDataPathPropExchange`.

Invalide esta función para realizar cualquier procesamiento especial de esta notificación. En concreto, las invalidaciones de esta función deben llamar a la clase base.

##  <a name="onsetdata"></a>COleControl:: OnSetData

Lo llama el marco de trabajo para reemplazar los datos del control con los datos especificados.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parámetros

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) que especifica el formato de los datos.

*lpStgMedium*<br/>
Puntero a una estructura [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) en la que residen los datos.

*bRelease*<br/>
TRUE si el control debe liberar el medio de almacenamiento; FALSE si el control no debe liberar el medio de almacenamiento.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Si los datos están en el formato del conjunto de propiedades persistentes, la implementación predeterminada modifica el estado del control en consecuencia. De lo contrario, la implementación predeterminada no hace nada. Si *bRelease* es true, se realiza una llamada a `ReleaseStgMedium`; de lo contrario, no.

Invalide esta función para reemplazar los datos del control con los datos especificados.

Para obtener más información, vea las estructuras `FORMATETC` y `STGMEDIUM` en la Windows SDK.

##  <a name="onsetextent"></a>COleControl:: OnSetExtent

Lo llama el marco de trabajo cuando es necesario cambiar la extensión del control, como resultado de una llamada a [IOleObject:: SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parámetros

*lpSizeL*<br/>
Puntero a la estructura de `SIZEL` que usa enteros largos para representar el ancho y el alto del control, expresado en unidades de HIMETRIC.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se aceptó el cambio de tamaño; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada controla el cambio de tamaño de la extensión del control. Si el control está activo en contexto, se realiza una llamada al `OnPosRectChanged` del contenedor.

Invalide esta función para modificar el cambio de tamaño predeterminado del control.

##  <a name="onsetobjectrects"></a>COleControl:: OnSetObjectRects

Lo llama el marco de trabajo para implementar una llamada a [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parámetros

*lpRectPos*<br/>
Puntero a una estructura de `RECT` que indica la nueva posición y el tamaño del control en relación con el contenedor.

*lpRectClip*<br/>
Puntero a una estructura de `RECT` que indica un área rectangular en la que se va a recortar el control.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se aceptó el reposicionamiento; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada controla automáticamente el cambio de posición y el cambio de tamaño de la ventana de control y devuelve TRUE.

Invalide esta función para modificar el comportamiento predeterminado de esta función.

##  <a name="onshowtoolbars"></a>COleControl:: OnShowToolBars

Lo llama el marco de trabajo cuando el control se ha activado en la interfaz de usuario.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada no hace nada.

##  <a name="ontextchanged"></a>COleControl:: OnTextChanged

Lo llama el marco de trabajo cuando cambia el valor de la propiedad Caption o Text.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada llama a `InvalidateControl`.

Invalide esta función si desea recibir una notificación después de que cambie esta propiedad.

##  <a name="onwindowlessmessage"></a>COleControl:: OnWindowlessMessage

Lo llama el marco de trabajo en respuesta a la solicitud de `IOleInPlaceObjectWindowless::OnWindowMessage` de un contenedor.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parámetros

*mensaje*<br/>
Identificador de mensaje tal y como lo pasa Windows.

*wParam*<br/>
Tal y como lo pasa Windows. Especifica información adicional específica del mensaje. El contenido de este parámetro depende del valor del parámetro *MSG* .

*lParam*<br/>
Tal y como lo pasa Windows. Especifica información adicional específica del mensaje. El contenido de este parámetro depende del valor del parámetro *MSG* .

*plResult*<br/>
Código de resultado de Windows. Especifica el resultado del procesamiento del mensaje y depende del mensaje enviado.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Procesa los mensajes de ventana para los controles sin ventanas. los `OnWindowlessMessage` de `COleControl`deben usarse para mensajes de ventana distintos de los mensajes del mouse y los mensajes del teclado. `COleControl` proporciona [SetCapture](#setcapture) y [SetFocus](#setfocus) específicamente para obtener la captura del mouse y el foco de teclado para objetos OLE sin ventanas.

Dado que los objetos sin ventana no tienen una ventana, necesitan un mecanismo para que el contenedor envíe mensajes a ellos. Un objeto OLE sin ventanas obtiene los mensajes de su contenedor, a través del método `OnWindowMessage` en la interfaz `IOleInPlaceObjectWindowless` (una extensión de [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) para la compatibilidad sin ventanas). `OnWindowMessage` no toma un parámetro `HWND`.

##  <a name="parenttoclient"></a>COleControl::P arentToClient

Convierte las coordenadas de *PPoint* en coordenadas de cliente.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parámetros

*lprcBounds*<br/>
Puntero a los límites del control OLE dentro del contenedor. No es el área cliente sino el área del control completo, incluidos los bordes y las barras de desplazamiento.

*pPoint*<br/>
Puntero al punto primario (contenedor) que se va a convertir en las coordenadas del área cliente del control.

*bHitTest*<br/>
Especifica si se debe realizar o no la prueba de posicionamiento en el punto.

### <a name="return-value"></a>Valor devuelto

Si *bHitTest* es false, devuelve HTNOWHERE. Si *bHitTest* es true, devuelve la ubicación en la que el punto primario (contenedor) ha descargado en el área cliente del control OLE y es uno de los siguientes valores de la prueba de posicionamiento del mouse:

- HTBORDER en el borde de una ventana que no tiene un borde de ajuste de tamaño.

- HTBOTTOM en el borde horizontal inferior de la ventana.

- HTBOTTOMLEFT en la esquina inferior izquierda del borde de la ventana.

- HTBOTTOMRIGHT en la esquina inferior derecha del borde de la ventana.

- HTCAPTION en un área de la barra de título.

- HTCLIENT en un área cliente.

- HTERROR en el fondo de la pantalla o en una línea de división entre Windows (igual que HTNOWHERE, salvo que la función `DefWndProc` Windows genera un bip del sistema para indicar un error).

- HTGROWBOX en un cuadro de tamaño.

- HTHSCROLL en la barra de desplazamiento horizontal.

- HTLEFT en el borde izquierdo de la ventana.

- HTMAXBUTTON en un botón maximizar.

- HTMENU en un área de menú.

- HTMINBUTTON en un botón minimizar.

- HTNOWHERE en el fondo de la pantalla o en una línea divisoria entre ventanas.

- HTREDUCE en un botón minimizar.

- HTRIGHT en el borde derecho de la ventana.

- HTSIZE en un cuadro de tamaño (igual que HTGROWBOX).

- HTSYSMENU en un menú de control o en un botón cerrar de una ventana secundaria.

- HTTOP en el borde horizontal superior de la ventana.

- HTTOPLEFT en la esquina superior izquierda del borde de la ventana.

- HTTOPRIGHT en la esquina superior derecha del borde de la ventana.

- HTTRANSPARENT en una ventana actualmente incluida en otra ventana.

- HTVSCROLL en la barra de desplazamiento vertical.

- HTZOOM en un botón maximizar.

### <a name="remarks"></a>Observaciones

En la entrada *PPoint* es relativa al origen del elemento primario (esquina superior izquierda del contenedor). En la salida *PPoint* es relativa al origen del área cliente del control OLE (esquina superior izquierda del área cliente del control).

##  <a name="postmodaldialog"></a>COleControl::P ostModalDialog

Notifica al contenedor que se ha cerrado un cuadro de diálogo modal.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parámetros

*hWndParent*<br/>
Identificador de la ventana primaria del cuadro de diálogo modal.

### <a name="remarks"></a>Observaciones

Llame a esta función después de mostrar cualquier cuadro de diálogo modal. Debe llamar a esta función para que el contenedor pueda habilitar cualquier ventana de nivel superior deshabilitada por `PreModalDialog`. Esta función se debe emparejar con una llamada a `PreModalDialog`.

##  <a name="premodaldialog"></a>COleControl::P reModalDialog

Notifica al contenedor que un cuadro de diálogo modal está a punto de mostrarse.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parámetros

*hWndParent*<br/>
Identificador de la ventana primaria del cuadro de diálogo modal.

### <a name="remarks"></a>Observaciones

Llame a esta función antes de mostrar un cuadro de diálogo modal. Debe llamar a esta función para que el contenedor pueda deshabilitar todas las ventanas de nivel superior. Una vez mostrado el cuadro de diálogo modal, debe llamar a `PostModalDialog`.

##  <a name="recreatecontrolwindow"></a>COleControl:: RecreateControlWindow

Destruye y vuelve a crear la ventana del control.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Observaciones

Esto puede ser necesario si tiene que cambiar los bits de estilo de la ventana.

##  <a name="refresh"></a>COleControl:: Refresh

Fuerza a que se vuelva a dibujar el control OLE.

```
void Refresh();
```

### <a name="remarks"></a>Observaciones

Esta función es compatible con la clase base `COleControl` como un método estándar, denominado Refresh. Esto permite a los usuarios del control OLE volver a pintar el control en un momento determinado. Para obtener más información sobre este método, vea el artículo [controles ActiveX: métodos](../../mfc/mfc-activex-controls-methods.md).

##  <a name="releasecapture"></a>COleControl:: ReleaseCapture

Libera la captura del mouse.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Si el control tiene actualmente la captura del mouse, se libera la captura. De lo contrario, esta función no tiene ningún efecto.

##  <a name="releasedc"></a>COleControl:: ReleaseDC

Libera el contexto de dispositivo de pantalla de un contenedor de un control sin ventana, liberando el contexto de dispositivo para que lo usen otras aplicaciones.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Identifica el contexto de dispositivo contenedor que se va a liberar.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

La aplicación debe llamar a `ReleaseDC` para cada llamada a [GetDC](#getdc).

##  <a name="reparentcontrolwindow"></a>COleControl:: ReparentControlWindow

Establece el elemento primario del control.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parámetros

*hWndOuter*<br/>
Identificador de la ventana de control.

*hWndParent*<br/>
Identificador de la nueva ventana primaria.

### <a name="remarks"></a>Observaciones

Llame a esta función para restablecer el elemento primario de la ventana de control.

##  <a name="resetstockprops"></a>COleControl:: ResetStockProps

Inicializa el estado de las propiedades estándar de `COleControl` con sus valores predeterminados.

```
void ResetStockProps();
```

### <a name="remarks"></a>Observaciones

Las propiedades son: Appearance, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, hWnd y Text. Para obtener una descripción de las propiedades estándar, vea [controles ActiveX: agregar propiedades estándar](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Puede mejorar el rendimiento de la inicialización binaria de un control utilizando `ResetStockProps` y `ResetVersion` para reemplazar `COleControl::OnResetState`. Observe el ejemplo siguiente. Para obtener más información sobre la optimización de la inicialización, vea [controles ActiveX: optimización](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Ejemplo

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>COleControl:: ResetVersion

Inicializa el número de versión en el valor especificado.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parámetros

*dwVersionDefault*<br/>
Número de versión que se va a asignar al control.

### <a name="remarks"></a>Observaciones

Puede mejorar el rendimiento de la inicialización binaria de un control utilizando `ResetVersion` y `ResetStockProps` para reemplazar `COleControl::OnResetState`. Vea el ejemplo en [ResetStockProps](#resetstockprops). Para obtener más información sobre la optimización de la inicialización, vea [controles ActiveX: optimización](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="scrollwindow"></a>COleControl:: ScrollWindow

Permite a un objeto OLE sin ventana desplazarse por un área dentro de su imagen activa en contexto en la pantalla.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parámetros

*xAmount*<br/>
Especifica la cantidad, en unidades de dispositivo, de desplazamiento horizontal. Este parámetro debe ser un valor negativo para desplazarse a la izquierda.

*yAmount*<br/>
Especifica la cantidad, en unidades de dispositivo, de desplazamiento vertical. Este parámetro debe ser un valor negativo para desplazarse hacia arriba.

*lpRect*<br/>
Señala a un objeto [CRect](../../atl-mfc-shared/reference/crect-class.md) o una estructura Rect que especifica la parte del área cliente del objeto OLE que se va a desplazar, en coordenadas de cliente de la ventana contenedora. Si *lpRect* es null, se desplaza el área cliente del objeto OLE completo.

*lpClipRect*<br/>
Señala a un objeto `CRect` o a una estructura de `RECT` que especifica el rectángulo al que se va a recortar. Solo se desplazan los píxeles dentro del rectángulo. Los bits que se encuentran fuera del rectángulo no se ven afectados aunque estén en el rectángulo *lpRect* . Si *lpClipRect* es null, no se realiza ningún recorte en el rectángulo de desplazamiento.

##  <a name="selectfontobject"></a>COleControl:: SelectFontObject

Selecciona una fuente en un contexto de dispositivo.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Puntero a un objeto de contexto de dispositivo.

*fontHolder*<br/>
Referencia al objeto [CFontHolder](../../mfc/reference/cfontholder-class.md) que representa la fuente que se va a seleccionar.

### <a name="return-value"></a>Valor devuelto

Puntero a la fuente seleccionada anteriormente. Cuando el autor de la llamada ha finalizado todas las operaciones de dibujo que usan *fontHolder,* debe volver a seleccionar la fuente seleccionada anteriormente pasándola como parámetro a [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject).

##  <a name="selectstockfont"></a>COleControl:: SelectStockFont

Selecciona la propiedad fuente estándar en un contexto de dispositivo.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Contexto de dispositivo en el que se seleccionará la fuente.

### <a name="return-value"></a>Valor devuelto

Puntero al objeto de `CFont` previamente seleccionado. Debe usar [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject) para volver a seleccionar esta fuente en el contexto del dispositivo cuando haya terminado.

##  <a name="serializeextent"></a>COleControl:: SerializeExtent

Serializa o inicializa el estado del espacio de presentación asignado al control.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parámetros

*analítico*<br/>
`CArchive` objeto que se va a serializar o desde el que se va a serializar.

### <a name="remarks"></a>Observaciones

Puede mejorar el rendimiento de la persistencia binaria de un control mediante `SerializeExtent`, `SerializeStockProps`y `SerializeVersion` para reemplazar `COleControl::Serialize`. Observe el ejemplo siguiente. Para obtener más información sobre la optimización de la inicialización, vea [controles ActiveX: optimización](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Ejemplo

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>COleControl:: SerializeStockProps

Serializa o inicializa el estado de las propiedades estándar de `COleControl`: Appearance, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor y Text.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parámetros

*analítico*<br/>
`CArchive` objeto que se va a serializar o desde el que se va a serializar.

### <a name="remarks"></a>Observaciones

Para obtener una descripción de las propiedades estándar, vea [controles ActiveX: agregar propiedades estándar](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Puede mejorar el rendimiento de la persistencia binaria de un control mediante `SerializeStockProps`, `SerializeExtent`y `SerializeVersion` para reemplazar `COleControl::Serialize`. Para obtener un ejemplo, vea el código en [SerializeExtent](#serializeextent). Para obtener más información sobre la optimización de la inicialización, vea [controles ActiveX: optimización](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="serializeversion"></a>COleControl:: SerializeVersion

Serializa o inicializa el estado de la información de versión de un control.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parámetros

*analítico*<br/>
`CArchive` objeto que se va a serializar o desde el que se va a serializar.

*dwVersionDefault*<br/>
Número de versión actual del control.

*bConvert*<br/>
Indica si los datos persistentes se deben convertir al formato más reciente cuando se guardan o se mantienen en el mismo formato que tenía cuando se cargó.

### <a name="return-value"></a>Valor devuelto

Número de versión del control. Si el archivo especificado se está cargando, `SerializeVersion` devuelve la versión cargada desde ese archivo. De lo contrario, devuelve la versión cargada actualmente.

### <a name="remarks"></a>Observaciones

Puede mejorar el rendimiento de la persistencia binaria de un control mediante `SerializeVersion`, `SerializeExtent`y `SerializeStockProps` para reemplazar `COleControl::Serialize`. Para obtener un ejemplo, vea el código en [SerializeExtent](#serializeextent). Para obtener más información sobre la optimización de la inicialización, vea [controles ActiveX: optimización](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="setappearance"></a>COleControl:: SetAppearance

Establece el valor de la propiedad de aspecto de las acciones del control.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parámetros

*sAppearance*<br/>
Un valor **corto** (VT_I2) que se va a utilizar para la apariencia del control. Un valor de cero establece la apariencia del control en Flat y un valor de 1 establece la apariencia del control en 3D.

### <a name="remarks"></a>Observaciones

Para obtener más información sobre las propiedades estándar, vea [controles ActiveX: propiedades](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setbackcolor"></a>COleControl:: SetBackColor

Establece el valor de la propiedad BackColor de stock del control.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parámetros

*dwBackColor*<br/>
OLE_COLOR valor que se va a usar para el dibujo en segundo plano del control.

### <a name="remarks"></a>Observaciones

Para obtener más información sobre el uso de esta propiedad y otras propiedades relacionadas, vea el artículo [controles ActiveX: propiedades](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setborderstyle"></a>COleControl:: SetBorderStyle

Establece el valor de la propiedad BorderStyle de stock del control.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parámetros

*sBorderStyle*<br/>
Nuevo estilo de borde para el control. 0 indica que no hay borde y 1 indica un borde normal.

### <a name="remarks"></a>Observaciones

La ventana de control se volverá a crear y `OnBorderStyleChanged` llamará.

##  <a name="setcapture"></a>COleControl:: SetCapture

Hace que la ventana contenedora del control tome posesión de la captura del mouse en nombre del control.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto de ventana de `CWnd` que previamente ha recibido la entrada del mouse.

### <a name="remarks"></a>Observaciones

Si el control está activado y sin ventana, esta función hace que la ventana contenedora del control asuma la posesión de la captura del mouse, en nombre del control. De lo contrario, esta función hace que el propio control pueda tomar posesión de la captura del mouse (igual que `CWnd::SetCapture`).

##  <a name="setcontrolsize"></a>COleControl:: SetControlSize

Establece el tamaño de la ventana de control OLE y notifica al contenedor que el sitio de control está cambiando.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parámetros

*serie*<br/>
Especifica el nuevo ancho del control en píxeles.

*CY*<br/>
Especifica el nuevo alto del control en píxeles.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada se realizó correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Esta función no se debe usar en el constructor del control.

Tenga en cuenta que todas las coordenadas de las ventanas de control son relativas a la esquina superior izquierda del control.

##  <a name="setenabled"></a>COleControl:: SetEnabled

Establece el valor de propiedad estándar habilitado del control.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parámetros

*bEnabled*<br/>
TRUE si el control se va a habilitar; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

Después de establecer esta propiedad, se llama a `OnEnabledChange`.

##  <a name="setfocus"></a>COleControl:: SetFocus

Hace que la ventana contenedora del control tome posesión del foco de entrada en nombre del control.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto de ventana de `CWnd` que tenía anteriormente el foco de entrada, o NULL si no hay ninguna ventana.

### <a name="remarks"></a>Observaciones

Si el control está activado y sin ventana, esta función hace que la ventana contenedora del control asuma la posesión del foco de entrada en nombre del control. El foco de entrada dirige la entrada del teclado a la ventana del contenedor y el contenedor envía todos los mensajes de teclado posteriores al objeto OLE que llama a `SetFocus`. Cualquier ventana que tenía anteriormente el foco de entrada lo pierde.

Si el control no tiene ventana, esta función hace que el propio control pueda tomar posesión del foco de entrada (igual que `CWnd::SetFocus`).

##  <a name="setfont"></a>COleControl:: SetFont

Establece la propiedad fuente estándar del control.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parámetros

*pFontDisp*<br/>
Puntero a una interfaz de envío de fuentes.

##  <a name="setforecolor"></a>COleControl:: SetForeColor

Establece el valor de la propiedad ForeColor estándar del control.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parámetros

*dwForeColor*<br/>
OLE_COLOR valor que se va a usar para el dibujo en primer plano del control.

### <a name="remarks"></a>Observaciones

Para obtener más información sobre el uso de esta propiedad y otras propiedades relacionadas, vea el artículo [controles ActiveX: propiedades](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setinitialdataformats"></a>COleControl:: SetInitialDataFormats

Lo llama el marco de trabajo para inicializar la lista de formatos de datos admitidos por el control.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada especifica dos formatos: CF_METAFILEPICT y el conjunto de propiedades Persistent.

##  <a name="setinitialsize"></a>COleControl:: SetInitialSize

Establece el tamaño de un control OLE cuando se muestra por primera vez en un contenedor.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parámetros

*serie*<br/>
Ancho inicial del control OLE en píxeles.

*CY*<br/>
Alto inicial del control OLE en píxeles.

### <a name="remarks"></a>Observaciones

Llame a esta función en el constructor para establecer el tamaño inicial del control. El tamaño inicial se mide en unidades de dispositivo o píxeles. Se recomienda realizar esta llamada en el constructor del control.

##  <a name="setmodifiedflag"></a>COleControl:: SetModifiedFlag

Cambia el estado modificado de un control.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parámetros

*bModified*<br/>
Nuevo valor de la marca modificada del control. TRUE indica que el estado del control ha sido modificado; FALSE indica que el estado del control se ha guardado recientemente.

### <a name="remarks"></a>Observaciones

Llame a esta función siempre que se produzca un cambio que afecte al estado persistente del control. Por ejemplo, si cambia el valor de una propiedad persistente, llame a esta función con *bModified* **true**.

##  <a name="setnotpermitted"></a>COleControl:: SetNotPermitted

Indica que se ha producido un error en una solicitud de edición.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Observaciones

Llame a esta función cuando se produzca un error en `BoundPropertyRequestEdit`. Esta función produce una excepción de tipo `COleDispScodeException` para indicar que no se permitió la operación SET.

##  <a name="setnotsupported"></a>COleControl:: SetNotSupported

Impide que el usuario modifique el valor de la propiedad de un control.

```
void SetNotSupported();
```

### <a name="remarks"></a>Observaciones

Llame a esta función en lugar de la función set de cualquier propiedad en la que no se admita la modificación del valor de propiedad por parte del usuario del control. Un ejemplo sería una propiedad que es de solo lectura.

##  <a name="setrectincontainer"></a>COleControl:: SetRectInContainer

Establece las coordenadas del rectángulo del control en relación con el contenedor, expresado en unidades de dispositivo.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*lpRect*<br/>
Puntero a un rectángulo que contiene las nuevas coordenadas del control en relación con el contenedor.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada se realizó correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Si el control está abierto, se cambia de tamaño; de lo contrario, se llama a la función `OnPosRectChanged` del contenedor.

##  <a name="settext"></a>COleControl:: SetText

Establece el valor del título o la propiedad de texto del control.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parámetros

*Miembros pszText*<br/>
Puntero a una cadena de caracteres.

### <a name="remarks"></a>Observaciones

Tenga en cuenta que el título y las propiedades de texto de las acciones se asignan al mismo valor. Esto significa que cualquier cambio realizado en cualquier propiedad cambiará automáticamente ambas propiedades. En general, un control debe admitir el título o la propiedad de texto, pero no ambos.

##  <a name="throwerror"></a>COleControl:: ThrowError

Indica la aparición de un error en el control.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parámetros

*seguro*<br/>
Valor del código de estado que se va a informar. Para obtener una lista completa de los posibles códigos, vea el artículo [controles ActiveX: temas avanzados](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
IDENTIFICADOR de recurso de cadena de la excepción que se va a informar.

*nHelpID*<br/>
IDENTIFICADOR de la ayuda del tema en el que se va a informar.

*pszDescription*<br/>
Cadena que contiene una explicación de la excepción que se va a informar.

### <a name="remarks"></a>Observaciones

Solo se debe llamar a esta función desde dentro de una función get o set para una propiedad OLE o la implementación de un método de automatización OLE. Si necesita señalizar los errores que se producen en otras ocasiones, debe activar el evento de error de stock.

##  <a name="transformcoords"></a>COleControl:: TransformCoords

Transforma los valores de coordenadas entre las unidades HIMETRIC y las unidades nativas del contenedor.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parámetros

*lpptlHimetric*<br/>
Puntero a una estructura de `POINTL` que contiene coordenadas en unidades de HIMETRIC.

*lpptfContainer*<br/>
Puntero a una estructura de `POINTF` que contiene coordenadas en el tamaño de unidad del contenedor.

*flags*<br/>
Una combinación de los siguientes valores:

- XFORMCOORDS_POSITION una posición en el contenedor.

- XFORMCOORDS_SIZE un tamaño en el contenedor.

- XFORMCOORDS_HIMETRICTOCONTAINER transformar unidades HIMETRIC en unidades del contenedor.

- XFORMCOORDS_CONTAINERTOHIMETRIC transformar las unidades del contenedor en unidades de HIMETRIC.

### <a name="remarks"></a>Observaciones

Las dos primeras marcas, XFORMCOORDS_POSITION y XFORMCOORDS_SIZE, indican si las coordenadas se deben tratar como una posición o como un tamaño. Las dos marcas restantes indican la dirección de la transformación.

##  <a name="translatecolor"></a>COleControl:: TranslateColor

Convierte un valor de color del tipo de datos OLE_COLOR en el tipo de datos [COLORREF](/windows/win32/gdi/colorref) .

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parámetros

*clrColor*<br/>
Un tipo de datos OLE_COLOR. Para obtener más información, vea la función [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) de Windows.

*hpal*<br/>
Identificador de una paleta opcional; puede ser NULL.

### <a name="return-value"></a>Valor devuelto

Un valor de color RGB (rojo, verde, azul) de 32 bits que define el color sólido más cercano al valor *clrColor* que el dispositivo puede representar.

### <a name="remarks"></a>Observaciones

Esta función es útil para traducir las propiedades ForeColor y BackColor de las acciones a los tipos COLORREF utilizados por las funciones miembro de [CDC](../../mfc/reference/cdc-class.md) .

##  <a name="willambientsbevalidduringload"></a>COleControl:: WillAmbientsBeValidDuringLoad

Determina si el control debe usar los valores de las propiedades de ambiente como valores predeterminados, cuando se carga posteriormente desde su estado persistente.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero indica que las propiedades de ambiente serán válidas; de lo contrario, las propiedades de ambiente no serán válidas.

### <a name="remarks"></a>Observaciones

En algunos contenedores, es posible que el control no tenga acceso a sus propiedades de ambiente durante la llamada inicial a la invalidación de `COleControl::DoPropExchange`. Este es el caso si el contenedor llama a [IPersistStreamInit:: Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) o [IPersistStorage:: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) antes de llamar a [IOleObject:: SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (es decir, si no respeta el bit de estado de OLEMISC_SETCLIENTSITEFIRST).

##  <a name="windowproc"></a>COleControl:: WindowProc

Proporciona un procedimiento de Windows para un objeto `COleControl`.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parámetros

*message*<br/>
Especifica el mensaje de Windows que se va a procesar.

*wParam*<br/>
Proporciona información adicional que se usa para procesar el mensaje. El valor del parámetro depende del mensaje.

*lParam*<br/>
Proporciona información adicional que se usa para procesar el mensaje. El valor del parámetro depende del mensaje.

### <a name="return-value"></a>Valor devuelto

El valor devuelto del mensaje enviado.

### <a name="remarks"></a>Observaciones

Llame a esta función para enviar mensajes específicos a través del mapa de mensajes del control.

## <a name="see-also"></a>Consulte también

[Ejemplo de MFC CIRC3](../../overview/visual-cpp-samples.md)<br/>
[Ejemplo TESTHELP de MFC](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage (clase)](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd (clase)](../../mfc/reference/cwnd-class.md)<br/>
[Gráfico de jerarquías](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder (clase)](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder (clase)](../../mfc/reference/cpictureholder-class.md)<br/>
