---
title: Clase CWinAppEx
ms.date: 11/04/2016
f1_keywords:
- CWinAppEx
- AFXWINAPPEX/CWinAppEx
- AFXWINAPPEX/CWinAppEx::CWinAppEx
- AFXWINAPPEX/CWinAppEx::CleanState
- AFXWINAPPEX/CWinAppEx::EnableLoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::EnableTearOffMenus
- AFXWINAPPEX/CWinAppEx::EnableUserTools
- AFXWINAPPEX/CWinAppEx::ExitInstance
- AFXWINAPPEX/CWinAppEx::GetBinary
- AFXWINAPPEX/CWinAppEx::GetContextMenuManager
- AFXWINAPPEX/CWinAppEx::GetDataVersion
- AFXWINAPPEX/CWinAppEx::GetDataVersionMajor
- AFXWINAPPEX/CWinAppEx::GetDataVersionMinor
- AFXWINAPPEX/CWinAppEx::GetInt
- AFXWINAPPEX/CWinAppEx::GetKeyboardManager
- AFXWINAPPEX/CWinAppEx::GetMouseManager
- AFXWINAPPEX/CWinAppEx::GetObject
- AFXWINAPPEX/CWinAppEx::GetRegSectionPath
- AFXWINAPPEX/CWinAppEx::GetRegistryBase
- AFXWINAPPEX/CWinAppEx::GetSectionBinary
- AFXWINAPPEX/CWinAppEx::GetSectionInt
- AFXWINAPPEX/CWinAppEx::GetSectionObject
- AFXWINAPPEX/CWinAppEx::GetSectionString
- AFXWINAPPEX/CWinAppEx::GetShellManager
- AFXWINAPPEX/CWinAppEx::GetString
- AFXWINAPPEX/CWinAppEx::GetTooltipManager
- AFXWINAPPEX/CWinAppEx::GetUserToolsManager
- AFXWINAPPEX/CWinAppEx::InitContextMenuManager
- AFXWINAPPEX/CWinAppEx::InitKeyboardManager
- AFXWINAPPEX/CWinAppEx::InitMouseManager
- AFXWINAPPEX/CWinAppEx::InitShellManager
- AFXWINAPPEX/CWinAppEx::InitTooltipManager
- AFXWINAPPEX/CWinAppEx::IsResourceSmartUpdate
- AFXWINAPPEX/CWinAppEx::IsStateExists
- AFXWINAPPEX/CWinAppEx::LoadState
- AFXWINAPPEX/CWinAppEx::OnAppContextHelp
- AFXWINAPPEX/CWinAppEx::OnViewDoubleClick
- AFXWINAPPEX/CWinAppEx::OnWorkspaceIdle
- AFXWINAPPEX/CWinAppEx::SaveState
- AFXWINAPPEX/CWinAppEx::SetRegistryBase
- AFXWINAPPEX/CWinAppEx::ShowPopupMenu
- AFXWINAPPEX/CWinAppEx::WriteBinary
- AFXWINAPPEX/CWinAppEx::WriteInt
- AFXWINAPPEX/CWinAppEx::WriteObject
- AFXWINAPPEX/CWinAppEx::WriteSectionBinary
- AFXWINAPPEX/CWinAppEx::WriteSectionInt
- AFXWINAPPEX/CWinAppEx::WriteSectionObject
- AFXWINAPPEX/CWinAppEx::WriteSectionString
- AFXWINAPPEX/CWinAppEx::WriteString
- AFXWINAPPEX/CWinAppEx::LoadCustomState
- AFXWINAPPEX/CWinAppEx::LoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::OnClosingMainFrame
- AFXWINAPPEX/CWinAppEx::PreLoadState
- AFXWINAPPEX/CWinAppEx::PreSaveState
- AFXWINAPPEX/CWinAppEx::ReloadWindowPlacement
- AFXWINAPPEX/CWinAppEx::SaveCustomState
- AFXWINAPPEX/CWinAppEx::StoreWindowPlacement
- AFXWINAPPEX/CWinAppEx::m_bForceImageReset
helpviewer_keywords:
- CWinAppEx [MFC], CWinAppEx
- CWinAppEx [MFC], CleanState
- CWinAppEx [MFC], EnableLoadWindowPlacement
- CWinAppEx [MFC], EnableTearOffMenus
- CWinAppEx [MFC], EnableUserTools
- CWinAppEx [MFC], ExitInstance
- CWinAppEx [MFC], GetBinary
- CWinAppEx [MFC], GetContextMenuManager
- CWinAppEx [MFC], GetDataVersion
- CWinAppEx [MFC], GetDataVersionMajor
- CWinAppEx [MFC], GetDataVersionMinor
- CWinAppEx [MFC], GetInt
- CWinAppEx [MFC], GetKeyboardManager
- CWinAppEx [MFC], GetMouseManager
- CWinAppEx [MFC], GetObject
- CWinAppEx [MFC], GetRegSectionPath
- CWinAppEx [MFC], GetRegistryBase
- CWinAppEx [MFC], GetSectionBinary
- CWinAppEx [MFC], GetSectionInt
- CWinAppEx [MFC], GetSectionObject
- CWinAppEx [MFC], GetSectionString
- CWinAppEx [MFC], GetShellManager
- CWinAppEx [MFC], GetString
- CWinAppEx [MFC], GetTooltipManager
- CWinAppEx [MFC], GetUserToolsManager
- CWinAppEx [MFC], InitContextMenuManager
- CWinAppEx [MFC], InitKeyboardManager
- CWinAppEx [MFC], InitMouseManager
- CWinAppEx [MFC], InitShellManager
- CWinAppEx [MFC], InitTooltipManager
- CWinAppEx [MFC], IsResourceSmartUpdate
- CWinAppEx [MFC], IsStateExists
- CWinAppEx [MFC], LoadState
- CWinAppEx [MFC], OnAppContextHelp
- CWinAppEx [MFC], OnViewDoubleClick
- CWinAppEx [MFC], OnWorkspaceIdle
- CWinAppEx [MFC], SaveState
- CWinAppEx [MFC], SetRegistryBase
- CWinAppEx [MFC], ShowPopupMenu
- CWinAppEx [MFC], WriteBinary
- CWinAppEx [MFC], WriteInt
- CWinAppEx [MFC], WriteObject
- CWinAppEx [MFC], WriteSectionBinary
- CWinAppEx [MFC], WriteSectionInt
- CWinAppEx [MFC], WriteSectionObject
- CWinAppEx [MFC], WriteSectionString
- CWinAppEx [MFC], WriteString
- CWinAppEx [MFC], LoadCustomState
- CWinAppEx [MFC], LoadWindowPlacement
- CWinAppEx [MFC], OnClosingMainFrame
- CWinAppEx [MFC], PreLoadState
- CWinAppEx [MFC], PreSaveState
- CWinAppEx [MFC], ReloadWindowPlacement
- CWinAppEx [MFC], SaveCustomState
- CWinAppEx [MFC], StoreWindowPlacement
- CWinAppEx [MFC], m_bForceImageReset
ms.assetid: a3d3e053-3e22-463f-9444-c73abb1bb9d7
ms.openlocfilehash: c222567703d0e57480c00f6f2bf9e78f16979150
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/16/2020
ms.locfileid: "79426310"
---
# <a name="cwinappex-class"></a>Clase CWinAppEx

`CWinAppEx` controla el estado de la aplicación, guarda el estado en el registro, carga el estado del registro, inicializa los administradores de la aplicación y proporciona vínculos a esos mismos administradores de la aplicación.

   Para obtener más información, consulte el código fuente que se encuentra en la **\\VC\\src\\MFC** de la instalación de Visual Studio.
## <a name="syntax"></a>Sintaxis

```
class CWinAppEx : public CWinApp
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>Constructores públicos

|Nombre|Descripción|
|----------|-----------------|
|[CWinAppEx:: CWinAppEx](#cwinappex)|Construye un objeto `CWinAppEx`.|

### <a name="public-methods"></a>Métodos públicos

|Nombre|Descripción|
|----------|-----------------|
|[CWinAppEx:: CleanState](#cleanstate)|Quita la información sobre la aplicación del registro de Windows.|
|[CWinAppEx:: EnableLoadWindowPlacement](#enableloadwindowplacement)|Especifica si la aplicación cargará el tamaño y la ubicación iniciales de la ventana de marco principal del registro.|
|[CWinAppEx:: EnableTearOffMenus](#enabletearoffmenus)|Habilita los menús de recorte para la aplicación.|
|[CWinAppEx:: EnableUserTools](#enableusertools)|Permite al usuario crear comandos de menú personalizados en la aplicación.|
|[CWinAppEx:: ExitInstance](#exitinstance)|Lo llama el marco de trabajo desde dentro de la función miembro `Run` para salir de esta instancia de la aplicación. (Invalida [CWinApp:: ExitInstance](../../mfc/reference/cwinapp-class.md#exitinstance)).|
|[CWinAppEx:: GetBinary](#getbinary)|Lee datos binarios asociados al valor de registro especificado.|
|[CWinAppEx:: GetContextMenuManager](#getcontextmenumanager)|Devuelve un puntero al objeto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) global.|
|[CWinAppEx:: GetDataVersion](#getdataversion)||
|[CWinAppEx:: GetDataVersionMajor](#getdataversionmajor)|Devuelve la versión principal de la aplicación guardada en el registro de Windows.|
|[CWinAppEx:: GetDataVersionMinor](#getdataversionminor)|Devuelve la versión secundaria de la aplicación guardada en el registro de Windows.|
|[CWinAppEx:: GetInt](#getint)|Lee datos numéricos que están asociados al valor especificado del registro.|
|[CWinAppEx:: GetKeyboardManager](#getkeyboardmanager)|Devuelve un puntero al objeto [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) global.|
|[CWinAppEx:: GetMouseManager](#getmousemanager)|Devuelve un puntero al objeto [CMouseManager](../../mfc/reference/cmousemanager-class.md) global.|
|[CWinAppEx:: GetObject](#getobject)|Lee datos derivados de `CObject`asociados al valor especificado del registro.|
|[CWinAppEx:: GetRegSectionPath](#getregsectionpath)|Devuelve una cadena que es la ruta de acceso de una clave del registro. Esta ruta de acceso concatena la ruta de acceso relativa suministrada con la ruta de acceso de la aplicación.|
|[CWinAppEx:: GetRegistryBase](#getregistrybase)|Devuelve la ruta de acceso del registro de la aplicación.|
|[CWinAppEx:: GetSectionBinary](#getsectionbinary)|Lee los datos binarios asociados a la clave y el valor especificados del registro.|
|[CWinAppEx:: GetSectionInt](#getsectionint)|Lee datos numéricos del registro asociados a la clave y el valor especificados.|
|[CWinAppEx:: GetSectionObject](#getsectionobject)|Lee `CObject` datos asociados a la clave y el valor especificados del registro.|
|[CWinAppEx:: GetSectionString](#getsectionstring)|Lee los datos de cadena que están asociados a la clave y el valor especificados del registro.|
|[CWinAppEx:: GetShellManager](#getshellmanager)|Devuelve un puntero al objeto [CShellManager](../../mfc/reference/cshellmanager-class.md) global.|
|[CWinAppEx:: GetString](#getstring)|Lee datos de cadena asociados al valor especificado del registro.|
|[CWinAppEx:: GetTooltipManager](#gettooltipmanager)|Devuelve un puntero al objeto [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) global.|
|[CWinAppEx:: GetUserToolsManager](#getusertoolsmanager)|Devuelve un puntero al objeto [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) global.|
|[CWinAppEx:: InitContextMenuManager](#initcontextmenumanager)|Inicializa el objeto `CContextMenuManager`.|
|[CWinAppEx:: InitKeyboardManager](#initkeyboardmanager)|Inicializa el objeto `CKeyboardManager`.|
|[CWinAppEx:: InitMouseManager](#initmousemanager)|Inicializa el objeto `CMouseManager`.|
|[CWinAppEx:: InitShellManager](#initshellmanager)|Inicializa la clase `CShellManager`|
|[CWinAppEx:: InitTooltipManager](#inittooltipmanager)|Inicializa la clase `CTooltipManager`.|
|[CWinAppEx:: IsResourceSmartUpdate](#isresourcesmartupdate)||
|[CWinAppEx:: IsStateExists](#isstateexists)|Indica si la clave especificada está en el registro.|
|[CWinAppEx:: LoadState](#loadstate)|Carga el estado de la aplicación desde el registro.|
|[CWinAppEx:: OnAppContextHelp](#onappcontexthelp)|Lo llama el marco de trabajo cuando el usuario solicita ayuda contextual para el cuadro de diálogo de **Personalización** .|
|[CWinAppEx:: OnViewDoubleClick](#onviewdoubleclick)|Llama al comando definido por el usuario cuando el usuario hace doble clic en cualquier parte de la aplicación.|
|[CWinAppEx:: OnWorkspaceIdle](#onworkspaceidle)||
|[CWinAppEx:: SaveState](#savestate)|Escribe el estado del marco de trabajo de la aplicación en el registro de Windows.|
|[CWinAppEx:: SetRegistryBase](#setregistrybase)|Establece la ruta de acceso de la clave del registro predeterminada. Esta clave servirá como raíz para todas las llamadas posteriores del registro.|
|[CWinAppEx:: ShowPopupMenu](#showpopupmenu)|Muestra un menú emergente.|
|[CWinAppEx:: WriteBinary](#writebinary)|Escribe los datos binarios en el valor del registro especificado.|
|[CWinAppEx:: WriteInt](#writeint)|Escribe los datos numéricos en el valor del registro especificado.|
|[CWinAppEx:: WriteObject](#writeobject)|Escribe datos que se derivan de la [clase CObject](../../mfc/reference/cobject-class.md) en el valor del registro especificado.|
|[CWinAppEx:: WriteSectionBinary](#writesectionbinary)|Escribe los datos binarios en un valor de la clave del registro especificada.|
|[CWinAppEx:: WriteSectionInt](#writesectionint)|Escribe los datos numéricos en un valor de la clave del registro especificada.|
|[CWinAppEx:: WriteSectionObject](#writesectionobject)|Escribe datos derivados de la clase `CObject` en un valor de la clave del registro especificada.|
|[CWinAppEx:: WriteSectionString](#writesectionstring)|Escribe los datos de cadena en un valor de la clave del registro especificada.|
|[CWinAppEx:: WriteString](#writestring)|Escribe los datos de cadena en el valor del registro especificado.|

### <a name="protected-methods"></a>Métodos protegidos

|Nombre|Descripción|
|----------|-----------------|
|[CWinAppEx:: LoadCustomState](#loadcustomstate)|Lo llama el marco de trabajo cuando se ha cargado el estado de la aplicación.|
|[CWinAppEx:: LoadWindowPlacement](#loadwindowplacement)|Lo llama el marco de trabajo cuando carga el tamaño y la ubicación de la aplicación desde el registro. Los datos cargados incluyen el tamaño y la ubicación del fotograma principal en el momento en que la aplicación se cerró por última vez.|
|[CWinAppEx:: OnClosingMainFrame](#onclosingmainframe)|Lo llama el marco de trabajo cuando una ventana de marco principal está procesando WM_CLOSE.|
|[CWinAppEx::P reLoadState](#preloadstate)|Lo llama el marco de trabajo inmediatamente antes de que se cargue el estado de la aplicación.|
|[CWinAppEx::P reSaveState](#presavestate)|Lo llama el marco de trabajo inmediatamente antes de guardar el estado de la aplicación.|
|[CWinAppEx:: ReloadWindowPlacement](#reloadwindowplacement)|Recarga el tamaño y la ubicación de la ventana proporcionada desde el registro.|
|[CWinAppEx:: SaveCustomState](#savecustomstate)|Lo llama el marco de trabajo después de escribir el estado de la aplicación en el registro.|
|[CWinAppEx:: StoreWindowPlacement](#storewindowplacement)|Lo llama el marco de trabajo para escribir el tamaño y la ubicación del marco principal en el registro.|

### <a name="data-members"></a>Miembros de datos

|Nombre|Descripción|
|----------|-----------------|
|[CWinAppEx:: m_bForceImageReset](#m_bforceimagereset)|Especifica si el marco restablecerá todas las imágenes de la barra de herramientas cuando se cargue la ventana de marco que contiene la barra de herramientas.|

## <a name="remarks"></a>Observaciones

Gran parte de la funcionalidad proporcionada por el marco de trabajo de MFC depende de la clase `CWinAppEx`. Puede incorporar la clase `CWinAppEx` a la aplicación de una de estas dos maneras:

- Construya una clase `CWinAppEx` en el subproceso principal.

- Derive la clase de aplicación principal de `CWinAppEx`.

Después de incorporar `CWinAppEx` a la aplicación, puede inicializar cualquiera de los administradores de la aplicación. Antes de utilizar un administrador de aplicaciones, debe inicializarlo mediante una llamada al método de inicialización adecuado. Para obtener un puntero a un administrador específico, llame al método get asociado. La clase `CWinAppEx` administra los siguientes administradores de aplicación: [clase CMouseManager](../../mfc/reference/cmousemanager-class.md), clase [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), clase [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md), clase [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)y [clase CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md).

## <a name="inheritance-hierarchy"></a>Jerarquía de herencia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

[CWinApp](../../mfc/reference/cwinapp-class.md)

[CWinAppEx](../../mfc/reference/cwinappex-class.md)

## <a name="requirements"></a>Requisitos

**Encabezado:** afxwinappex. h

##  <a name="cleanstate"></a>CWinAppEx:: CleanState

Quita toda la información sobre la aplicación del registro de Windows.

```
virtual BOOL CleanState(LPCTSTR lpszSectionName=NULL);
```

### <a name="parameters"></a>Parámetros

*lpszSectionName*<br/>
de Una cadena que contiene una ruta de acceso de una clave del registro.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método se realizó correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Este método borra los datos de la aplicación de una sección específica del registro. Puede especificar la sección que se va a borrar mediante el parámetro *lpszSectionName*. Si *lpszSectionName* es null, este método usará la ruta de acceso predeterminada del registro almacenada en el objeto `CWinAppEx`. Para obtener la ruta de acceso predeterminada del registro, use [CWinAppEx:: GetRegistryBase](#getregistrybase).

##  <a name="cwinappex"></a>CWinAppEx:: CWinAppEx

Construye un objeto `CWinAppEx`.

```
CWinAppEx(BOOL bResourceSmartUpdate = FALSE);
```

### <a name="parameters"></a>Parámetros

*bResourceSmartUpdate*<br/>
de Parámetro booleano que especifica si el objeto de área de trabajo debe detectar y controlar las actualizaciones de recursos.

### <a name="remarks"></a>Observaciones

La clase `CWinAppEx` tiene métodos de inicialización, proporciona funcionalidad para guardar y cargar la información de la aplicación en el registro y controla la configuración global de la aplicación. También permite usar administradores globales, como la [clase CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) y la [clase CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md). Cada aplicación solo puede tener una instancia de la clase `CWinAppEx`.

##  <a name="enableloadwindowplacement"></a>CWinAppEx:: EnableLoadWindowPlacement

Especifica si la aplicación cargará el tamaño y la ubicación iniciales de la ventana de marco principal del registro.

```
void EnableLoadWindowPlacement(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Parámetros

*bEnable*<br/>
de Especifica si la aplicación carga el tamaño y la ubicación iniciales de la ventana de marco principal del registro.

### <a name="remarks"></a>Observaciones

De forma predeterminada, el tamaño y la ubicación del fotograma principal se cargan desde el registro junto con otras opciones de configuración de la aplicación. Esto sucede durante [CWinAppEx:: Loadstate](#loadstate). Si no desea cargar la ubicación inicial de la ventana desde el registro, llame a este método con *bEnable* establecido en false.

##  <a name="enabletearoffmenus"></a>CWinAppEx:: EnableTearOffMenus

Crea e inicializa un objeto [CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md) .

```
BOOL EnableTearOffMenus(
    LPCTSTR lpszRegEntry,
    const UINT uiCmdFirst,
    const UINT uiCmdLast);
```

### <a name="parameters"></a>Parámetros

*lpszRegEntry*<br/>
de Cadena que contiene la ruta de acceso de una clave del registro. La aplicación utiliza esta clave del registro para almacenar información de los menús de recorte.

*uiCmdFirst*<br/>
de Primer identificador de menú desactivado.

*uiCmdLast*<br/>
de Último identificador de menú que se ha anulado.

### <a name="return-value"></a>Valor devuelto

TRUE si el `CMenuTearOffManager` se crea y se inicializa correctamente; FALSE si se produce un error o si el `CMenuTearOffManager` ya existe.

### <a name="remarks"></a>Observaciones

Use esta función para habilitar los menús de recorte en la aplicación. Debe llamar a esta función desde `InitInstance`.

##  <a name="enableusertools"></a>CWinAppEx:: EnableUserTools

Permite al usuario crear comandos de menú personalizados que reducen las pulsaciones de tecla en la aplicación. Este método crea un objeto [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) .

```
BOOL EnableUserTools(
    const UINT uiCmdToolsDummy,
    const UINT uiCmdFirst,
    const UINT uiCmdLast,
    CRuntimeClass* pToolRTC = RUNTIME_CLASS(CUserTool),
    UINT uArgMenuID = 0,
    UINT uInitDirMenuID = 0);
```

### <a name="parameters"></a>Parámetros

*uiCmdToolsDummy*<br/>
de Entero sin signo que el marco de trabajo usa como marcador de posición para el identificador de comando del menú herramientas de usuario.

*uiCmdFirst*<br/>
de IDENTIFICADOR de comando para el primer comando de la herramienta de usuario.

*uiCmdLast*<br/>
de El identificador de comando para el último comando de la herramienta de usuario.

*pToolRTC*<br/>
de Una clase que el objeto `CUserToolsManager` usa para crear nuevas herramientas de usuario.

*uArgMenuID*<br/>
de IDENTIFICADOR de menú de argumento.

*uInitDirMenuID*<br/>
de El identificador de menú del directorio inicial de la herramienta.

### <a name="return-value"></a>Valor devuelto

TRUE si el método crea e inicializa un objeto `CUserToolsManager`; FALSE si el método produce un error o si ya existe un objeto de `CUserToolsManager`.

### <a name="remarks"></a>Observaciones

Cuando se habilitan las herramientas definidas por el usuario, el marco de trabajo admite automáticamente un menú dinámico que se puede extender durante la personalización. El marco asocia cada nuevo elemento a un comando externo. El marco de trabajo invoca estos comandos cuando el usuario selecciona el elemento adecuado en el menú **herramientas** .

Cada vez que el usuario agrega un nuevo elemento, el marco de trabajo crea un nuevo objeto. El tipo de clase para el nuevo objeto se define mediante *pToolRTC*. El tipo de clase *pToolRTC* se debe derivar de la [clase CUserTool](../../mfc/reference/cusertool-class.md).

Para obtener más información sobre las herramientas de usuario y cómo incorporarlas a la aplicación, consulte [herramientas definidas por el usuario](../../mfc/user-defined-tools.md).

##  <a name="exitinstance"></a>CWinAppEx:: ExitInstance

```
virtual int ExitInstance();
```

### <a name="return-value"></a>Valor devuelto

### <a name="remarks"></a>Observaciones

##  <a name="getbinary"></a>CWinAppEx:: GetBinary

Lee datos binarios de una clave del registro especificada.

```
BOOL GetBinary(
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
de Cadena que contiene el nombre de una clave del registro.

*ppData*<br/>
enuncia Puntero al búfer que el método rellena con los datos binarios.

*pBytes*<br/>
enuncia Un puntero a un entero sin signo que el método utiliza para escribir el número de bytes leídos.

### <a name="return-value"></a>Valor devuelto

TRUE si es correcto; De lo contrario, FALSE.

### <a name="remarks"></a>Observaciones

Este método lee los datos binarios escritos en el registro. Para escribir datos en el registro, use los métodos [CWinAppEx:: WriteBinary](#writebinary) y [CWinAppEx:: WriteSectionBinary](#writesectionbinary).

El parámetro *lpszEntry* es el nombre de una entrada del registro que se encuentra en la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getcontextmenumanager"></a>CWinAppEx:: GetContextMenuManager

Devuelve un puntero al objeto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) global.

```
CContextMenuManager* GetContextMenuManager();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto de `CContextMenuManager` global.

### <a name="remarks"></a>Observaciones

Si no se inicializa el objeto CContextMenuManager, esta función llama a [CWinAppEx:: InitContextMenuManager](#initcontextmenumanager) antes de devolver un puntero.

##  <a name="getdataversion"></a>CWinAppEx:: GetDataVersion

```
int GetDataVersion() const;
```

### <a name="return-value"></a>Valor devuelto

### <a name="remarks"></a>Observaciones

##  <a name="getdataversionmajor"></a>CWinAppEx:: GetDataVersionMajor

Devuelve la versión principal de la aplicación que se guarda en el registro de Windows cuando se llama a [CWinAppEx:: SaveState](#savestate).

```
int GetDataVersionMajor() const;
```

### <a name="return-value"></a>Valor devuelto

Valor entero que contiene el número de versión principal.

##  <a name="getdataversionminor"></a>CWinAppEx:: GetDataVersionMinor

Devuelve la versión secundaria de la aplicación que se guarda en el registro de Windows cuando se llama a [CWinAppEx:: SaveState](#savestate).

```
int GetDataVersionMinor() const;
```

### <a name="return-value"></a>Valor devuelto

Valor entero que contiene el número de versión secundaria.

##  <a name="getint"></a>CWinAppEx:: GetInt

Lee datos enteros de una clave del registro especificada.

```
int GetInt(
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
de Cadena que contiene el nombre de una entrada del registro.

*nDefault*<br/>
de Valor predeterminado que el método devuelve si la entrada del registro especificada no existe.

### <a name="return-value"></a>Valor devuelto

Los datos del registro si el método se realizó correctamente; de lo contrario, *nDefault*.

### <a name="remarks"></a>Observaciones

Este método lee los datos enteros del registro. Si no hay ningún dato entero asociado a la clave del registro indicada por *lpszEntry*, este método devuelve *nDefault*. Para escribir datos en el registro, use los métodos [CWinAppEx:: WriteSectionInt](#writesectionint) y [CWinAppEx:: WriteInt](#writeint).

El parámetro *lpszEntry* es el nombre de una entrada del registro que se encuentra en la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getkeyboardmanager"></a>CWinAppEx:: GetKeyboardManager

Devuelve un puntero al objeto [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) global.

```
CKeyboardManager* GetKeyboardManager();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto de `CKeyboardManager` global.

### <a name="remarks"></a>Observaciones

Si no se inicializa el administrador de teclado, esta función llama a [CWinAppEx:: InitKeyboardManager](#initkeyboardmanager) antes de devolver un puntero.

##  <a name="getmousemanager"></a>CWinAppEx:: GetMouseManager

Devuelve un puntero al objeto [CMouseManager](../../mfc/reference/cmousemanager-class.md) global.

```
CMouseManager* GetMouseManager();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto de `CMouseManager` global.

### <a name="remarks"></a>Observaciones

Si no se inicializa el administrador del mouse, esta función llama a [CWinAppEx:: InitMouseManager](#initmousemanager) antes de devolver un puntero.

##  <a name="getobject"></a>CWinAppEx:: GetObject

Lee los datos de [CObject](../../mfc/reference/cobject-class.md)-derivado del registro.

```
BOOL GetObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
de Cadena que contiene la ruta de acceso relativa de una entrada del registro.

*obj*<br/>
enuncia Referencia a un `CObject`. El método utiliza esta referencia para almacenar los datos del registro.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método se realizó correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Observaciones

Este método lee los datos del registro que se derivan de `CObject`. Para escribir `CObject` datos en el registro, use [CWinAppEx:: writeObject](#writeobject) o [CWinAppEx:: WriteSectionObject](#writesectionobject).

El parámetro *lpszEntry* es el nombre de una entrada del registro que se encuentra en la clave predeterminada del registro de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getregistrybase"></a>CWinAppEx:: GetRegistryBase

Recupera la ruta de acceso predeterminada del registro para la aplicación.

```
LPCTSTR GetRegistryBase();
```

### <a name="return-value"></a>Valor devuelto

Cadena que contiene la ruta de acceso de la ubicación del registro predeterminada.

### <a name="remarks"></a>Observaciones

Todos los métodos de la [clase CWinAppEx](../../mfc/reference/cwinappex-class.md) que tienen acceso al registro se inician en una ubicación predeterminada. Utilice este método para recuperar una ruta de acceso de la ubicación del registro predeterminada. Use [CWinAppEx:: SetRegistryBase](#setregistrybase) para cambiar la ubicación predeterminada del registro.

##  <a name="getregsectionpath"></a>CWinAppEx:: GetRegSectionPath

Crea y devuelve la ruta de acceso absoluta de una clave del registro.

```
CString GetRegSectionPath(LPCTSTR szSectionAdd = _T(""));
```

### <a name="parameters"></a>Parámetros

*szSectionAdd*<br/>
de Cadena que contiene la ruta de acceso relativa de una clave del registro.

### <a name="return-value"></a>Valor devuelto

`CString` que contiene la ruta de acceso absoluta de una clave del registro.

### <a name="remarks"></a>Observaciones

Este método define la ruta de acceso absoluta de la clave del registro anexando la ruta de acceso relativa en *szSectionAdd* a la ubicación del registro predeterminada para la aplicación. Para obtener la clave del registro predeterminada, use el método [CWinAppEx:: GetRegistryBase](#getregistrybase).

##  <a name="getsectionbinary"></a>CWinAppEx:: GetSectionBinary

Lee datos binarios del registro.

```
BOOL GetSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
de Cadena que contiene la ruta de acceso relativa de una clave del registro.

*lpszEntry*<br/>
de Cadena que contiene el valor que se va a leer.

*ppData*<br/>
enuncia Puntero al búfer donde el método almacena los datos.

*pBytes*<br/>
enuncia Puntero a un entero sin signo. El método escribe el tamaño de *ppData* en este parámetro.

### <a name="return-value"></a>Valor devuelto

TRUE si es correcto; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

Este método lee los datos binarios que se escriben en el registro mediante los métodos [CWinAppEx:: WriteBinary](#writebinary) y [CWinAppEx:: WriteSectionBinary](#writesectionbinary).

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del registro. Se trata de una ruta de acceso relativa que se anexa al final de la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getsectionint"></a>CWinAppEx:: GetSectionInt

Lee datos enteros del registro.

```
int GetSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
de Cadena que contiene la ruta de acceso relativa de una clave del registro.

*lpszEntry*<br/>
de Cadena que contiene el valor que se va a leer.

*nDefault*<br/>
de Valor predeterminado que se va a devolver si el valor especificado no existe.

### <a name="return-value"></a>Valor devuelto

Los datos enteros que se almacenan en el valor del registro especificado; *nDefault* si los datos no existen.

### <a name="remarks"></a>Observaciones

Use los métodos [CWinAppEx:: WriteInt](#writeint) y [CWinAppEx:: WriteSectionInt](#writesectionint) para escribir datos enteros en el registro.

El parámetro *lpszSubSection* no es una ruta de acceso absoluta de una entrada del registro. Se trata de una ruta de acceso relativa que se agrega al final de la clave del registro predeterminada para la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getsectionobject"></a>CWinAppEx:: GetSectionObject

Lee los datos del registro de [CObject](../../mfc/reference/cobject-class.md) del registro.

```
BOOL GetSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
de Cadena que contiene la ruta de acceso relativa de una clave del registro.

*lpszEntry*<br/>
de Cadena que contiene el valor que se va a leer.

*obj*<br/>
enuncia Referencia a un `CObject`. El método utiliza este `CObject` para almacenar los datos del registro.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Este método lee los datos del registro. La lectura de datos se `CObject` datos o datos para una clase derivada de `CObject`. Para escribir `CObject` datos en el registro, use [CWinAppEx:: writeObject](#writeobject) o [CWinAppEx:: WriteSectionObject](#writesectionobject).

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del registro. Se trata de una ruta de acceso relativa que se anexa al final de la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getsectionstring"></a>CWinAppEx:: GetSectionString

Lee datos de cadena del registro.

```
CString GetSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = _T(""));
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
de Cadena que contiene la ruta de acceso relativa de una clave del registro.

*lpszEntry*<br/>
de Cadena que contiene el valor que se va a leer.

*lpszDefault*<br/>
de Valor predeterminado que se va a devolver si el valor especificado no existe.

### <a name="return-value"></a>Valor devuelto

Los datos de cadena almacenados en el valor del registro especificado si los datos existen; de lo contrario, *lpszDefault*.

### <a name="remarks"></a>Observaciones

Este método lee los datos de cadena escritos en el registro. Use [CWinAppEx:: WriteString](#writestring) y [CWinAppEx:: WriteSectionString](#writesectionstring) para escribir datos de cadena en el registro.

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del registro. Se trata de una ruta de acceso relativa que se anexa al final de la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getshellmanager"></a>CWinAppEx:: GetShellManager

Devuelve un puntero al objeto [CShellManager](../../mfc/reference/cshellmanager-class.md) global.

```
CShellManager* GetShellManager();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto de `CShellManager` global.

### <a name="remarks"></a>Observaciones

Si no se inicializa el objeto de `CShellManager`, esta función llama a [CWinAppEx:: InitShellManager](#initshellmanager) antes de devolver un puntero.

##  <a name="getstring"></a>CWinAppEx:: GetString

Lee datos de cadena de una clave del registro especificada.

```
CString GetString(
    LPCTSTR lpszEntry,
    LPCTSTR lpzDefault= _T(""));
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
de Cadena que contiene el nombre de una clave del registro.

*lpzDefault*<br/>
de Valor predeterminado que el método devuelve si la entrada del registro especificada no existe.

### <a name="return-value"></a>Valor devuelto

Los datos de cadena almacenados en el registro si se realizan correctamente; de lo contrario, *lpszDefault* .

### <a name="remarks"></a>Observaciones

Este método lee los datos de cadena escritos en el registro. Para escribir datos en el registro, use los métodos [CWinAppEx:: WriteString](#writestring) o [CWinAppEx:: WriteSectionString](#writesectionstring).

El parámetro *lpszEntry* es el nombre de una entrada del registro que se encuentra en la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="gettooltipmanager"></a>CWinAppEx:: GetTooltipManager

Devuelve un puntero al objeto [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) global.

```
CTooltipManager* GetTooltipManager();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto de `CTooltipManager` global.

### <a name="remarks"></a>Observaciones

Si no se inicializa el objeto de `CTooltipManager`, esta función llama a [CWinAppEx:: InitTooltipManager](#inittooltipmanager) antes de devolver un puntero.

##  <a name="getusertoolsmanager"></a>CWinAppEx:: GetUserToolsManager

Devuelve un puntero al objeto [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) global.

```
CUserToolsManager* GetUserToolsManager();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto de `CUserToolsManager` global; NULL si la administración de herramientas de usuario no está habilitada para la aplicación.

### <a name="remarks"></a>Observaciones

Antes de recuperar un puntero al objeto `CUserToolsManager`, debe inicializar el administrador mediante una llamada a [CWinAppEx:: EnableUserTools](#enableusertools).

##  <a name="initcontextmenumanager"></a>CWinAppEx:: InitContextMenuManager

Inicializa el objeto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) .

```
BOOL InitContextMenuManager();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método crea el objeto CContextMenuManager; 0 si el objeto de `CContextMenuManager` ya existe.

### <a name="remarks"></a>Observaciones

Si llama a [CWinAppEx:: GetContextMenuManager](#getcontextmenumanager), la implementación predeterminada de ese método llama a `InitContextMenuManager`.

Si la aplicación ya tiene un administrador de menús contextuales y llama a `InitContextMenuManager`, la aplicación tendrá un error de [aserción](diagnostic-services.md#assert) . Por lo tanto, no debe llamar a `InitContextMenuManager` si crea directamente un objeto `CContextMenuManager`. Si no está utilizando un `CContextMenuManager`personalizado, debe utilizar `GetContextMenuManager` para crear un objeto `CContextMenuManager`.

##  <a name="initkeyboardmanager"></a>CWinAppEx:: InitKeyboardManager

Inicializa el objeto [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) .

```
BOOL InitKeyboardManager();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método crea el objeto `CKeyboardManager`; 0 si el objeto de `CKeyboardManager` ya existe.

### <a name="remarks"></a>Observaciones

Si llama a [CWinAppEx:: GetKeyboardManager](#getkeyboardmanager), la implementación predeterminada de ese método llama a `InitKeyboardManager`.

Si la aplicación ya tiene un administrador de teclado y llama a `InitKeyboardManager`, la aplicación tendrá un error de [aserción](diagnostic-services.md#assert) . Por lo tanto, no debe llamar a `InitKeyboardManager` si crea directamente un objeto `CKeyboardManager`. Si no está utilizando un `CKeyboardManager`personalizado, debe utilizar `GetKeyboardManager` para crear un objeto `CKeyboardManager`.

##  <a name="initmousemanager"></a>CWinAppEx:: InitMouseManager

Inicializa el objeto [CMouseManager](../../mfc/reference/cmousemanager-class.md) .

```
BOOL InitMouseManager();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método crea el objeto `CMouseManager`; 0 si el objeto de `CMouseManager` ya existe.

### <a name="remarks"></a>Observaciones

Si llama a [CWinAppEx:: GetMouseManager](#getmousemanager), la implementación predeterminada de ese método llama a `InitMouseManager`.

Si la aplicación ya tiene un administrador del mouse y llama a `InitMouseManager`, la aplicación tendrá un error de [aserción](diagnostic-services.md#assert) . Por lo tanto, no debe llamar a `InitMouseManager` si crea directamente un objeto `CMouseManager`. Si no está utilizando un `CMouseManager`personalizado, debe utilizar `GetMouseManager` para crear un objeto `CMouseManager`.

##  <a name="initshellmanager"></a>CWinAppEx:: InitShellManager

Inicializa el objeto [CShellManager](../../mfc/reference/cshellmanager-class.md) .

```
BOOL InitShellManager();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método crea el objeto `CShellManager`; 0 si el objeto de `CShellManager` ya existe.

### <a name="remarks"></a>Observaciones

Si llama a [CWinAppEx:: GetShellManager](#getshellmanager), la implementación predeterminada de ese método llama a `InitShellManager`.

Si la aplicación ya tiene un administrador de Shell y llama a `InitShellManager`, la aplicación genera un error de [aserción](diagnostic-services.md#assert) . Por lo tanto, no llame a `InitShellManager` si crea un objeto `CShellManager` directamente. Si no está utilizando un `CShellManager`personalizado, use `GetShellManager` para crear un objeto `CShellManager`.

##  <a name="inittooltipmanager"></a>CWinAppEx:: InitTooltipManager

Inicializa el objeto [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) .

```
BOOL InitTooltipManager();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método crea el objeto `CTooltipManager`; 0 si el objeto de `CTooltipManager` ya existe.

### <a name="remarks"></a>Observaciones

Si llama a [CWinAppEx:: GetTooltipManager](#gettooltipmanager), la implementación predeterminada de ese método llama a `InitTooltipManager`.

Si la aplicación ya tiene un administrador de información sobre herramientas y llama a `InitTooltipManager`, la aplicación tendrá un error de [aserción](diagnostic-services.md#assert) . Por lo tanto, no debe llamar a `InitTooltipManager` si crea directamente un objeto `CTooltipManager`. Si no está utilizando un `CTooltipManager`personalizado, debe utilizar `GetTooltipManager` para crear un objeto `CTooltipManager`.

##  <a name="isresourcesmartupdate"></a>CWinAppEx:: IsResourceSmartUpdate

```
BOOL IsResourceSmartUpdate() const;
```

### <a name="return-value"></a>Valor devuelto

### <a name="remarks"></a>Observaciones

##  <a name="isstateexists"></a>CWinAppEx:: IsStateExists

Indica si la clave especificada está en el registro.

```
BOOL IsStateExists(LPCTSTR lpszSectionName);
```

### <a name="parameters"></a>Parámetros

*lpszSectionName*<br/>
de Una cadena que contiene una ruta de acceso de una clave del registro.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la clave está en el registro; de lo contrario, es 0.

##  <a name="loadcustomstate"></a>CWinAppEx:: LoadCustomState

El marco de trabajo llama a este método después de cargar el estado de la aplicación desde el registro.

```
virtual void LoadCustomState();
```

### <a name="remarks"></a>Observaciones

Invalide este método si desea realizar cualquier procesamiento después de que la aplicación cargue el estado del registro. De forma predeterminada, este método no hace nada.

Para cargar la información de estado personalizada del registro, primero se debe guardar la información mediante [CWinAppEx:: SaveCustomState](#savecustomstate).

##  <a name="loadstate"></a>CWinAppEx:: LoadState

Lee el estado de la aplicación del registro de Windows.

```
BOOL LoadState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

virtual BOOL LoadState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);
```

### <a name="parameters"></a>Parámetros

*pFrame*<br/>
de Un puntero a un objeto de ventana de marco. El método aplica la información de estado en el registro a esta ventana de marco.

*lpszSectionName*<br/>
de Cadena que contiene la ruta de acceso relativa de una clave del registro.

*pFrameImpl*<br/>
de Puntero a un objeto `CFrameImpl`. El método aplica la información de estado en el registro a esta ventana de marco.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

Este método carga el estado de la aplicación y cualquier información de estado de una ventana de marco. La información cargada para la ventana de marco se aplica a la ventana de marco proporcionada. Si no proporciona una ventana de marco, solo se carga la información de estado de la aplicación. La información de la aplicación incluye el estado de la [clase CMouseManager](../../mfc/reference/cmousemanager-class.md), la clase [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), la clase [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)y la [clase CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md).

La implementación predeterminada de `CFrameImpl::OnLoadFrame` llama a `LoadState`.

El parámetro *lpszSectionName* no es la ruta de acceso absoluta de una entrada del registro. Se trata de una ruta de acceso relativa que se agrega al final de la clave del registro predeterminada para la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="loadwindowplacement"></a>CWinAppEx:: LoadWindowPlacement

Lo llama el marco de trabajo cuando carga el tamaño y la ubicación de la ventana de marco principal del registro.

```
virtual BOOL LoadWindowPlacement(
    CRect& rectNormalPosition,
    int& nFlags,
    int& nShowCmd);
```

### <a name="parameters"></a>Parámetros

*rectNormalPosition*<br/>
enuncia Rectángulo que contiene las coordenadas de la ventana de marco principal cuando se encuentra en la posición restaurada.

*nFlags*<br/>
enuncia Marcas que controlan la posición de la ventana minimizada y el modo en que el sistema operativo cambia entre una ventana minimizada y una ventana restaurada.

*nShowCmd*<br/>
enuncia Un entero que especifica el estado de presentación de la ventana. Para obtener más información sobre los valores posibles, vea [CWnd:: ShowWindow](../../mfc/reference/cwnd-class.md#showwindow).

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

De forma predeterminada, MFC carga automáticamente la posición y el estado anteriores de la ventana de marco principal cuando se inicia la aplicación. Para obtener más información sobre cómo se almacena esta información en el registro, vea [CWinAppEx:: StoreWindowPlacement](#storewindowplacement).

Invalide este método si desea cargar información adicional sobre la ventana de marco principal.

##  <a name="m_bforceimagereset"></a>CWinAppEx:: m_bForceImageReset

Especifica si el marco restablece todas las imágenes de la barra de herramientas cuando vuelve a cargar la ventana de marco que contiene la barra de herramientas.

```
BOOL m_bForceImageReset;
```

### <a name="remarks"></a>Observaciones

El miembro de datos `m_bForceImageReset` es una variable protegida.

##  <a name="onappcontexthelp"></a>CWinAppEx:: OnAppContextHelp

El marco de trabajo llama a este método cuando el usuario solicita ayuda contextual para el cuadro de diálogo de **Personalización** .

```
virtual void OnAppContextHelp(
    CWnd* pWndControl,
    const DWORD dwHelpIDArray[]);
```

### <a name="parameters"></a>Parámetros

*pWndControl*<br/>
de Un puntero a un objeto de ventana para el que el usuario invocó la ayuda contextual.

*dwHelpIDArray[]*<br/>
de Valor reservado.

### <a name="remarks"></a>Observaciones

Este método está reservado actualmente para uso futuro. La implementación predeterminada no realiza ninguna acción y el marco de trabajo no lo llama actualmente.

##  <a name="onclosingmainframe"></a>CWinAppEx:: OnClosingMainFrame

El marco de trabajo llama a este método cuando una ventana de marco está procesando WM_CLOSE.

```
virtual void OnClosingMainFrame(CFrameImpl* pFrameImpl);
```

### <a name="parameters"></a>Parámetros

*pFrameImpl*<br/>
de Puntero a un objeto `CFrameImpl`.

### <a name="remarks"></a>Observaciones

La implementación predeterminada de este método guarda el estado de *pFrameImpl*.

##  <a name="onviewdoubleclick"></a>CWinAppEx:: OnViewDoubleClick

Llama al comando definido por el usuario que está asociado a una vista cuando el usuario hace doble clic en cualquier parte dentro de esa vista.

```
virtual BOOL OnViewDoubleClick(
    CWnd* pWnd,
    int iViewId);
```

### <a name="parameters"></a>Parámetros

*pWnd*<br/>
de Un puntero a un objeto derivado de la [clase CView](../../mfc/reference/cview-class.md).

*iViewId*<br/>
de IDENTIFICADOR de la vista.

### <a name="return-value"></a>Valor devuelto

TRUE si el marco de trabajo encuentra un comando; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

Para admitir el comportamiento personalizado del mouse, debe llamar a esta función al procesar el mensaje de WM_LBUTTONDBLCLK. Este método ejecutará el comando asociado al identificador de vista proporcionado por *iViewId*. Para obtener más información sobre el comportamiento personalizado del mouse, consulte [Personalización del teclado y del mouse](../../mfc/keyboard-and-mouse-customization.md).

##  <a name="onworkspaceidle"></a>CWinAppEx:: OnWorkspaceIdle

```
virtual BOOL OnWorkspaceIdle(CWnd*);
```

### <a name="parameters"></a>Parámetros

de *CWnd&#38;*<br/>

### <a name="return-value"></a>Valor devuelto

### <a name="remarks"></a>Observaciones

##  <a name="preloadstate"></a>CWinAppEx::P reLoadState

El marco de trabajo llama a este método inmediatamente antes de cargar el estado de la aplicación desde el registro.

```
virtual void PreLoadState();
```

### <a name="remarks"></a>Observaciones

Invalide este método si desea realizar cualquier procesamiento inmediatamente antes de que el marco de trabajo cargue el estado de la aplicación.

##  <a name="presavestate"></a>CWinAppEx::P reSaveState

El marco de trabajo llama a este método inmediatamente antes de guardar el estado de la aplicación.

```
virtual void PreSaveState();
```

### <a name="remarks"></a>Observaciones

Invalide este método si desea realizar cualquier procesamiento inmediatamente antes de que el marco de trabajo guarde el estado de la aplicación.

##  <a name="reloadwindowplacement"></a>CWinAppEx:: ReloadWindowPlacement

Recarga el tamaño y la ubicación de una ventana del registro.

```
virtual BOOL ReloadWindowPlacement(CFrameWnd* pFrame);
```

### <a name="parameters"></a>Parámetros

*pFrame*<br/>
de Puntero a una ventana de marco.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método se realizó correctamente; 0 si se produjo un error en la carga o no hay datos para cargar.

### <a name="remarks"></a>Observaciones

Use la función [CWinAppEx:: StoreWindowPlacement](#storewindowplacement) para escribir el tamaño y la ubicación de una ventana en el registro.

##  <a name="savecustomstate"></a>CWinAppEx:: SaveCustomState

El marco de trabajo llama a este método después de guardar el estado de la aplicación en el registro.

```
virtual void SaveCustomState();
```

### <a name="remarks"></a>Observaciones

Invalide este método si desea realizar cualquier procesamiento después de que la aplicación guarde el estado en el registro. De forma predeterminada, este método no hace nada.

##  <a name="savestate"></a>CWinAppEx:: SaveState

Escribe el estado de la aplicación en el registro de Windows.

```
virtual BOOL SaveState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);

BOOL SaveState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>Parámetros

*lpszSectionName*<br/>
de Cadena que contiene la ruta de acceso relativa de una clave del registro.

*pFrameImpl*<br/>
de Puntero a un objeto `CFrameImpl`. Este marco se guarda en el registro de Windows.

*pFrame*<br/>
de Un puntero a un objeto de ventana de marco. Este marco se guarda en el registro de Windows.

### <a name="return-value"></a>Valor devuelto

TRUE si es correcto; De lo contrario, FALSE.

### <a name="remarks"></a>Observaciones

Este método guarda el estado de la aplicación y cualquier información de estado de la ventana de marco proporcionada. Si no proporciona una ventana de marco, el método solo guarda el estado de la aplicación. La información de la aplicación incluye el estado de la [clase CMouseManager](../../mfc/reference/cmousemanager-class.md), la clase [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), la clase [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)y la [clase CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md).

El parámetro *lpszSectionName* no es la ruta de acceso absoluta de una entrada del registro. Se trata de una ruta de acceso relativa que se anexa al final de la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="setregistrybase"></a>CWinAppEx:: SetRegistryBase

Establece la ruta de acceso predeterminada del registro para la aplicación.

```
LPCTSTR SetRegistryBase(LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>Parámetros

*lpszSectionName*<br/>
de Cadena que contiene la ruta de acceso de una clave del registro.

### <a name="return-value"></a>Valor devuelto

Cadena que contiene la ruta de acceso de la ubicación del registro predeterminada.

### <a name="remarks"></a>Observaciones

Todos los métodos de la [clase CWinAppEx](../../mfc/reference/cwinappex-class.md) que tienen acceso al registro se inician en una ubicación predeterminada. Utilice este método para cambiar la ubicación predeterminada del registro. Use [CWinAppEx:: GetRegistryBase](#getregistrybase) para recuperar la ubicación del registro predeterminada.

##  <a name="showpopupmenu"></a>CWinAppEx:: ShowPopupMenu

Muestra un menú emergente.

```
virtual BOOL ShowPopupMenu(
    UINT uiMenuResId,
    const CPoint& point,
    CWnd* pWnd);
```

### <a name="parameters"></a>Parámetros

*uiMenuResId*<br/>
de Un identificador de recurso de menú.

*Elija*<br/>
de [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) que especifica la posición del menú en coordenadas de la pantalla.

*pWnd*<br/>
de Un puntero a la ventana que posee el menú emergente.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el menú emergente se muestra correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

Este método muestra el menú asociado a *uiMenuResId*.

Para admitir menús emergentes, debe tener un objeto [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) . Si no ha inicializado el objeto de `CContextMenuManager`, `ShowPopupMenu` producirá un error.

##  <a name="storewindowplacement"></a>CWinAppEx:: StoreWindowPlacement

Lo llama el marco de trabajo para escribir el tamaño y la ubicación de la ventana de marco principal en el registro.

```
virtual BOOL StoreWindowPlacement(
    const CRect& rectNormalPosition,
    int nFlags,
    int nShowCmd);
```

### <a name="parameters"></a>Parámetros

*nFlags*<br/>
de Marcas que controlan la posición de la ventana minimizada y el modo en que el sistema operativo cambia entre una ventana minimizada y una ventana restaurada.

*nShowCmd*<br/>
de Un entero que especifica el estado de presentación de la ventana. Para obtener más información sobre los valores posibles, vea [CWnd:: ShowWindow](../../mfc/reference/cwnd-class.md#showwindow).

*rectNormalPosition*<br/>
de Rectángulo que contiene las coordenadas de la ventana de marco principal cuando se encuentra en estado restaurado.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

De forma predeterminada, MFC guarda automáticamente la posición y el estado de la ventana de marco principal antes de salir de la aplicación. Esta información se almacena en el registro de Windows en la clave Windowplacement (en la ubicación predeterminada del registro de la aplicación. Para obtener más información sobre la ubicación predeterminada del registro de la aplicación, vea [CWinAppEx:: GetRegistryBase](#getregistrybase).

Invalide este método si desea almacenar información adicional acerca de la ventana de marco principal.

##  <a name="writebinary"></a>CWinAppEx:: WriteBinary

Escribe datos binarios en el registro.

```
BOOL WriteBinary(
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
de Cadena que contiene el nombre de una clave del registro.

*pData*<br/>
de Datos que se van a almacenar.

*nBytes*<br/>
de Tamaño de *pdata* en bytes.

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

El parámetro *lpszEntry* es el nombre de una entrada del registro que se encuentra en la clave predeterminada del registro de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

Si no existe la clave especificada por *lpszEntry* , este método la creará.

##  <a name="writeint"></a>CWinAppEx:: WriteInt

Escribe datos numéricos en el registro.

```
BOOL WriteInt(
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
de Cadena que contiene el nombre de una clave del registro.

*Nvalor*<br/>
de Datos que se van a almacenar.

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

El parámetro *lpszEntry* es el nombre de una entrada del registro que se encuentra en la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

Si no existe la clave especificada por *lpszEntry* , este método la creará.

##  <a name="writeobject"></a>CWinAppEx:: WriteObject

Escribe en el registro los datos derivados de la [clase CObject](../../mfc/reference/cobject-class.md) .

```
BOOL WriteObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
de Cadena que contiene el valor que se va a establecer.

*obj*<br/>
de Referencia a `CObject` datos que almacenará el método.

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

Este método escribe los datos *obj* en el valor especificado en la clave del registro predeterminada. Use [CWinAppEx:: GetRegistryBase](#getregistrybase) para determinar la clave del registro actual.

##  <a name="writesectionbinary"></a>CWinAppEx:: WriteSectionBinary

Escribe datos binarios en un valor del registro.

```
BOOL WriteSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
de Cadena que contiene el nombre de una clave del registro.

*lpszEntry*<br/>
de Cadena que contiene el valor que se va a establecer.

*pData*<br/>
de Datos que se van a escribir en el registro.

*nBytes*<br/>
de Tamaño de *pdata* en bytes.

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

El parámetro *lpszSubSection* no es la ruta de acceso absoluta de una entrada del registro. Se trata de una ruta de acceso relativa que se anexa al final de la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

Si no existe la clave especificada por *lpszEntry* , este método la creará.

##  <a name="writesectionint"></a>CWinAppEx:: WriteSectionInt

Escribe datos numéricos en el registro.

```
BOOL WriteSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
de Cadena que contiene la ruta de acceso relativa de una clave del registro.

*lpszEntry*<br/>
de Cadena que contiene el valor que se va a establecer.

*Nvalor*<br/>
de Datos que se van a escribir en el registro.

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del registro. Se trata de una ruta de acceso relativa que se anexa a la clave predeterminada del registro de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

Si no existe la clave especificada por *lpszEntry* , este método la creará.

##  <a name="writesectionobject"></a>CWinAppEx:: WriteSectionObject

Escribe datos derivados de la [clase CObject](../../mfc/reference/cobject-class.md) en un valor del registro específico.

```
BOOL WriteSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
de Cadena que contiene el nombre de una clave del registro.

*lpszEntry*<br/>
de Cadena que contiene el nombre del valor que se va a establecer.

*obj*<br/>
de Datos que se van a almacenar.

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del registro. Se trata de una ruta de acceso relativa que se anexa al final de la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase), respectivamente.

Si el valor especificado por *lpszEntry* no existe en la clave del registro especificada por *lpszSubSection*, este método creará ese valor.

##  <a name="writesectionstring"></a>CWinAppEx:: WriteSectionString

Escribe datos de cadena en un valor del registro.

```
BOOL WriteSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
de Cadena que contiene el nombre de una clave del registro.

*lpszEntry*<br/>
de Cadena que contiene el valor que se va a establecer.

*lpszValue*<br/>
de Datos de cadena que se van a escribir en el registro.

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del registro. Se trata de una ruta de acceso relativa que se anexa al final de la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase), respectivamente.

Si el valor especificado por *lpszEntry* no existe en *lpszSubSection*, este método lo creará.

##  <a name="writestring"></a>CWinAppEx:: WriteString

Escribe datos de cadena en el registro.

```
BOOL WriteString(
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
de Cadena que contiene el nombre de una clave del registro.

*lpszValue*<br/>
de Datos que se van a almacenar.

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

El parámetro *lpszEntry* es el nombre de una entrada del registro que se encuentra en la clave del registro predeterminada de la aplicación. Para obtener o establecer la clave del registro predeterminada, use los métodos [CWinAppEx:: GetRegistryBase](#getregistrybase) y [CWinAppEx:: SetRegistryBase](#setregistrybase) , respectivamente.

Si no existe la clave especificada por *lspzEntry* , este método la creará.

## <a name="see-also"></a>Consulte también

[Gráfico de jerarquías](../../mfc/hierarchy-chart.md)<br/>
[Clases](../../mfc/reference/mfc-classes.md)<br/>
[CWinApp (clase)](../../mfc/reference/cwinapp-class.md)<br/>
[CMouseManager (clase)](../../mfc/reference/cmousemanager-class.md)<br/>
[CContextMenuManager (clase)](../../mfc/reference/ccontextmenumanager-class.md)<br/>
[CKeyboardManager (clase)](../../mfc/reference/ckeyboardmanager-class.md)<br/>
[CUserToolsManager (clase)](../../mfc/reference/cusertoolsmanager-class.md)
