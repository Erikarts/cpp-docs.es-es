---
title: Clase CWinAppEx
ms.date: 11/04/2016
f1_keywords:
- CWinAppEx
- AFXWINAPPEX/CWinAppEx
- AFXWINAPPEX/CWinAppEx::CWinAppEx
- AFXWINAPPEX/CWinAppEx::CleanState
- AFXWINAPPEX/CWinAppEx::EnableLoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::EnableTearOffMenus
- AFXWINAPPEX/CWinAppEx::EnableUserTools
- AFXWINAPPEX/CWinAppEx::ExitInstance
- AFXWINAPPEX/CWinAppEx::GetBinary
- AFXWINAPPEX/CWinAppEx::GetContextMenuManager
- AFXWINAPPEX/CWinAppEx::GetDataVersion
- AFXWINAPPEX/CWinAppEx::GetDataVersionMajor
- AFXWINAPPEX/CWinAppEx::GetDataVersionMinor
- AFXWINAPPEX/CWinAppEx::GetInt
- AFXWINAPPEX/CWinAppEx::GetKeyboardManager
- AFXWINAPPEX/CWinAppEx::GetMouseManager
- AFXWINAPPEX/CWinAppEx::GetObject
- AFXWINAPPEX/CWinAppEx::GetRegSectionPath
- AFXWINAPPEX/CWinAppEx::GetRegistryBase
- AFXWINAPPEX/CWinAppEx::GetSectionBinary
- AFXWINAPPEX/CWinAppEx::GetSectionInt
- AFXWINAPPEX/CWinAppEx::GetSectionObject
- AFXWINAPPEX/CWinAppEx::GetSectionString
- AFXWINAPPEX/CWinAppEx::GetShellManager
- AFXWINAPPEX/CWinAppEx::GetString
- AFXWINAPPEX/CWinAppEx::GetTooltipManager
- AFXWINAPPEX/CWinAppEx::GetUserToolsManager
- AFXWINAPPEX/CWinAppEx::InitContextMenuManager
- AFXWINAPPEX/CWinAppEx::InitKeyboardManager
- AFXWINAPPEX/CWinAppEx::InitMouseManager
- AFXWINAPPEX/CWinAppEx::InitShellManager
- AFXWINAPPEX/CWinAppEx::InitTooltipManager
- AFXWINAPPEX/CWinAppEx::IsResourceSmartUpdate
- AFXWINAPPEX/CWinAppEx::IsStateExists
- AFXWINAPPEX/CWinAppEx::LoadState
- AFXWINAPPEX/CWinAppEx::OnAppContextHelp
- AFXWINAPPEX/CWinAppEx::OnViewDoubleClick
- AFXWINAPPEX/CWinAppEx::OnWorkspaceIdle
- AFXWINAPPEX/CWinAppEx::SaveState
- AFXWINAPPEX/CWinAppEx::SetRegistryBase
- AFXWINAPPEX/CWinAppEx::ShowPopupMenu
- AFXWINAPPEX/CWinAppEx::WriteBinary
- AFXWINAPPEX/CWinAppEx::WriteInt
- AFXWINAPPEX/CWinAppEx::WriteObject
- AFXWINAPPEX/CWinAppEx::WriteSectionBinary
- AFXWINAPPEX/CWinAppEx::WriteSectionInt
- AFXWINAPPEX/CWinAppEx::WriteSectionObject
- AFXWINAPPEX/CWinAppEx::WriteSectionString
- AFXWINAPPEX/CWinAppEx::WriteString
- AFXWINAPPEX/CWinAppEx::LoadCustomState
- AFXWINAPPEX/CWinAppEx::LoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::OnClosingMainFrame
- AFXWINAPPEX/CWinAppEx::PreLoadState
- AFXWINAPPEX/CWinAppEx::PreSaveState
- AFXWINAPPEX/CWinAppEx::ReloadWindowPlacement
- AFXWINAPPEX/CWinAppEx::SaveCustomState
- AFXWINAPPEX/CWinAppEx::StoreWindowPlacement
- AFXWINAPPEX/CWinAppEx::m_bForceImageReset
helpviewer_keywords:
- CWinAppEx [MFC], CWinAppEx
- CWinAppEx [MFC], CleanState
- CWinAppEx [MFC], EnableLoadWindowPlacement
- CWinAppEx [MFC], EnableTearOffMenus
- CWinAppEx [MFC], EnableUserTools
- CWinAppEx [MFC], ExitInstance
- CWinAppEx [MFC], GetBinary
- CWinAppEx [MFC], GetContextMenuManager
- CWinAppEx [MFC], GetDataVersion
- CWinAppEx [MFC], GetDataVersionMajor
- CWinAppEx [MFC], GetDataVersionMinor
- CWinAppEx [MFC], GetInt
- CWinAppEx [MFC], GetKeyboardManager
- CWinAppEx [MFC], GetMouseManager
- CWinAppEx [MFC], GetObject
- CWinAppEx [MFC], GetRegSectionPath
- CWinAppEx [MFC], GetRegistryBase
- CWinAppEx [MFC], GetSectionBinary
- CWinAppEx [MFC], GetSectionInt
- CWinAppEx [MFC], GetSectionObject
- CWinAppEx [MFC], GetSectionString
- CWinAppEx [MFC], GetShellManager
- CWinAppEx [MFC], GetString
- CWinAppEx [MFC], GetTooltipManager
- CWinAppEx [MFC], GetUserToolsManager
- CWinAppEx [MFC], InitContextMenuManager
- CWinAppEx [MFC], InitKeyboardManager
- CWinAppEx [MFC], InitMouseManager
- CWinAppEx [MFC], InitShellManager
- CWinAppEx [MFC], InitTooltipManager
- CWinAppEx [MFC], IsResourceSmartUpdate
- CWinAppEx [MFC], IsStateExists
- CWinAppEx [MFC], LoadState
- CWinAppEx [MFC], OnAppContextHelp
- CWinAppEx [MFC], OnViewDoubleClick
- CWinAppEx [MFC], OnWorkspaceIdle
- CWinAppEx [MFC], SaveState
- CWinAppEx [MFC], SetRegistryBase
- CWinAppEx [MFC], ShowPopupMenu
- CWinAppEx [MFC], WriteBinary
- CWinAppEx [MFC], WriteInt
- CWinAppEx [MFC], WriteObject
- CWinAppEx [MFC], WriteSectionBinary
- CWinAppEx [MFC], WriteSectionInt
- CWinAppEx [MFC], WriteSectionObject
- CWinAppEx [MFC], WriteSectionString
- CWinAppEx [MFC], WriteString
- CWinAppEx [MFC], LoadCustomState
- CWinAppEx [MFC], LoadWindowPlacement
- CWinAppEx [MFC], OnClosingMainFrame
- CWinAppEx [MFC], PreLoadState
- CWinAppEx [MFC], PreSaveState
- CWinAppEx [MFC], ReloadWindowPlacement
- CWinAppEx [MFC], SaveCustomState
- CWinAppEx [MFC], StoreWindowPlacement
- CWinAppEx [MFC], m_bForceImageReset
ms.assetid: a3d3e053-3e22-463f-9444-c73abb1bb9d7
ms.openlocfilehash: b630a588d6c7ec81a22a9665deb0fa7517f90dc8
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/22/2020
ms.locfileid: "81750647"
---
# <a name="cwinappex-class"></a>Clase CWinAppEx

`CWinAppEx`controla el estado de la aplicación, guarda el estado en el registro, carga el estado desde el registro, inicializa los administradores de aplicaciones y proporciona vínculos a esos mismos administradores de aplicaciones.

Para obtener más información, vea el código fuente ubicado en la carpeta **VC\\atlmfc\\src\\mfc** de la instalación de Visual Studio.

## <a name="syntax"></a>Sintaxis

```
class CWinAppEx : public CWinApp
```

## <a name="members"></a>Miembros

### <a name="public-constructors"></a>Constructores públicos

|Nombre|Descripción|
|----------|-----------------|
|[CWinappEx::CWinAppEx](#cwinappex)|Construye un objeto `CWinAppEx`.|

### <a name="public-methods"></a>Métodos públicos

|Nombre|Descripción|
|----------|-----------------|
|[CWinAppEx::CleanState](#cleanstate)|Quita información sobre la aplicación del registro de Windows.|
|[CWinAppEx::EnableLoadWindowPlacement](#enableloadwindowplacement)|Especifica si la aplicación cargará el tamaño inicial y la ubicación de la ventana de marco principal desde el registro.|
|[CWinAppEx::EnableTearOffMenus](#enabletearoffmenus)|Habilita los menús de desmontaje para la aplicación.|
|[CWinAppEx::EnableUserTools](#enableusertools)|Permite al usuario crear comandos de menú personalizados en la aplicación.|
|[CWinAppEx::ExitInstance](#exitinstance)|Llamado por el marco `Run` de trabajo desde dentro de la función miembro para salir de esta instancia de la aplicación. (Reemplaza [CWinApp::ExitInstance](../../mfc/reference/cwinapp-class.md#exitinstance).)|
|[CWinAppEx::GetBinary](#getbinary)|Lee los datos binarios asociados con el valor del Registro especificado.|
|[CWinAppEx::GetContextMenuManager](#getcontextmenumanager)|Devuelve un puntero al objeto [Global CContextMenuManager.](../../mfc/reference/ccontextmenumanager-class.md)|
|[CWinAppEx::GetDataVersion](#getdataversion)||
|[CWinAppEx::GetDataVersionMajor](#getdataversionmajor)|Devuelve la versión principal de la aplicación guardada en el registro de Windows.|
|[CWinappEx::GetDataVersionMinor](#getdataversionminor)|Devuelve la versión secundaria de la aplicación guardada en el registro de Windows.|
|[CWinAppEx::GetInt](#getint)|Lee los datos numéricos asociados con el valor especificado del registro.|
|[CWinAppEx::GetKeyboardManager](#getkeyboardmanager)|Devuelve un puntero al objeto [Global CKeyboardManager.](../../mfc/reference/ckeyboardmanager-class.md)|
|[CWinAppEx::GetMouseManager](#getmousemanager)|Devuelve un puntero al objeto [CMouseManager](../../mfc/reference/cmousemanager-class.md) global.|
|[CWinAppEx::GetObject](#getobject)|Lee `CObject`los datos derivados que están asociados con el valor especificado del registro.|
|[CWinAppEx::GetRegSectionPath](#getregsectionpath)|Devuelve una cadena que es la ruta de acceso de una clave del Registro. Esta ruta de acceso concatena la ruta de acceso relativa proporcionada con la ruta de acceso de la aplicación.|
|[CWinAppEx::GetRegistryBase](#getregistrybase)|Devuelve la ruta de acceso del Registro para la aplicación.|
|[CWinAppEx::GetSectionBinary](#getsectionbinary)|Lee los datos binarios asociados con la clave y el valor especificados del registro.|
|[CWinAppEx::GetSectionInt](#getsectionint)|Lee los datos numéricos del registro asociado con la clave y el valor especificados.|
|[CWinAppEx::GetSectionObject](#getsectionobject)|Lee `CObject` los datos asociados con la clave y el valor especificados del registro.|
|[CWinAppEx::GetSectionString](#getsectionstring)|Lee los datos de cadena asociados a la clave y el valor especificados del registro.|
|[CWinAppEx::GetShellManager](#getshellmanager)|Devuelve un puntero al objeto [CShellManager](../../mfc/reference/cshellmanager-class.md) global.|
|[CWinAppEx::GetString](#getstring)|Lee los datos de cadena asociados al valor especificado del registro.|
|[CWinAppEx::GetTooltipManager](#gettooltipmanager)|Devuelve un puntero al objeto [Global CTooltipManager.](../../mfc/reference/ctooltipmanager-class.md)|
|[CWinAppEx::GetUserToolsManager](#getusertoolsmanager)|Devuelve un puntero al objeto [Global CUserToolsManager.](../../mfc/reference/cusertoolsmanager-class.md)|
|[CWinAppEx::InitContextMenuManager](#initcontextmenumanager)|Inicializa el objeto `CContextMenuManager`.|
|[CWinAppEx::InitKeyboardManager](#initkeyboardmanager)|Inicializa el objeto `CKeyboardManager`.|
|[CWinAppEx::InitMouseManager](#initmousemanager)|Inicializa el objeto `CMouseManager`.|
|[CWinAppEx::InitShellManager](#initshellmanager)|Inicializa la `CShellManager` clase|
|[CWinappEx::InitTooltipManager](#inittooltipmanager)|Inicializa la clase `CTooltipManager`.|
|[CWinAppEx::IsResourceSmartUpdate](#isresourcesmartupdate)||
|[CWinAppEx::IsStateExists](#isstateexists)|Indica si la clave especificada está en el registro.|
|[CWinAppEx::LoadState](#loadstate)|Carga el estado de la aplicación desde el registro.|
|[CWinAppEx::OnAppContextHelp](#onappcontexthelp)|Llamado por el marco de trabajo cuando el usuario solicita ayuda de contexto para el cuadro de diálogo **Personalización.**|
|[CWinAppEx::OnViewDoubleClick](#onviewdoubleclick)|Llama al comando definido por el usuario cuando el usuario hace doble clic en cualquier parte de la aplicación.|
|[CwinappEx::OnWorkspaceIdle](#onworkspaceidle)||
|[CWinAppEx::SaveState](#savestate)|Escribe el estado del marco de trabajo de la aplicación en el registro de Windows.|
|[CWinAppEx::SetRegistryBase](#setregistrybase)|Establece la ruta de acceso de la clave de registro predeterminada. Esta clave servirá como raíz para todas las llamadas de registro posteriores.|
|[CWinAppEx::ShowPopupMenu](#showpopupmenu)|Muestra un menú emergente.|
|[CWinAppEx::WriteBinary](#writebinary)|Escribe los datos binarios en el valor del Registro especificado.|
|[CWinAppEx::WriteInt](#writeint)|Escribe los datos numéricos en el valor del Registro especificado.|
|[CWinAppEx::WriteObject](#writeobject)|Escribe datos que se derivan de la [clase CObject](../../mfc/reference/cobject-class.md) en el valor del Registro especificado.|
|[CWinAppEx::WriteSectionBinary](#writesectionbinary)|Escribe los datos binarios en un valor de la clave del Registro especificada.|
|[CWinAppEx::WriteSectionInt](#writesectionint)|Escribe los datos numéricos en un valor de la clave del Registro especificada.|
|[CWinAppEx::WriteSectionObject](#writesectionobject)|Escribe los datos derivados de la `CObject` clase en un valor de la clave del Registro especificada.|
|[CWinAppEx::WriteSectionString](#writesectionstring)|Escribe los datos de cadena en un valor de la clave del Registro especificada.|
|[CWinAppEx::WriteString](#writestring)|Escribe los datos de cadena en el valor del Registro especificado.|

### <a name="protected-methods"></a>Métodos protegidos

|Nombre|Descripción|
|----------|-----------------|
|[CWinAppEx::LoadCustomState](#loadcustomstate)|Llamado por el marco de trabajo cuando se ha cargado el estado de la aplicación.|
|[CWinAppEx::LoadWindowPlacement](#loadwindowplacement)|Llamado por el marco de trabajo cuando carga el tamaño y la ubicación de la aplicación desde el registro. Los datos cargados incluyen el tamaño y la ubicación del fotograma principal en el momento en que se cerró la aplicación por última vez.|
|[CWinAppEx::OnClosingMainFrame](#onclosingmainframe)|Llamado por el marco de trabajo cuando una ventana de marco principal está procesando WM_CLOSE.|
|[CWinAppEx::PreLoadState](#preloadstate)|Llamado por el marco de trabajo inmediatamente antes de cargar el estado de la aplicación.|
|[CWinAppEx::PreSaveState](#presavestate)|Llamado por el marco de trabajo inmediatamente antes de que se guarde el estado de la aplicación.|
|[CWinAppEx::ReloadWindowPlacement](#reloadwindowplacement)|Recarga el tamaño y la ubicación de la ventana suministrada desde el registro|
|[CWinAppEx::SaveCustomState](#savecustomstate)|Llamado por el marco de trabajo después de escribir el estado de la aplicación en el registro.|
|[CWinAppEx::StoreWindowPlacement](#storewindowplacement)|Llamado por el marco de trabajo para escribir el tamaño y la ubicación del marco principal en el registro.|

### <a name="data-members"></a>Miembros de datos

|Nombre|Descripción|
|----------|-----------------|
|[CWinAppEx::m_bForceImageReset](#m_bforceimagereset)|Especifica si el marco de trabajo restablecerá todas las imágenes de la barra de herramientas cuando se cargue la ventana de marco que contiene la barra de herramientas.|

## <a name="remarks"></a>Observaciones

Gran parte de la funcionalidad proporcionada por `CWinAppEx` el marco MFC depende de la clase. Puede incorporar `CWinAppEx` la clase a la aplicación de una de estas dos maneras:

- Construir `CWinAppEx` una clase en el subproceso principal.

- Derive la clase `CWinAppEx`de aplicación principal de .

Después `CWinAppEx` de incorporar a la aplicación, puede inicializar cualquiera de los administradores de aplicaciones. Antes de usar un administrador de aplicaciones, debe inicializarlo llamando al método initialize adecuado. Para obtener un puntero a un administrador específico, llame al método get asociado. La `CWinAppEx` clase administra los siguientes gestores de aplicaciones: [CMouseManager (Clase),](../../mfc/reference/cmousemanager-class.md) [CContextMenuManager (Clase),](../../mfc/reference/ccontextmenumanager-class.md) [CKeyboardManager (Clase)](../../mfc/reference/ckeyboardmanager-class.md), [CUserToolsManager (clase)](../../mfc/reference/cusertoolsmanager-class.md)y [CMenuTearOffManager (Clase).](../../mfc/reference/cmenutearoffmanager-class.md)

## <a name="inheritance-hierarchy"></a>Jerarquía de herencia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

[Cwinapp](../../mfc/reference/cwinapp-class.md)

[CWinAppEx](../../mfc/reference/cwinappex-class.md)

## <a name="requirements"></a>Requisitos

**Encabezado:** afxwinappex.h

## <a name="cwinappexcleanstate"></a><a name="cleanstate"></a>CWinAppEx::CleanState

Elimina toda la información sobre la aplicación del registro de Windows.

```
virtual BOOL CleanState(LPCTSTR lpszSectionName=NULL);
```

### <a name="parameters"></a>Parámetros

*lpszSectionName*<br/>
[en] Cadena que contiene una ruta de acceso de una clave del Registro.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método se realizó correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Este método borra los datos de la aplicación de una sección específica del registro. Puede especificar la sección que se va a borrar mediante el parámetro *lpszSectionName*. Si *lpszSectionName* es NULL, este método usará la `CWinAppEx` ruta de acceso predeterminada del Registro almacenada en el objeto. Para obtener la ruta de acceso predeterminada del Registro, utilice [CWinAppEx::GetRegistryBase](#getregistrybase).

## <a name="cwinappexcwinappex"></a><a name="cwinappex"></a>CWinappEx::CWinAppEx

Construye un objeto `CWinAppEx`.

```
CWinAppEx(BOOL bResourceSmartUpdate = FALSE);
```

### <a name="parameters"></a>Parámetros

*bResourceSmartUpdate*<br/>
[en] Parámetro booleano que especifica si el objeto de área de trabajo debe detectar y controlar las actualizaciones de recursos.

### <a name="remarks"></a>Observaciones

La `CWinAppEx` clase tiene métodos de inicialización, proporciona funcionalidad para guardar y cargar información de la aplicación en el registro y controla la configuración global de la aplicación. También permite utilizar gestores globales como la [clase CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) y la [clase CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md). Cada aplicación solo puede tener `CWinAppEx` una instancia de la clase.

## <a name="cwinappexenableloadwindowplacement"></a><a name="enableloadwindowplacement"></a>CWinAppEx::EnableLoadWindowPlacement

Especifica si la aplicación cargará el tamaño inicial y la ubicación de la ventana de marco principal desde el registro.

```cpp
void EnableLoadWindowPlacement(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Parámetros

*bHabilitar*<br/>
[en] Especifica si la aplicación carga el tamaño inicial y la ubicación de la ventana de marco principal desde el registro.

### <a name="remarks"></a>Observaciones

De forma predeterminada, el tamaño y la ubicación del marco principal se cargan desde el registro junto con otras configuraciones de la aplicación. Esto ocurre durante [CWinAppEx::LoadState](#loadstate). Si no desea cargar la ubicación inicial de la ventana desde el registro, llame a este método con *bEnable* establecido en FALSE.

## <a name="cwinappexenabletearoffmenus"></a><a name="enabletearoffmenus"></a>CWinAppEx::EnableTearOffMenus

Crea e inicializa un [CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md) objeto.

```
BOOL EnableTearOffMenus(
    LPCTSTR lpszRegEntry,
    const UINT uiCmdFirst,
    const UINT uiCmdLast);
```

### <a name="parameters"></a>Parámetros

*lpszRegEntry*<br/>
[en] Cadena que contiene la ruta de acceso de una clave del Registro. La aplicación utiliza esta clave del Registro para almacenar información para los menús de desmontaje.

*uiCmdFirst*<br/>
[en] El primer ID de menú de desgarro.

*uiCmdLast*<br/>
[en] El último ID de menú de desgarro.

### <a name="return-value"></a>Valor devuelto

TRUESi `CMenuTearOffManager` se crea e inicializa correctamente; FALSE si se produce `CMenuTearOffManager` un error o si el ya existe.

### <a name="remarks"></a>Observaciones

Utilice esta función para habilitar los menús de desmontaje en la aplicación. Debe llamar a `InitInstance`esta función desde .

## <a name="cwinappexenableusertools"></a><a name="enableusertools"></a>CWinAppEx::EnableUserTools

Permite al usuario crear comandos de menú personalizados que reducen las pulsaciones de teclas en la aplicación. Este método crea un [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) objeto.

```
BOOL EnableUserTools(
    const UINT uiCmdToolsDummy,
    const UINT uiCmdFirst,
    const UINT uiCmdLast,
    CRuntimeClass* pToolRTC = RUNTIME_CLASS(CUserTool),
    UINT uArgMenuID = 0,
    UINT uInitDirMenuID = 0);
```

### <a name="parameters"></a>Parámetros

*uiCmdToolsDummy*<br/>
[en] Entero sin signo que el marco de trabajo utiliza como marcador de posición para el identificador de comando del menú de herramientas de usuario.

*uiCmdFirst*<br/>
[en] El identificador de comando para el primer comando de herramienta de usuario.

*uiCmdLast*<br/>
[en] El identificador de comando para el último comando de la herramienta de usuario.

*pToolRTC*<br/>
[en] Clase que `CUserToolsManager` el objeto utiliza para crear nuevas herramientas de usuario.

*uArgMenuID*<br/>
[en] El identificador del menú de argumentos.

*uInitDirMenuID*<br/>
[en] El ID de menú para el directorio de herramientas inicial.

### <a name="return-value"></a>Valor devuelto

TRUESi el método crea `CUserToolsManager` e inicializa un objeto; FALSE si se produce `CUserToolsManager` un error en el método o si ya existe un objeto.

### <a name="remarks"></a>Observaciones

Al habilitar las herramientas definidas por el usuario, el marco de trabajo admite automáticamente un menú dinámico que se puede ampliar durante la personalización. El marco de trabajo asocia cada nuevo elemento con un comando externo. El marco de trabajo invoca estos comandos cuando el usuario selecciona el elemento adecuado en el **herramientas** menú.

Cada vez que el usuario agrega un nuevo elemento, el marco de trabajo crea un nuevo objeto. El tipo de clase para el nuevo objeto se define mediante *pToolRTC*. El tipo de clase *pToolRTC* debe derivarse de la [clase CUserTool](../../mfc/reference/cusertool-class.md).

Para obtener más información acerca de las herramientas de usuario y cómo incorporarlas a la aplicación, consulte [Herramientas definidas por](../../mfc/user-defined-tools.md)el usuario .

## <a name="cwinappexexitinstance"></a><a name="exitinstance"></a>CWinAppEx::ExitInstance

```
virtual int ExitInstance();
```

### <a name="return-value"></a>Valor devuelto

### <a name="remarks"></a>Observaciones

## <a name="cwinappexgetbinary"></a><a name="getbinary"></a>CWinAppEx::GetBinary

Lee los datos binarios de una clave del Registro especificada.

```
BOOL GetBinary(
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
[en] Cadena que contiene el nombre de una clave del Registro.

*ppData*<br/>
[fuera] Puntero al búfer que el método rellena con los datos binarios.

*pBytes*<br/>
[fuera] Puntero a un entero sin signo que el método utiliza para escribir el número de bytes leídos.

### <a name="return-value"></a>Valor devuelto

TRUESi se realiza correctamente; FALSE en caso contrario.

### <a name="remarks"></a>Observaciones

Este método lee los datos binarios escritos en el registro. Para escribir datos en el registro, utilice los métodos [CWinAppEx::WriteBinary](#writebinary) y [CWinAppEx::WriteSectionBinary](#writesectionbinary).

El parámetro *lpszEntry* es el nombre de una entrada del Registro que se encuentra bajo la clave de registro predeterminada de la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

## <a name="cwinappexgetcontextmenumanager"></a><a name="getcontextmenumanager"></a>CWinAppEx::GetContextMenuManager

Devuelve un puntero al objeto [Global CContextMenuManager.](../../mfc/reference/ccontextmenumanager-class.md)

```
CContextMenuManager* GetContextMenuManager();
```

### <a name="return-value"></a>Valor devuelto

Un puntero al `CContextMenuManager` objeto global.

### <a name="remarks"></a>Observaciones

Si el CContextMenuManager objeto no se inicializa, esta función llama [a CWinAppEx::InitContextMenuManager](#initcontextmenumanager) antes de devolver un puntero.

## <a name="cwinappexgetdataversion"></a><a name="getdataversion"></a>CWinAppEx::GetDataVersion

```
int GetDataVersion() const;
```

### <a name="return-value"></a>Valor devuelto

### <a name="remarks"></a>Observaciones

## <a name="cwinappexgetdataversionmajor"></a><a name="getdataversionmajor"></a>CWinAppEx::GetDataVersionMajor

Devuelve la versión principal de la aplicación que se guarda en el registro de Windows cuando se llama a [CWinAppEx::SaveState](#savestate).

```
int GetDataVersionMajor() const;
```

### <a name="return-value"></a>Valor devuelto

Un valor entero que contiene el número de versión principal.

## <a name="cwinappexgetdataversionminor"></a><a name="getdataversionminor"></a>CWinappEx::GetDataVersionMinor

Devuelve la versión secundaria de la aplicación que se guarda en el registro de Windows cuando se llama a [CWinAppEx::SaveState](#savestate).

```
int GetDataVersionMinor() const;
```

### <a name="return-value"></a>Valor devuelto

Valor entero que contiene el número de versión secundaria.

## <a name="cwinappexgetint"></a><a name="getint"></a>CWinAppEx::GetInt

Lee los datos enteros de una clave del Registro especificada.

```
int GetInt(
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
[en] Cadena que contiene el nombre de una entrada del Registro.

*nPredeterminado*<br/>
[en] El valor predeterminado que devuelve el método si no existe la entrada del Registro especificada.

### <a name="return-value"></a>Valor devuelto

Los datos del registro si el método se realizó correctamente; de lo contrario *nDefault*.

### <a name="remarks"></a>Observaciones

Este método lee los datos enteros del registro. Si no hay datos enteros asociados a la clave del Registro indicada por *lpszEntry*, este método devuelve *nDefault*. Para escribir datos en el registro, utilice los métodos [CWinAppEx::WriteSectionInt](#writesectionint) y [CWinAppEx::WriteInt](#writeint).

El parámetro *lpszEntry* es el nombre de una entrada del Registro que se encuentra bajo la clave de registro predeterminada de la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

## <a name="cwinappexgetkeyboardmanager"></a><a name="getkeyboardmanager"></a>CWinAppEx::GetKeyboardManager

Devuelve un puntero al objeto [Global CKeyboardManager.](../../mfc/reference/ckeyboardmanager-class.md)

```
CKeyboardManager* GetKeyboardManager();
```

### <a name="return-value"></a>Valor devuelto

Un puntero al `CKeyboardManager` objeto global.

### <a name="remarks"></a>Observaciones

Si no se inicializa el administrador de teclado, esta función llama a [CWinAppEx::InitKeyboardManager](#initkeyboardmanager) antes de devolver un puntero.

## <a name="cwinappexgetmousemanager"></a><a name="getmousemanager"></a>CWinAppEx::GetMouseManager

Devuelve un puntero al objeto [CMouseManager](../../mfc/reference/cmousemanager-class.md) global.

```
CMouseManager* GetMouseManager();
```

### <a name="return-value"></a>Valor devuelto

Un puntero al `CMouseManager` objeto global.

### <a name="remarks"></a>Observaciones

Si no se inicializa el administrador del mouse, esta función llama a [CWinAppEx::InitMouseManager](#initmousemanager) antes de devolver un puntero.

## <a name="cwinappexgetobject"></a><a name="getobject"></a>CWinAppEx::GetObject

Lee los datos de [CObject](../../mfc/reference/cobject-class.md)-dervied del registro.

```
BOOL GetObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
[en] Cadena que contiene la ruta de acceso relativa de una entrada del Registro.

*obj*<br/>
[fuera] Una referencia `CObject`a un archivo . El método utiliza esta referencia para almacenar los datos del Registro.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método se realizó correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Este método lee los datos del registro `CObject`del que se derivan de . Para `CObject` escribir datos en el registro, utilice [CWinAppEx::WriteObject](#writeobject) o [CWinAppEx::WriteSectionObject](#writesectionobject).

El parámetro *lpszEntry* es el nombre de una entrada del Registro que se encuentra bajo la clave de registro predeterminada de la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

## <a name="cwinappexgetregistrybase"></a><a name="getregistrybase"></a>CWinAppEx::GetRegistryBase

Recupera la ruta de acceso del Registro predeterminada para la aplicación.

```
LPCTSTR GetRegistryBase();
```

### <a name="return-value"></a>Valor devuelto

Cadena que contiene la ruta de acceso de la ubicación predeterminada del Registro.

### <a name="remarks"></a>Observaciones

Todos los métodos de la [clase CWinAppEx](../../mfc/reference/cwinappex-class.md) que tienen acceso al registro se inician en una ubicación predeterminada. Utilice este método para recuperar una ruta de acceso de la ubicación predeterminada del Registro. Utilice [CWinAppEx::SetRegistryBase](#setregistrybase) para cambiar la ubicación predeterminada del Registro.

## <a name="cwinappexgetregsectionpath"></a><a name="getregsectionpath"></a>CWinAppEx::GetRegSectionPath

Crea y devuelve la ruta de acceso absoluta de una clave del Registro.

```
CString GetRegSectionPath(LPCTSTR szSectionAdd = _T(""));
```

### <a name="parameters"></a>Parámetros

*szSectionAdd*<br/>
[en] Cadena que contiene la ruta de acceso relativa de una clave del Registro.

### <a name="return-value"></a>Valor devuelto

A `CString` que contiene la ruta de acceso absoluta de una clave del Registro.

### <a name="remarks"></a>Observaciones

Este método define la ruta de acceso absoluta de la clave del Registro anexando la ruta de acceso relativa en *szSectionAdd* a la ubicación predeterminada del Registro para la aplicación. Para obtener la clave de registro predeterminada, utilice el método [CWinAppEx::GetRegistryBase](#getregistrybase).

## <a name="cwinappexgetsectionbinary"></a><a name="getsectionbinary"></a>CWinAppEx::GetSectionBinary

Lee los datos binarios del registro.

```
BOOL GetSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
[en] Cadena que contiene la ruta de acceso relativa de una clave del Registro.

*lpszEntry*<br/>
[en] Cadena que contiene el valor que se va a leer.

*ppData*<br/>
[fuera] Puntero al búfer donde el método almacena los datos.

*pBytes*<br/>
[fuera] Puntero a un entero sin signo. El método escribe el tamaño de *ppData en* este parámetro.

### <a name="return-value"></a>Valor devuelto

TRUE si es correcto; en caso contrario, FALSE.

### <a name="remarks"></a>Observaciones

Este método lee los datos binarios que se escriben en el registro mediante los métodos [CWinAppEx::WriteBinary](#writebinary) y [CWinAppEx::WriteSectionBinary](#writesectionbinary).

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del Registro. Es una ruta de acceso relativa que se anexa al final de la clave de registro predeterminada para la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

## <a name="cwinappexgetsectionint"></a><a name="getsectionint"></a>CWinAppEx::GetSectionInt

Lee los datos enteros del registro.

```
int GetSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
[en] Cadena que contiene la ruta de acceso relativa de una clave del Registro.

*lpszEntry*<br/>
[en] Cadena que contiene el valor que se va a leer.

*nPredeterminado*<br/>
[en] El valor predeterminado que se va a devolver si el valor especificado no existe.

### <a name="return-value"></a>Valor devuelto

Los datos enteros que se almacenan en el valor del Registro especificado; *nPredeterminado* si los datos no existen.

### <a name="remarks"></a>Observaciones

Utilice los métodos [CWinAppEx::WriteInt](#writeint) y [CWinAppEx::WriteSectionInt](#writesectionint) para escribir datos enteros en el registro.

El parámetro *lpszSubSection* no es una ruta de acceso absoluta de una entrada del Registro. Es una ruta de acceso relativa que se agrega al final de la clave de registro predeterminada para la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

## <a name="cwinappexgetsectionobject"></a><a name="getsectionobject"></a>CWinAppEx::GetSectionObject

Lee los datos del registro [CObject](../../mfc/reference/cobject-class.md) del registro.

```
BOOL GetSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
[en] Cadena que contiene la ruta de acceso relativa de una clave del Registro.

*lpszEntry*<br/>
[en] Cadena que contiene el valor que se va a leer.

*obj*<br/>
[fuera] Una referencia `CObject`a un archivo . El método `CObject` usa esto para almacenar los datos del registro.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Este método lee los datos del registro. Los datos `CObject` leídos son datos o datos `CObject`de una clase derivada de . Para `CObject` escribir datos en el registro, utilice [CWinAppEx::WriteObject](#writeobject) o [CWinAppEx::WriteSectionObject](#writesectionobject).

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del Registro. Es una ruta de acceso relativa que se anexa al final de la clave de registro predeterminada para la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

## <a name="cwinappexgetsectionstring"></a><a name="getsectionstring"></a>CWinAppEx::GetSectionString

Lee los datos de cadena del registro.

```
CString GetSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = _T(""));
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
[en] Cadena que contiene la ruta de acceso relativa de una clave del Registro.

*lpszEntry*<br/>
[en] Cadena que contiene el valor que se va a leer.

*lpszDefault*<br/>
[en] El valor predeterminado que se va a devolver si el valor especificado no existe.

### <a name="return-value"></a>Valor devuelto

Los datos de cadena almacenados en el valor del Registro especificado si los datos existen; de lo contrario *lpszDefault*.

### <a name="remarks"></a>Observaciones

Este método lee los datos de cadena escritos en el registro. Use [CWinAppEx::WriteString](#writestring) y [CWinAppEx::WriteSectionString](#writesectionstring) para escribir datos de cadena en el registro.

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del Registro. Es una ruta de acceso relativa que se anexa al final de la clave de registro predeterminada para la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

## <a name="cwinappexgetshellmanager"></a><a name="getshellmanager"></a>CWinAppEx::GetShellManager

Devuelve un puntero al objeto [CShellManager](../../mfc/reference/cshellmanager-class.md) global.

```
CShellManager* GetShellManager();
```

### <a name="return-value"></a>Valor devuelto

Un puntero al `CShellManager` objeto global.

### <a name="remarks"></a>Observaciones

Si `CShellManager` el objeto no se inicializa, esta función llama [a CWinAppEx::InitShellManager](#initshellmanager) antes de devolver un puntero.

## <a name="cwinappexgetstring"></a><a name="getstring"></a>CWinAppEx::GetString

Lee los datos de cadena de una clave del Registro especificada.

```
CString GetString(
    LPCTSTR lpszEntry,
    LPCTSTR lpzDefault= _T(""));
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
[en] Cadena que contiene el nombre de una clave del Registro

*lpzDefault*<br/>
[en] El valor predeterminado que devuelve el método si no existe la entrada del Registro especificada.

### <a name="return-value"></a>Valor devuelto

Los datos de cadena almacenados en el registro si se realiza correctamente; *lpszDefault* en caso contrario.

### <a name="remarks"></a>Observaciones

Este método lee los datos de cadena escritos en el registro. Para escribir datos en el registro, utilice los métodos [CWinAppEx::WriteString](#writestring) o [CWinAppEx::WriteSectionString](#writesectionstring).

El parámetro *lpszEntry* es el nombre de una entrada del Registro que se encuentra bajo la clave de registro predeterminada de la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

## <a name="cwinappexgettooltipmanager"></a><a name="gettooltipmanager"></a>CWinAppEx::GetTooltipManager

Devuelve un puntero al objeto [Global CTooltipManager.](../../mfc/reference/ctooltipmanager-class.md)

```
CTooltipManager* GetTooltipManager();
```

### <a name="return-value"></a>Valor devuelto

Un puntero al `CTooltipManager` objeto global.

### <a name="remarks"></a>Observaciones

Si `CTooltipManager` el objeto no se inicializa, esta función llama [a CWinAppEx::InitTooltipManager](#inittooltipmanager) antes de devolver un puntero.

## <a name="cwinappexgetusertoolsmanager"></a><a name="getusertoolsmanager"></a>CWinAppEx::GetUserToolsManager

Devuelve un puntero al objeto [Global CUserToolsManager.](../../mfc/reference/cusertoolsmanager-class.md)

```
CUserToolsManager* GetUserToolsManager();
```

### <a name="return-value"></a>Valor devuelto

Un puntero al `CUserToolsManager` objeto global; NULL si la administración de herramientas de usuario no está habilitada para la aplicación.

### <a name="remarks"></a>Observaciones

Antes de recuperar un `CUserToolsManager` puntero al objeto, debe inicializar el administrador llamando a [CWinAppEx::EnableUserTools](#enableusertools).

## <a name="cwinappexinitcontextmenumanager"></a><a name="initcontextmenumanager"></a>CWinAppEx::InitContextMenuManager

Inicializa el [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) objeto.

```
BOOL InitContextMenuManager();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método crea el CContextMenuManager objeto; 0 si `CContextMenuManager` el objeto ya existe.

### <a name="remarks"></a>Observaciones

Si se llama a [CWinAppEx::GetContextMenuManager](#getcontextmenumanager), `InitContextMenuManager`la implementación predeterminada de ese método llama a .

Si la aplicación ya tiene un `InitContextMenuManager`administrador de menús contextuales y llama a , la aplicación tendrá un error [ASSERT.](diagnostic-services.md#assert) Por lo tanto, `InitContextMenuManager` no debe `CContextMenuManager` llamar si crea un objeto directamente. Si no utiliza un `CContextMenuManager`objeto personalizado, debe utilizar `GetContextMenuManager` para crear un `CContextMenuManager` objeto.

## <a name="cwinappexinitkeyboardmanager"></a><a name="initkeyboardmanager"></a>CWinAppEx::InitKeyboardManager

Inicializa el [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) objeto.

```
BOOL InitKeyboardManager();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si `CKeyboardManager` el método crea el objeto; 0 si `CKeyboardManager` el objeto ya existe.

### <a name="remarks"></a>Observaciones

Si se llama a [CWinAppEx::GetKeyboardManager](#getkeyboardmanager), `InitKeyboardManager`la implementación predeterminada de ese método llama .

Si la aplicación ya tiene `InitKeyboardManager`un administrador de teclado y se llama , la aplicación tendrá un error [ASSERT.](diagnostic-services.md#assert) Por lo tanto, `InitKeyboardManager` no debe `CKeyboardManager` llamar si crea un objeto directamente. Si no utiliza un `CKeyboardManager`objeto personalizado, debe utilizar `GetKeyboardManager` para crear un `CKeyboardManager` objeto.

## <a name="cwinappexinitmousemanager"></a><a name="initmousemanager"></a>CWinAppEx::InitMouseManager

Inicializa el [CMouseManager](../../mfc/reference/cmousemanager-class.md) objeto.

```
BOOL InitMouseManager();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si `CMouseManager` el método crea el objeto; 0 si `CMouseManager` el objeto ya existe.

### <a name="remarks"></a>Observaciones

Si se llama a [CWinAppEx::GetMouseManager](#getmousemanager), `InitMouseManager`la implementación predeterminada de ese método llama .

Si la aplicación ya tiene `InitMouseManager`un administrador de mouse y se llama , la aplicación tendrá un error [ASSERT.](diagnostic-services.md#assert) Por lo tanto, no debe llamar `InitMouseManager` si crea un `CMouseManager` objeto directamente. Si no utiliza un `CMouseManager`objeto personalizado, debe utilizar `GetMouseManager` para crear un `CMouseManager` objeto.

## <a name="cwinappexinitshellmanager"></a><a name="initshellmanager"></a>CWinAppEx::InitShellManager

Inicializa el [CShellManager](../../mfc/reference/cshellmanager-class.md) objeto.

```
BOOL InitShellManager();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si `CShellManager` el método crea el objeto; 0 si `CShellManager` el objeto ya existe.

### <a name="remarks"></a>Observaciones

Si se llama a [CWinAppEx::GetShellManager](#getshellmanager), `InitShellManager`la implementación predeterminada de ese método llama .

Si la aplicación ya tiene `InitShellManager`un administrador de shell y se llama a , la aplicación genera un error [ASSERT.](diagnostic-services.md#assert) Por lo tanto, no `InitShellManager` `CShellManager` llame si crea un objeto directamente. Si no utiliza un `CShellManager`objeto `GetShellManager` personalizado, `CShellManager` utilícelo para crear un objeto.

## <a name="cwinappexinittooltipmanager"></a><a name="inittooltipmanager"></a>CWinappEx::InitTooltipManager

Inicializa el [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) objeto.

```
BOOL InitTooltipManager();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si `CTooltipManager` el método crea el objeto; 0 si `CTooltipManager` el objeto ya existe.

### <a name="remarks"></a>Observaciones

Si se llama a [CWinAppEx::GetTooltipManager](#gettooltipmanager), `InitTooltipManager`la implementación predeterminada de ese método llama .

Si la aplicación ya tiene `InitTooltipManager`un administrador de información sobre herramientas y se llama , la aplicación tendrá un error [ASSERT.](diagnostic-services.md#assert) Por lo tanto, `InitTooltipManager` no debe `CTooltipManager` llamar si crea un objeto directamente. Si no utiliza un `CTooltipManager`objeto personalizado, debe utilizar `GetTooltipManager` para crear un `CTooltipManager` objeto.

## <a name="cwinappexisresourcesmartupdate"></a><a name="isresourcesmartupdate"></a>CWinAppEx::IsResourceSmartUpdate

```
BOOL IsResourceSmartUpdate() const;
```

### <a name="return-value"></a>Valor devuelto

### <a name="remarks"></a>Observaciones

## <a name="cwinappexisstateexists"></a><a name="isstateexists"></a>CWinAppEx::IsStateExists

Indica si la clave especificada está en el registro.

```
BOOL IsStateExists(LPCTSTR lpszSectionName);
```

### <a name="parameters"></a>Parámetros

*lpszSectionName*<br/>
[en] Cadena que contiene una ruta de acceso de una clave del Registro.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la clave está en el registro; de lo contrario 0.

## <a name="cwinappexloadcustomstate"></a><a name="loadcustomstate"></a>CWinAppEx::LoadCustomState

El marco de trabajo llama a este método después de cargar el estado de la aplicación desde el registro.

```
virtual void LoadCustomState();
```

### <a name="remarks"></a>Observaciones

Invalide este método si desea realizar cualquier procesamiento después de que la aplicación cargue el estado desde el registro. De forma predeterminada, este método no hace nada.

Para cargar información de estado personalizada desde el registro, la información debe guardarse primero mediante [CWinAppEx::SaveCustomState](#savecustomstate).

## <a name="cwinappexloadstate"></a><a name="loadstate"></a>CWinAppEx::LoadState

Lee el estado de la aplicación desde el registro de Windows.

```
BOOL LoadState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

virtual BOOL LoadState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);
```

### <a name="parameters"></a>Parámetros

*pFrame*<br/>
[en] Puntero a un objeto de ventana de marco. El método aplica la información de estado del registro a esta ventana de marco.

*lpszSectionName*<br/>
[en] Cadena que contiene la ruta de acceso relativa de una clave del Registro.

*pFrameImpl*<br/>
[en] Un puntero `CFrameImpl` a un objeto. El método aplica la información de estado del registro a esta ventana de marco.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

Este método carga el estado de la aplicación y cualquier información de estado para una ventana de marco. La información cargada para la ventana de marco se aplica a la ventana de marco proporcionada. Si no proporciona una ventana de marco, solo se carga la información de estado de la aplicación. La información de la aplicación incluye el estado de la [clase CMouseManager](../../mfc/reference/cmousemanager-class.md), [CContextMenuManager (Clase),](../../mfc/reference/ccontextmenumanager-class.md) [CKeyboardManager (clase)](../../mfc/reference/ckeyboardmanager-class.md)y [CUserToolsManager (clase).](../../mfc/reference/cusertoolsmanager-class.md)

La implementación `CFrameImpl::OnLoadFrame` `LoadState`predeterminada de llamadas .

El parámetro *lpszSectionName* no es la ruta de acceso absoluta para una entrada del Registro. Es una ruta de acceso relativa que se agrega al final de la clave de registro predeterminada para la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

## <a name="cwinappexloadwindowplacement"></a><a name="loadwindowplacement"></a>CWinAppEx::LoadWindowPlacement

Llamado por el marco de trabajo cuando carga el tamaño y la ubicación de la ventana de marco principal desde el registro.

```
virtual BOOL LoadWindowPlacement(
    CRect& rectNormalPosition,
    int& nFlags,
    int& nShowCmd);
```

### <a name="parameters"></a>Parámetros

*rectNormalPosition*<br/>
[fuera] Rectángulo que contiene las coordenadas de la ventana de marco principal cuando está en la posición restaurada.

*nFlags*<br/>
[fuera] Indicadores que controlan la posición de la ventana minimizada y cómo el sistema operativo cambia entre una ventana minimizada y una ventana restaurada.

*nShowCmd*<br/>
[fuera] Entero que especifica el estado de la demostración de la ventana. Para obtener más información acerca de los valores posibles, vea [CWnd::ShowWindow](../../mfc/reference/cwnd-class.md#showwindow).

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

De forma predeterminada, MFC carga automáticamente la posición anterior y el estado de la ventana de marco principal cuando se inicia la aplicación. Para obtener más información sobre cómo se almacena esta información en el registro, vea [CWinAppEx::StoreWindowPlacement](#storewindowplacement).

Invalide este método si desea cargar información adicional sobre la ventana de marco principal.

## <a name="cwinappexm_bforceimagereset"></a><a name="m_bforceimagereset"></a>CWinAppEx::m_bForceImageReset

Especifica si el marco de trabajo restablece todas las imágenes de la barra de herramientas cuando vuelve a cargar la ventana de marco que contiene la barra de herramientas.

```
BOOL m_bForceImageReset;
```

### <a name="remarks"></a>Observaciones

El `m_bForceImageReset` miembro de datos es una variable protegida.

## <a name="cwinappexonappcontexthelp"></a><a name="onappcontexthelp"></a>CWinAppEx::OnAppContextHelp

El marco de trabajo llama a este método cuando el usuario solicita ayuda de contexto para el cuadro de diálogo **Personalización.**

```
virtual void OnAppContextHelp(
    CWnd* pWndControl,
    const DWORD dwHelpIDArray[]);
```

### <a name="parameters"></a>Parámetros

*pWndControl*<br/>
[en] Puntero a un objeto de ventana para el que el usuario invocó la ayuda de contexto.

*dwHelpIDArray[]*<br/>
[en] Un valor reservado.

### <a name="remarks"></a>Observaciones

Este método está actualmente reservado para uso futuro. La implementación predeterminada no hace nada y actualmente no es llamada por el marco de trabajo.

## <a name="cwinappexonclosingmainframe"></a><a name="onclosingmainframe"></a>CWinAppEx::OnClosingMainFrame

El marco de trabajo llama a este método cuando una ventana de marco está procesando WM_CLOSE.

```
virtual void OnClosingMainFrame(CFrameImpl* pFrameImpl);
```

### <a name="parameters"></a>Parámetros

*pFrameImpl*<br/>
[en] Un puntero `CFrameImpl` a un objeto.

### <a name="remarks"></a>Observaciones

La implementación predeterminada de este método guarda el estado de *pFrameImpl*.

## <a name="cwinappexonviewdoubleclick"></a><a name="onviewdoubleclick"></a>CWinAppEx::OnViewDoubleClick

Llama al comando definido por el usuario que está asociado a una vista cuando el usuario hace doble clic en cualquier lugar dentro de esa vista.

```
virtual BOOL OnViewDoubleClick(
    CWnd* pWnd,
    int iViewId);
```

### <a name="parameters"></a>Parámetros

*pWnd*<br/>
[en] Puntero a un objeto derivado de la [clase CView](../../mfc/reference/cview-class.md).

*iViewId*<br/>
[en] El identificador de vista.

### <a name="return-value"></a>Valor devuelto

TRUESi el marco de trabajo encuentra un comando; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

Para admitir el comportamiento personalizado del mouse, debe llamar a esta función cuando procese el mensaje WM_LBUTTONDBLCLK. Este método ejecutará el comando asociado con el identificador de vista proporcionado por *iViewId*. Para obtener más información sobre el comportamiento personalizado del mouse, vea [Personalización de teclado y mouse](../../mfc/keyboard-and-mouse-customization.md).

## <a name="cwinappexonworkspaceidle"></a><a name="onworkspaceidle"></a>CwinappEx::OnWorkspaceIdle

```
virtual BOOL OnWorkspaceIdle(CWnd*);
```

### <a name="parameters"></a>Parámetros

[en] *CWnd&#38;*<br/>

### <a name="return-value"></a>Valor devuelto

### <a name="remarks"></a>Observaciones

## <a name="cwinappexpreloadstate"></a><a name="preloadstate"></a>CWinAppEx::PreLoadState

El marco de trabajo llama a este método inmediatamente antes de cargar el estado de la aplicación desde el registro.

```
virtual void PreLoadState();
```

### <a name="remarks"></a>Observaciones

Invalide este método si desea realizar cualquier procesamiento inmediatamente antes de que el marco de trabajo cargue el estado de la aplicación.

## <a name="cwinappexpresavestate"></a><a name="presavestate"></a>CWinAppEx::PreSaveState

El marco de trabajo llama a este método inmediatamente antes de guardar el estado de la aplicación.

```
virtual void PreSaveState();
```

### <a name="remarks"></a>Observaciones

Invalide este método si desea realizar cualquier procesamiento inmediatamente antes de que el marco de trabajo guarde el estado de la aplicación.

## <a name="cwinappexreloadwindowplacement"></a><a name="reloadwindowplacement"></a>CWinAppEx::ReloadWindowPlacement

Vuelve a cargar el tamaño y la ubicación de una ventana del registro.

```
virtual BOOL ReloadWindowPlacement(CFrameWnd* pFrame);
```

### <a name="parameters"></a>Parámetros

*pFrame*<br/>
[en] Un puntero a una ventana de marco.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el método se realizó correctamente; 0 si la carga ha fallado o no hay datos que cargar.

### <a name="remarks"></a>Observaciones

Utilice la función [CWinAppEx::StoreWindowPlacement](#storewindowplacement) para escribir el tamaño y la ubicación de una ventana en el registro.

## <a name="cwinappexsavecustomstate"></a><a name="savecustomstate"></a>CWinAppEx::SaveCustomState

El marco de trabajo llama a este método después de guardar el estado de la aplicación en el registro.

```
virtual void SaveCustomState();
```

### <a name="remarks"></a>Observaciones

Invalide este método si desea realizar cualquier procesamiento después de que la aplicación guarde el estado en el registro. De forma predeterminada, este método no hace nada.

## <a name="cwinappexsavestate"></a><a name="savestate"></a>CWinAppEx::SaveState

Escribe el estado de la aplicación en el registro de Windows.

```
virtual BOOL SaveState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);

BOOL SaveState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>Parámetros

*lpszSectionName*<br/>
[en] Cadena que contiene la ruta de acceso relativa de una clave del Registro.

*pFrameImpl*<br/>
[en] Un puntero `CFrameImpl` a un objeto. Este marco se guarda en el registro de Windows.

*pFrame*<br/>
[en] Puntero a un objeto de ventana de marco. Este marco se guarda en el registro de Windows.

### <a name="return-value"></a>Valor devuelto

TRUESi se realiza correctamente; FALSE en caso contrario.

### <a name="remarks"></a>Observaciones

Este método guarda el estado de la aplicación y cualquier información de estado para la ventana de marco proporcionada. Si no proporciona una ventana de marco, el método solo guarda el estado de la aplicación. La información de la aplicación incluye el estado de la [clase CMouseManager](../../mfc/reference/cmousemanager-class.md), [CContextMenuManager (Clase),](../../mfc/reference/ccontextmenumanager-class.md) [CKeyboardManager (clase)](../../mfc/reference/ckeyboardmanager-class.md)y [CUserToolsManager (clase).](../../mfc/reference/cusertoolsmanager-class.md)

El parámetro *lpszSectionName* no es la ruta de acceso absoluta para una entrada del Registro. Es una ruta de acceso relativa que se anexa al final de la clave de registro predeterminada para la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

## <a name="cwinappexsetregistrybase"></a><a name="setregistrybase"></a>CWinAppEx::SetRegistryBase

Establece la ruta de acceso predeterminada del Registro para la aplicación.

```
LPCTSTR SetRegistryBase(LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>Parámetros

*lpszSectionName*<br/>
[en] Cadena que contiene la ruta de acceso de una clave del Registro.

### <a name="return-value"></a>Valor devuelto

Cadena que contiene la ruta de acceso de la ubicación predeterminada del Registro.

### <a name="remarks"></a>Observaciones

Todos los métodos de la [clase CWinAppEx](../../mfc/reference/cwinappex-class.md) que tienen acceso al registro se inician en una ubicación predeterminada. Utilice este método para cambiar esa ubicación predeterminada del Registro. Utilice [CWinAppEx::GetRegistryBase](#getregistrybase) para recuperar la ubicación predeterminada del Registro.

## <a name="cwinappexshowpopupmenu"></a><a name="showpopupmenu"></a>CWinAppEx::ShowPopupMenu

Muestra un menú emergente.

```
virtual BOOL ShowPopupMenu(
    UINT uiMenuResId,
    const CPoint& point,
    CWnd* pWnd);
```

### <a name="parameters"></a>Parámetros

*uiMenuResId*<br/>
[en] Un identificador de recurso de menú.

*Punto*<br/>
[en] Un [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) que especifica la posición del menú en coordenadas de pantalla.

*pWnd*<br/>
[en] Puntero a la ventana propietaria del menú emergente.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el menú emergente se muestra correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

Este método muestra el menú asociado a *uiMenuResId*.

Para admitir menús emergentes, debe tener un [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) objeto. Si no ha inicializado `CContextMenuManager` `ShowPopupMenu` el objeto, se producirá un error.

## <a name="cwinappexstorewindowplacement"></a><a name="storewindowplacement"></a>CWinAppEx::StoreWindowPlacement

Llamado por el marco de trabajo para escribir el tamaño y la ubicación de la ventana de marco principal en el registro.

```
virtual BOOL StoreWindowPlacement(
    const CRect& rectNormalPosition,
    int nFlags,
    int nShowCmd);
```

### <a name="parameters"></a>Parámetros

*nFlags*<br/>
[en] Indicadores que controlan la posición de la ventana minimizada y cómo el sistema operativo cambia entre una ventana minimizada y una ventana restaurada.

*nShowCmd*<br/>
[en] Entero que especifica el estado de la demostración de la ventana. Para obtener más información acerca de los valores posibles, vea [CWnd::ShowWindow](../../mfc/reference/cwnd-class.md#showwindow).

*rectNormalPosition*<br/>
[en] Rectángulo que contiene las coordenadas de la ventana de marco principal cuando está en estado restaurado.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 en caso contrario.

### <a name="remarks"></a>Observaciones

De forma predeterminada, MFC guarda automáticamente la posición y el estado de la ventana de marco principal antes de que se cierre la aplicación. Esta información se almacena en el registro de Windows en la clave WindowPlacement en la ubicación predeterminada del Registro de la aplicación. Para obtener más información acerca de la ubicación predeterminada del Registro de la aplicación, vea [CWinAppEx::GetRegistryBase](#getregistrybase).

Invalide este método si desea almacenar información adicional sobre la ventana de marco principal.

## <a name="cwinappexwritebinary"></a><a name="writebinary"></a>CWinAppEx::WriteBinary

Escribe datos binarios en el registro.

```
BOOL WriteBinary(
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
[en] Cadena que contiene el nombre de una clave del Registro.

*pData*<br/>
[en] Los datos que se almacenarán.

*nBytes*<br/>
[en] El tamaño de *pData* en bytes.

### <a name="return-value"></a>Valor devuelto

TRUESi este método se realiza correctamente; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

El parámetro *lpszEntry* es el nombre de una entrada del Registro que se encuentra bajo la clave de registro predeterminada de la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

Si la clave especificada por *lpszEntry* no existe, este método la creará.

## <a name="cwinappexwriteint"></a><a name="writeint"></a>CWinAppEx::WriteInt

Escribe datos numéricos en el registro.

```
BOOL WriteInt(
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
[en] Cadena que contiene el nombre de una clave del Registro.

*nValor*<br/>
[en] Los datos que se almacenarán.

### <a name="return-value"></a>Valor devuelto

TRUESi este método se realiza correctamente; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

El parámetro *lpszEntry* es el nombre de una entrada del Registro que se encuentra bajo la clave de registro predeterminada de la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

Si la clave especificada por *lpszEntry* no existe, este método la creará.

## <a name="cwinappexwriteobject"></a><a name="writeobject"></a>CWinAppEx::WriteObject

Escribe datos derivados de la [clase CObject](../../mfc/reference/cobject-class.md) en el registro.

```
BOOL WriteObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
[en] Cadena que contiene el valor que se va a establecer.

*obj*<br/>
[en] Una referencia `CObject` a los datos que almacenará el método.

### <a name="return-value"></a>Valor devuelto

TRUESi este método se realiza correctamente; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

Este método escribe los datos *obj* en el valor especificado en la clave de registro predeterminada. Utilice [CWinAppEx::GetRegistryBase](#getregistrybase) para determinar la clave del Registro actual.

## <a name="cwinappexwritesectionbinary"></a><a name="writesectionbinary"></a>CWinAppEx::WriteSectionBinary

Escribe datos binarios en un valor del registro.

```
BOOL WriteSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
[en] Cadena que contiene el nombre de una clave del Registro

*lpszEntry*<br/>
[en] Cadena que contiene el valor que se va a establecer.

*pData*<br/>
[en] Los datos que se escribirá en el registro.

*nBytes*<br/>
[en] El tamaño de *pData* en bytes.

### <a name="return-value"></a>Valor devuelto

TRUESi este método se realiza correctamente; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

El parámetro *lpszSubSection* no es la ruta de acceso absoluta para una entrada del Registro. Es una ruta de acceso relativa que se anexa al final de la clave de registro predeterminada para la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

Si la clave especificada por *lpszEntry* no existe, este método la creará.

## <a name="cwinappexwritesectionint"></a><a name="writesectionint"></a>CWinAppEx::WriteSectionInt

Escribe datos numéricos en el registro.

```
BOOL WriteSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
[en] Cadena que contiene la ruta de acceso relativa de una clave del Registro.

*lpszEntry*<br/>
[en] Cadena que contiene el valor que se va a establecer.

*nValor*<br/>
[en] Los datos que se escribirá en el registro.

### <a name="return-value"></a>Valor devuelto

TRUESi este método se realiza correctamente; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del Registro. Es una ruta de acceso relativa que se anexa a la clave de registro predeterminada para la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

Si la clave especificada por *lpszEntry* no existe, este método la creará.

## <a name="cwinappexwritesectionobject"></a><a name="writesectionobject"></a>CWinAppEx::WriteSectionObject

Escribe datos derivados de la [clase CObject](../../mfc/reference/cobject-class.md) en un valor de registro específico.

```
BOOL WriteSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
[en] Cadena que contiene el nombre de una clave del Registro.

*lpszEntry*<br/>
[en] Cadena que contiene el nombre del valor que se va a establecer.

*obj*<br/>
[en] Los datos que se almacenarán.

### <a name="return-value"></a>Valor devuelto

TRUESi este método se realiza correctamente; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del Registro. Es una ruta de acceso relativa que se anexa al final de la clave de registro predeterminada para la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase), respectivamente.

Si el valor especificado por *lpszEntry* no existe en la clave del Registro especificada por *lpszSubSection*, este método creará ese valor.

## <a name="cwinappexwritesectionstring"></a><a name="writesectionstring"></a>CWinAppEx::WriteSectionString

Escribe datos de cadena en un valor del Registro.

```
BOOL WriteSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Parámetros

*lpszSubSection*<br/>
[en] Cadena que contiene el nombre de una clave del Registro.

*lpszEntry*<br/>
[en] Cadena que contiene el valor que se va a establecer.

*lpszValue*<br/>
[en] Los datos de cadena que se escribirá en el registro.

### <a name="return-value"></a>Valor devuelto

TRUESi este método se realiza correctamente; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

El parámetro *lpszSubSection* no es una ruta de acceso absoluta para una entrada del Registro. Es una ruta de acceso relativa que se anexa al final de la clave de registro predeterminada para la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase), respectivamente.

Si el valor especificado por *lpszEntry* no existe en *lpszSubSection*, este método lo creará.

## <a name="cwinappexwritestring"></a><a name="writestring"></a>CWinAppEx::WriteString

Escribe datos de cadena en el registro.

```
BOOL WriteString(
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Parámetros

*lpszEntry*<br/>
[en] Cadena que contiene el nombre de una clave del Registro.

*lpszValue*<br/>
[en] Los datos que se almacenarán.

### <a name="return-value"></a>Valor devuelto

TRUESi este método se realiza correctamente; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

El parámetro *lpszEntry* es el nombre de una entrada del Registro que se encuentra bajo la clave de registro predeterminada de la aplicación. Para obtener o establecer la clave de registro predeterminada, utilice los métodos [CWinAppEx::GetRegistryBase](#getregistrybase) y [CWinAppEx::SetRegistryBase](#setregistrybase) respectivamente.

Si la clave especificada por *lspzEntry* no existe, este método la creará.

## <a name="see-also"></a>Vea también

[Gráfico de jerarquías](../../mfc/hierarchy-chart.md)<br/>
[Clases](../../mfc/reference/mfc-classes.md)<br/>
[Clase CWinApp](../../mfc/reference/cwinapp-class.md)<br/>
[Clase CMouseManager](../../mfc/reference/cmousemanager-class.md)<br/>
[CContextMenuManager (clase)](../../mfc/reference/ccontextmenumanager-class.md)<br/>
[Clase CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)<br/>
[Clase CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)
