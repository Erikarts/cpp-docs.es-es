---
title: CToolBarCtrl (clase)
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: 92f5adcea50e660ecfad131313247e118312e609
ms.sourcegitcommit: c7f90df497e6261764893f9cc04b5d1f1bf0b64b
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/05/2019
ms.locfileid: "58781268"
---
# <a name="ctoolbarctrl-class"></a>CToolBarCtrl (clase)

Proporciona la funcionalidad del control de barra de herramientas común de Windows.

## <a name="syntax"></a>Sintaxis

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>Miembros

### <a name="public-constructors"></a>Constructores públicos

|Name|Descripción|
|----------|-----------------|
|[CToolBarCtrl::CToolBarCtrl](#ctoolbarctrl)|Construye un objeto `CToolBarCtrl`.|

### <a name="public-methods"></a>Métodos públicos

|Name|Descripción|
|----------|-----------------|
|[CToolBarCtrl::AddBitmap](#addbitmap)|Agrega una o más imágenes de botón de mapa de bits a la lista de imágenes de los botones disponibles para un control de barra de herramientas.|
|[CToolBarCtrl::AddButtons](#addbuttons)|Agrega uno o varios botones a un control de barra de herramientas.|
|[CToolBarCtrl::AddString](#addstring)|Agrega una nueva cadena, pasada como un identificador de recurso a la lista interna de la barra de herramientas de cadenas.|
|[CToolBarCtrl::AddStrings](#addstrings)|Agrega una nueva cadena o cadenas, que se pasa como un puntero a un búfer de cadenas separadas por null, en la lista interna de la barra de herramientas de cadenas.|
|[CToolBarCtrl::AutoSize](#autosize)|Cambia el tamaño de un control de barra de herramientas.|
|[CToolBarCtrl::ChangeBitmap](#changebitmap)|Cambia el mapa de bits para un botón en el control de barra de herramientas actual.|
|[CToolBarCtrl::CheckButton](#checkbutton)|Comprueba o borra un botón determinado en un control de barra de herramientas.|
|[CToolBarCtrl::CommandToIndex](#commandtoindex)|Recupera el índice de base cero del botón asociado al identificador de comando especificado.|
|[CToolBarCtrl::Create](#create)|Crea un control de barra de herramientas y lo adjunta a un `CToolBarCtrl` objeto.|
|[CToolBarCtrl::CreateEx](#createex)|Crea un control de barra de herramientas con los estilos extendidos de Windows especificados y lo asocia a un `CToolBarCtrl` objeto.|
|[CToolBarCtrl::Customize](#customize)|Muestra el cuadro de diálogo Personalizar barra de herramientas.|
|[CToolBarCtrl::DeleteButton](#deletebutton)|Elimina un botón del control de barra de herramientas.|
|[CToolBarCtrl::EnableButton](#enablebutton)|Habilita o deshabilita el botón especificado en un control de barra de herramientas.|
|[CToolBarCtrl::GetAnchorHighlight](#getanchorhighlight)|Recupera el resaltado de anclaje para una barra de herramientas.|
|[CToolBarCtrl::GetBitmap](#getbitmap)|Recupera el índice del mapa de bits asociado con un botón en una barra de herramientas.|
|[CToolBarCtrl::GetBitmapFlags](#getbitmapflags)|Obtiene los marcadores asociados con el mapa de bits de la barra de herramientas.|
|[CToolBarCtrl::GetButton](#getbutton)|Recupera información sobre el botón especificado en un control de barra de herramientas.|
|[CToolBarCtrl::GetButtonCount](#getbuttoncount)|Recupera un recuento de los botones actualmente en el control de barra de herramientas.|
|[CToolBarCtrl::GetButtonInfo](#getbuttoninfo)|Recupera la información de un botón en una barra de herramientas.|
|[CToolBarCtrl::GetButtonSize](#getbuttonsize)|Recupera el ancho y alto actuales de los botones de barra de herramientas, en píxeles.|
|[CToolBarCtrl::GetColorScheme](#getcolorscheme)|Recupera la combinación de colores del control de barra de herramientas actual.|
|[CToolBarCtrl::GetDisabledImageList](#getdisabledimagelist)|Recupera la lista de imágenes que se usa un control de barra de herramientas para mostrar deshabilitado los botones.|
|[CToolBarCtrl::GetDropTarget](#getdroptarget)|Recupera el [IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget) interfaz para un control de barra de herramientas.|
|[CToolBarCtrl::GetExtendedStyle](#getextendedstyle)|Recupera los estilos extendidos para un control de barra de herramientas.|
|[CToolBarCtrl::GetHotImageList](#gethotimagelist)|Recupera la lista de imágenes que usa un control de barra de herramientas para mostrar los botones "activos". Un botón activo aparece resaltado cuando el puntero del mouse está por encima de él.|
|[CToolBarCtrl::GetHotItem](#gethotitem)|Recupera el índice del elemento activo en una barra de herramientas.|
|[CToolBarCtrl::GetImageList](#getimagelist)|Recupera la lista de imágenes que usa un control de barra de herramientas para mostrar botones en su estado predeterminado.|
|[CToolBarCtrl::GetInsertMark](#getinsertmark)|Recupera la marca de inserción actual de la barra de herramientas.|
|[CToolBarCtrl::GetInsertMarkColor](#getinsertmarkcolor)|Recupera el color utilizado para dibujar la marca de inserción para la barra de herramientas.|
|[CToolBarCtrl::GetItemRect](#getitemrect)|Recupera el rectángulo delimitador de un botón en un control de barra de herramientas.|
|[CToolBarCtrl::GetMaxSize](#getmaxsize)|Recupera el tamaño total de todos los botones visibles y los separadores en la barra de herramientas.|
|[CToolBarCtrl::GetMaxTextRows](#getmaxtextrows)|Recupera el número máximo de filas de texto que se muestran en un botón de barra de herramientas.|
|[CToolBarCtrl::GetMetrics](#getmetrics)|Recupera las métricas de un control de barra de herramientas.|
|[CToolBarCtrl::GetPadding](#getpadding)|Recupera el relleno horizontal y vertical del control de barra de herramientas actual.|
|[CToolBarCtrl::GetPressedImageList](#getpressedimagelist)|Recupera la lista de imágenes que el control de barra de herramientas actual que se usa para representar los botones en estado presionado.|
|[CToolBarCtrl::GetRect](#getrect)|Recupera el rectángulo delimitador para un botón de barra de herramientas especificada.|
|[CToolBarCtrl::GetRows](#getrows)|Recupera el número de filas de botones que se muestra actualmente en la barra de herramientas.|
|[CToolBarCtrl::GetState](#getstate)|Recupera información sobre el estado del botón especificado en un control de barra de herramientas, por ejemplo, si está habilitado, presionado o activado.|
|[CToolBarCtrl::GetString](#getstring)|Recupera una cadena de la barra de herramientas.|
|[CToolBarCtrl::GetStyle](#getstyle)|Recupera los estilos actualmente en uso para un control de barra de herramientas.|
|[CToolBarCtrl::GetToolTips](#gettooltips)|Recupera el identificador del control de la sugerencia de herramienta, si existe, asociado con el control de barra de herramientas.|
|[CToolBarCtrl::HideButton](#hidebutton)|Oculta o muestra el botón especificado en un control de barra de herramientas.|
|[CToolBarCtrl::HitTest](#hittest)|Determina dónde se encuentra un punto en un control de barra de herramientas.|
|[CToolBarCtrl::Indeterminate](#indeterminate)|Establece o borra el estado indeterminado (gris) del botón especificado en un control de barra de herramientas.|
|[CToolBarCtrl::InsertButton](#insertbutton)|Inserta un botón en un control de barra de herramientas.|
|[CToolBarCtrl::InsertMarkHitTest](#insertmarkhittest)|Recupera la información de marca de inserción de un punto en una barra de herramientas.|
|[CToolBarCtrl::IsButtonChecked](#isbuttonchecked)|Indica si se activa el botón especificado en un control de barra de herramientas.|
|[CToolBarCtrl::IsButtonEnabled](#isbuttonenabled)|Indica si está habilitado el botón especificado en un control de barra de herramientas.|
|[CToolBarCtrl::IsButtonHidden](#isbuttonhidden)|Indica si se oculta el botón especificado en un control de barra de herramientas.|
|[CToolBarCtrl::IsButtonHighlighted](#isbuttonhighlighted)|Comprueba el estado de resaltado del botón de barra de herramientas.|
|[CToolBarCtrl::IsButtonIndeterminate](#isbuttonindeterminate)|Indica si el estado del botón especificado en un control de barra de herramientas es indeterminado (gris).|
|[CToolBarCtrl::IsButtonPressed](#isbuttonpressed)|Indica si se presiona el botón especificado en un control de barra de herramientas.|
|[CToolBarCtrl::LoadImages](#loadimages)|Carga los mapas de bits en la lista de imágenes de un control de barra de herramientas.|
|[CToolBarCtrl::MapAccelerator](#mapaccelerator)|Un carácter de acelerador se asigna a un botón de barra de herramientas.|
|[CToolBarCtrl::MarkButton](#markbutton)|Establece el estado de resaltado de un botón determinado en un control de barra de herramientas.|
|[CToolBarCtrl::MoveButton](#movebutton)|Mueve un botón de un índice a otra.|
|[CToolBarCtrl::PressButton](#pressbutton)|Presiona o suelta el botón especificado en un control de barra de herramientas.|
|[CToolBarCtrl::ReplaceBitmap](#replacebitmap)|Reemplaza el mapa de bits existente en el control de barra de herramientas actual con un nuevo mapa de bits.|
|[CToolBarCtrl::RestoreState](#restorestate)|Restaura el estado del control de barra de herramientas.|
|[CToolBarCtrl::SaveState](#savestate)|Guarda el estado del control de barra de herramientas.|
|[CToolBarCtrl::SetAnchorHighlight](#setanchorhighlight)|Establece el resaltado de anclaje para una barra de herramientas.|
|[CToolBarCtrl::SetBitmapSize](#setbitmapsize)|Establece el tamaño de las imágenes de mapa de bits que se agregarán a un control de barra de herramientas.|
|[CToolBarCtrl::SetButtonInfo](#setbuttoninfo)|Establece la información de un botón existente en una barra de herramientas.|
|[CToolBarCtrl::SetButtonSize](#setbuttonsize)|Establece el tamaño de los botones que deben agregarse a un control de barra de herramientas.|
|[CToolBarCtrl::SetButtonStructSize](#setbuttonstructsize)|Especifica el tamaño de la `TBBUTTON` estructura.|
|[CToolBarCtrl::SetButtonWidth](#setbuttonwidth)|Establece el ancho mínimo y máximo de botón en el control de barra de herramientas.|
|[CToolBarCtrl::SetCmdID](#setcmdid)|Establece el identificador de comando que se enviarán a la ventana propietaria cuando se presiona el botón especificado.|
|[CToolBarCtrl::SetColorScheme](#setcolorscheme)|Establece la combinación de colores del control de barra de herramientas actual.|
|[CToolBarCtrl::SetDisabledImageList](#setdisabledimagelist)|Establece la lista de imágenes que se va a usar el control de barra de herramientas para mostrar deshabilitado los botones.|
|[CToolBarCtrl::SetDrawTextFlags](#setdrawtextflags)|Establece las marcas de la función de Win32 [DrawText](/windows/desktop/api/winuser/nf-winuser-drawtext), que se usa para dibujar el texto en el rectángulo especificado, con un formato según cómo se establecen las marcas.|
|[CToolBarCtrl::SetExtendedStyle](#setextendedstyle)|Establece los estilos extendidos para un control de barra de herramientas.|
|[CToolBarCtrl::SetHotImageList](#sethotimagelist)|Establece la lista de imágenes que va a usar el control de barra de herramientas para mostrar los botones "activos".|
|[CToolBarCtrl::SetHotItem](#sethotitem)|Establece el elemento activo en una barra de herramientas.|
|[CToolBarCtrl::SetImageList](#setimagelist)|Establece la lista de imágenes que va a usar la barra de herramientas para mostrar botones que se encuentran en su estado predeterminado.|
|[CToolBarCtrl::SetIndent](#setindent)|Establece la sangría del primer botón en un control de barra de herramientas.|
|[CToolBarCtrl::SetInsertMark](#setinsertmark)|Establece la marca de inserción actual de la barra de herramientas.|
|[CToolBarCtrl::SetInsertMarkColor](#setinsertmarkcolor)|Establece el color utilizado para dibujar la marca de inserción para la barra de herramientas.|
|[CToolBarCtrl::SetMaxTextRows](#setmaxtextrows)|Establece el número máximo de filas de texto que se muestran en un botón de barra de herramientas.|
|[CToolBarCtrl::SetMetrics](#setmetrics)|Establece las métricas de un control de barra de herramientas.|
|[CToolBarCtrl::SetOwner](#setowner)|Establece la ventana para recibir mensajes de notificación del control de barra de herramientas.|
|[CToolBarCtrl::SetPadding](#setpadding)|Establece el relleno horizontal y vertical del control de barra de herramientas actual.|
|[CToolBarCtrl::SetPressedImageList](#setpressedimagelist)|Establece la lista de imágenes que el control de barra de herramientas actual que se usa para representar los botones en estado presionado.|
|[CToolBarCtrl::SetRows](#setrows)|Establece el número de filas de botones que aparecen en la barra de herramientas.|
|[CToolBarCtrl::SetState](#setstate)|Establece el estado del botón especificado en un control de barra de herramientas.|
|[CToolBarCtrl::SetStyle](#setstyle)|Establece los estilos para un control de barra de herramientas.|
|[CToolBarCtrl::SetToolTips](#settooltips)|Asocia un control con el control de barra de herramientas.|
|[CToolBarCtrl::SetWindowTheme](#setwindowtheme)|Establece el estilo visual de un control de barra de herramientas.|

## <a name="remarks"></a>Comentarios

Este control (y, por tanto, la `CToolBarCtrl` clase) está disponible solo para programas que se ejecutan en Windows 95/98 y Windows NT versión 3.51 y versiones posteriores.

Un control común de barra de herramientas de Windows es una ventana secundaria rectangular que contiene uno o varios botones. Estos botones pueden mostrar una imagen de mapa de bits, una cadena o ambos. Cuando el usuario elige un botón, envía un mensaje de comando a la ventana propietaria de la barra de herramientas. Normalmente, los botones de una barra de herramientas corresponden a elementos de menú de la aplicación; proporcionan una manera más directa para el usuario tener acceso a los comandos de la aplicación.

`CToolBarCtrl` los objetos contienen varias estructuras de datos interno importante: una lista de mapas de bits de imagen de botón o una lista de imágenes, una lista de cadenas de la etiqueta de botón y una lista de `TBBUTTON` estructuras que asociación una imagen o de cadena con la posición, estilo, estado e identificador de comando del botón. Cada uno de los elementos de estas estructuras de datos se denomina mediante un índice de base cero. Para poder usar un `CToolBarCtrl` de objeto, debe configurar estas estructuras de datos. La lista de cadenas puede usarse solo para las etiquetas de botón; no se puede recuperar las cadenas de la barra de herramientas.

Para usar un `CToolBarCtrl` de objeto, normalmente se siguen estos pasos:

1. Construir la `CToolBarCtrl` objeto.

1. Llame a [crear](#create) para crear el control común de barra de herramientas de Windows y adjuntarlo a la `CToolBarCtrl` objeto. Indican el estilo de barra de herramientas mediante el uso de estilos, como TBSTYLE_TRANSPARENT para una barra de herramientas transparente o TBSTYLE_DROPDOWN para una barra de herramientas que es compatible con los botones de estilo de lista desplegable.

1. Identificar cómo desea que los botones de la barra de herramientas muestra:

   - Para utilizar imágenes de mapa de bits para los botones, agregue los mapas de bits de botón a la barra de herramientas mediante una llamada a [AddBitmap](#addbitmap).

   - Para usar imágenes de muestra de una lista de imágenes para los botones, especifique la lista de imágenes mediante una llamada a [SetImageList](#setimagelist), [SetHotImageList](#sethotimagelist), o [SetDisabledImageList](#setdisabledimagelist).

   - Para usar las etiquetas de cadena para los botones, agregue las cadenas a la barra de herramientas mediante una llamada a [AddString](#addstring) o [a AddStrings](#addstrings).

1. Agregar estructuras de botón a la barra de herramientas mediante una llamada a [AddButtons](#addbuttons).

1. Si desea información sobre herramientas para un botón de barra de herramientas en una ventana propietaria que no es un `CFrameWnd`, deberá controlar los mensajes TTN_NEEDTEXT en la ventana propietaria de la barra de herramientas, como se describe en [controlar herramienta notificaciones](../../mfc/handling-tool-tip-notifications.md). Si se deriva de la ventana primaria de la barra de herramientas `CFrameWnd`, información sobre herramientas se muestra sin ningún esfuerzo adicional del usuario porque `CFrameWnd` proporciona un controlador predeterminado.

1. Si desea que el usuario pueda personalizar la barra de herramientas, controlar los mensajes de notificación de personalización en la ventana propietaria, como se describe en [controlar notificaciones de personalización](../../mfc/handling-customization-notifications.md).

Puede usar [SaveState](#savestate) para guardar el estado actual de un control de barra de herramientas en el registro y [RestoreState](#restorestate) para restaurar el estado según la información almacenada previamente en el registro. Además de guardar el estado de la barra de herramientas entre los usos de la aplicación, las aplicaciones normalmente almacenan el estado antes de que el usuario comienza a personalizar la barra de herramientas en caso de que el usuario más adelante desea restaurar la barra de herramientas a su estado original.

## <a name="support-for-internet-explorer-version-40-and-later"></a>Soporte técnico para Internet Explorer 4.0 y versiones posteriores

Para admitir la funcionalidad presentada en Internet Explorer, versión 4.0 y versiones posterior, MFC proporciona compatibilidad de la lista de imágenes y estilos de transparentes y sin formato para los controles de barra de herramientas.

Una barra de herramientas transparente permite al cliente en la barra de herramientas mostrar a través. Para crear una barra de herramientas transparente, use los estilos TBSTYLE_FLAT y TBSTYLE_TRANSPARENT. Seguimiento activo; de características de las barras de herramientas transparentes es decir, cuando el puntero del mouse se mueve sobre un botón activo en la barra de herramientas, se cambia la apariencia del botón. Barras de herramientas creadas con solo el estilo TBSTYLE_FLAT contiene botones que no son transparentes.

Compatibilidad de la lista de imágenes permite una mayor flexibilidad de control de comportamiento predeterminado, imágenes activas e imágenes de deshabilitado. Use [función miembro GetImageList](#getimagelist), [GetHotImageList](#gethotimagelist), y [GetDisabledImageList](#getdisabledimagelist) con la barra de herramientas transparente para manipular la imagen de según su estado:

Para obtener más información sobre el uso de `CToolBarCtrl`, consulte [controles](../../mfc/controls-mfc.md) y [utilizando CToolBarCtrl](../../mfc/using-ctoolbarctrl.md).

## <a name="inheritance-hierarchy"></a>Jerarquía de herencia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>Requisitos

**Encabezado:** afxcmn.h

##  <a name="addbitmap"></a>  CToolBarCtrl::AddBitmap

Agrega una o más imágenes de botón a la lista de imágenes de botón que se almacenan en el control de barra de herramientas.

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>Parámetros

*nNumButtons*<br/>
Número de imágenes de botón en el mapa de bits.

*nBitmapID*<br/>
Identificador de recurso del mapa de bits que contiene la imagen del botón o para agregar las imágenes.

*pBitmap*<br/>
Puntero a la `CBitmap` objeto que contiene la imagen del botón o para agregar las imágenes.

### <a name="return-value"></a>Valor devuelto

Índice de base cero de la nueva imagen si se realiza correctamente; en caso contrario, - 1.

### <a name="remarks"></a>Comentarios

Puede usar la API de Windows [CreateMappedBitmap](/windows/desktop/api/commctrl/nf-commctrl-createmappedbitmap) para asignar colores antes de agregar el mapa de bits a la barra de herramientas. Si se pasa un puntero a un `CBitMap` de objeto, debe asegurarse de que el mapa de bits no se destruye hasta después de que se destruye la barra de herramientas.

##  <a name="addbuttons"></a>  CToolBarCtrl::AddButtons

Agrega uno o varios botones a un control de barra de herramientas.

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>Parámetros

*nNumButtons*<br/>
Número de botones para agregar.

*lpButtons*<br/>
Dirección de una matriz de `TBBUTTON` estructuras que contiene información acerca de los botones para agregar. Debe haber el mismo número de elementos de la matriz como botones especificados por *nNumButtons*.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

El *lpButtons* puntero apunta a una matriz de `TBBUTTON` estructuras. Cada `TBBUTTON` estructura asocia el botón que se agrega con el estilo del botón, de imagen o cadena, el identificador de comando, estado y datos definidos por el usuario:

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

Los miembros son los siguientes:

- `iBitmap`

   Índice de base cero de la imagen del botón, -1 si no hay ninguna imagen para este botón.

- `idCommand`

   Identificador de comando asociado con el botón. Este identificador se envía en un mensaje WM_COMMAND cuando se elige el botón. Si el `fsStyle` miembro tiene el valor TBSTYLE_SEP, este miembro debe ser cero.

- `fsState`

   Marcas de estado del botón. Puede ser una combinación de los valores enumerados a continuación:

   - TBSTATE_CHECKED el botón tiene el estilo TBSTYLE_CHECKED y se presiona.

   - El botón TBSTATE_ENABLED acepta entradas del usuario. Un botón que no tiene este estado no acepta la entrada del usuario y está deshabilitado.

   - TBSTATE_HIDDEN el botón no está visible y no puede recibir la entrada del usuario.

   - TBSTATE_INDETERMINATE el botón aparece atenuado.

   - TBSTATE_PRESSED se presiona el botón.

   - Salto de línea de un TBSTATE_WRAP sigue el botón. El botón también debe tener el estado TBSTATE_ENABLED.

- `fsStyle`

   Estilo de botón. Puede ser una combinación de los valores enumerados a continuación:

   - TBSTYLE_BUTTON crea un botón de comando estándar.

   - TBSTYLE_CHECK crea un botón que alterne entre los Estados presionados y no presionados cada vez que el usuario hace clic en él. El botón tiene un color de fondo diferente cuando se encuentra en estado presionado.

   - TBSTYLE_CHECKGROUP crea un botón para comprobar que se mantiene presionado hasta que se presiona el botón otro en el grupo.

   - TBSTYLE_GROUP crea presiona un botón que se mantiene hasta que se presiona el botón otro en el grupo.

   - TBSTYLE_SEP crea un separador, proporciona un pequeño espacio entre los grupos de botón. Un botón que tenga este estilo no recibe la entrada del usuario.

- `dwData`

   Datos definidos por el usuario.

- `iString`

   Índice de base cero de la cadena que se usará como el botón de la etiqueta, -1 si no hay ninguna cadena de este botón.

La imagen o una cadena cuyo índice se proporciona debe anteriormente se han agregado para el control de barra de herramientas lista utilizando [AddBitmap](#addbitmap), [AddString](#addstring), o [a AddStrings](#addstrings).

##  <a name="addstring"></a>  CToolBarCtrl::AddString

Agrega una nueva cadena, pasada como un identificador de recurso a la lista interna de la barra de herramientas de cadenas.

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>Parámetros

*nStringID*<br/>
Identificador de recurso del recurso de cadena para agregar a la lista de cadenas del control de barra de herramientas.

### <a name="return-value"></a>Valor devuelto

Índice de base cero de la primera cadena nuevo agregado si se realiza correctamente; en caso contrario,-1.

##  <a name="addstrings"></a>  CToolBarCtrl::AddStrings

Agrega una nueva cadena o cadenas a la lista de cadenas disponibles para un control de barra de herramientas.

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>Parámetros

*lpszStrings*<br/>
Dirección de un búfer que contiene uno o más cadenas terminadas en null para agregar a la lista de cadenas de la barra de herramientas. La última cadena debe terminar con dos caracteres null.

### <a name="return-value"></a>Valor devuelto

Índice de base cero de la primera cadena nuevo agregado si se realiza correctamente; en caso contrario,-1.

### <a name="remarks"></a>Comentarios

Las cadenas en el búfer deben estar separadas por un carácter nulo. Debe asegurarse de que la última cadena tiene dos terminadores nulos. Para dar formato correctamente a una constante de cadena, puede escribir como:

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

O bien

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

No se debe pasar un `CString` objeto a esta función, ya que no es posible tener más de un carácter null en un `CString`.

##  <a name="autosize"></a>  CToolBarCtrl::AutoSize

Cambia el tamaño del control de barra de herramientas completa.

```
void AutoSize();
```

### <a name="remarks"></a>Comentarios

Esta función se debe llamar cuando cambia el tamaño de la ventana primaria, o cuando cambia el tamaño de la barra de herramientas (por ejemplo, al establecer el tamaño de botón o un mapa de bits, o agregar cadenas).

##  <a name="changebitmap"></a>  CToolBarCtrl::ChangeBitmap

Cambia el mapa de bits para un botón en el control de barra de herramientas actual.

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>Parámetros

|Parámetro|Descripción|
|---------------|-----------------|
|*idButton*|[in] Identificador del comando del botón que se va a recibir un nuevo mapa de bits.|
|*iBitmap*|[in] Índice de base cero de una imagen en la lista de imágenes del control de barra de herramientas actual.|

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Comentarios

Si este método se realiza correctamente, el sistema muestra la imagen especificada en el botón especificado.

Este método envía el [TB_CHANGEBITMAP](/windows/desktop/Controls/tb-changebitmap) mensaje, que se describe en el SDK de Windows.

### <a name="example"></a>Ejemplo

En el ejemplo de código siguiente se cambia el mapa de bits para el **Guardar archivo** botón al mapa de bits para el **sobre** botón.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

##  <a name="checkbutton"></a>  CToolBarCtrl::CheckButton

Comprueba o borra un botón determinado en un control de barra de herramientas.

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador del comando del botón para activar o desactivar.

*bComprobar*<br/>
True para comprobar el botón, FALSE para desactivarla.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Cuando se ha activado un botón, parece que se han presionado. Si desea cambiar el estado de más de un botón, considere la posibilidad de llamar a [SetState](#setstate) en su lugar.

##  <a name="commandtoindex"></a>  CToolBarCtrl::CommandToIndex

Recupera el índice de base cero del botón asociado al identificador de comando especificado.

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador de comando cuyo botón índice al que desea buscar.

### <a name="return-value"></a>Valor devuelto

Índice de base cero del botón asociado al identificador de comando.

### <a name="remarks"></a>Comentarios

##  <a name="create"></a>  CToolBarCtrl::Create

Crea un control de barra de herramientas y lo adjunta a un `CToolBarCtrl` objeto.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Parámetros

*dwStyle*<br/>
Especifica el estilo del control de barra de herramientas. Las barras de herramientas siempre deben tener el estilo WS_CHILD. Además, puede especificar cualquier combinación de los estilos de barra de herramientas y estilos de ventana como se describió en **comentarios**.

*rect*<br/>
Opcionalmente, especifica el tamaño y la posición del control de barra de herramientas. Puede ser un [CRect](../../atl-mfc-shared/reference/crect-class.md) objeto o un [RECT](/previous-versions/dd162897\(v=vs.85\)) estructura.

*pParentWnd*<br/>
Especifica la ventana primaria del control de barra de herramientas. No debe ser NULL.

*nID*<br/>
Especifica el identificador. del control de barra de herramientas

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Construir un `CToolBarCtrl` en dos pasos. En primer lugar, llame al constructor y, a continuación, llame a `Create`, que crea el control de barra de herramientas y lo adjunta a la `CToolBarCtrl` objeto. Se aplican los siguientes estilos de ventana a un control de barra de herramientas.

- WS_CHILD siempre

- WS_VISIBLE normalmente

- WS_DISABLED rara vez

Consulte [CreateWindow](/windows/desktop/api/winuser/nf-winuser-createwindowa) en el SDK de Windows para obtener una descripción de los estilos de ventana.

Opcionalmente, aplique una combinación de [estilos de control comunes](/windows/desktop/Controls/common-control-styles), tal y como se describe en el SDK de Windows.

Aplicar una combinación de estilos de barra de herramientas para el control o los botones sí mismos. Los estilos se describen en el tema [Control de barra de herramientas y los estilos de botón](/windows/desktop/Controls/toolbar-control-and-button-styles) en el SDK de Windows.

Para usar los estilos extendidos de la barra de herramientas, llame a [SetExtendedStyle](#setextendedstyle) después de llamar a `Create`. Para crear una barra de herramientas con los estilos de ventana extendidos, llame a [CToolBarCtrl::CreateEx](#createex) en lugar de `Create`.

El control de barra de herramientas establece automáticamente el tamaño y posición de la ventana de la barra de herramientas. El alto se basa en el alto de los botones en la barra de herramientas. El ancho es igual que el ancho del área de cliente de la ventana primaria. Los estilos CCS_TOP y CCS_BOTTOM determinan si la barra de herramientas se coloca a lo largo de la parte superior o inferior del área de cliente. De forma predeterminada, una barra de herramientas tiene el estilo CCS_TOP.

##  <a name="createex"></a>  CToolBarCtrl::CreateEx

Crea un control (una ventana secundaria) y lo asocia a la `CToolBarCtrl` objeto.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Parámetros

*dwExStyle*<br/>
Especifica el estilo extendido del control que se está creando. Para obtener una lista de los estilos extendidos de Windows, consulte el *dwExStyle* parámetro [CreateWindowEx](/windows/desktop/api/winuser/nf-winuser-createwindowexa) en el SDK de Windows.

*dwStyle*<br/>
Especifica el estilo del control de barra de herramientas. Las barras de herramientas siempre deben tener el estilo WS_CHILD. Además, puede especificar cualquier combinación de los estilos de barra de herramientas y estilos de ventana como se describe en el **comentarios** sección de [crear](#create).

*rect*<br/>
Una referencia a un [RECT](/previous-versions/dd162897\(v=vs.85\)) estructura que describe el tamaño y posición de la ventana que se creará, en coordenadas de cliente de *pParentWnd*.

*pParentWnd*<br/>
Un puntero a la ventana que es primario del control.

*nID*<br/>
Identificador de ventana secundaria. del control

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Use `CreateEx` en lugar de [crear](#create) para aplicar estilos extendidos de Windows, especificados por el prólogo de estilo extendido de Windows **WS_EX_**. `CreateEx` crea el control con los estilos extendidos de Windows especificados por *dwExStyle*. Conjunto específico de un control mediante estilos extendidos [SetExtendedStyle](#setextendedstyle). Por ejemplo, usar `CreateEx` para establecer estos estilos como WS_EX_CONTEXTHELP, pero usa `SetExtendedStyle` para establecer estos estilos como TBSTYLE_EX_DRAWDDARROWS. Para obtener más información, vea los estilos que se describe en [estilos extendidos de barra de herramientas](/windows/desktop/Controls/toolbar-extended-styles) en el SDK de Windows.

##  <a name="ctoolbarctrl"></a>  CToolBarCtrl::CToolBarCtrl

Construye un objeto `CToolBarCtrl`.

```
CToolBarCtrl();
```

### <a name="remarks"></a>Comentarios

Debe llamar a [crear](#create) para que pueda usar la barra de herramientas.

##  <a name="customize"></a>  CToolBarCtrl::Customize

Muestra el cuadro de diálogo Personalizar barra de herramientas.

```
void Customize();
```

### <a name="remarks"></a>Comentarios

Este cuadro de diálogo permite al usuario personalizar la barra de herramientas mediante la adición y eliminación de los botones. Para admitir la personalización, ventana primaria de la barra de herramientas debe controlar los mensajes de notificación de personalización como se describe en [controlar notificaciones de personalización](../../mfc/handling-customization-notifications.md). La barra de herramientas debe también se crearon con el estilo CCS_ADJUSTABLE, como se describe en [CToolBarCtrl:: Create](#create).

##  <a name="deletebutton"></a>  CToolBarCtrl::DeleteButton

Elimina un botón del control de barra de herramientas.

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>Parámetros

*nIndex*<br/>
Índice de base cero del botón Eliminar.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

##  <a name="enablebutton"></a>  CToolBarCtrl::EnableButton

Habilita o deshabilita el botón especificado en un control de barra de herramientas.

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador del comando del botón para habilitar o deshabilitar.

*bHabilitar el*<br/>
TRUE para habilitar el botón; FALSE para deshabilitar el botón.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Cuando se ha habilitado un botón, puede presionar y activado. Si desea cambiar el estado de más de un botón, considere la posibilidad de llamar a [SetState](#setstate) en su lugar.

##  <a name="getanchorhighlight"></a>  CToolBarCtrl::GetAnchorHighlight

Recupera el resaltado de anclaje para una barra de herramientas.

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>Valor devuelto

Si es distinto de cero, resaltado de delimitador está habilitado. Si es cero, el resaltado de anclaje está deshabilitado.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETANCHORHIGHLIGHT](/windows/desktop/Controls/tb-getanchorhighlight), tal y como se describe en el SDK de Windows.

##  <a name="getbitmap"></a>  CToolBarCtrl::GetBitmap

Recupera el índice del mapa de bits asociado con un botón en una barra de herramientas.

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador del comando del botón cuyo índice de mapa de bits es va a recuperar.

### <a name="return-value"></a>Valor devuelto

Devuelve el índice de mapa de bits si se realiza correctamente, o cero en caso contrario.

### <a name="remarks"></a>Comentarios

Implementa la funcionalidad de [TB_GETBITMAP](/windows/desktop/Controls/tb-getbitmap) en el SDK de Windows.

##  <a name="getbitmapflags"></a>  CToolBarCtrl::GetBitmapFlags

Recupera las marcas de mapa de bits de la barra de herramientas.

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>Valor devuelto

Un tipo UINT que tiene la marca TBBF_LARGE establecer si es compatible con la visualización de mapas de bits de la barra de herramientas, desactive en caso contrario.

### <a name="remarks"></a>Comentarios

Se debe llamar después de crear la barra de herramientas, pero antes de agregar mapas de bits a la barra de herramientas. El valor devuelto indica si la presentación admite mapas de bits grandes o no. Si la presentación es compatible con los mapas de bits grandes y si decide usarlas, llame a [SetBitmapSize](#setbitmapsize) y [SetButtonSize](#setbuttonsize) antes de agregar el mapa de bits grande utilizando [AddBitmap](#addbitmap).

##  <a name="getbutton"></a>  CToolBarCtrl::GetButton

Recupera información sobre el botón especificado en un control de barra de herramientas.

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>Parámetros

*nIndex*<br/>
Índice de base cero del botón que se va a recuperar la información.

*lpButton*<br/>
Dirección de la `TBBUTTON` estructura que va a recibir una copia de la información del botón. Consulte [CToolBarCtrl::AddButtons](#addbuttons) para obtener información sobre la `TBBUTTON` estructura.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

##  <a name="getbuttoncount"></a>  CToolBarCtrl::GetButtonCount

Recupera un recuento de los botones actualmente en el control de barra de herramientas.

```
int GetButtonCount() const;
```

### <a name="return-value"></a>Valor devuelto

El recuento de los botones.

##  <a name="getbuttoninfo"></a>  CToolBarCtrl::GetButtonInfo

Recupera la información de un botón en una barra de herramientas.

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
El identificador del botón.

*ptbbi*<br/>
Un puntero a un [TBBUTTONINFO](/windows/desktop/api/commctrl/ns-commctrl-tbbuttoninfoa) estructura que recibe la información del botón.

### <a name="return-value"></a>Valor devuelto

Índice de base cero del botón, si se realiza correctamente; en caso contrario,-1.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETBUTTONINFO](/windows/desktop/Controls/tb-getbuttoninfo), tal y como se describe en el SDK de Windows.

##  <a name="getbuttonsize"></a>  CToolBarCtrl::GetButtonSize

Obtiene el tamaño de un botón de barra de herramientas.

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>Valor devuelto

Un valor DWORD que contiene los valores de anchura y altura en LOWORD y HIWORD, respectivamente.

##  <a name="getbuttontext"></a>  CToolBarCtrl::GetButtonText

Recupera el texto para mostrar un botón especificado en el control de barra de herramientas actual.

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>Parámetros

|Parámetro|Descripción|
|---------------|-----------------|
|*idButton*|[in] El identificador del botón cuyo texto para mostrar se recupera.|

### <a name="return-value"></a>Valor devuelto

Un [CString](../../atl-mfc-shared/using-cstring.md) que contiene el texto para mostrar del botón especificado.

### <a name="remarks"></a>Comentarios

Este método envía el [TB_GETBUTTONTEXT](/windows/desktop/Controls/tb-getbuttontext) mensaje, que se describe en el SDK de Windows.

##  <a name="getcolorscheme"></a>  CToolBarCtrl::GetColorScheme

Recupera la combinación de colores del control de barra de herramientas actual.

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>Parámetros

|Parámetro|Descripción|
|---------------|-----------------|
|*lpColorScheme*|[out] Puntero a un [COLORSCHEME](/windows/desktop/api/commctrl/ns-commctrl-tagcolorscheme) estructura que recibe la información de esquema de color. Cuando este método finaliza, la estructura describe el color de resaltado y el color de sombra del control de barra de herramientas.|

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Comentarios

Este método envía el [TB_GETCOLORSCHEME](/windows/desktop/Controls/tb-getcolorscheme) mensaje, que se describe en el SDK de Windows.

##  <a name="getdisabledimagelist"></a>  CToolBarCtrl::GetDisabledImageList

Recupera la lista de imágenes que se usa un control de barra de herramientas para mostrar deshabilitado los botones.

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>Valor devuelto

Un puntero a un [CImageList](../../mfc/reference/cimagelist-class.md) objeto, o NULL si no se establece ninguna lista de imágenes deshabilitado.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETDISABLEDIMAGELIST](/windows/desktop/Controls/tb-getdisabledimagelist), tal y como se describe en el SDK de Windows. La implementación de MFC `GetDisabledImageList` usa un `CImageList` imágenes de objeto que contiene el botón del control de barra de herramientas, en lugar de un identificador de una lista de imágenes.

##  <a name="getdroptarget"></a>  CToolBarCtrl::GetDropTarget

Recupera el [IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget) interfaz para un control de barra de herramientas.

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>Parámetros

*ppDropTarget*<br/>
Un puntero a un [IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget) puntero de interfaz. Si se produce un error, se coloca un puntero NULL en esta dirección.

### <a name="return-value"></a>Valor devuelto

Devuelve un valor HRESULT que indica éxito o fracaso de la operación.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETOBJECT](/windows/desktop/Controls/tb-getobject), tal y como se describe en el SDK de Windows.

##  <a name="getextendedstyle"></a>  CToolBarCtrl::GetExtendedStyle

Recupera los estilos extendidos para un control de barra de herramientas.

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>Valor devuelto

DWORD que representa los estilos extendidos actualmente en uso para el control de barra de herramientas. Para obtener una lista de estilos, consulte [estilos extendidos de barra de herramientas](/windows/desktop/Controls/toolbar-extended-styles), en el SDK de Windows.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETEXTENDEDSTYLE](/windows/desktop/Controls/tb-getextendedstyle), tal y como se describe en el SDK de Windows.

##  <a name="gethotimagelist"></a>  CToolBarCtrl::GetHotImageList

Recupera la lista de imágenes que usa un control de barra de herramientas para mostrar los botones "activos". Un botón activo aparece resaltado cuando el puntero del mouse está por encima de él.

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>Valor devuelto

Un puntero a un [CImageList](../../mfc/reference/cimagelist-class.md) objeto, o NULL si no se establece ninguna lista de imágenes deshabilitado.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETHOTIMAGELIST](/windows/desktop/Controls/tb-gethotimagelist), tal y como se describe en el SDK de Windows. Un botón activo aparece resaltado cuando el puntero del mouse está por encima de él.

##  <a name="gethotitem"></a>  CToolBarCtrl::GetHotItem

Recupera el índice del elemento activo en una barra de herramientas.

```
int GetHotItem() const;
```

### <a name="return-value"></a>Valor devuelto

Índice de base cero del elemento activo en una barra de herramientas.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETHOTITEM](/windows/desktop/Controls/tb-gethotitem), tal y como se describe en el SDK de Windows.

##  <a name="getimagelist"></a>  CToolBarCtrl::GetImageList

Recupera la lista de imágenes que usa un control de barra de herramientas para mostrar botones en su estado predeterminado.

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>Valor devuelto

Un puntero a un [CImageList](../../mfc/reference/cimagelist-class.md) objeto, o NULL si no se establece ninguna lista de imágenes.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETIMAGELIST](/windows/desktop/Controls/tb-getimagelist), tal y como se describe en el SDK de Windows.

##  <a name="getinsertmark"></a>  CToolBarCtrl::GetInsertMark

Recupera la marca de inserción actual de la barra de herramientas.

```
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>Parámetros

*ptbim*<br/>
Un puntero a un [TBINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-tbinsertmark) estructura que recibe la marca de inserción.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETINSERTMARK](/windows/desktop/Controls/tb-getinsertmark), tal y como se describe en el SDK de Windows.

##  <a name="getinsertmarkcolor"></a>  CToolBarCtrl::GetInsertMarkColor

Recupera el color utilizado para dibujar la marca de inserción para la barra de herramientas.

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>Valor devuelto

Un valor COLORREF que contiene el color de la marca de inserción actual.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETINSERTMARKCOLOR](/windows/desktop/Controls/tb-getinsertmarkcolor), tal y como se describe en el SDK de Windows.

##  <a name="getitemrect"></a>  CToolBarCtrl::GetItemRect

Recupera el rectángulo delimitador de un botón en un control de barra de herramientas.

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Parámetros

*nIndex*<br/>
Índice de base cero del botón que se va a recuperar la información.

*lpRect*<br/>
Dirección de un [RECT](/previous-versions/dd162897\(v=vs.85\)) estructura o un [CRect](../../atl-mfc-shared/reference/crect-class.md) objeto que recibe las coordenadas del rectángulo delimitador.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esta función no recupera el rectángulo delimitador para los botones cuyo estado se establece en TBSTATE_HIDDEN.

##  <a name="getmaxsize"></a>  CToolBarCtrl::GetMaxSize

Recupera el tamaño total de todos los botones visibles y los separadores en la barra de herramientas.

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>Parámetros

*pSize*<br/>
Un puntero a un [tamaño](/windows/desktop/api/windef/ns-windef-tagsize) estructura que recibe el tamaño de los elementos.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETMAXSIZE](/windows/desktop/Controls/tb-getmaxsize), tal y como se describe en el SDK de Windows.

##  <a name="getmaxtextrows"></a>  CToolBarCtrl::GetMaxTextRows

Recupera el número máximo de filas de texto que se muestran en un botón de barra de herramientas.

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>Valor devuelto

El número máximo de filas de texto que se muestran en un botón de barra de herramientas.

##  <a name="getmetrics"></a>  CToolBarCtrl::GetMetrics

Recupera las métricas de la `CToolBarCtrl` objeto.

```
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>Parámetros

*ptbm*<br/>
Un puntero a la [TBMETRICS](/windows/desktop/api/commctrl/ns-commctrl-tbmetrics) estructura de la `CToolBarCtrl` objeto.

### <a name="remarks"></a>Comentarios

Esta función miembro emula la funcionalidad de la [TB_GETMETRICS](/windows/desktop/Controls/tb-getmetrics) del mensaje, como se describe en el SDK de Windows.

##  <a name="getpadding"></a>  CToolBarCtrl::GetPadding

Recupera el relleno horizontal y vertical del control de barra de herramientas actual.

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>Parámetros

|Parámetro|Descripción|
|---------------|-----------------|
|*pnHorzPadding*|[out] Un entero que recibe el relleno horizontal del control de barra de herramientas, en píxeles.|
|*pnVertPadding*|[out] Un entero que recibe el relleno vertical del control de barra de herramientas, en píxeles.|

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Comentarios

Este método envía el [TB_GETPADDING](/windows/desktop/Controls/tb-getpadding) mensaje, que se describe en el SDK de Windows.

##  <a name="getpressedimagelist"></a>  CToolBarCtrl::GetPressedImageList

Recupera la lista de imágenes que el control de barra de herramientas actual que se usa para representar los botones en estado presionado.

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>Valor devuelto

Puntero a un [CImageList](../../mfc/reference/cimagelist-class.md) que contiene la lista de imágenes para el control actual, o NULL si no se ha establecido ninguna lista de imágenes de este tipo.

### <a name="remarks"></a>Comentarios

Este método envía el [TB_GETPRESSEDIMAGELIST](/windows/desktop/Controls/tb-getpressedimagelist) mensaje, que se describe en el SDK de Windows.

##  <a name="getrect"></a>  CToolBarCtrl::GetRect

Recupera el rectángulo delimitador para un botón de barra de herramientas especificada.

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
El identificador del botón.

*lpRect*<br/>
Un puntero a un [RECT](/previous-versions/dd162897\(v=vs.85\)) estructura para recibir la información del rectángulo delimitador.

### <a name="return-value"></a>Valor devuelto

TRUE si es correcto; en caso contrario, FALSE.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETRECT](/windows/desktop/Controls/tb-getrect), tal y como se describe en el SDK de Windows.

##  <a name="getrows"></a>  CToolBarCtrl::GetRows

Recupera el número de filas de botones que se muestra actualmente por el control de barra de herramientas.

```
int GetRows() const;
```

### <a name="return-value"></a>Valor devuelto

Número de filas de botones que se muestra actualmente en la barra de herramientas.

### <a name="remarks"></a>Comentarios

Tenga en cuenta que el número de filas siempre será uno, a menos que se creó la barra de herramientas con el estilo TBSTYLE_WRAPABLE.

##  <a name="getstate"></a>  CToolBarCtrl::GetState

Recupera información sobre el estado del botón especificado en un control de barra de herramientas, por ejemplo, si está habilitado, presionado o activado.

```
int GetState(int nID) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador del comando del botón que se va a recuperar la información.

### <a name="return-value"></a>Valor devuelto

La información de estado del botón si se realiza correctamente o - 1 en caso contrario. La información de estado del botón puede ser una combinación de los valores enumerados en [CToolBarCtrl::AddButtons](#addbuttons).

### <a name="remarks"></a>Comentarios

Esta función resulta especialmente útil si desea recuperar más de uno de los Estados del botón. Para recuperar sólo un estado, use una de las funciones miembro siguientes: [IsButtonEnabled tal](#isbuttonenabled), [IsButtonChecked](#isbuttonchecked), [IsButtonPressed](#isbuttonpressed), [IsButtonHidden](#isbuttonhidden), o [IsButtonIndeterminate](#isbuttonindeterminate). Sin embargo, el `GetState` función miembro es la única manera de detectar el estado del botón TBSTATE_WRAP.

##  <a name="getstring"></a>  CToolBarCtrl::GetString

Recupera una cadena de la barra de herramientas.

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>Parámetros

*nString*<br/>
Índice de la cadena.

*lpstrString*<br/>
Puntero a un búfer que se usa para devolver la cadena.

*cchMaxLen*<br/>
Longitud del búfer en bytes.

*str*<br/>
La cadena.

### <a name="return-value"></a>Valor devuelto

La longitud de la cadena si es correcto, -1 si no lo es.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_GETSTRING](/windows/desktop/Controls/tb-getstring), tal y como se describe en el SDK de Windows.

##  <a name="getstyle"></a>  CToolBarCtrl::GetStyle

Obtiene los estilos actualmente aplicados a un control de barra de herramientas.

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>Valor devuelto

Un valor DWORD que contiene una combinación de [estilos de control de barra de herramientas](/windows/desktop/Controls/toolbar-control-and-button-styles), tal y como se describe en el SDK de Windows.

##  <a name="gettooltips"></a>  CToolBarCtrl::GetToolTips

Recupera el identificador del control de la sugerencia de herramienta, si existe, asociado con el control de barra de herramientas.

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>Valor devuelto

Un puntero a la [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) objeto asociado con esta barra de herramientas o NULL si la barra de herramientas no tiene ningún control de información sobre herramientas asociado.

### <a name="remarks"></a>Comentarios

Dado que el control de barra de herramientas normalmente crea y mantiene su propio control de información sobre herramientas, mayoría de los programas no es necesario llamar a esta función.

##  <a name="hittest"></a>  CToolBarCtrl::HitTest

Determina dónde se encuentra un punto en un control de barra de herramientas.

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>Parámetros

*ppt*<br/>
Un puntero a un [punto](/previous-versions/dd162805\(v=vs.85\)) estructura que contiene la coordenada x de la prueba de posicionamiento en el `x` miembro y la coordenada y de la posición de prueba en el `y` miembro. Las coordenadas son relativas al área de cliente de la barra de herramientas.

### <a name="return-value"></a>Valor devuelto

Valor entero que indica la ubicación de un punto de una barra de herramientas. Si el valor es cero o un valor positivo, el valor devuelto es el índice de base cero del elemento nonseparator en el que se encuentra el punto.

Si el valor devuelto es negativo, el punto no queda dentro de un botón. El valor absoluto del valor devuelto es el índice de un elemento separador o el elemento nonseparator más cercano.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_HITTEST](/windows/desktop/Controls/tb-hittest), tal y como se describe en el SDK de Windows.

##  <a name="hidebutton"></a>  CToolBarCtrl::HideButton

Oculta o muestra el botón especificado en un control de barra de herramientas.

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador del comando del botón para mostrar u ocultar.

*bHide*<br/>
True para ocultar el botón, FALSE para mostrarla.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Si desea cambiar el estado de más de un botón, considere la posibilidad de llamar a [SetState](#setstate) en su lugar.

##  <a name="indeterminate"></a>  CToolBarCtrl::Indeterminate

Establece o borra el estado indeterminado del botón especificado en un control de barra de herramientas.

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador del comando del botón cuyo estado indeterminado consiste en estar establecida o desactivada.

*bIndeterminate*<br/>
TRUE para establecer el estado indeterminado del botón especificado, FALSE para desactivarla.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Botones indeterminados se muestran en gris, como la forma del botón Negrita en la barra de herramientas de un procesador de textos tendría el aspecto cuando el texto seleccionado contiene caracteres en negrita y normales. Si desea cambiar el estado de más de un botón, considere la posibilidad de llamar a [SetState](#setstate) en su lugar.

##  <a name="insertbutton"></a>  CToolBarCtrl::InsertButton

Inserta un botón en un control de barra de herramientas.

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>Parámetros

*nIndex*<br/>
Índice de base cero de un botón. Esta función inserta el nuevo botón a la izquierda de este botón.

*lpButton*<br/>
Dirección de un `TBBUTTON` estructura que contiene información acerca del botón que se va a insertar. Consulte [CToolBarCtrl::AddButtons](#addbuttons) para obtener una descripción de la `TBBUTTON` estructura.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

La imagen o una cadena cuyo índice se proporciona debe anteriormente se han agregado para el control de barra de herramientas lista utilizando [AddBitmap](#addbitmap), [AddString](#addstring), o [a AddStrings](#addstrings).

##  <a name="insertmarkhittest"></a>  CToolBarCtrl::InsertMarkHitTest

Recupera la información de marca de inserción de un punto en una barra de herramientas.

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>Parámetros

*ppt*<br/>
Un puntero a un [punto](/previous-versions/dd162805\(v=vs.85\)) coordina la estructura que contiene la prueba de posicionamiento, en relación con el área cliente de la barra de herramientas.

*ptbim*<br/>
Un puntero a un [TBINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-tbinsertmark) estructura que recibe la información de marca de inserción.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_INSERTMARKHITTEST](/windows/desktop/Controls/tb-insertmarkhittest), tal y como se describe en el SDK de Windows.

##  <a name="isbuttonchecked"></a>  CToolBarCtrl::IsButtonChecked

Determina si se activa el botón especificado en un control de barra de herramientas.

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador del comando del botón en la barra de herramientas.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se activa el botón; en caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Considere la posibilidad de llamar a [GetState](#getstate) si desea recuperar más de un estado de botón.

##  <a name="isbuttonenabled"></a>  CToolBarCtrl::IsButtonEnabled

Determina si está habilitado el botón especificado en un control de barra de herramientas.

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador del comando del botón en la barra de herramientas.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el botón está habilitado; en caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Considere la posibilidad de llamar a [GetState](#getstate) si desea recuperar más de un estado de botón.

##  <a name="isbuttonhidden"></a>  CToolBarCtrl::IsButtonHidden

Determina si se oculta el botón especificado en un control de barra de herramientas.

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador del comando del botón en la barra de herramientas.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se oculta el botón; en caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Considere la posibilidad de llamar a [GetState](#getstate) si desea recuperar más de un estado de botón.

##  <a name="isbuttonhighlighted"></a>  CToolBarCtrl::IsButtonHighlighted

Comprueba el estado de resaltado de un botón de barra de herramientas.

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
[in] El identificador de comando para el botón de barra de herramientas.

### <a name="return-value"></a>Valor devuelto

Si se resalta el botón de número entero positivo, 0 si no se resalta el botón, o -1 si un error se produce.

##  <a name="isbuttonindeterminate"></a>  CToolBarCtrl::IsButtonIndeterminate

Determina si el botón especificado en un control de barra de herramientas es indeterminado.

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
[in] Identificador del comando del botón en la barra de herramientas.

### <a name="return-value"></a>Valor devuelto

Entero positivo si el botón es indeterminado, cero si el botón no es indeterminado, o -1 si un error se produce.

### <a name="remarks"></a>Comentarios

Indeterminado botones aparecen atenuadas, tales como la forma del botón Negrita en la barra de herramientas de un procesador de textos que se ve cuando el texto seleccionado contiene caracteres en negrita y normales. Considere la posibilidad de llamar a [GetState](#getstate) si desea recuperar más de un estado de botón.

##  <a name="isbuttonpressed"></a>  CToolBarCtrl::IsButtonPressed

Determina si se presiona el botón especificado en un control de barra de herramientas.

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador del comando del botón en la barra de herramientas.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se presiona el botón, en caso contrario, cero.

### <a name="remarks"></a>Comentarios

Considere la posibilidad de llamar a [GetState](#getstate) si desea recuperar más de un estado de botón.

##  <a name="loadimages"></a>  CToolBarCtrl::LoadImages

Carga los mapas de bits en la lista de imágenes de un control de barra de herramientas.

```
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>Parámetros

*iBitmapID*<br/>
Id. de un mapa de bits que contiene las imágenes que se van a cargar. Para especificar su propio recurso de mapa de bits, establezca este parámetro en el identificador de un recurso de mapa de bits y establezca *hInst* en NULL. El recurso de mapa de bits se agregará a la lista de imágenes como una sola imagen. Puede agregar mapas de bits estándar definido por el sistema estableciendo *hinst* HINST_COMMCTRL y establecer este parámetro en uno de los siguientes identificadores:

|Id. de mapa de bits|Descripción|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|Mapas de bits del explorador de gran tamaño|
|IDB_HIST_SMALL_COLOR|Mapas de bits del explorador de pequeño tamaño|
|IDB_STD_LARGE_COLOR|Mapas de bits estándar de gran tamaño|
|IDB_STD_SMALL_COLOR|Mapas de bits estándar de pequeño tamaño|
|IDB_VIEW_LARGE_COLOR|Mapas de bits de la vista de gran tamaño|
|IDB_VIEW_SMALL_COLOR|Mapas de bits de la vista de pequeño tamaño|

*hinst*<br/>
Identificador de instancia del programa para la aplicación que realiza la llamada. Este parámetro puede ser HINST_COMMCTRL para cargar una lista de imágenes estándar.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_LOADIMAGES](/windows/desktop/Controls/tb-loadimages), tal y como se describe en el SDK de Windows.

##  <a name="mapaccelerator"></a>  CToolBarCtrl::MapAccelerator

Un carácter de acelerador se asigna a un botón de barra de herramientas.

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>Parámetros

*chAccel*<br/>
Carácter de Acelerador para asignarse. Este carácter es el mismo carácter que está subrayado en el texto del botón.

*pIDBtn*<br/>
Un puntero a un tipo UINT que recibe el identificador de comando del botón que se corresponde con el acelerador especificado en *chAccel*.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_MAPACCELERATOR](/windows/desktop/Controls/tb-mapaccelerator), tal y como se describe en el SDK de Windows.

##  <a name="markbutton"></a>  CToolBarCtrl::MarkButton

Establece el estado de resaltado de un botón determinado en un control de barra de herramientas.

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
El identificador del botón.

*fHighlight*<br/>
Especifica el estado de resaltado debe establecerse. De forma predeterminada, el valor TRUE. Si se establece en FALSE, el botón se establece en su estado predeterminado.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_MARKBUTTON](/windows/desktop/Controls/tb-markbutton), tal y como se describe en el SDK de Windows.

##  <a name="movebutton"></a>  CToolBarCtrl::MoveButton

Mueve un botón de un índice a otra.

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>Parámetros

*nOldPos*<br/>
Índice de base cero del botón que se va a mover.

*nNewPos*<br/>
Índice de base cero de destino del botón.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_MOVEBUTTON](/windows/desktop/Controls/tb-movebutton), tal y como se describe en el SDK de Windows.

##  <a name="pressbutton"></a>  CToolBarCtrl::PressButton

Presiona o suelta el botón especificado en un control de barra de herramientas.

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
[in] Identificador del comando del botón en presiona o suelta.

*bPress*<br/>
[in] TRUE para que se presione el botón especificado; FALSE para liberar el botón especificado. El valor predeterminado es TRUE.

### <a name="return-value"></a>Valor devuelto

TRUE si el método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Comentarios

Si desea cambiar el estado de más de un botón, considere la posibilidad de llamar a [SetState](#setstate) en su lugar.

Este método envía el [TB_PRESSBUTTON](/windows/desktop/Controls/tb-pressbutton) mensaje, que se describe en el SDK de Windows.

##  <a name="replacebitmap"></a>  CToolBarCtrl::ReplaceBitmap

Reemplaza el mapa de bits existente en el control de barra de herramientas actual con un nuevo mapa de bits.

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>Parámetros

|Parámetro|Descripción|
|---------------|-----------------|
|*pReplaceBitmap*|[in] Puntero a un [TBREPLACEBITMAP](/windows/desktop/api/commctrl/ns-commctrl-tbreplacebitmap) estructura que describe el mapa de bits que se debe reemplazar y el nuevo mapa de bits.|

### <a name="return-value"></a>Valor devuelto

TRUE si este método se realiza correctamente; en caso contrario, FALSE.

### <a name="remarks"></a>Comentarios

Este método envía el [TB_REPLACEBITMAP](/windows/desktop/Controls/tb-replacebitmap) mensaje, que se describe en el SDK de Windows.

### <a name="example"></a>Ejemplo

El siguiente ejemplo de código reemplaza el mapa de bits de la barra de herramientas estándar con un mapa de bits diferentes.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

##  <a name="restorestate"></a>  CToolBarCtrl::RestoreState

Restaura el estado del control de barra de herramientas de la ubicación en el registro especificado por los parámetros.

```
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Parámetros

*hKeyRoot*<br/>
Identifica una clave abierta actualmente en el registro o cualquiera de los valores de identificador reservado predefinidos siguientes:

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
Apunta a una cadena terminada en null que contiene el nombre de la subclave que se asocia un valor. Este parámetro puede ser null o un puntero a una cadena vacía. Si el parámetro es NULL, el valor se agregará a la clave identificada por el *hKeyRoot* parámetro.

*lpszValueName*<br/>
Apunta a una cadena que contiene el nombre del valor que se va a recuperar. Si un valor con este nombre ya no está presente en la clave, la función lo agrega a la clave.

##  <a name="savestate"></a>  CToolBarCtrl::SaveState

Guarda el estado del control de barra de herramientas en la ubicación en el registro especificado por los parámetros.

```
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Parámetros

*hKeyRoot*<br/>
Identifica una clave abierta actualmente en el registro o cualquiera de los valores de identificador reservado predefinidos siguientes:

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
Apunta a una cadena terminada en null que contiene el nombre de la subclave que se asocia un valor. Este parámetro puede ser null o un puntero a una cadena vacía. Si el parámetro es NULL, el valor se agregará a la clave identificada por el *hKeyRoot* parámetro.

*lpszValueName*<br/>
Apunta a una cadena que contiene el nombre del valor para establecer. Si un valor con este nombre ya no está presente en la clave, la función lo agrega a la clave.

##  <a name="setanchorhighlight"></a>  CToolBarCtrl::SetAnchorHighlight

Establece el resaltado de anclaje para una barra de herramientas.

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>Parámetros

*fAnchor*<br/>
[in] Especifica si el resaltado de delimitador está habilitado o deshabilitado. Si este valor es distinto de cero, se habilitará el anclaje resaltado. Si este valor es cero, se deshabilitará al anclaje resaltado

### <a name="return-value"></a>Valor devuelto

El valor de delimitador anterior. Si se habilitó el resaltado, este valor es distinto de cero. Si no se habilitó el resaltado, este valor es cero.

### <a name="remarks"></a>Comentarios

Este método implementa el comportamiento del mensaje de Win32 [TB_SETANCHORHIGHLIGHT](/windows/desktop/Controls/tb-setanchorhighlight), tal y como se describe en el SDK de Windows.

##  <a name="setbitmapsize"></a>  CToolBarCtrl::SetBitmapSize

Establece el tamaño de las imágenes de mapa de bits reales que se agregarán a un control de barra de herramientas.

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>Parámetros

*size*<br/>
Ancho y alto, en píxeles, de las imágenes de mapa de bits.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esta función debe llamarse únicamente antes de agregar los mapas de bits a la barra de herramientas. Si la aplicación no establece explícitamente el tamaño del mapa de bits, el valor predeterminado es 16 por 15 píxeles.

##  <a name="setbuttoninfo"></a>  CToolBarCtrl::SetButtonInfo

Establece la información de un botón existente en una barra de herramientas.

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
El identificador del botón.

*ptbbi*<br/>
Un puntero a un [TBBUTTONINFO](/windows/desktop/api/commctrl/ns-commctrl-tbbuttoninfoa) estructura que recibe la información del botón.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

La función miembro implementa el comportamiento del mensaje de Win32 [TB_SETBUTTONINFO](/windows/desktop/Controls/tb-setbuttoninfo), tal y como se describe en el SDK de Windows.

##  <a name="setbuttonsize"></a>  CToolBarCtrl::SetButtonSize

Establece el tamaño de los botones del control de barra de herramientas.

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>Parámetros

*size*<br/>
Ancho y alto, en píxeles, de los botones.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

El tamaño del botón siempre debe ser al menos tan grande como el tamaño del mapa de bits que incluye. Esta función debe llamarse únicamente antes de agregar los mapas de bits a la barra de herramientas. Si la aplicación no establece explícitamente el tamaño del botón, el valor predeterminado es 24 por 22 píxeles.

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CToolBar:: GetToolBarCtrl](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl).

##  <a name="setbuttonstructsize"></a>  CToolBarCtrl::SetButtonStructSize

Especifica el tamaño de la `TBBUTTON` estructura.

```
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>Parámetros

*nSize*<br/>
Tamaño, en bytes, de la `TBBUTTON` estructura.

### <a name="remarks"></a>Comentarios

Si desea almacenar datos adicionales en el `TBBUTTON` estructura, o bien podría derivar una nueva estructura de `TBBUTTON`, agregar los miembros sea necesario, o crear una estructura que contiene un `TBBUTTON` estructura como su primer miembro. A continuación, se llamaría a esta función para indicar el control de barra de herramientas en el tamaño de la nueva estructura.

Consulte [CToolBarCtrl::AddButtons](#addbuttons) para obtener más información sobre la `TBBUTTON` estructura.

##  <a name="setbuttonwidth"></a>  CToolBarCtrl::SetButtonWidth

Establece el ancho mínimo y máximo de botón en el control de barra de herramientas.

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>Parámetros

*cxMin*<br/>
Ancho del botón mínimo, en píxeles. Botones de barra de herramientas nunca será más estrechas que este valor.

*cxMax*<br/>
Ancho del botón máximo, en píxeles. Si el texto del botón es demasiado amplia, en el control se muestra con puntos de puntos suspensivos.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_SETBUTTONWIDTH](/windows/desktop/Controls/tb-setbuttonwidth), tal y como se describe en el SDK de Windows.

##  <a name="setcmdid"></a>  CToolBarCtrl::SetCmdID

Establece el identificador de comando que se enviarán a la ventana propietaria cuando se presiona el botón especificado.

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>Parámetros

*nIndex*<br/>
Índice de base cero del botón cuyo identificador de comando que se va a establecer.

*nID*<br/>
El identificador de comando para establecer el botón seleccionado.

### <a name="return-value"></a>Valor devuelto

Devuelve cero si se realiza correctamente; en caso contrario, es cero.

##  <a name="setcolorscheme"></a>  CToolBarCtrl::SetColorScheme

Establece la combinación de colores del control de barra de herramientas actual.

```
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>Parámetros

|Parámetro|Descripción|
|---------------|-----------------|
|*lpColorScheme*|[in] Puntero a un [COLORSCHEME](/windows/desktop/api/commctrl/ns-commctrl-tagcolorscheme) estructura que describe el color de resaltado y el color de sombra del control de barra de herramientas.|

### <a name="remarks"></a>Comentarios

Este método no tiene ningún efecto si se establece un tema visual de Windows Vista.

Este método envía el [TB_SETCOLORSCHEME](/windows/desktop/Controls/tb-setcolorscheme) mensaje, que se describe en el SDK de Windows.

### <a name="example"></a>Ejemplo

El ejemplo de código siguiente establece la combinación de colores para el control de barra de herramientas actual. El ejemplo de código realiza los bordes superiores e izquierdos de cada botón herramienta rojo y los bordes derecho e inferior azul. Cuando el usuario presiona el botón, los bordes rojos del botón en color azules y sus bordes azules en color rojos.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

##  <a name="setdisabledimagelist"></a>  CToolBarCtrl::SetDisabledImageList

Establece la lista de imágenes que se va a usar el control de barra de herramientas para mostrar deshabilitado los botones.

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Parámetros

*pImageList*<br/>
Un puntero a un `CImageList` objeto que contiene las imágenes que va a usar el control de barra de herramientas a las imágenes de botón Mostrar deshabilitado.

### <a name="return-value"></a>Valor devuelto

Un puntero a un [CImageList](../../mfc/reference/cimagelist-class.md) objeto que se había utilizado previamente por el control de barra de herramientas para las imágenes de botón Mostrar deshabilitado.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_SETDISABLEDIMAGELIST](/windows/desktop/Controls/tb-setdisabledimagelist), tal y como se describe en el SDK de Windows. La implementación de MFC `SetDisabledImageList` usa un `CImageList` imágenes de objeto que contiene el botón deshabilitado del control de barra de herramientas, en lugar de un identificador de una lista de imágenes.

##  <a name="setdrawtextflags"></a>  CToolBarCtrl::SetDrawTextFlags

Establece las marcas de la función de Win32 [DrawText](/windows/desktop/api/winuser/nf-winuser-drawtext), que se usa para dibujar el texto en el rectángulo especificado, con un formato según cómo se establecen las marcas.

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>Parámetros

*dwMask*<br/>
Una combinación de uno o varios de los indicadores DT_, especificados en la función de Win32 [DrawText](/windows/desktop/api/winuser/nf-winuser-drawtext), que indica que bits en *dwDTFlags* se usará al dibujar el texto.

*dwDTFlags*<br/>
Una combinación de uno o varios de los indicadores DT_, especificados en la función de Win32 `DrawText`, que indican cómo se dibujará el texto del botón. Este valor se pasa a `DrawText` cuando se dibuja el texto del botón.

### <a name="return-value"></a>Valor devuelto

DWORD que contiene el marcas de dibujo de texto anterior.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_SETDRAWTEXTFLAGS](/windows/desktop/Controls/tb-setdrawtextflags), tal y como se describe en el SDK de Windows. Esta función miembro establece las marcas de la función de Win32 `DrawText`, que dibuja el texto en el rectángulo especificado, con un formato según cómo se establecen las marcas.

##  <a name="setextendedstyle"></a>  CToolBarCtrl::SetExtendedStyle

Establece los estilos extendidos para un control de barra de herramientas.

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>Parámetros

*dwExStyle*<br/>
Valor que especifica los estilos extendidos de nuevo. Este parámetro puede ser una combinación de la barra de herramientas estilos extendidos.

### <a name="return-value"></a>Valor devuelto

Estilos extendidos de un valor DWORD que representa el anterior. Para obtener una lista de estilos, consulte [estilos extendidos de barra de herramientas](/windows/desktop/Controls/toolbar-extended-styles), en el SDK de Windows.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_SETEXTENDEDSTYLE](/windows/desktop/Controls/tb-setextendedstyle), tal y como se describe en el SDK de Windows.

##  <a name="sethotimagelist"></a>  CToolBarCtrl::SetHotImageList

Establece la lista de imágenes que va a usar el control de barra de herramientas para mostrar los botones "activos".

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Parámetros

*pImageList*<br/>
Un puntero a un `CImageList` objeto que contiene las imágenes que se usará el control de barra de herramientas para mostrar imágenes de botón activo.

### <a name="return-value"></a>Valor devuelto

Un puntero a un [CImageList](../../mfc/reference/cimagelist-class.md) objeto que se había utilizado previamente por el control de barra de herramientas para mostrar las imágenes de botón activo.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_SETHOTIMAGELIST](/windows/desktop/Controls/tb-sethotimagelist), tal y como se describe en el SDK de Windows.

La implementación de MFC `SetHotImageList` usa un `CImageList` imágenes de objeto que contiene el botón de activo del control de barra de herramientas, en lugar de un identificador de una lista de imágenes. Un botón activo aparece resaltado cuando el puntero se encuentra por encima de él.

##  <a name="sethotitem"></a>  CToolBarCtrl::SetHotItem

Establece el elemento activo en una barra de herramientas.

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>Parámetros

*nHot*<br/>
El número de índice de base cero del elemento que estará activo. Si este valor es -1, ninguno de los elementos estará de moda.

### <a name="return-value"></a>Valor devuelto

Índice del elemento activo anterior, o -1 si se ha producido ningún elemento activo.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_SETHOTITEM](/windows/desktop/Controls/tb-sethotitem), tal y como se describe en el SDK de Windows.

##  <a name="setimagelist"></a>  CToolBarCtrl::SetImageList

Establece la lista de imágenes que va a usar la barra de herramientas para mostrar botones que se encuentran en su estado predeterminado.

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Parámetros

*pImageList*<br/>
Un puntero a un `CImageList` objeto que contiene las imágenes que se usará el control de barra de herramientas para mostrar imágenes de botón en su estado predeterminado.

### <a name="return-value"></a>Valor devuelto

Un puntero a un [CImageList](../../mfc/reference/cimagelist-class.md) objeto que se había utilizado previamente por el control de barra de herramientas para mostrar las imágenes de botón en su estado predeterminado.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_SETIMAGELIST](/windows/desktop/Controls/tb-setimagelist), tal y como se describe en el SDK de Windows.

La implementación de MFC `SetImageList` usa un `CImageList` imágenes de objeto que contiene el botón del control de barra de herramientas, en lugar de un identificador de una lista de imágenes.

##  <a name="setindent"></a>  CToolBarCtrl::SetIndent

Establece la sangría del primer botón en un control de barra de herramientas.

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>Parámetros

*iIndent*<br/>
Valor que especifica la sangría, en píxeles.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

##  <a name="setinsertmark"></a>  CToolBarCtrl::SetInsertMark

Establece la marca de inserción actual de la barra de herramientas.

```
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>Parámetros

*ptbim*<br/>
Un puntero a la [TBINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-tbinsertmark) estructura que contiene la marca de inserción.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_SETINSERTMARK](/windows/desktop/Controls/tb-setinsertmark), tal y como se describe en el SDK de Windows.

##  <a name="setinsertmarkcolor"></a>  CToolBarCtrl::SetInsertMarkColor

Establece el color utilizado para dibujar la marca de inserción para la barra de herramientas.

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>Parámetros

*clrNew*<br/>
Un valor COLORREF que contiene el nuevo color de la marca de inserción.

### <a name="return-value"></a>Valor devuelto

Un valor COLORREF que contiene el color de la marca de inserción anterior.

### <a name="remarks"></a>Comentarios

Esta función miembro implementa el comportamiento del mensaje de Win32 [TB_SETINSERTMARKCOLOR](/windows/desktop/Controls/tb-setinsertmarkcolor), tal y como se describe en el SDK de Windows.

##  <a name="setmaxtextrows"></a>  CToolBarCtrl::SetMaxTextRows

Establece el número máximo de filas de texto que se muestran en un botón de barra de herramientas.

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>Parámetros

*iMaxRows*<br/>
Número máximo de filas que se va a establecer.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

##  <a name="setmetrics"></a>  CToolBarCtrl::SetMetrics

Establece las métricas de la `CToolBarCtrl` objeto.

```
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>Parámetros

*ptbm*<br/>
Un puntero a la [TBMETRICS](/windows/desktop/api/commctrl/ns-commctrl-tbmetrics) estructura de la `CToolBarCtrl` objeto.

### <a name="remarks"></a>Comentarios

Esta función miembro emula la funcionalidad de la [TB_SETMETRICS](/windows/desktop/Controls/tb-setmetrics) del mensaje, como se describe en el SDK de Windows.

##  <a name="setowner"></a>  CToolBarCtrl::SetOwner

Establece la ventana propietaria para el control de barra de herramientas.

```
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>Parámetros

*pWnd*<br/>
Puntero a la `CWnd` o `CWnd`-objeto derivado que será la nueva ventana de propietario para el control de barra de herramientas.

### <a name="remarks"></a>Comentarios

La ventana propietaria es la ventana que recibe notificaciones de la barra de herramientas.

##  <a name="setpadding"></a>  CToolBarCtrl::SetPadding

Establece el relleno horizontal y vertical del control de barra de herramientas actual.

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>Parámetros

|Parámetro|Descripción|
|---------------|-----------------|
|*nHorzPadding*|[in] Especifica el relleno horizontal del control de barra de herramientas, en píxeles.|
|*nVertPadding*|[in] Especifica el relleno vertical del control de barra de herramientas, en píxeles.|

### <a name="return-value"></a>Valor devuelto

Un valor DWORD cuya palabra baja contiene el valor de relleno horizontal anterior, y cuya palabra alta contiene el valor de relleno vertical anterior. Los valores de relleno se miden en píxeles.

### <a name="remarks"></a>Comentarios

Este método envía el [TB_SETPADDING](/windows/desktop/Controls/tb-setpadding) mensaje, que se describe en el SDK de Windows.

### <a name="example"></a>Ejemplo

El ejemplo de código siguiente establece el relleno horizontal y vertical del control de barra de herramientas actual a 20 píxeles.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

##  <a name="setpressedimagelist"></a>  CToolBarCtrl::SetPressedImageList

Establece la lista de imágenes que el control de barra de herramientas actual que se usa para representar los botones en estado presionado.

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>Parámetros

|Parámetro|Descripción|
|---------------|-----------------|
|*iImageID*|[in] Índice de base cero de la lista de imágenes. Si usa solo una lista de imágenes, establezca este parámetro en cero.|
|*pImageList*|[in] Puntero a un [CImageList](../../mfc/reference/cimagelist-class.md) que contiene la lista de imágenes.|

### <a name="return-value"></a>Valor devuelto

Puntero a un [CImageList](../../mfc/reference/cimagelist-class.md) que contiene la lista anterior de la imagen para el control actual, o NULL si se ha establecido ninguna lista de imágenes de este tipo.

### <a name="remarks"></a>Comentarios

Este método envía el [TB_SETPRESSEDIMAGELIST](/windows/desktop/Controls/tb-setpressedimagelist) mensaje, que se describe en el SDK de Windows.

### <a name="example"></a>Ejemplo

El ejemplo de código siguiente establece la lista de imagen presionado para ser la misma que la lista de imágenes de forma predeterminada.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

##  <a name="setrows"></a>  CToolBarCtrl::SetRows

Solicita el control de barra de herramientas para cambiar el tamaño para el número solicitado de filas.

```
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>Parámetros

*nRows*<br/>
Número solicitado de filas.

*bLarger*<br/>
Indica si se debe usar las filas más o menos filas si no puede cambiarse de tamaño la barra de herramientas para el número solicitado de filas.

*lpRect*<br/>
Apunta a la [CRect](../../atl-mfc-shared/reference/crect-class.md) objeto o [RECT](/previous-versions/dd162897\(v=vs.85\)) estructura que va a recibir el nuevo rectángulo delimitador de la barra de herramientas.

### <a name="remarks"></a>Comentarios

Si la barra de herramientas no se puede cambiar de tamaño para el número solicitado de filas, cambiará su tamaño como el siguiente más grande o siguiente más pequeño tamaño válido, dependiendo del valor de *bLarger*. Si *bLarger* es TRUE, el nuevo número de filas será mayor que el número solicitado. Si *bLarger* es FALSE, el nuevo número de filas será menor que el número solicitado.

Un número determinado de filas es válido para la barra de herramientas si se pueden organizar los botones de tal manera que todas las filas tienen el mismo número de botones (excepto quizás la última fila). Por ejemplo, una barra de herramientas que contiene cuatro botones podría no ajustarse a las tres filas porque las dos últimas filas tendría que ser más corto. Si ha intentado cambiar el tamaño a las filas de tres, cuatro filas obtendría si *bLarger* era TRUE y dos filas si *bLarger* era FALSE.

Si hay separadores en la barra de herramientas, las reglas para cuando hay un número determinado de filas válido son más complicadas. El diseño se calcula de forma que los grupos de botones (botones con un separador antes del primer) y el último botón en el grupo nunca se dividen en varias filas a menos que el grupo no cabe en una fila.

Si un grupo no cabe en una fila, se iniciará el siguiente grupo en la siguiente fila incluso si lo suficiente en la fila en el que finalizó el grupo de gran tamaño. El propósito de esta regla es realizar la separación entre grupos grandes más evidentes. Los separadores verticales resultantes se cuentan como filas.

Tenga en cuenta también que el `SetRows` función miembro siempre elegir el diseño que da como resultado el tamaño más pequeño de la barra de herramientas. Creación de una barra de herramientas con el TBSTYLE_WRAPABLE dado el ancho del control de estilo y, a continuación, cambiar el tamaño que del control simplemente aplicará el método descrito anteriormente.

Esta función solo puede llamarse para las barras de herramientas que se crearon con el estilo TBSTYLE_WRAPABLE.

##  <a name="setstate"></a>  CToolBarCtrl::SetState

Establece el estado del botón especificado en un control de barra de herramientas.

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
Identificador del comando del botón.

*nState*<br/>
Indicadores de estado. Puede ser una combinación de los valores enumerados de Estados del botón en [CToolBarCtrl::AddButtons](#addbuttons).

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si es correcto. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esta función resulta especialmente útil si desea establecer más de uno de los Estados del botón. Para establecer simplemente un estado, use una de las funciones miembro siguientes: [EnableButton](#enablebutton), [CheckButton](#checkbutton), [HideButton](#hidebutton), [indeterminado](#indeterminate), o [PressButton](#pressbutton).

##  <a name="setstyle"></a>  CToolBarCtrl::SetStyle

Establece los estilos para un control de barra de herramientas.

```
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>Parámetros

*dwStyle*<br/>
Un valor DWORD que contiene una combinación de [estilos de control de barra de herramientas](/windows/desktop/Controls/toolbar-control-and-button-styles), tal y como se describe en el SDK de Windows.

##  <a name="settooltips"></a>  CToolBarCtrl::SetToolTips

Asocia un control a un control de barra de herramientas.

```
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>Parámetros

*pTip*<br/>
Puntero a la [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) objeto.

##  <a name="setwindowtheme"></a>  CToolBarCtrl::SetWindowTheme

Establece el estilo visual de la `CToolBarCtrl` objeto.

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>Parámetros

*pszSubAppName*<br/>
Un puntero a una cadena Unicode que contiene el estilo visual de la barra de herramientas para establecer.

### <a name="return-value"></a>Valor devuelto

No se utiliza el valor devuelto.

### <a name="remarks"></a>Comentarios

Esta función miembro emula la funcionalidad de la [TB_SETWINDOWTHEME](/windows/desktop/Controls/tb-setwindowtheme) del mensaje, como se describe en el SDK de Windows.

## <a name="see-also"></a>Vea también

[MFC Sample CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[Ejemplo MFCIE de MFC](../../overview/visual-cpp-samples.md)<br/>
[CWnd (clase)](../../mfc/reference/cwnd-class.md)<br/>
[Gráfico de jerarquías](../../mfc/hierarchy-chart.md)<br/>
[CToolBar (clase)](../../mfc/reference/ctoolbar-class.md)
