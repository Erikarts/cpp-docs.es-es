---
title: CFileDialog (clase)
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: 197dec23b4c715b0bca35976f9fa53a055cdd78f
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/14/2020
ms.locfileid: "81373898"
---
# <a name="cfiledialog-class"></a>CFileDialog (clase)

Encapsula el cuadro de diálogo común que se utiliza para las operaciones de apertura de archivos o guardado de archivos.

## <a name="syntax"></a>Sintaxis

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Miembros

### <a name="public-constructors"></a>Constructores públicos

|Nombre|Descripción|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|Construye un objeto `CFileDialog`.|

### <a name="public-methods"></a>Métodos públicos

|Nombre|Descripción|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|Agrega un botón de verificación al cuadro de diálogo.|
|[CFileDialog::AddComboBox](#addcombobox)|Agrega un cuadro combinado al cuadro de diálogo.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Agrega un elemento a un control contenedor en el cuadro de diálogo.|
|[CFileDialog::AddEditBox](#addeditbox)|Agrega un cuadro de edición al cuadro de diálogo.|
|[CFileDialog::AddMenu](#addmenu)|Agrega un menú al cuadro de diálogo.|
|[CFileDialog::AddPlace](#addplace)|Sobrecargado. Agrega una carpeta a la lista de lugares disponibles para que el usuario abra o guarde elementos.|
|[CFileDialog::AddPushButton](#addpushbutton)|Agrega un botón al cuadro de diálogo.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Agrega un botón de opción (también conocido como botón de opción) al grupo de diálogo.|
|[CFileDialog::AddSeparator](#addseparator)|Agrega un separador al cuadro de diálogo.|
|[CFileDialog::AddText](#addtext)|Agrega contenido de texto al cuadro de diálogo.|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Actualiza el estado `CFileDialog` del para que coincida `m_ofn` con los parámetros y los indicadores almacenados en la variable miembro.|
|[CFileDialog::DoModal](#domodal)|Muestra el cuadro de diálogo y permite al usuario realizar una selección.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Habilita una lista desplegable en el botón **Abrir** o **Guardar** del cuadro de diálogo.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Detiene la adición de elementos a un grupo visual en el cuadro de diálogo.|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Obtiene el estado actual de un botón de verificación (casilla de verificación) en el cuadro de diálogo.|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Obtiene el estado actual de un elemento en un control contenedor que se encuentra en el cuadro de diálogo.|
|[CFileDialog::GetControlState](#getcontrolstate)|Obtiene la visibilidad actual y los estados habilitados de un control determinado.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Obtiene el texto actual en un control de cuadro de edición.|
|[CFileDialog::GetFileExt](#getfileext)|Devuelve la extensión del archivo seleccionado.|
|[CFileDialog::GetFileName](#getfilename)|Devuelve el nombre de archivo del archivo seleccionado.|
|[CFileDialog::GetFileTitle](#getfiletitle)|Devuelve el título del archivo seleccionado.|
|[CFileDialog::GetFolderPath](#getfolderpath)|Recupera la ruta de acceso de la carpeta o directorio abierto actualmente para un cuadro de diálogo común **Abrir** o **Guardar como** estilo Explorador.|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Recupera el objeto COM interno `CFileDialog` para un objeto personalizado.|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Recupera el objeto COM `CFileDialog` interno para un que se utiliza como **un** abrir archivo cuadro de diálogo.|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Recupera el objeto COM `CFileDialog` interno para un que se utiliza como un **guardar** archivo cuadro de diálogo.|
|[CFileDialog::GetNextPathName](#getnextpathname)|Devuelve la ruta de acceso completa del siguiente archivo seleccionado.|
|[CFileDialog::GetOFN](#getofn)|Recupera la `OPENFILENAME` estructura `CFileDialog` del objeto.|
|[CFileDialog::GetPathName](#getpathname)|Devuelve la ruta de acceso completa del archivo seleccionado.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Devuelve el estado de solo lectura del archivo seleccionado.|
|[CFileDialog::GetResult](#getresult)|Obtiene la elección que el usuario realizó en el cuadro de diálogo.|
|[CFileDialog::GetResults](#getresults)|Obtiene las opciones del usuario en un cuadro de diálogo que permite la selección múltiple.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Obtiene un elemento determinado de controles de contenedor especificados en el cuadro de diálogo.|
|[CFileDialog::GetStartPosition](#getstartposition)|Devuelve la posición del primer elemento de la lista de nombres de archivo.|
|[CFileDialog::HideControl](#hidecontrol)|Oculta el control especificado en un cuadro de diálogo común **Abrir** o **Guardar como** estilo Explorador.|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Determina si el cuadro de diálogo actual en modo selector de carpetas.|
|[CFileDialog::MakeProminent](#makeprominent)|Coloca un control en el cuadro de diálogo para que destaque en comparación con otros controles agregados.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Quita un elemento de un control contenedor en el cuadro de diálogo.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Establece el estado actual de un botón de verificación (casilla de verificación) en el cuadro de diálogo.|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Establece el estado actual de un elemento en un control contenedor que se encuentra en el cuadro de diálogo.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Establece el texto de un elemento de control. Por ejemplo, el texto que acompaña a un botón de opción o un elemento de un menú.|
|[CFileDialog::SetControlLabel](#setcontrollabel)|Establece el texto asociado a un control, como el texto del botón o una etiqueta de cuadro de edición.|
|[CFileDialog::SetControlState](#setcontrolstate)|Establece la visibilidad actual y los estados habilitados de un control determinado.|
|[CFileDialog::SetControlText](#setcontroltext)|Establece el texto del control especificado en un cuadro de diálogo común **Abrir** o **Guardar como** estilo Explorador.|
|[CFileDialog::SetDefExt](#setdefext)|Establece la extensión de nombre de archivo predeterminada para un cuadro de diálogo común **Abrir** o **Guardar como** estilo Explorador.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Establece el texto actual en un control de cuadro de edición.|
|[CFileDialog::SetProperties](#setproperties)|Proporciona un almacén de propiedades que define los valores predeterminados que se van a usar para el elemento que se está guardando.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Establece el estado seleccionado de un elemento determinado en un grupo de botones de opción o en un cuadro combinado que se encuentra en el cuadro de diálogo.|
|[CFileDialog::SetTemplate](#settemplate)|Establece la plantilla de `CFileDialog` cuadro de diálogo para el objeto.|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Declara un grupo visual en el cuadro de diálogo. Las llamadas posteriores a cualquier método "add" agregan esos elementos a este grupo.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Actualiza los datos `m_ofn` almacenados en la variable miembro para que coincidan con el estado actual del cuadro de diálogo de archivo.|

### <a name="protected-methods"></a>Métodos protegidos

|Nombre|Descripción|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Se llama cuando se hace clic en el botón.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Se llama cuando la casilla de verificación está marcada o desactivada.|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Se llama cuando el control está activo.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Controla el mensaje de CDN_SELCHANGE WM_NOTIFY.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|Valida el nombre de archivo introducido en el cuadro de diálogo.|
|[CFileDialog::OnFolderChange](#onfolderchange)|Controla el mensaje de CDN_FOLDERCHANGE WM_NOTIFY.|
|[CFileDialog::OnInitDone](#oninitdone)|Controla el mensaje de CDN_INITDONE WM_NOTIFY.|
|[CFileDialog::OnItemSelected](#onitemselected)|Se llama cuando se selecciona el elemento contenedor.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Le permite realizar acciones personalizadas cuando cambia la selección de archivos.|
|[CFileDialog::OnShareViolation](#onshareviolation)|Maneja las infracciones de las acciones.|
|[CFileDialog::OnTypeChange](#ontypechange)|Controla el mensaje de CDN_TYPECHANGE WM_NOTIFY.|

### <a name="public-data-members"></a>Miembros de datos públicos

|Nombre|Descripción|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|La `OPENFILENAME` estructura de Windows. Proporciona acceso a los parámetros básicos del cuadro de diálogo de archivo.|

## <a name="remarks"></a>Observaciones

Los cuadros de diálogo de archivos comunes le permiten implementar cuadros de diálogo de selección de archivos, por ejemplo, **Abrir archivo** y **Guardar como**, de forma coherente con los estándares de Windows.

Puede usar `CFileDialog` tal cual con el constructor proporcionado, o puede `CFileDialog` derivar su propia clase de cuadro de diálogo y escribir un constructor para satisfacer sus necesidades. En cualquier caso, estos cuadros de diálogo se comportarán como cuadros de diálogo MFC estándar porque se derivan de la [Clase CCommonDialog](../../mfc/reference/ccommondialog-class.md). `CFileDialog`depende del COMMDLG. DLL que se incluye en Windows.

Tanto la apariencia como la `CFileDialog` funcionalidad de la con Windows Vista o posterior difieren de las versiones anteriores de Windows. El `CFileDialog` valor predeterminado usa automáticamente el nuevo estilo de Windows Vista o posterior sin cambios de código si un programa se compila y ejecuta en Windows Vista o posterior. Utilice el *bVistaStyle* parámetro en el constructor para invalidar manualmente esta actualización automática. La excepción a la actualización automática son los cuadros de diálogo personalizados. No se convertirán al nuevo estilo. Para obtener más información sobre el constructor, vea [CFileDialog::CFileDialog](#cfiledialog).

> [!NOTE]
> El sistema de identificador de control difiere en Windows Vista o `CFileDialog`posterior de versiones anteriores de Windows cuando se utiliza un archivo . Debe actualizar todas `CFileDialog` las referencias a controles en el código para poder migrar el proyecto desde una versión anterior de Windows.

Algunos `CFileDialog` métodos no se admiten en Windows Vista o posterior. Compruebe el tema del método individual para obtener información sobre si se admite el método. Además, las siguientes funciones heredadas no se admiten en Windows Vista o posterior:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

Los mensajes de `CFileDialog` Windows para la clase varían en función del sistema operativo que esté utilizando. Por ejemplo, Windows XP no admite [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) y [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) para la `CFileDialog` clase. Sin embargo, Windows Vista y sistemas operativos posteriores sí los admiten. Para obtener más información acerca de los diferentes mensajes que se generan y el orden en que se reciben, vea Ejemplo de [CFileDialog: Orden](../../overview/visual-cpp-samples.md)de eventos de registro .

Para usar `CFileDialog` un objeto, primero cree `CFileDialog` el objeto mediante el constructor. Una vez construido el cuadro de diálogo, puede establecer o modificar cualquier valor en el [CFileDialog::m_ofn](#m_ofn) estructura para inicializar los valores o estados de los controles de cuadro de diálogo. La `m_ofn` estructura es `OPENFILENAME`de tipo . Para obtener más información, consulte la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) en el Windows SDK.

Después de inicializar los controles de cuadro de diálogo, llame a la [CFileDialog::DoModal](#domodal) método para mostrar el cuadro de diálogo para que el usuario puede escribir la ruta de acceso y el nombre de archivo. `DoModal`devuelve si el usuario ha haciendo clic en el botón Aceptar (IDOK) o Cancelar (IDCANCEL). Si `DoModal` devuelve IDOK, puede usar `CFileDialog` una de las funciones miembro públicas para recuperar la información puesta por el usuario.

> [!NOTE]
> En Windows Vista o posterior, varias llamadas a [IFileDialog::SetFileTypes](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) produce un error. La segunda `SetFileTypes` llamada a cualquier `CFileDialog` instancia de un devolverá E_UNEXPECTED en Windows Vista o posterior. Algunas `CFileDialog` funciones de método llaman a `SetFileTypes`. Por ejemplo, dos `CFileDialog::DoModal` llamadas a `CFileDialog` la misma instancia de un genera [ASSERT](diagnostic-services.md#assert).

`CFileDialog`incluye varios miembros protegidos que le permiten realizar un control personalizado de infracciones de recursos compartidos, validación de nombres de archivo y notificación de cambio de cuadro de lista. Estos miembros protegidos son funciones de devolución de llamada que la mayoría de las aplicaciones no tienen que usar porque el control predeterminado se realiza automáticamente. Las entradas de mapa de mensajes para estas funciones no son necesarias porque son funciones virtuales estándar.

Puede usar la función [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) de Windows para determinar si se ha producido un error durante la inicialización del cuadro de diálogo y para obtener más información sobre el error.

La destrucción de `CFileDialog` objetos se maneja automáticamente. No es necesario llamar a [CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Para permitir que el usuario seleccione varios archivos, establezca la marca OFN_ALLOWMULTISELECT antes de llamar a `DoModal`. Debe proporcionar su propio búfer de nombre de archivo para dar cabida a la lista devuelta de varios nombres de archivo. Para ello, `m_ofn.lpstrFile` reemplace con un puntero a un búfer `CFileDialog`que haya asignado, después de construir el archivo , pero antes de llamar a `DoModal`.

Además, debe `m_ofn.nMaxFile` establecer mediante el número de caracteres en el búfer al que apunta `m_ofn.lpstrFile`. Si establece el número máximo de `n`archivos que se `n * (_MAX_PATH + 1) + 1`seleccionarán en , el tamaño de búfer necesario es . El primer elemento devuelto en el búfer es la ruta de acceso a la carpeta donde se seleccionaron los archivos. Para Windows Vista o cuadros de diálogo de estilo posterior, las cadenas de directorio y nombre de archivo terminan en null, con un carácter nulo adicional después del último nombre de archivo. Este formato permite que los cuadros de diálogo de estilo Explorador devuelvan nombres de archivo largos que incluyan espacios. Para los cuadros de diálogo de estilo antiguo, las cadenas de directorio y nombre de archivo están separadas por espacios y la función utiliza nombres de archivo cortos para los nombres de archivo con espacios.

En el ejemplo siguiente se muestra cómo utilizar un búfer para recuperar y enumerar varios nombres de archivo.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Para cambiar el tamaño del búfer en respuesta al usuario que `CFileDialog` selecciona varios nombres de archivo, debe derivar una nueva clase de e invalidar el [CFileDialog::OnFileNameChange](#onfilenamechange) método.

Si deriva una nueva `CFileDialog`clase de , puede usar un mapa de mensajes para controlar los mensajes. Para ampliar el control de mensajes `CFileDialog`predeterminado, derive una clase de , agregue un mapa de mensajes a la nueva clase y proporcione funciones miembro para los nuevos mensajes. No es necesario proporcionar una función de enlace para personalizar el cuadro de diálogo.

Para personalizar el cuadro de `CFileDialog`diálogo, derive una clase de , proporcione una plantilla de cuadro de diálogo personalizado y agregue un mapa de mensajes para procesar los mensajes de notificación de los controles extendidos. Pase los mensajes sin procesar a la clase base. No es necesario personalizar la función de enlace.

Cuando se utiliza el estilo de `CFileDialog`Windows Vista o posterior de la , no se pueden utilizar mapas de mensajes y plantillas de cuadro de diálogo. En su lugar, debe utilizar las interfaces COM para una funcionalidad similar.

Para obtener más información `CFileDialog`sobre cómo utilizar , vea [Clases](../../mfc/common-dialog-classes.md)de cuadro de diálogo comunes .

## <a name="inheritance-hierarchy"></a>Jerarquía de herencia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Requisitos

**Encabezado:** afxdlgs.h

## <a name="cfiledialogaddcheckbutton"></a><a name="addcheckbutton"></a>CFileDialog::AddCheckButton

Agrega un botón de verificación al cuadro de diálogo.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del botón de verificación que se va a agregar.

*strLabel*<br/>
El nombre del botón de verificación.

*bChecked*<br/>
Un valor booleano que indica el estado actual del botón de verificación. TRUESi está marcada; FALSE de lo contrario

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogaddcombobox"></a><a name="addcombobox"></a>CFileDialog::AddComboBox

Agrega un cuadro combinado al cuadro de diálogo.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del cuadro combinado que se va a agregar.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogaddcontrolitem"></a><a name="addcontrolitem"></a>CFileDialog::AddControlItem

Agrega un elemento a un control contenedor en el cuadro de diálogo.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control contenedor al que se va a agregar el elemento.

*dwIDItem*<br/>
Identificador del elemento.

*strLabel*<br/>
Texto del elemento.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogaddeditbox"></a><a name="addeditbox"></a>CFileDialog::AddEditBox

Agrega un cuadro de edición al cuadro de diálogo.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del cuadro de edición que se va a agregar.

*strText*<br/>
El nombre del cuadro de edición.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogaddmenu"></a><a name="addmenu"></a>CFileDialog::AddMenu

Agrega un menú al cuadro de diálogo.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del menú que se va a agregar.

*strLabel*<br/>
El nombre del menú.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogaddplace"></a><a name="addplace"></a>CFileDialog::AddPlace

Agrega una carpeta a la lista de lugares disponibles para que el usuario abra o guarde elementos.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Parámetros

*lpszFolder*<br/>
Una ruta de acceso a la carpeta que se va a poner a disposición del usuario. Esto sólo puede ser una carpeta.

*fdap*<br/>
Especifica dónde se coloca la carpeta dentro de la lista.

*psi*<br/>
Puntero a un IShellItem que representa la carpeta que se va a poner a disposición del usuario. Esto sólo puede ser una carpeta.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogaddpushbutton"></a><a name="addpushbutton"></a>CFileDialog::AddPushButton

Agrega un botón al cuadro de diálogo.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del botón que se va a agregar.

*strLabel*<br/>
El nombre del botón.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogaddradiobuttonlist"></a><a name="addradiobuttonlist"></a>CFileDialog::AddRadioButtonList

Agrega un botón de opción (también conocido como botón de opción) al grupo de diálogo.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del grupo de botones de opción que se va a agregar.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogaddseparator"></a><a name="addseparator"></a>CFileDialog::AddSeparator

Agrega un separador al cuadro de diálogo.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del separador se agrega.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogaddtext"></a><a name="addtext"></a>CFileDialog::AddText

Agrega texto al cuadro de diálogo.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del texto que se va a agregar.

*strText*<br/>
El nombre del texto.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogapplyofntoshelldialog"></a><a name="applyofntoshelldialog"></a>CFileDialog::ApplyOFNToShellDialog

Actualiza el estado actual de la [CFileDialog](../../mfc/reference/cfiledialog-class.md) `m_ofn` en función de los valores almacenados en la estructura de datos.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Observaciones

En versiones de Windows anteriores a Windows Vista, la estructura `CFileDialog`de datos [OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) del miembro se sincronizaba continuamente con el estado del archivo . Cualquier cambio en el [m_ofn](#m_ofn) variable miembro se reflejaron inmediatamente en el estado del cuadro de diálogo. Además, cualquier cambio en el estado `m_ofn` del cuadro de diálogo actualiza inmediatamente la variable miembro.

En Windows Vista o posterior, `m_ofn` no se garantiza `CFileDialog` que se sincronicen los valores de la variable miembro y el estado de la. Esta función fuerza `CFileDialog` el estado de `m_ofn` la que se va a actualizar para que coincida con la estructura. Windows llama a esta función automáticamente durante [CFileDialog::DoModal](#domodal).

Para obtener más información `CFileDialog` acerca de cómo utilizar la clase en Windows Vista o posterior, vea [CFileDialog (Clase)](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog).

## <a name="cfiledialogcfiledialog"></a><a name="cfiledialog"></a>CFileDialog::CFileDialog

Llame a esta función para construir un cuadro de diálogo de archivo estándar de Windows.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Parámetros

*bOpenFileDialog*<br/>
[en] Parámetro que especifica qué tipo de cuadro de diálogo se va a crear. Establézcalo en TRUE para construir un cuadro de diálogo **Abrir archivo.** Establézcalo en FALSE para construir un cuadro de diálogo **Guardar como** archivo.

*lpszDefExt*<br/>
[en] La extensión de nombre de archivo predeterminada. Si el usuario no incluye una extensión conocida (una que tiene una asociación en el equipo del usuario) en el cuadro Nombre de archivo, la extensión especificada por *lpszDefExt* se anexa automáticamente al nombre de archivo. Si este parámetro es NULL, no se anexa ninguna extensión.

*lpszFileName*<br/>
[en] El nombre de archivo inicial que aparece en el cuadro Nombre de archivo. Si ES NULL, no aparece ningún nombre de archivo inicial.

*dwFlags*<br/>
[en] Una combinación de uno o más indicadores que puede usar para personalizar el cuadro de diálogo. Para obtener una descripción de estos indicadores, vea la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) en el Windows SDK. Si modifica `m_ofn.Flags` el miembro de la estructura, utilice un operador OR bit a bit en los cambios para mantener intacto el comportamiento predeterminado.

*lpszFilter*<br/>
[en] Una serie de pares de cadenas que especifican filtros que puede aplicar al archivo. Si especifica filtros de archivos, solo aparecerán en la lista Archivos los archivos que coincidan con los criterios de filtro. Consulte la sección Comentarios para obtener más información sobre cómo trabajar con filtros de archivos.

*pParentWnd*<br/>
[en] Puntero a la ventana principal o propietaria del cuadro de diálogo de archivo.

*dwSize*<br/>
[en] El tamaño `OPENFILENAME` de la estructura. Este valor depende de la versión del sistema operativo. MFC usó este parámetro para determinar el tipo adecuado de cuadro de diálogo para crear. El tamaño predeterminado de 0 significa que el código MFC determinará el tamaño correcto del cuadro de diálogo que se usará en función de la versión del sistema operativo en la que se ejecuta el programa.

*bVistaStyle*<br/>
[en] **Nota** Este parámetro está disponible en Visual Studio 2008 y versiones posteriores y hace que el cuadro de diálogo de nuevo estilo se use solo si se ejecuta en Windows Vista o posterior.

Parámetro que especifica el estilo del cuadro de diálogo de archivo. Establézcalo en TRUE para usar los nuevos cuadros de diálogo de archivo de estilo de Vista. De lo contrario, se utilizará el estilo antiguo de los cuadros de diálogo. Consulte la sección Comentarios para obtener más información sobre cómo ejecutar en Vista.

### <a name="remarks"></a>Observaciones

Se construye un cuadro de diálogo **Abrir archivo** o **Guardar como,** en función del valor de *bOpenFileDialog*.

Especificar una extensión predeterminada mediante *lpszDefExt* puede no producir el comportamiento que espera, porque rara vez es predecible qué extensiones tienen asociaciones de archivos en el equipo del usuario. Si necesita más control sobre el apéndice de una extensión predeterminada, puede derivar su propia clase de `CFileDialog`, e invalidar el `CFileDialog::OnFileNameOK` método para realizar su propio control de extensión.

Para permitir que el usuario seleccione varios archivos, establezca la marca OFN_ALLOWMULTISELECT antes de llamar a [DoModal](#domodal). Debe proporcionar su propio búfer de nombre de archivo para almacenar la lista devuelta de varios nombres de archivo. Para ello, `m_ofn.lpstrFile` reemplace con un puntero a un búfer que ha asignado, después de construir [CFileDialog](../../mfc/reference/cfiledialog-class.md), pero antes de llamar a `DoModal`. Además, debe `m_ofn.nMaxFile` establecer con el número de `m_ofn.lpstrFile`caracteres en el búfer al que apunta . Si establece el número máximo de archivos que se seleccionarán en *n*, el tamaño de búfer necesario es `n`*(_MAX_PATH + 1) + 1. Por ejemplo:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Para permitir que el usuario cambie el tamaño de un cuadro de diálogo de estilo Explorador mediante el mouse o el teclado, establezca la marca OFN_ENABLESIZING. Establecer esta marca solo es necesario si proporciona un procedimiento de enlace o una plantilla personalizada. La marca solo funciona con un cuadro de diálogo de estilo Explorador; no se puede cambiar el tamaño de los cuadros de diálogo de estilo antiguo.

El parámetro *lpszFilter* se utiliza para determinar el tipo de nombre de archivo que debe mostrarse un archivo en la lista de archivos. La primera cadena del par de cadenas describe el filtro; la segunda cadena indica la extensión de nombre de archivo que se va a utilizar. Se pueden especificar varias extensiones mediante un punto y coma (el carácter ';') como delimitador. La cadena termina con dos caracteres '&#124;', seguidos de un carácter NULL. También puede usar un [CString](../../atl-mfc-shared/using-cstring.md) objeto para este parámetro.

Por ejemplo, Microsoft Excel permite a los usuarios abrir archivos que tienen extensiones .xlc (gráfico) o .xls (hoja de trabajo), entre otros. El filtro para Excel se podría escribir como:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Sin embargo, si va a utilizar `OPENFILENAME` esta cadena para actualizar directamente la estructura, debe delimitar las cadenas con el carácter nulo, '-0', en lugar de las barras verticales ('&#124;').

El *bVistaStyle* parámetro solo es aplicable cuando se ejecuta en Windows Vista o posterior. En versiones anteriores de Windows, se omite este parámetro. Si *bVistaStyle* se establece en TRUE, al compilar un programa con Visual Studio 2008 o posterior, se usará el nuevo cuadro de **diálogo** de archivo de estilo Vista. De lo contrario, se usará el estilo anterior MFC cuadro de **diálogo** de archivo.

Las plantillas de cuadro de diálogo no se admiten en los cuadros de diálogo basados en *bVistaStyle*

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog::DoModal](#domodal).

## <a name="cfiledialogdomodal"></a><a name="domodal"></a>CFileDialog::DoModal

Llame a esta función para mostrar el cuadro de diálogo de archivo común de Windows y permitir al usuario examinar archivos y directorios e introducir un nombre de archivo.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Valor devuelto

IDOK o IDCANCEL. Si se devuelve IDCANCEL, llame a la función [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) de Windows para determinar si se ha producido un error.

IDOK e IDCANCEL son constantes que indican si el usuario ha seleccionado el botón Aceptar o Cancelar.

### <a name="remarks"></a>Observaciones

Si desea inicializar las distintas opciones del cuadro `m_ofn` de diálogo de archivo `DoModal`estableciendo miembros de la estructura, debe hacerlo antes de llamar a , pero después de que se construya el objeto de cuadro de diálogo.

Por ejemplo, si desea permitir que el usuario seleccione varios `DoModal`archivos, establezca la marca OFN_ALLOWMULTISELECT antes de llamar , como se muestra en el ejemplo de código de este tema.

Cuando el usuario hace clic en los botones Aceptar o Cancelar del cuadro de diálogo, o selecciona la opción Cerrar del menú de control del cuadro de diálogo, el control se devuelve a la aplicación. A continuación, puede llamar a otras funciones miembro para recuperar la configuración o la información que el usuario introduce en el cuadro de diálogo.

`DoModal`es una función virtual `CDialog`invalidada de la clase .

### <a name="example"></a>Ejemplo

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

## <a name="cfiledialogenableopendropdown"></a><a name="enableopendropdown"></a>CFileDialog::EnableOpenDropDown

Habilita una lista desplegable en el botón Abrir o Guardar del cuadro de diálogo.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador de la lista desplegable.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogendvisualgroup"></a><a name="endvisualgroup"></a>CFileDialog::EndVisualGroup

Detiene la adición de elementos a un grupo visual en el cuadro de diálogo.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Valor devuelto

Devuelve S_OK si se realiza correctamente; un valor de error en caso contrario.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialoggetcheckbuttonstate"></a><a name="getcheckbuttonstate"></a>CFileDialog::GetCheckButtonState

Recupera el estado actual de un botón de verificación (casilla de verificación) en el cuadro de diálogo.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador de la casilla de verificación.

*bChecked*<br/>
El estado de la casilla de verificación. TRUE indica checked; FALSE indica desmarcado.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialoggetcontrolitemstate"></a><a name="getcontrolitemstate"></a>CFileDialog::GetControlItemState

Recupera el estado actual de un elemento en un control contenedor que se encuentra en el cuadro de diálogo.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Id. del control contenedor.

*dwIDItem*<br/>
Identificador del elemento.

*dwState*<br/>
Referencia a una variable que recibe uno de los valores más de la enumeración CDCONTROLSTATE que indica el estado actual del control.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialoggetcontrolstate"></a><a name="getcontrolstate"></a>CFileDialog::GetControlState

Recupera la visibilidad actual y los estados habilitados de un control determinado.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Id. del control.

*dwState*<br/>
Referencia a una variable que recibe uno o varios valores de la enumeración CDCONTROLSTATE que indica el estado actual del control.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialoggeteditboxtext"></a><a name="geteditboxtext"></a>CFileDialog::GetEditBoxText

Recupera el texto actual en un control de cuadro de edición.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del cuadro de edición.

*strText*<br/>
Valor de texto.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialoggetfileext"></a><a name="getfileext"></a>CFileDialog::GetFileExt

Llame a esta función para recuperar la extensión del nombre de archivo introducido en el cuadro de diálogo.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Valor devuelto

La extensión del nombre de archivo.

### <a name="remarks"></a>Observaciones

Por ejemplo, si el nombre del archivo introducido es DATA. TXT, `GetFileExt` devuelve "TXT".

Si `m_ofn.Flags` tiene la marca OFN_ALLOWMULTISELECT establecida, esta cadena contiene una secuencia de cadenas terminadas en null, siendo la primera cadena la ruta de acceso del directorio del grupo de archivos seleccionada, seguida de los nombres de todos los archivos seleccionados por el usuario. Para recuperar nombres de ruta de acceso de archivo, utilice el [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) funciones miembro.

## <a name="cfiledialoggetfilename"></a><a name="getfilename"></a>CFileDialog::GetFileName

Llame a esta función para recuperar el nombre del nombre de archivo introducido en el cuadro de diálogo.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Valor devuelto

Nombre del archivo.

### <a name="remarks"></a>Observaciones

El nombre del archivo incluye el prefijo y la extensión. Por ejemplo, `GetFileName` devolverá "TEXT. DAT" para el archivo C:-FILES-TEXT.DAT.

Si `m_ofn.Flags` tiene `OFN_ALLOWMULTISELECT` el indicador establecido, debe llamar a [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) para recuperar un nombre de ruta de acceso de archivo.

## <a name="cfiledialoggetfiletitle"></a><a name="getfiletitle"></a>CFileDialog::GetFileTitle

Llame a esta función para recuperar el título del archivo introducido en el cuadro de diálogo.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Valor devuelto

El título del archivo.

### <a name="remarks"></a>Observaciones

El título del archivo incluye solo su prefijo, sin la ruta de acceso o la extensión. Por ejemplo, `GetFileTitle` se devolverá "TEXT" para el archivo C:-FILES-TEXT.DAT.

Si `m_ofn.Flags` tiene la marca OFN_ALLOWMULTISELECT establecida, esta cadena contiene una secuencia de cadenas terminadas en null, siendo la primera cadena la ruta de acceso del directorio del grupo de archivos seleccionada, seguida de los nombres de todos los archivos seleccionados por el usuario. Por este motivo, use las funciones miembro [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) para recuperar el siguiente nombre de archivo de la lista.

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog::DoModal](#domodal).

## <a name="cfiledialoggetfolderpath"></a><a name="getfolderpath"></a>CFileDialog::GetFolderPath

Llame a esta función miembro para recuperar la ruta de acceso de la carpeta o directorio abierto actualmente para un estilo de Explorador Abrir o Guardar como cuadro de diálogo común.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Valor devuelto

Un [CString](../../atl-mfc-shared/reference/cstringt-class.md) objeto que contiene la carpeta o directorio abierto actualmente.

### <a name="remarks"></a>Observaciones

El cuadro de diálogo debe haberse creado con el estilo OFN_EXPLORER; de lo contrario, el método producirá un error con una aserción.

Puede llamar a este método solo mientras se muestra el cuadro de diálogo. Una vez cerrado el cuadro de diálogo, esta función ya no funcionará y el método producirá un error con una aserción.

## <a name="cfiledialoggetifiledialogcustomize"></a><a name="getifiledialogcustomize"></a>CFileDialog::GetIFileDialogCustomize

Recupera un puntero al objeto COM interno para un [determinado CFileDialog](../../mfc/reference/cfiledialog-class.md).

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Valor devuelto

El puntero al objeto COM `CFileDialog`interno para el archivo . Es su responsabilidad liberar este puntero adecuadamente.

### <a name="remarks"></a>Observaciones

Utilice esta función solo en Windows Vista o posterior con un objeto que tenga *bVistaStyle* establecido en TRUE. Si utiliza esta función cuando *bVistaStyle* es FALSE, devolverá NULL en modo de versión y producirá una aserción en modo de depuración.

Para obtener más `IFileDialogCustomize` información acerca de la interfaz, vea [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Ejemplo

En este ejemplo se recupera el objeto COM interno. Para ejecutar este ejemplo de código, debe compilarlo en Windows Vista o posterior.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

## <a name="cfiledialoggetifileopendialog"></a><a name="getifileopendialog"></a>CFileDialog::GetIFileOpenDialog

Recupera un puntero al objeto COM `CFileDialog`interno para un archivo .

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Valor devuelto

El puntero al objeto COM `CFileDialog`interno para el archivo . Es su responsabilidad liberar este puntero adecuadamente.

### <a name="remarks"></a>Observaciones

Utilice esta función solo en Windows Vista o posterior con un objeto que tenga *bVistaStyle* establecido en TRUE. Esta función devuelve `CFileDialog` NULL si no es un cuadro de diálogo **Abrir** o si *bVistaStyle* está establecido en FALSE. En este último caso, la función solo devuelve NULL en modo de versión: en modo de depuración producirá una aserción.

Para obtener más `IFileOpenDialog` información acerca de la interfaz, vea [IFileOpenDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Ejemplo

En este ejemplo se recupera el objeto COM interno. Para ejecutar este código, debe compilarlo en Windows Vista o posterior.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

## <a name="cfiledialoggetifilesavedialog"></a><a name="getifilesavedialog"></a>CFileDialog::GetIFileSaveDialog

Recupera un puntero al objeto COM `CFileDialog`interno para un archivo .

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Valor devuelto

El puntero al objeto COM `CFileDialog`interno para el archivo . Es su responsabilidad liberar este puntero adecuadamente.

### <a name="remarks"></a>Observaciones

Utilice esta función solo en Windows Vista o posterior con un objeto que tenga *bVistaStyle* establecido en TRUE. Esta función devolverá `CFileDialog` NULL si no es un cuadro de diálogo **Guardar** o si *bVistaStyle* está establecido en FALSE. En este último caso, la función solo devuelve NULL en modo de versión: en modo de depuración producirá una aserción.

Para obtener más `IFileSaveDialog` información acerca de la interfaz, vea [IFileSaveDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Ejemplo

En este ejemplo se recupera el objeto COM interno. Para ejecutar este ejemplo de código, debe compilarlo en Windows Vista o posterior.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

## <a name="cfiledialoggetnextpathname"></a><a name="getnextpathname"></a>CFileDialog::GetNextPathName

Llame a esta función para recuperar el siguiente nombre de archivo del grupo seleccionado en el cuadro de diálogo.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Parámetros

*Pos*<br/>
Una referencia a un valor `GetNextPathName` POSITION `GetStartPosition` devuelto por una llamada anterior o de función. NULL si se ha alcanzado el final de la lista.

### <a name="return-value"></a>Valor devuelto

Ruta de acceso completa del archivo.

### <a name="remarks"></a>Observaciones

La ruta de acceso del nombre de archivo incluye el título del archivo más la ruta de acceso completa del directorio. Por ejemplo, `GetNextPathName` devolverá "C:-FILES-TEXT. DAT" para el archivo C:-FILES-TEXT.DAT. Puede utilizar `GetNextPathName` en un bucle de iteración directa `GetStartPosition`si establece la posición inicial con una llamada a .

Si la selección consta de un solo archivo, se devolverá ese nombre de archivo.

## <a name="cfiledialoggetofn"></a><a name="getofn"></a>CFileDialog::GetOFN

Recupera la `OPENFILENAME` estructura asociada.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Valor devuelto

Una estructura [OPENFILENAME.](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)

### <a name="remarks"></a>Observaciones

Utilice la segunda versión de esta función para inicializar la apariencia de un cuadro de diálogo `DoModal` Abrir **archivo** o Guardar **archivo** como después de que se construye, pero antes de que se muestre con la función miembro. Por ejemplo, puede `lpstrTitle` establecer `m_ofn` el miembro del título que desea que tenga el cuadro de diálogo.

## <a name="cfiledialoggetpathname"></a><a name="getpathname"></a>CFileDialog::GetPathName

Llame a esta función para recuperar la ruta de acceso completa del archivo introducido en el cuadro de diálogo.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Valor devuelto

Ruta de acceso completa del archivo.

### <a name="remarks"></a>Observaciones

La ruta de acceso del nombre de archivo incluye el título del archivo más la ruta de acceso completa del directorio. Por ejemplo, `GetPathName` devolverá "C:-FILES-TEXT. DAT" para el archivo C:-FILES-TEXT.DAT.

Si `m_ofn.Flags` tiene la marca OFN_ALLOWMULTISELECT establecida, esta cadena contiene una secuencia de cadenas de valores null, siendo la primera cadena la ruta de acceso del directorio del grupo de archivos seleccionada, seguida de los nombres de todos los archivos seleccionados por el usuario. Por este motivo, use las funciones miembro [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) para recuperar el siguiente nombre de archivo de la lista.

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog::DoModal](#domodal).

## <a name="cfiledialoggetreadonlypref"></a><a name="getreadonlypref"></a>CFileDialog::GetReadOnlyPref

Llame a esta función para determinar si la casilla de verificación Solo lectura se ha seleccionado en los cuadros de diálogo Abrir archivo estándar de Windows y Guardar archivo como.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la casilla de verificación Solo lectura del cuadro de diálogo está activada; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Puede ocultar la casilla de verificación Solo `CFileDialog` lectura estableciendo el estilo OFN_HIDEREADONLY en el constructor.

> [!NOTE]
> Windows Vista o `CFileDialog` objetos de estilo posteriores no admiten esta función. Al intentar utilizar esta función en `CFileDialog` un estilo de Windows Vista o posterior, se producirá [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

## <a name="cfiledialoggetresult"></a><a name="getresult"></a>CFileDialog::GetResult

Recupera la elección que el usuario realizó en el cuadro de diálogo.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Valor devuelto

Puntero a un IShellItem que representa la elección del usuario.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialoggetresults"></a><a name="getresults"></a>CFileDialog::GetResults

Recupera las opciones del usuario en un cuadro de diálogo que permite la selección múltiple.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Valor devuelto

Un puntero a un IShellItemArray a través del cual se puede tener acceso a los elementos seleccionados en el cuadro de diálogo.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialoggetselectedcontrolitem"></a><a name="getselectedcontrolitem"></a>CFileDialog::GetSelectedControlItem

Recupera un elemento determinado del control contenedor especificado en el cuadro de diálogo.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Id. del control contenedor.

*dwIDItem*<br/>
El identificador del elemento seleccionado por el usuario en el control.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialoggetstartposition"></a><a name="getstartposition"></a>CFileDialog::GetStartPosition

Llame a esta función miembro para recuperar la posición `m_ofn.Flags` del primer nombre de ruta de acceso de archivo en la lista, si tiene la OFN_ALLOWMULTISELECT marca establecida.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Valor devuelto

Un valor POSITION que se puede utilizar para la iteración; NULL si la lista está vacía.

## <a name="cfiledialoghidecontrol"></a><a name="hidecontrol"></a>CFileDialog::HideControl

Llame a esta función miembro para ocultar el control especificado en un estilo de explorador Abrir o Guardar como cuadro de diálogo común.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
El identificador del control que se debe ocultar.

### <a name="remarks"></a>Observaciones

El cuadro de diálogo debe haberse creado con el estilo OFN_EXPLORER; de lo contrario, la función producirá un error con una aserción.

## <a name="cfiledialogispickfoldersmode"></a><a name="ispickfoldersmode"></a>CFileDialog::IsPickFoldersMode

Determina si el cuadro de diálogo actual está en modo de selector de carpetas.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Valor devuelto

TRUESi el cuadro de diálogo está en modo selector de carpetas; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogm_ofn"></a><a name="m_ofn"></a>CFileDialog::m_ofn

`m_ofn`es una estructura `OPENFILENAME`de tipo . Los datos de esta estructura representan `CFileDialog`el estado actual del archivo .

### <a name="remarks"></a>Observaciones

Utilice esta estructura para inicializar la apariencia de un cuadro de diálogo **Abrir archivo** o **Guardar** archivo como después de construirlo, pero antes de mostrarlo con el [método DoModal.](#domodal) Por ejemplo, puede establecer el miembro `m_ofn` *lpstrTitle* en el título que desea que tenga el cuadro de diálogo.

Con el estilo de Windows Vista `m_ofn` o posterior de [CFileDialog](../../mfc/reference/cfiledialog-class.md), no se garantiza que coincida siempre con el estado del cuadro de diálogo. Se sincroniza con el cuadro de diálogo en versiones anteriores de Windows. Vea [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) y [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog) para obtener `m_ofn` más información `CFileDialog` acerca de la sincronización de la estructura y el estado en Windows Vista o posterior.

Los cuadros de diálogo de archivos de estilo `CFileDialog`de Windows Vista o posterior no admiten determinados miembros y marcas del archivo . Como resultado, estos no tendrán ningún efecto.

A continuación se muestra una lista de los miembros que no son compatibles con Windows Vista o posterior:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

Las siguientes marcas no son compatibles y, por lo tanto, `CFileDialog`no tienen ningún efecto cuando se utiliza el estilo de Windows Vista o posterior de:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES - efectivamente siempre encendido en Windows Vista o posterior

- OFN_NOLONGNAMES - efectivamente siempre apagado en Windows Vista o posterior

- OFN_NONETWORKBUTTON - efectivamente siempre encendido en Windows Vista o posterior

- OFN_READONLY

- OFN_SHOWHELP

Para obtener más información acerca de esta estructura, vea la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) en el Windows SDK.

## <a name="cfiledialogmakeprominent"></a><a name="makeprominent"></a>CFileDialog::MakeProminent

Coloca un control en el cuadro de diálogo para que destaque en comparación con otros controles.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Id. del control.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogonbuttonclicked"></a><a name="onbuttonclicked"></a>CFileDialog::OnButtonClicked

Se llama cuando se hace clic en el botón.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del botón.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogoncheckbuttontoggled"></a><a name="oncheckbuttontoggled"></a>CFileDialog::OnCheckButtonToggled

Se llama cuando la casilla de verificación está marcada o desactivada.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador de la casilla de verificación.

*bChecked*<br/>
Comprobado o desmarcado.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogoncontrolactivating"></a><a name="oncontrolactivating"></a>CFileDialog::OnControlActivating

Se llama cuando se activa el control.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Id. del control.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogonfilenamechange"></a><a name="onfilenamechange"></a>CFileDialog::OnFileNameChange

Invalide este método si desea controlar el mensaje de CDN_SELCHANGE WM_NOTIFY.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Observaciones

El sistema envía el mensaje de CDN_SELCHANGE cuando el usuario selecciona un nuevo archivo o carpeta en la lista de archivos del cuadro de diálogo **Abrir** o **Guardar como.** Invalide este método si desea realizar cualquier acción en respuesta a este mensaje.

El sistema envía este mensaje solo si la ventana de diálogo se creó con la marca OFN_EXPLORER activada. Para obtener más información acerca de la notificación, consulte [CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange). Para obtener información sobre la marca OFN_EXPLORER, vea la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) y [los cuadros](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)de diálogo Abrir y guardar como .

## <a name="cfiledialogonfilenameok"></a><a name="onfilenameok"></a>CFileDialog::OnFileNameOK

Reemplace esta función solo si desea proporcionar una validación personalizada de los nombres de archivo que se introducen en un cuadro de diálogo de archivo común.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Valor devuelto

1 si el nombre de archivo no es un nombre de archivo válido; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Esta función le permite rechazar un nombre de archivo por cualquier motivo específico de la aplicación. Normalmente, no es necesario utilizar esta función porque el marco de trabajo proporciona la validación predeterminada de los nombres de archivo y muestra un cuadro de mensaje si se especifica un nombre de archivo no válido.

Si se devuelve 1, el cuadro de diálogo permanecerá visualizado para que el usuario escriba otro nombre de archivo. El procedimiento de diálogo descarta el cuadro de diálogo si la devolución es 0. Otros valores devueltos distintos de cero están reservados actualmente y no se deben usar.

## <a name="cfiledialogonfolderchange"></a><a name="onfolderchange"></a>CFileDialog::OnFolderChange

Reemplace esta función para controlar el mensaje WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Observaciones

El mensaje de notificación se envía cuando se abre una nueva carpeta en el cuadro de diálogo Abrir o Guardar como.

La notificación solo se envía si el cuadro de diálogo se creó con el estilo OFN_EXPLORER. Para obtener más información acerca de la notificación, consulte [CDN_FOLDERCHANGE](/windows/win32/dlgbox/cdn-folderchange). Para obtener información sobre el estilo OFN_EXPLORER, vea la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) y [los cuadros](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)de diálogo Abrir y guardar como .

## <a name="cfiledialogoninitdone"></a><a name="oninitdone"></a>CFileDialog::OnInitDone

Reemplace esta función para controlar el mensaje WM_NOTIFY CDN_INITDONE.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Observaciones

El sistema envía este mensaje de notificación cuando el sistema ha terminado de organizar los controles en el cuadro de diálogo **Abrir** o **Guardar como** para dejar espacio para los controles del cuadro de diálogo secundario.

El sistema lo envía solo si la ventana de diálogo se creó con el estilo OFN_EXPLORER. Para obtener más información acerca de la notificación, consulte [CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone). Para obtener información sobre el estilo OFN_EXPLORER, vea la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) y [los cuadros](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)de diálogo Abrir y guardar como .

> [!NOTE]
> Los cuadros de diálogo de archivos de estilo de Windows Vista o posterior no admiten esta función. Al intentar utilizar esta función en un cuadro de diálogo de archivo de estilo de Windows Vista o posterior, se producirá [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

## <a name="cfiledialogonitemselected"></a><a name="onitemselected"></a>CFileDialog::OnItemSelected

Se llama cuando se selecciona el elemento contenedor.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Id. del control contenedor.

*dwIDItem*<br/>
Identificador del elemento.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogonlbselchangednotify"></a><a name="onlbselchangednotify"></a>CFileDialog::OnLBSelChangedNotify

Esta función se llama siempre que la selección actual en un cuadro de lista está a punto de cambiar.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Parámetros

*nIDBox*<br/>
El identificador del cuadro de lista o cuadro combinado en el que se produjo la selección.

*iCurSel*<br/>
El índice de la selección actual.

*nCódigo*<br/>
El código de notificación de control. Este parámetro debe tener uno de los siguientes valores:

- CD_LBSELCHANGE Especifica *iCurSel* es el elemento seleccionado en un cuadro de lista de selección única.

- CD_LBSELSUB Especifica que *iCurSel* ya no está seleccionado en un cuadro de lista de selección múltiple.

- CD_LBSELADD Especifica que *iCurSel* está seleccionado en un cuadro de lista de selección múltiple.

- CD_LBSELNOITEMS Especifica que no existe ninguna selección en un cuadro de lista de selección múltiple.

### <a name="remarks"></a>Observaciones

Reemplace esta función para proporcionar un control personalizado de los cambios de selección en el cuadro de lista. Por ejemplo, puede utilizar esta función para mostrar los derechos de acceso o la fecha-última modificación de cada archivo que el usuario selecciona.

## <a name="cfiledialogonshareviolation"></a><a name="onshareviolation"></a>CFileDialog::OnShareViolation

Invalide esta función para proporcionar un control personalizado de las infracciones de recursos compartidos.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parámetros

*lpszPathName*<br/>
La ruta de acceso del archivo en el que se produjo la infracción del recurso compartido.

### <a name="return-value"></a>Valor devuelto

Uno de los valores siguientes:

- OFN_SHAREFALLTHROUGH El nombre de archivo se devuelve desde el cuadro de diálogo.

- OFN_SHARENOWARN No es necesario tomar medidas adicionales.

- OFN_SHAREWARN El usuario recibe el mensaje de advertencia estándar para este error.

### <a name="remarks"></a>Observaciones

Normalmente, no es necesario usar esta función porque el marco de trabajo proporciona la comprobación predeterminada de infracciones de recursos compartidos y muestra un cuadro de mensaje si se produce una infracción de recurso compartido.

Si desea deshabilitar la comprobación de infracción de recurso compartido, `m_ofn.Flags`utilice el operador OR bit a bit para combinar la marca OFN_SHAREAWARE con .

## <a name="cfiledialogontypechange"></a><a name="ontypechange"></a>CFileDialog::OnTypeChange

Invalide esta función para controlar el mensaje de WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Observaciones

El mensaje de notificación se envía cuando el usuario selecciona un nuevo tipo de archivo de la lista de tipos de archivo en el cuadro de diálogo Abrir o Guardar como.

La notificación solo se envía si el cuadro de diálogo se creó con el estilo OFN_EXPLORER. Para obtener más información acerca de la notificación, consulte [CDN_TYPECHANGE](/windows/win32/dlgbox/cdn-typechange). Para obtener información sobre el estilo OFN_EXPLORER, vea la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) y [los cuadros](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)de diálogo Abrir y guardar como .

## <a name="cfiledialogremovecontrolitem"></a><a name="removecontrolitem"></a>CFileDialog::RemoveControlItem

Quita un elemento de un control contenedor en el cuadro de diálogo.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control contenedor del que se va a quitar el elemento.

*dwIDItem*<br/>
Identificador del elemento.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogsetcheckbuttonstate"></a><a name="setcheckbuttonstate"></a>CFileDialog::SetCheckButtonState

Establece el estado actual de un botón de verificación (casilla de verificación) en el cuadro de diálogo.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador de la casilla de verificación.

*bChecked*<br/>
El estado de la casilla de verificación. TRUE indica checked; FALSE indica Desmarcado.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogsetcontrolitemstate"></a><a name="setcontrolitemstate"></a>CFileDialog::SetControlItemState

Establece el estado actual de un elemento en un control contenedor que se encuentra en el cuadro de diálogo.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Id. del control contenedor.

*dwIDItem*<br/>
Identificador del elemento.

*dwState*<br/>
Uno o varios valores de la enumeración CDCONTROLSTATE que indican el nuevo estado del control.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogsetcontrolitemtext"></a><a name="setcontrolitemtext"></a>CFileDialog::SetControlItemText

Establece el texto de un elemento de control. Por ejemplo, el texto que acompaña a un botón de opción o un elemento de un menú.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Id. del control contenedor.

*dwIDItem*<br/>
Identificador del elemento.

*strLabel*<br/>
Texto del elemento.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogsetcontrollabel"></a><a name="setcontrollabel"></a>CFileDialog::SetControlLabel

Establece el texto asociado a un control, como el texto del botón o una etiqueta de cuadro de edición.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Id. del control.

*strLabel*<br/>
El nombre del control.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogsetcontrolstate"></a><a name="setcontrolstate"></a>CFileDialog::SetControlState

Establece la visibilidad actual y los estados habilitados de un control determinado.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Id. del control.

*dwState*<br/>
Uno o varios valores de la enumeración CDCONTROLSTATE que indican el estado actual del control.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogsetcontroltext"></a><a name="setcontroltext"></a>CFileDialog::SetControlText

Llame a este método para establecer el texto para el control especificado en un estilo de Explorador **Abrir** o **Guardar como** cuadro de diálogo.

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
[en] El identificador del control para el que se debe establecer el texto.

*lpsz*<br/>
[en] Puntero a la cadena que contiene el texto que se va a establecer para el control.

### <a name="remarks"></a>Observaciones

Ambas versiones de esta función son válidas para aplicaciones que utilizan Unicode. Sin embargo, sólo la versión con el tipo LPCSTR es válida para aplicaciones que utilizan ANSI.

Para utilizar este método, debe crear el cuadro de diálogo con el estilo OFN_EXPLORER. De lo contrario, se producirá un error en la función con una aserción.

## <a name="cfiledialogsetdefext"></a><a name="setdefext"></a>CFileDialog::SetDefExt

Llame a esta función para establecer la extensión de nombre de archivo predeterminada para un cuadro de diálogo común Abrir o Guardar como estilo Explorador.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Parámetros

*lpsz*<br/>
Puntero a una cadena que contiene la extensión predeterminada que se usará para el objeto de cuadro de diálogo. Esta cadena no debe contener un punto (.).

### <a name="remarks"></a>Observaciones

El cuadro de diálogo debe haberse creado con el estilo OFN_EXPLORER; de lo contrario, la función producirá un error con una aserción.

## <a name="cfiledialogseteditboxtext"></a><a name="seteditboxtext"></a>CFileDialog::SetEditBoxText

Establece el texto actual en un control de cuadro de edición.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del cuadro de edición.

*strText*<br/>
Valor de texto.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogsetproperties"></a><a name="setproperties"></a>CFileDialog::SetProperties

Proporciona un almacén de propiedades que define los valores predeterminados que se van a usar para el elemento que se está guardando.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Parámetros

*lpszPropList*<br/>
Lista de propiedades predefinidas separadas por ";". Para obtener una lista de los indicadores, consulte la sección **Indicadores** de [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew).

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogsetselectedcontrolitem"></a><a name="setselectedcontrolitem"></a>CFileDialog::SetSelectedControlItem

Establece el estado seleccionado de un elemento determinado en un grupo de botones de opción o en un cuadro combinado que se encuentra en el cuadro de diálogo.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Id. del control contenedor.

*dwIDItem*<br/>
El identificador del elemento seleccionado por el usuario en el control.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogsettemplate"></a><a name="settemplate"></a>CFileDialog::SetTemplate

Establece la plantilla de cuadro de diálogo para el [CFileDialog](../../mfc/reference/cfiledialog-class.md) objeto.

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Parámetros

*nWin3ID*<br/>
[en] Contiene el número de identificador del recurso `CFileDialog` de plantilla para el objeto que no es Explorer. Esta plantilla solo se utiliza en Windows NT 3.51 o cuando el estilo OFN_EXPLORER no está presente.

*nWin4ID*<br/>
[en] Contiene el número de identificador del `CFileDialog` recurso de plantilla para el Explorer objeto. Esta plantilla solo se utiliza en Windows NT 4.0 y versiones posteriores, Windows 95 y versiones posteriores, o cuando el estilo OFN_EXPLORER está presente.

*lpWin3ID*<br/>
[en] Contiene el nombre del recurso de `CFileDialog` plantilla para el objeto que no es Explorer. Esta plantilla solo se utiliza en Windows NT 3.51 o cuando el estilo OFN_EXPLORER no está presente.

*lpWin4ID*<br/>
[en] Contiene el nombre del recurso `CFileDialog` de plantilla del objeto Explorer. Esta plantilla solo se utiliza en Windows NT 4.0 y versiones posteriores, Windows 95 y versiones posteriores, o cuando el estilo OFN_EXPLORER está presente.

### <a name="remarks"></a>Observaciones

El sistema utilizará solo una de las plantillas especificadas. El sistema determina qué plantilla utilizar en función de la presencia del estilo OFN_EXPLORER y el sistema operativo en el que se ejecuta la aplicación. Al especificar una plantilla que no sea de Explorador y de estilo Explorador, es fácil admitir Windows NT 3.51, Windows NT 4.0 y versiones posteriores, y Windows 95 y versiones posteriores.

> [!NOTE]
> Los cuadros de diálogo de archivo de estilo de Windows Vista o posterior no admiten esta función. Al intentar utilizar esta función en un cuadro de diálogo de archivo de estilo de Windows Vista o posterior, se producirá [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Una alternativa es utilizar un cuadro de diálogo personalizado. Para obtener más información `CFileDialog`sobre el uso de un objeto personalizado , vea [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

## <a name="cfiledialogstartvisualgroup"></a><a name="startvisualgroup"></a>CFileDialog::StartVisualGroup

Declara un grupo visual en el cuadro de diálogo. Las llamadas posteriores a cualquier método "add" agregan esos elementos a este grupo.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del grupo visual.

*strLabel*<br/>
El nombre del grupo.

### <a name="remarks"></a>Observaciones

## <a name="cfiledialogupdateofnfromshelldialog"></a><a name="updateofnfromshelldialog"></a>CFileDialog::UpdateOFNFromShellDialog

Actualiza `m_ofn` la estructura de datos de la [CFileDialog](../../mfc/reference/cfiledialog-class.md) en función del estado actual del objeto interno.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Observaciones

En versiones de Windows anteriores a Windows Vista, la estructura `CFileDialog`de datos [OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) del miembro se sincronizaba continuamente con el estado del archivo . Cualquier cambio en [la](#m_ofn) m_ofn variable miembro afectaba directamente al estado del cuadro de diálogo. Además, cualquier cambio en el estado del cuadro de diálogo actualizó inmediatamente la m_ofn variable miembro.

En Windows Vista o `m_ofn` posterior, la estructura de datos no se actualiza automáticamente. Para garantizar la precisión de `m_ofn` los datos en la `UpdateOFNFromShellDialog` variable miembro, debe llamar a la función antes de tener acceso a los datos. Windows llama a esta función automáticamente durante el procesamiento de [IFileDialog::OnFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Para obtener más información `CFileDialog` acerca de cómo utilizar la clase en Windows Vista o posterior, vea [CFileDialog (Clase)](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Ejemplo

En este `CFileDialog` ejemplo se actualiza el antes de mostrarlo. Antes de `m_ofn` actualizar la variable miembro, necesitamos sincronizarla con el estado actual del cuadro de diálogo.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Consulte también

[Clase CCommonDialog](../../mfc/reference/ccommondialog-class.md)<br/>
[Gráfico de jerarquías](../../mfc/hierarchy-chart.md)
