---
title: CFileDialog (clase)
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: f74d883fa0dcdce025345848caf49069736ee0fa
ms.sourcegitcommit: c7f90df497e6261764893f9cc04b5d1f1bf0b64b
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/05/2019
ms.locfileid: "58779214"
---
# <a name="cfiledialog-class"></a>CFileDialog (clase)

Encapsula el cuadro de diálogo común que se usa para abrir el archivo o archivo de las operaciones de almacenamiento.

## <a name="syntax"></a>Sintaxis

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Miembros

### <a name="public-constructors"></a>Constructores públicos

|Name|Descripción|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|Construye un objeto `CFileDialog`.|

### <a name="public-methods"></a>Métodos públicos

|Name|Descripción|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|Agrega un botón de comprobación en el cuadro de diálogo.|
|[CFileDialog::AddComboBox](#addcombobox)|Agrega un cuadro combinado en el cuadro de diálogo.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Agrega un elemento a un control contenedor en el cuadro de diálogo.|
|[CFileDialog::AddEditBox](#addeditbox)|Agrega un cuadro de edición en el cuadro de diálogo.|
|[CFileDialog::AddMenu](#addmenu)|Agrega un menú en el cuadro de diálogo.|
|[CFileDialog::AddPlace](#addplace)|Sobrecargado. Agrega que una carpeta a la lista de plazas disponible para el usuario desea abrir o guardar elementos.|
|[CFileDialog::AddPushButton](#addpushbutton)|Agrega un botón en el cuadro de diálogo.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Agrega un grupo de opciones (también denominado botón de radio) en el cuadro de diálogo.|
|[CFileDialog::AddSeparator](#addseparator)|Agrega un separador en el cuadro de diálogo.|
|[CFileDialog::AddText](#addtext)|Agrega el contenido de texto al cuadro de diálogo.|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Actualiza el estado de la `CFileDialog` para que coincida con los parámetros y marcadores almacenados en el `m_ofn` variable miembro.|
|[CFileDialog::DoModal](#domodal)|Muestra el cuadro de diálogo y permite al usuario realizar una selección.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Habilita una lista desplegable en el **abierto** o **guardar** botón en el cuadro de diálogo.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Detiene la adición de elementos a un grupo en el cuadro de diálogo visual.|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Obtiene el estado actual de un botón de comprobación (casilla) en el cuadro de diálogo.|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Obtiene el estado actual de un elemento en un control contenedor que se encuentra en el cuadro de diálogo.|
|[CFileDialog::GetControlState](#getcontrolstate)|Obtiene la visibilidad actual y Estados de un control determinado habilitados.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Obtiene el texto actual en un control de cuadro de edición.|
|[CFileDialog::GetFileExt](#getfileext)|Devuelve la extensión del archivo seleccionado.|
|[CFileDialog::GetFileName](#getfilename)|Devuelve el nombre de archivo del archivo seleccionado.|
|[CFileDialog::GetFileTitle](#getfiletitle)|Devuelve el título del archivo seleccionado.|
|[CFileDialog::GetFolderPath](#getfolderpath)|Recupera la ruta de acceso del directorio o carpeta abierta para un tipo de explorador **abrir** o **Guardar como** cuadro de diálogo común.|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Recupera el objeto interno de COM para un personalizado `CFileDialog` objeto.|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Recupera el objeto COM interno para un `CFileDialog` que se usa como un **abierto** cuadro de diálogo de archivo.|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Recupera el objeto COM interno para un `CFileDialog` que se usa como un **guardar** cuadro de diálogo de archivo.|
|[CFileDialog::GetNextPathName](#getnextpathname)|Devuelve la ruta de acceso completa del archivo seleccionado siguiente.|
|[CFileDialog::GetOFN](#getofn)|Recupera el `OPENFILENAME` estructura de la `CFileDialog` objeto.|
|[CFileDialog::GetPathName](#getpathname)|Devuelve la ruta de acceso completa del archivo seleccionado.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Devuelve el estado de solo lectura del archivo seleccionado.|
|[CFileDialog::GetResult](#getresult)|Obtiene la opción realizados por el usuario en el cuadro de diálogo.|
|[CFileDialog::GetResults](#getresults)|Obtiene las opciones del usuario en un cuadro de diálogo que permite la selección múltiple.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Obtiene un elemento determinado de controles de contenedor especificado en el cuadro de diálogo.|
|[CFileDialog::GetStartPosition](#getstartposition)|Devuelve la posición del primer elemento de la lista de nombres de archivo.|
|[CFileDialog::HideControl](#hidecontrol)|Oculta el control especificado en un tipo de explorador **abierto** o **Guardar como** cuadro de diálogo común.|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Determina si el cuadro de diálogo actual en modo selector de carpetas.|
|[CFileDialog::MakeProminent](#makeprominent)|Coloca un control en el cuadro de diálogo para que destaque en comparación con otros controles agregados.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Quita un elemento de un control contenedor en el cuadro de diálogo.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Establece el estado actual de un botón de comprobación (casilla) en el cuadro de diálogo.|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Establece el estado actual de un elemento en un control contenedor que se encuentra en el cuadro de diálogo.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Establece el texto de un elemento de control. Por ejemplo, el texto que acompaña a un elemento en un menú o un botón de radio.|
|[CFileDialog::SetControlLabel](#setcontrollabel)|Establece el texto asociado a un control, como texto del botón o una etiqueta del cuadro de edición.|
|[CFileDialog::SetControlState](#setcontrolstate)|Establece la visibilidad actual y Estados de un control determinado habilitados.|
|[CFileDialog::SetControlText](#setcontroltext)|Establece el texto para el control especificado en un tipo de explorador **abierto** o **Guardar como** cuadro de diálogo común.|
|[CFileDialog::SetDefExt](#setdefext)|Establece la extensión de nombre de archivo predeterminado para un tipo de explorador **abierto** o **Guardar como** cuadro de diálogo común.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Establece el texto actual en un control de cuadro de edición.|
|[CFileDialog::SetProperties](#setproperties)|Proporciona un almacén de propiedades que define los valores predeterminados que se van a usar para el elemento que se está guardando.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Establece el estado seleccionado de un elemento determinado en un grupo de botones de opción o un cuadro combinado se encuentra en el cuadro de diálogo.|
|[CFileDialog::SetTemplate](#settemplate)|Establece la plantilla de cuadro de diálogo para la `CFileDialog` objeto.|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Declara un grupo en el cuadro de diálogo visual. Las llamadas subsiguientes a cualquier método "add" agregan esos elementos a este grupo.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Actualiza los datos almacenados en el `m_ofn` variable miembro para que coincida con el estado actual del cuadro de diálogo de archivo.|

### <a name="protected-methods"></a>Métodos protegidos

|Name|Descripción|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Se llama cuando se hace clic en el botón.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Se llama cuando la casilla está activada o desactivada.|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Se llama cuando se activa el control.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Controla el mensaje WM_NOTIFY CDN_SELCHANGE.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|Valida el nombre de archivo especificado en el cuadro de diálogo.|
|[CFileDialog::OnFolderChange](#onfolderchange)|Controla el mensaje WM_NOTIFY CDN_FOLDERCHANGE.|
|[CFileDialog::OnInitDone](#oninitdone)|Controla el mensaje WM_NOTIFY CDN_INITDONE.|
|[CFileDialog::OnItemSelected](#onitemselected)|Se llama cuando se selecciona el elemento contenedor.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Permite realizar acciones personalizadas cuando cambia la selección de archivo.|
|[CFileDialog::OnShareViolation](#onshareviolation)|Identificadores de compartan las infracciones.|
|[CFileDialog::OnTypeChange](#ontypechange)|Controla el mensaje WM_NOTIFY CDN_TYPECHANGE.|

### <a name="public-data-members"></a>Miembros de datos públicos

|Name|Descripción|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|El Windows `OPENFILENAME` estructura. Proporciona acceso a los parámetros de cuadro de diálogo de archivo básico.|

## <a name="remarks"></a>Comentarios

Cuadros de diálogo comunes le permite implementar los cuadros de diálogo de selección de archivos, por ejemplo, **abrir archivo** y **Guardar como**, de manera que sea coherente con los estándares de Windows.

Puede usar `CFileDialog` tal cual con el constructor proporcionado, o puede derivar su propia clase de cuadro de diálogo de `CFileDialog` y escribir un constructor para satisfacer sus necesidades. En cualquier caso, estos cuadros de diálogo se comportarán como cuadros de diálogo MFC estándar porque se deriva el [CCommonDialog (clase)](../../mfc/reference/ccommondialog-class.md). `CFileDialog` se basa en el COMMDLG. Archivo DLL que se incluye en Windows.

La apariencia y la funcionalidad de la `CFileDialog` con Windows Vista o versiones posteriores difieren de las versiones anteriores de Windows. El valor predeterminado `CFileDialog` utiliza automáticamente el nuevo Windows Vista o el estilo más adelante sin cambios de código si un programa compilado y ejecutar en Windows Vista o posterior. Use la *bVistaStyle* parámetro del constructor para reemplazar manualmente la actualización automática. La excepción a la actualización automática es cuadros de diálogo personalizados. No se convertirá en el nuevo estilo. Para obtener más información sobre el constructor, vea [CFileDialog::CFileDialog](#cfiledialog).

> [!NOTE]
>  El sistema de Id. de control es diferente en Windows Vista o versiones posteriores desde versiones anteriores de Windows cuando se usa un `CFileDialog`. Debe actualizar todas las referencias a `CFileDialog` controles en el código antes de que se puede portar su proyecto desde una versión anterior de Windows.

Algunos `CFileDialog` métodos no se admiten en Windows Vista o posterior. Consulte el tema de los métodos individuales para obtener información sobre si se admite el método. Además, las siguientes funciones heredadas no se admiten en Windows Vista o posterior:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

Los mensajes de windows para el `CFileDialog` clase varían en función de qué sistema operativo que está usando. Por ejemplo, no es compatible con Windows XP [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) y [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) para el `CFileDialog` clase. Sin embargo, Windows Vista y sistemas operativos posteriores son compatibles con ellos. Para obtener más información sobre los distintos mensajes que se generan y el orden en que se reciben, consulte [CFileDialog ejemplo: Orden de los eventos de registro](../../overview/visual-cpp-samples.md).

Para usar un `CFileDialog` de objetos, primero cree el objeto utilizando el `CFileDialog` constructor. Después de que se ha construido el cuadro de diálogo, puede establecer o modificar los valores de la [CFileDialog::m_ofn](#m_ofn) estructura para inicializar los valores o los Estados de los controles de cuadro de diálogo. El `m_ofn` estructura es de tipo `OPENFILENAME`. Para obtener más información, consulte el [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) estructura en el SDK de Windows.

Después de inicializar los controles de cuadro de diálogo, llame a la [CFileDialog::DoModal](#domodal) método para mostrar el cuadro de diálogo cuadro para que el usuario puede escribir la ruta de acceso y nombre de archivo. `DoModal` Devuelve si el usuario hizo clic en Aceptar (IDOK) o en el botón Cancelar (IDCANCEL). Si `DoModal` devuelve IDOK, puede usar uno de los `CFileDialog` colocan funciones miembro públicas para recuperar la información en el usuario.

> [!NOTE]
> En Windows Vista o versiones posteriores, varias llamadas a [IFileDialog::SetFileTypes](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) produce un error. La segunda llamada a `SetFileTypes` para cualquier instancia de un `CFileDialog` devuelve E_UNEXPECTED en Windows Vista o posterior. Algunos `CFileDialog` método funciones llaman a `SetFileTypes`. Por ejemplo, dos llamadas a `CFileDialog::DoModal` para la misma instancia de un `CFileDialog` genera [ASSERT](diagnostic-services.md#assert).

`CFileDialog` incluye varios miembros protegidos que le permiten realizar un procesamiento personalizado de infracciones de recurso compartido, validación de nombre de archivo y notificación de cambio de cuadro de lista. Estos miembros protegidos son funciones de devolución de llamada que no es necesario usar ya control predeterminado que se realiza automáticamente la mayoría de las aplicaciones. Las entradas de mapa de mensajes para estas funciones no son necesarias porque son funciones virtuales estándar.

Puede usar el Windows [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) función para determinar si se produjo un error durante la inicialización del cuadro de diálogo y para obtener más información sobre el error.

La destrucción de `CFileDialog` objetos se controla automáticamente. No es necesario llamar a [CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Para permitir al usuario seleccionar varios archivos, establezca la marca OFN_ALLOWMULTISELECT antes de llamar a `DoModal`. Debe proporcionar su propio búfer de nombre de archivo para dar cabida a la lista de varios nombres de archivo devuelta. Realizar esto reemplazando `m_ofn.lpstrFile` con un puntero a un búfer ha asignado, después de crear el `CFileDialog`, pero antes de llamar a `DoModal`.

Además, debe establecer `m_ofn.nMaxFile` utilizando el número de caracteres en el búfer señalado por `m_ofn.lpstrFile`. Si establece el número máximo de archivos que se seleccionen para `n`, el tamaño de búfer necesario es `n * (_MAX_PATH + 1) + 1`. El primer elemento devuelto en el búfer es la ruta de acceso a la carpeta donde se han seleccionado los archivos. Para Windows Vista o cuadros de diálogo de estilo de una versión posterior, las cadenas de nombre de archivo y directorio son terminada en null, con un carácter null adicional después del último nombre de archivo. Este formato permite que los cuadros de diálogo de tipo de explorador devolver nombres de archivo largos que incluyen espacios. En los cuadros de diálogo de estilo antiguo, las cadenas de nombre de directorio y archivo están separadas por espacios y la función utiliza los nombres de archivo cortos para los nombres de archivo con espacios.

El ejemplo siguiente muestra cómo utilizar un búfer para recuperar y mostrar varios nombres de archivo.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Para cambiar el tamaño del búfer en respuesta al usuario seleccionar varios nombres de archivo, debe derivar una nueva clase de `CFileDialog` e invalidar la [CFileDialog::OnFileNameChange](#onfilenamechange) método.

Si deriva una nueva clase de `CFileDialog`, puede usar un mapa de mensajes para controlar los mensajes. Para extender el control de mensajes de forma predeterminada, derive una clase de `CFileDialog`, agregue un mapa de mensajes a la nueva clase y proporcionar funciones de miembro para los mensajes nuevos. No es necesario proporcionar una función de enlace para personalizar el cuadro de diálogo.

Para personalizar el cuadro de diálogo, derive una clase de `CFileDialog`, proporcione una plantilla de cuadro de diálogo personalizado y agregar un mapa de mensajes para procesar los mensajes de notificación de los controles extendidos. Pasar los mensajes sin procesar a la clase base. No es necesario personalizar la función de enlace.

Cuando se usa el estilo de una versión posterior de o Windows Vista la `CFileDialog`, no se puede usar mapas de mensajes y las plantillas de cuadro de diálogo. En su lugar, debe usar las interfaces COM para una funcionalidad similar.

Para obtener más información sobre cómo usar `CFileDialog`, consulte [clases de cuadro de diálogo comunes](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Jerarquía de herencia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Requisitos

**Encabezado:** afxdlgs.h

##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton

Agrega un botón de comprobación en el cuadro de diálogo.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador de la marca de verificación para agregar.

*strLabel*<br/>
El nombre del botón de comprobación.

*bChecked*<br/>
Un valor booleano que indica el estado actual de la marca de verificación. TRUE si se activa; FALSE en caso contrario

### <a name="remarks"></a>Comentarios

##  <a name="addcombobox"></a>  CFileDialog::AddComboBox

Agrega un cuadro combinado en el cuadro de diálogo.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del cuadro combinado para agregar.

### <a name="remarks"></a>Comentarios

##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem

Agrega un elemento a un control contenedor en el cuadro de diálogo.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control contenedor para agregar el elemento.

*dwIDItem*<br/>
El identificador del elemento.

*strLabel*<br/>
Texto del elemento.

### <a name="remarks"></a>Comentarios

##  <a name="addeditbox"></a>  CFileDialog::AddEditBox

Agrega un cuadro de edición en el cuadro de diálogo.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del cuadro de edición para agregar.

*strText*<br/>
El nombre del cuadro de edición.

### <a name="remarks"></a>Comentarios

##  <a name="addmenu"></a>  CFileDialog::AddMenu

Agrega un menú en el cuadro de diálogo.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del menú para agregar.

*strLabel*<br/>
El nombre del menú.

### <a name="remarks"></a>Comentarios

##  <a name="addplace"></a>  CFileDialog::AddPlace

Agrega que una carpeta a la lista de plazas disponible para el usuario desea abrir o guardar elementos.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Parámetros

*lpszFolder*<br/>
Una ruta de acceso a la carpeta esté disponible para el usuario. Sólo puede ser una carpeta.

*fdap*<br/>
Especifica dónde se coloca la carpeta en la lista.

*psi*<br/>
Un puntero a un IShellItem que representa la carpeta esté disponible para el usuario. Sólo puede ser una carpeta.

### <a name="remarks"></a>Comentarios

##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton

Agrega un botón en el cuadro de diálogo.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del botón Agregar.

*strLabel*<br/>
El nombre del botón.

### <a name="remarks"></a>Comentarios

##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList

Agrega un grupo de opciones (también denominado botón de radio) en el cuadro de diálogo.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del grupo de botones de opción para agregar.

### <a name="remarks"></a>Comentarios

##  <a name="addseparator"></a>  CFileDialog::AddSeparator

Agrega un separador en el cuadro de diálogo.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
Agregue el identificador del separador.

### <a name="remarks"></a>Comentarios

##  <a name="addtext"></a>  CFileDialog::AddText

Agrega texto al cuadro de diálogo.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del texto va a agregar.

*strText*<br/>
El nombre de texto.

### <a name="remarks"></a>Comentarios

##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog

Actualiza el estado actual de la [CFileDialog](../../mfc/reference/cfiledialog-class.md) según los valores almacenados en el `m_ofn` estructura de datos.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Comentarios

En las versiones de Windows antes de Windows Vista, el miembro [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) continuamente se sincronizó la estructura de datos con el estado de la `CFileDialog`. Los cambios realizados en el [m_ofn](#m_ofn) variable miembro se reflejan inmediatamente en el estado del cuadro de diálogo. Además, los cambios realizados en el estado del cuadro de diálogo actualizarán inmediatamente el `m_ofn` variable miembro.

En Windows Vista o versiones posteriores, los valores de la `m_ofn` variable miembro y el estado de la `CFileDialog` no se garantiza que se sincronicen. Esta función fuerza el estado de la `CFileDialog` actualizarse para que coincida con el `m_ofn` estructura. Windows llama a esta función automáticamente durante [CFileDialog::DoModal](#domodal).

Para obtener más información sobre cómo usar el `CFileDialog` clase en Windows Vista o una versión posterior, consulte [clase CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog).

##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog

Llame a esta función para construir un cuadro de diálogo de archivo estándar de Windows.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Parámetros

*bOpenFileDialog*<br/>
[in] El parámetro que especifica qué tipo de cuadro de diálogo para crear. Establézcalo en TRUE para construir un **abrir archivo** cuadro de diálogo. Establézcalo en FALSE para construir un **Guardar archivo como** cuadro de diálogo.

*lpszDefExt*<br/>
[in] La extensión de nombre de archivo predeterminado. Si el usuario no tiene una extensión conocida (uno que tenga una asociación en el equipo del usuario) en el cuadro Nombre de archivo, la extensión especificada por *lpszDefExt* se anexa automáticamente al nombre de archivo. Si este parámetro es NULL, no se anexa ninguna extensión.

*lpszFileName*<br/>
[in] El nombre de archivo inicial que aparece en el cuadro Nombre de archivo. Si es NULL, no aparece ningún nombre de archivo inicial.

*dwFlags*<br/>
[in] Una combinación de uno o más marcadores que se pueden usar para personalizar el cuadro de diálogo. Para obtener una descripción de estas marcas, vea el [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) estructura en el SDK de Windows. Si modifica el `m_ofn.Flags` miembros de estructura, utilice un operador OR bit a bit de los cambios para mantener intactos el comportamiento predeterminado.

*lpszFilter*<br/>
[in] Una serie de pares de cadenas que especifican filtros puede aplicar al archivo. Si especifica filtros de archivo, sólo los archivos que coinciden con los criterios de filtro aparecerán en la lista de archivos. Vea la sección Comentarios para obtener más información sobre cómo trabajar con filtros de archivo.

*pParentWnd*<br/>
[in] Un puntero a la ventana principal o propietaria del cuadro de diálogo de archivo.

*dwSize*<br/>
[in] El tamaño de la `OPENFILENAME` estructura. Este valor depende de la versión del sistema operativo. MFC utiliza este parámetro para determinar el tipo adecuado de cuadro de diálogo para crear. El tamaño predeterminado de 0 significa que el código de MFC determinan el tamaño del cuadro de diálogo correctos para utilizar según la versión de sistema operativo en el que se ejecuta el programa.

*bVistaStyle*<br/>
[in] **Nota** este parámetro está disponible en Visual Studio 2008 y versiones posteriores y estará que el cuadro de diálogo nuevo estilo que se utilizará sólo si está ejecutando en Windows Vista o posterior.

El parámetro que especifica el estilo del cuadro de diálogo de archivo. Establézcala en True para usar el nuevo estilo de Vista diálogos de archivo. En caso contrario, se usará el estilo anterior de los cuadros de diálogo. Consulte la sección Comentarios para obtener más información acerca de la que se ejecutan en la Vista.

### <a name="remarks"></a>Comentarios

Ya sea un **abrir archivo** o **Guardar archivo como** se construye el cuadro de diálogo, dependiendo del valor de *bOpenFileDialog*.

Especifica una extensión predeterminada mediante *lpszDefExt* no se puede producir el comportamiento que espera, ya que rara vez es predecible qué extensiones tienen asociaciones de archivo en el equipo del usuario. Si necesita más control sobre la incorporación de una extensión de forma predeterminada, puede derivar su propia clase de `CFileDialog`e invalidar la `CFileDialog::OnFileNameOK` método para realizar su propio control de extensión.

Para permitir al usuario seleccionar varios archivos, establezca la marca OFN_ALLOWMULTISELECT antes de llamar a [DoModal](#domodal). Debe proporcionar su propio búfer de nombre de archivo para almacenar la lista de varios nombres de archivo devuelta. Realizar esto reemplazando `m_ofn.lpstrFile` con un puntero a un búfer ha asignado, después de crear el [CFileDialog](../../mfc/reference/cfiledialog-class.md), pero antes de llamar a `DoModal`. Además, debe establecer `m_ofn.nMaxFile` con el número de caracteres en el búfer señalado por `m_ofn.lpstrFile`. Si establece el número máximo de archivos que se seleccionen para *n*, es el tamaño del búfer necesario `n`*(_MAX_PATH + 1) + 1. Por ejemplo:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Para permitir al usuario cambiar el tamaño de un cuadro de diálogo de tipo explorador con el mouse o el teclado, establezca la marca OFN_ENABLESIZING. Al establecer esta marca solo es necesario si se proporciona un procedimiento de enlace o una plantilla personalizada. La marca solo funciona con un cuadro de diálogo de tipo explorador; no se pueden cambiar el tamaño de los cuadros de diálogo de estilo antiguo.

El *lpszFilter* parámetro se usa para determinar el tipo de nombre de archivo debe tener un archivo que se mostrará en la lista de archivos. La primera cadena en el par de cadenas describe el filtro; la segunda cadena indica la extensión de nombre de archivo para usar. Pueden especificarse varias extensiones mediante el uso de un punto y coma (el carácter ';') como delimitador. La cadena finaliza con dos '&#124;' caracteres, seguidos por un carácter nulo. También puede usar un [CString](../../atl-mfc-shared/using-cstring.md) objeto para este parámetro.

Por ejemplo, Microsoft Excel permite a los usuarios abrir archivos que tienen extensiones .xlc (gráfico) o. xls (hoja de cálculo), entre otros. El filtro para Excel podría escribirse como:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Sin embargo, si tiene previsto usar esta cadena directamente al actualizar el `OPENFILENAME` estructura, debe delimitar las cadenas con el carácter nulo '\0', en lugar de las barras verticales ('&#124;').

El *bVistaStyle* parámetro solo es aplicable cuando en Windows Vista o una versión posterior. En versiones anteriores de Windows, se omite este parámetro. Si *bVistaStyle* está establecida en TRUE, cuando se compila un programa con Visual Studio 2008 o posterior, el nuevo estilo de Vista **cuadro de diálogo archivo** se usará. En caso contrario, el estilo anterior de MFC **cuadro de diálogo archivo** se usará.

Plantillas de cuadro de diálogo no se admiten en los cuadros de diálogo según *bVistaStyle*

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog::DoModal](#domodal).

##  <a name="domodal"></a>  CFileDialog::DoModal

Llame a esta función para mostrar el cuadro de diálogo de archivo comunes de Windows y permite al usuario explorar los archivos y directorios y escriba un nombre de archivo.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Valor devuelto

IDOK o IDCANCEL. Si se devuelve IDCANCEL, llame a la Windows [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) función para determinar si se produjo un error.

IDOK e IDCANCEL son las constantes que indican si el usuario seleccionó el botón Aceptar o Cancelar.

### <a name="remarks"></a>Comentarios

Si desea inicializar las distintas opciones del cuadro de diálogo de archivo mediante el establecimiento de los miembros de la `m_ofn` estructura, debe hacerlo antes de llamar a `DoModal`, pero después de que se construye el objeto de cuadro de diálogo.

Por ejemplo, si desea permitir al usuario seleccionar varios archivos, establezca la marca OFN_ALLOWMULTISELECT antes de llamar a `DoModal`, tal y como se muestra en el ejemplo de código en este tema.

Cuando el usuario hace clic en el cuadro de diálogo botones Aceptar o cancelar o selecciona el cierre de opción en el cuadro de diálogo control de menú, el control se devuelve a la aplicación. A continuación, puede llamar otras funciones miembro para recuperar la configuración o la información de las entradas de usuario en el cuadro de diálogo.

`DoModal` es una función virtual invalida desde la clase `CDialog`.

### <a name="example"></a>Ejemplo

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown

Permite una lista desplegable en la apertura o botón en el cuadro de diálogo Guardar.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador de la lista desplegable.

### <a name="remarks"></a>Comentarios

##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup

Detiene la adición de elementos a un grupo en el cuadro de diálogo visual.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Valor devuelto

Devuelve S_OK si se realiza correctamente; un valor de error en caso contrario.

### <a name="remarks"></a>Comentarios

##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState

Recupera el estado actual de un botón de comprobación (casilla) en el cuadro de diálogo.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador de la casilla de verificación.

*bChecked*<br/>
El estado de la casilla de verificación. TRUE indica activado; FALSE indica desactivada.

### <a name="remarks"></a>Comentarios

##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState

Recupera el estado actual de un elemento en un control contenedor que se encuentra en el cuadro de diálogo.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control contenedor.

*dwIDItem*<br/>
El identificador del elemento.

*dwState*<br/>
Una referencia a una variable que recibe uno de varios valores de la enumeración CDCONTROLSTATE que indica el estado actual del control.

### <a name="remarks"></a>Comentarios

##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState

Recupera la visibilidad actual y los Estados de un control determinado habilitados.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control.

*dwState*<br/>
Una referencia a una variable que recibe uno o más valores de la enumeración CDCONTROLSTATE que indica el estado actual del control.

### <a name="remarks"></a>Comentarios

##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText

Recupera el texto actual en un control de cuadro de edición.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del cuadro de edición.

*strText*<br/>
Valor de texto.

### <a name="remarks"></a>Comentarios

##  <a name="getfileext"></a>  CFileDialog::GetFileExt

Llame a esta función para recuperar la extensión del nombre de archivo especificado en el cuadro de diálogo.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Valor devuelto

La extensión del nombre de archivo.

### <a name="remarks"></a>Comentarios

Por ejemplo, si escribe el nombre del archivo son los datos. TXT, `GetFileExt` devuelve "TXT".

Si `m_ofn.Flags` tiene la marca OFN_ALLOWMULTISELECT establecida, esta cadena contiene una secuencia de cadenas terminadas en null, con la primera cadena que se va a la ruta del directorio del grupo de archivos seleccionado, seguido de los nombres de todos los archivos seleccionados por el usuario. Para recuperar las rutas de acceso de archivo, use el [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) funciones miembro.

##  <a name="getfilename"></a>  CFileDialog::GetFileName

Llame a esta función para recuperar el nombre del nombre de archivo especificado en el cuadro de diálogo.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Valor devuelto

Nombre del archivo.

### <a name="remarks"></a>Comentarios

El nombre del archivo incluye el prefijo y la extensión. Por ejemplo, `GetFileName` devolverá "TEXT. DAT"para el archivo C:\FILES\TEXT.DAT.

Si `m_ofn.Flags` tiene la `OFN_ALLOWMULTISELECT` marcador establecido, debe llamar a [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) para recuperar una ruta de acceso de archivo.

##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle

Llame a esta función para recuperar el título del archivo especificado en el cuadro de diálogo.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Valor devuelto

El título del archivo.

### <a name="remarks"></a>Comentarios

El título del archivo incluye solo su prefijo, sin la ruta de acceso o la extensión. Por ejemplo, `GetFileTitle` devolverá "TEXT" para el archivo C:\FILES\TEXT.DAT.

Si `m_ofn.Flags` tiene la marca OFN_ALLOWMULTISELECT establecida, esta cadena contiene una secuencia de cadenas terminadas en null, con la primera cadena que se va a la ruta del directorio del grupo de archivos seleccionado, seguido de los nombres de todos los archivos seleccionados por el usuario. Por este motivo, utilice el [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) las funciones miembro para recuperar el siguiente nombre de archivo en la lista.

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog::DoModal](#domodal).

##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath

Llame a esta función miembro para recuperar la ruta de acceso del directorio para un cuadro de diálogo común de tipo explorador abrir o guardar como o carpeta abierta.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Valor devuelto

Un [CString](../../atl-mfc-shared/reference/cstringt-class.md) objeto que contiene la carpeta abierta actualmente o directorio.

### <a name="remarks"></a>Comentarios

El cuadro de diálogo se debe haber creado con el estilo OFN_EXPLORER; en caso contrario, el método producirá una aserción.

Puede llamar a este método solo mientras se muestra el cuadro de diálogo. Después de que se ha cerrado el cuadro de diálogo, esta función dejará de funcionar y el método se producirá un error con una aserción.

##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize

Recupera un puntero al objeto COM interno para un determinado [CFileDialog](../../mfc/reference/cfiledialog-class.md).

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Valor devuelto

El puntero al objeto COM interno para el `CFileDialog`. Es su responsabilidad para liberar este puntero adecuadamente.

### <a name="remarks"></a>Comentarios

Use esta función solo en Windows Vista o posterior con un objeto que tiene *bVistaStyle* establecida en TRUE. Si usa esta función cuando *bVistaStyle* es FALSE, devolverá NULL en modo de lanzamiento y producir una aserción en modo de depuración.

Para obtener más información sobre la `IFileDialogCustomize` interfaz, vea [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Ejemplo

En este ejemplo se recupera el objeto COM interno. Para ejecutar este ejemplo de código, se debe compilar en Windows Vista o posterior.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog

Recupera un puntero al objeto COM interno para un determinado `CFileDialog`.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Valor devuelto

El puntero al objeto COM interno para el `CFileDialog`. Es su responsabilidad para liberar este puntero adecuadamente.

### <a name="remarks"></a>Comentarios

Use esta función solo en Windows Vista o posterior con un objeto que tiene *bVistaStyle* establecida en TRUE. Esta función devuelve NULL si el `CFileDialog` no es un **abierto** cuadro de diálogo o si *bVistaStyle* está establecida en FALSE. En este último caso, la función solo devuelve NULL en modo de versión: en modo de depuración producirá una aserción.

Para obtener más información sobre la `IFileOpenDialog` interfaz, vea [IFileOpenDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Ejemplo

En este ejemplo se recupera el objeto COM interno. Para ejecutar este código, se debe compilar en Windows Vista o posterior.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog

Recupera un puntero al objeto COM interno para un determinado `CFileDialog`.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Valor devuelto

El puntero al objeto COM interno para el `CFileDialog`. Es su responsabilidad para liberar este puntero adecuadamente.

### <a name="remarks"></a>Comentarios

Use esta función solo en Windows Vista o posterior con un objeto que tiene *bVistaStyle* establecida en TRUE. Esta función devolverá NULL si el `CFileDialog` no es un **guardar** cuadro de diálogo o si *bVistaStyle* está establecida en FALSE. En este último caso, la función solo devuelve NULL en modo de versión: en modo de depuración producirá una aserción.

Para obtener más información sobre la `IFileSaveDialog` interfaz, vea [IFileSaveDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Ejemplo

En este ejemplo se recupera el objeto COM interno. Para ejecutar este ejemplo de código, se debe compilar en Windows Vista o posterior.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName

Llame a esta función para recuperar el nombre de archivo siguiente desde el grupo seleccionado en el cuadro de diálogo.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Parámetros

*posición*<br/>
Una referencia a un valor de posición devuelto por un método `GetNextPathName` o `GetStartPosition` llamada de función. Es NULL si se ha alcanzado el final de la lista.

### <a name="return-value"></a>Valor devuelto

Ruta de acceso completa del archivo.

### <a name="remarks"></a>Comentarios

La ruta de acceso del nombre de archivo incluye el título del archivo además de la ruta de acceso de todo el directorio. Por ejemplo, `GetNextPathName` devolverá "C:\FILES\TEXT. DAT"para el archivo C:\FILES\TEXT.DAT. Puede usar `GetNextPathName` en un bucle de iteración de avance, si establece la posición inicial con una llamada a `GetStartPosition`.

Si la selección se compone de un único archivo, se devolverá ese nombre de archivo.

##  <a name="getofn"></a>  CFileDialog::GetOFN

Recupera el asociado `OPENFILENAME` estructura.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Valor devuelto

Un [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) estructura.

### <a name="remarks"></a>Comentarios

Utilice la segunda versión de esta función para inicializar la apariencia de un **abrir archivo** o **Guardar archivo como** cuadro de diálogo una vez que se construye pero antes de que se muestre con la `DoModal` función miembro. Por ejemplo, puede establecer el `lpstrTitle` miembro `m_ofn` con el título que desee que el cuadro de diálogo.

##  <a name="getpathname"></a>  CFileDialog::GetPathName

Llame a esta función para recuperar la ruta de acceso completa del archivo especificado en el cuadro de diálogo.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Valor devuelto

Ruta de acceso completa del archivo.

### <a name="remarks"></a>Comentarios

La ruta de acceso del nombre de archivo incluye el título del archivo además de la ruta de acceso de todo el directorio. Por ejemplo, `GetPathName` devolverá "C:\FILES\TEXT. DAT"para el archivo C:\FILES\TEXT.DAT.

Si `m_ofn.Flags` tiene la marca OFN_ALLOWMULTISELECT establecida, esta cadena contiene una secuencia de null teminated cadenas, con la primera cadena que se va a la ruta del directorio del grupo de archivos seleccionado, seguido de los nombres de todos los archivos seleccionados por el usuario. Por este motivo, utilice el [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) las funciones miembro para recuperar el siguiente nombre de archivo en la lista.

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog::DoModal](#domodal).

##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref

Llame a esta función para determinar si se ha seleccionado la casilla de verificación de sólo lectura en los cuadros de diálogo Windows abrir archivo y guardar archivo como estándares.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se selecciona la casilla de verificación de sólo lectura en el cuadro de diálogo; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Puede ocultar la casilla de verificación de sólo lectura estableciendo el estilo OFN_HIDEREADONLY el `CFileDialog` constructor.

> [!NOTE]
> Windows Vista o versiones posterior estilo `CFileDialog` objetos no son compatibles con esta función. Cualquier intento de usar esta función en una Vista de Windows o un estilo más adelante `CFileDialog` producirá [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="getresult"></a>  CFileDialog::GetResult

Recupera la opción realizados por el usuario en el cuadro de diálogo.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Valor devuelto

Un puntero a un IShellItem que representa la elección del usuario.

### <a name="remarks"></a>Comentarios

##  <a name="getresults"></a>  CFileDialog::GetResults

Recupera las opciones del usuario en un cuadro de diálogo que permite la selección múltiple.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Valor devuelto

Un puntero a un IShellItemArray a través del cual se pueden tener acceso a los elementos seleccionados en el cuadro de diálogo.

### <a name="remarks"></a>Comentarios

##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem

Recupera un elemento determinado desde el control de contenedor especificado en el cuadro de diálogo.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control contenedor.

*dwIDItem*<br/>
El identificador del elemento que el usuario seleccionó en el control.

### <a name="remarks"></a>Comentarios

##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition

Llamar a esta función miembro para recuperar la posición de la primera ruta de acceso de archivo en la lista, si `m_ofn.Flags` tiene establecido el marcador OFN_ALLOWMULTISELECT.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Valor devuelto

Un valor de posición que se puede usar para la iteración; Es NULL si la lista está vacía.

##  <a name="hidecontrol"></a>  CFileDialog::HideControl

Llame a esta función miembro para ocultar el control especificado en un cuadro de diálogo común de tipo explorador abrir o guardar como.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
El identificador del control para ocultar.

### <a name="remarks"></a>Comentarios

El cuadro de diálogo se debe haber creado con el estilo OFN_EXPLORER; en caso contrario, se producirá un error de la función con una aserción.

##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode

Determina si el cuadro de diálogo actual está en modo selector de carpetas.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Valor devuelto

TRUE si el cuadro de diálogo está en modo de selector de carpeta; en caso contrario, FALSE.

### <a name="remarks"></a>Comentarios

##  <a name="m_ofn"></a>  CFileDialog::m_ofn

`m_ofn` es una estructura de tipo `OPENFILENAME`. Los datos de esta estructura representan el estado actual de la `CFileDialog`.

### <a name="remarks"></a>Comentarios

Utilice esta estructura para inicializar la apariencia de un **abrir archivo** o **Guardar archivo como** cuadro de diálogo después de crear, pero antes de mostrarlo con el [DoModal](#domodal) método. Por ejemplo, puede establecer el *lpstrTitle* miembro `m_ofn` con el título que desee que el cuadro de diálogo.

Con el estilo de una versión posterior de o Windows Vista [CFileDialog](../../mfc/reference/cfiledialog-class.md), `m_ofn` no se garantiza que siempre coincida con el estado del cuadro de diálogo. Se sincroniza con el cuadro de diálogo en versiones anteriores de Windows. Consulte [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) y [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog) para obtener más información acerca de cómo sincronizar la `m_ofn` estructura y el `CFileDialog` estado en Windows Vista o posterior.

Windows Vista o versiones posteriores cuadros de diálogo de archivo de estilo no se admiten determinados miembros y las marcas de la `CFileDialog`. Como resultado, estos no tendrán ningún efecto.

La siguiente es una lista de los miembros que no son compatibles con Windows Vista o versiones posteriores:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

Las marcas siguientes no son compatibles y, por tanto, no tienen ningún efecto cuando se usa el estilo de una versión posterior de o Windows Vista `CFileDialog`:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES - eficazmente siempre en Windows Vista o posterior

- OFN_NOLONGNAMES - desactivado de forma eficaz siempre en Windows Vista o posterior

- OFN_NONETWORKBUTTON - eficazmente siempre en Windows Vista o posterior

- OFN_READONLY

- OFN_SHOWHELP

Para obtener más información acerca de esta estructura, vea el [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) estructura en el SDK de Windows.

##  <a name="makeprominent"></a>  CFileDialog::MakeProminent

Coloca un control en el cuadro de diálogo para que destaque en comparación con otros controles.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control.

### <a name="remarks"></a>Comentarios

##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked

Se llama cuando se hace clic en el botón.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del botón.

### <a name="remarks"></a>Comentarios

##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled

Se llama cuando la casilla de verificación está activada o desactivada.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador de la casilla de verificación.

*bChecked*<br/>
Activada o desactivada.

### <a name="remarks"></a>Comentarios

##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating

Se llama cuando se activa el control.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control.

### <a name="remarks"></a>Comentarios

##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange

Invalide este método si desea controlar el mensaje WM_NOTIFY CDN_SELCHANGE.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Comentarios

El sistema envía el mensaje CDN_SELCHANGE cuando el usuario selecciona un nuevo archivo o carpeta en la lista de archivos de la **abierto** o **Guardar como** cuadro de diálogo. Invalide este método si desea realizar acciones en respuesta a este mensaje.

El sistema envía este mensaje solo si el cuadro de diálogo se creó con la marca OFN_EXPLORER activada. Para obtener más información acerca de la notificación, consulte [CDN_SELCHANGE](/windows/desktop/dlgbox/cdn-selchange). Para obtener información acerca de la marca OFN_EXPLORER, vea el [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) estructura y [abrir y guardar como cuadros de diálogo](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK

Reemplace esta función sólo si desea proporcionar validación personalizada de nombres de archivo que se introducen en un cuadro de diálogo de archivo comunes.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Valor devuelto

1 si el nombre de archivo no es un nombre de archivo válido; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Esta función permite rechazar un nombre de archivo por alguna razón específica de la aplicación. Normalmente, no es necesario utilizar esta función porque el marco de trabajo proporciona validación predeterminada de nombres de archivo y muestra un cuadro de mensaje si se escribe un nombre de archivo no válido.

Si se devuelve 1, el cuadro de diálogo permanecerá mostrado para el usuario que escriba otro nombre de archivo. El procedimiento de cuadro de diálogo descarta el cuadro de diálogo si el valor devuelto es 0. Otro distinto de cero, se devuelve los valores están reservados actualmente y no deben usarse.

##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange

Reemplace esta función para controlar el mensaje WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Comentarios

El mensaje de notificación se envía cuando se abre una nueva carpeta en el cuadro de diálogo Abrir o guardar como.

Se envía la notificación solo si el cuadro de diálogo se creó con el estilo OFN_EXPLORER. Para obtener más información acerca de la notificación, consulte [CDN_FOLDERCHANGE](/windows/desktop/dlgbox/cdn-folderchange). Para obtener información sobre el estilo OFN_EXPLORER, vea el [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) estructura y [abrir y guardar como cuadros de diálogo](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="oninitdone"></a>  CFileDialog::OnInitDone

Reemplace esta función para controlar el mensaje WM_NOTIFY CDN_INITDONE.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Comentarios

El sistema envía este mensaje de notificación cuando el sistema haya terminado de organizar controles en el **abierto** o **Guardar como** cuadro de diálogo para dejar espacio para los controles del cuadro de diálogo secundarios.

El sistema envía este solo si el cuadro de diálogo se creó con el estilo OFN_EXPLORER. Para obtener más información acerca de la notificación, consulte [CDN_INITDONE](/windows/desktop/dlgbox/cdn-initdone). Para obtener información sobre el estilo OFN_EXPLORER, vea el [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) estructura y [abrir y guardar como cuadros de diálogo](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

> [!NOTE]
> Windows Vista o versiones posteriores cuadros de diálogo de archivo de estilo no admiten esta función. Cualquier intento de usar esta función en un Windows Vista o versiones posterior cuadro de diálogo de archivo de estilo producirá [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected

Se llama cuando se selecciona el elemento contenedor.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control contenedor.

*dwIDItem*<br/>
El identificador del elemento.

### <a name="remarks"></a>Comentarios

##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify

Esta función se invoca siempre que la selección actual en un cuadro de lista que se va a cambiar.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Parámetros

*nIDBox*<br/>
El identificador del cuadro de lista o cuadro combinado en el que se produjo la selección.

*iCurSel*<br/>
El índice de la selección actual.

*nCode*<br/>
El código de notificación de control. Este parámetro debe tener uno de los siguientes valores:

- Especifica CD_LBSELCHANGE *iCurSel* es el elemento seleccionado en un cuadro de lista de selección única.

- CD_LBSELSUB especifica que *iCurSel* ya no está seleccionado en un cuadro de lista de selección múltiple.

- CD_LBSELADD especifica que *iCurSel* está seleccionado en un cuadro de lista de selección múltiple.

- CD_LBSELNOITEMS especifica que no hay nada seleccionado existe en un cuadro de lista de selección múltiple.

### <a name="remarks"></a>Comentarios

Reemplace esta función para proporcionar un control personalizado de cambios de selección en el cuadro de lista. Por ejemplo, puede usar esta función para mostrar los derechos de acceso o la fecha de última modificación de cada archivo que el usuario selecciona.

##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation

Reemplace esta función para proporcionar un control personalizado de las infracciones de recurso compartido.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parámetros

*lpszPathName*<br/>
La ruta de acceso del archivo en el que se produjo la infracción de recurso compartido.

### <a name="return-value"></a>Valor devuelto

Uno de los siguientes valores:

- El nombre de archivo OFN_SHAREFALLTHROUGH se devuelve desde el cuadro de diálogo.

- Hay que realizar ninguna acción de OFN_SHARENOWARN No.

- OFN_SHAREWARN el usuario recibe el mensaje de advertencia estándar para este error.

### <a name="remarks"></a>Comentarios

Normalmente, no es necesario utilizar esta función porque el marco de trabajo proporciona comprobación de infracciones de recurso compartido de forma predeterminada y muestra un cuadro de mensaje si se produce una infracción de recurso compartido.

Si desea deshabilitar la comprobación de infracción de recurso compartido, utilice el operador OR bit a bit para combinar la marca OFN_SHAREAWARE con `m_ofn.Flags`.

##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange

Reemplace esta función para controlar el mensaje WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Comentarios

El mensaje de notificación se envía cuando el usuario selecciona un nuevo tipo de archivo en la lista de tipos de archivo en la apertura o el cuadro de diálogo Guardar como.

Se envía la notificación solo si el cuadro de diálogo se creó con el estilo OFN_EXPLORER. Para obtener más información acerca de la notificación, consulte [CDN_TYPECHANGE](/windows/desktop/dlgbox/cdn-typechange). Para obtener información sobre el estilo OFN_EXPLORER, vea el [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) estructura y [abrir y guardar como cuadros de diálogo](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem

Quita un elemento de un control contenedor en el cuadro de diálogo.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control contenedor para quitar el elemento.

*dwIDItem*<br/>
El identificador del elemento.

### <a name="remarks"></a>Comentarios

##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState

Establece el estado actual de un botón de comprobación (casilla) en el cuadro de diálogo.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador de la casilla de verificación.

*bChecked*<br/>
El estado de la casilla de verificación. TRUE indica activado; FALSE indica desactivado.

### <a name="remarks"></a>Comentarios

##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState

Establece el estado actual de un elemento en un control contenedor que se encuentra en el cuadro de diálogo.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control contenedor.

*dwIDItem*<br/>
El identificador del elemento.

*dwState*<br/>
Uno o más valores de la enumeración CDCONTROLSTATE que indican el estado nueva del control.

### <a name="remarks"></a>Comentarios

##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText

Establece el texto de un elemento de control. Por ejemplo, el texto que acompaña a un elemento en un menú o un botón de radio.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control contenedor.

*dwIDItem*<br/>
El identificador del elemento.

*strLabel*<br/>
Texto del elemento.

### <a name="remarks"></a>Comentarios

##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel

Establece el texto asociado a un control, como texto del botón o una etiqueta del cuadro de edición.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control.

*strLabel*<br/>
El nombre del control.

### <a name="remarks"></a>Comentarios

##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState

Establece la visibilidad actual y Estados de un control determinado habilitados.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control.

*dwState*<br/>
Uno o más valores de la enumeración CDCONTROLSTATE que indican el estado actual del control.

### <a name="remarks"></a>Comentarios

##  <a name="setcontroltext"></a>  CFileDialog::SetControlText

Llame a este método para establecer el texto para el control especificado en un tipo de explorador **abierto** o **Guardar como** cuadro de diálogo.

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
[in] El identificador del control que se va a establecer el texto.

*lpsz*<br/>
[in] Un puntero a la cadena que contiene el texto que se establece para el control.

### <a name="remarks"></a>Comentarios

Ambas versiones de esta función son válidos para las aplicaciones que utilizan Unicode. Sin embargo, solo la versión con el tipo LPCSTR es válida para las aplicaciones que usan ANSI.

Para usar este método, debe crear el cuadro de diálogo con el estilo OFN_EXPLORER. En caso contrario, se producirá un error de la función con una aserción.

##  <a name="setdefext"></a>  CFileDialog::SetDefExt

Llame a esta función para establecer la extensión de nombre de archivo predeterminado para un cuadro de diálogo común de tipo explorador abrir o guardar como.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Parámetros

*lpsz*<br/>
Un puntero a una cadena que contiene la extensión predeterminada que se usará para el objeto de cuadro de diálogo. Esta cadena no debe contener un punto (.).

### <a name="remarks"></a>Comentarios

El cuadro de diálogo se debe haber creado con el estilo OFN_EXPLORER; en caso contrario, se producirá un error de la función con una aserción.

##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText

Establece el texto actual en un control de cuadro de edición.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del cuadro de edición.

*strText*<br/>
Valor de texto.

### <a name="remarks"></a>Comentarios

##  <a name="setproperties"></a>  CFileDialog::SetProperties

Proporciona un almacén de propiedades que define los valores predeterminados que se van a usar para el elemento que se está guardando.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Parámetros

*lpszPropList*<br/>
Lista de propiedades predefinidas separadas por ";". Para obtener una lista de las marcas, vea el **marcas** sección de [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna).

### <a name="remarks"></a>Comentarios

##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem

Establece el estado seleccionado de un elemento determinado en un grupo de botones de opción o un cuadro combinado se encuentra en el cuadro de diálogo.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del control contenedor.

*dwIDItem*<br/>
El identificador del elemento que el usuario seleccionó en el control.

### <a name="remarks"></a>Comentarios

##  <a name="settemplate"></a>  CFileDialog::SetTemplate

Establece la plantilla de cuadro de diálogo para la [CFileDialog](../../mfc/reference/cfiledialog-class.md) objeto.

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Parámetros

*nWin3ID*<br/>
[in] Contiene el número de Id. del recurso de plantilla para el explorador que no es de- `CFileDialog` objeto. Esta plantilla solo se usa en Windows NT 3.51 o cuando el estilo OFN_EXPLORER no está presente.

*nWin4ID*<br/>
[in] Contiene el número de Id. del recurso de plantilla para el Explorador de `CFileDialog` objeto. Esta plantilla se usa solo en Windows NT 4.0 y versiones posteriores, Windows 95 y versiones posteriores, o cuando el estilo OFN_EXPLORER está presente.

*lpWin3ID*<br/>
[in] Contiene el nombre del recurso de plantilla para el explorador que no es de- `CFileDialog` objeto. Esta plantilla solo se usa en Windows NT 3.51 o cuando el estilo OFN_EXPLORER no está presente.

*lpWin4ID*<br/>
[in] Contiene el nombre del recurso de plantilla del explorador `CFileDialog` objeto. Esta plantilla se usa solo en Windows NT 4.0 y versiones posteriores, Windows 95 y versiones posteriores, o cuando el estilo OFN_EXPLORER está presente.

### <a name="remarks"></a>Comentarios

El sistema usará sólo una de las plantillas especificadas. El sistema determina qué plantilla utilizar según la presencia del estilo OFN_EXPLORER y el sistema operativo que se ejecuta la aplicación. Al especificar una que no son de explorador y la plantilla de estilo del explorador, es fácil admitir Windows NT 3.51, Windows NT 4.0 y versiones posteriores y Windows 95 y versiones posteriores.

> [!NOTE]
> Windows Vista o versiones posteriores cuadros de diálogo de archivo de estilo no admiten esta función. Cualquier intento de usar esta función en un Windows Vista o el cuadro de diálogo de archivo de estilo posterior producirá [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Una alternativa es usar un cuadro de diálogo personalizado. Para obtener más información acerca de cómo utilizar una personalizada `CFileDialog`, consulte [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup

Declara un grupo en el cuadro de diálogo visual. Las llamadas subsiguientes a cualquier método "add" agregan esos elementos a este grupo.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
El identificador del grupo visual.

*strLabel*<br/>
El nombre del grupo.

### <a name="remarks"></a>Comentarios

##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog

Las actualizaciones de la `m_ofn` estructura de datos de la [CFileDialog](../../mfc/reference/cfiledialog-class.md) según el estado actual del objeto interno.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Comentarios

En las versiones de Windows antes de Windows Vista, el miembro [OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx) continuamente se sincronizó la estructura de datos con el estado de la `CFileDialog`. Los cambios realizados en el [m_ofn](#m_ofn) variable miembro ve directamente afectado el estado del cuadro de diálogo. Además, los cambios realizados en el estado del cuadro de diálogo actualizan inmediatamente en la variable de miembro m_ofn.

En Windows Vista o versiones posteriores, el `m_ofn` estructura de datos no se actualiza automáticamente. Para garantizar la precisión de los datos en el `m_ofn` variable miembro, debe llamar a la `UpdateOFNFromShellDialog` función antes de acceder a los datos. Windows llama a esta función automáticamente durante el procesamiento de [IFileDialog::OnFileOK](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Para obtener más información sobre cómo usar el `CFileDialog` clase en Windows Vista o una versión posterior, consulte [clase CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Ejemplo

Este ejemplo se actualiza el `CFileDialog` antes de mostrarla. Antes de actualizar el `m_ofn` variable miembro, se necesita sincronizar el estado actual del cuadro de diálogo.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Vea también

[CCommonDialog (clase)](../../mfc/reference/ccommondialog-class.md)<br/>
[Gráfico de jerarquías](../../mfc/hierarchy-chart.md)
