---
title: CFileDialog (clase)
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: c301766b64af7fc1523b39adad91d9b52a5e88f7
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/15/2019
ms.locfileid: "69506595"
---
# <a name="cfiledialog-class"></a>CFileDialog (clase)

Encapsula el cuadro de diálogo común que se usa para las operaciones de archivo abrir o guardar archivo.

## <a name="syntax"></a>Sintaxis

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Miembros

### <a name="public-constructors"></a>Constructores públicos

|NOMBRE|DESCRIPCIÓN|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|Construye un objeto `CFileDialog`.|

### <a name="public-methods"></a>Métodos públicos

|NOMBRE|DESCRIPCIÓN|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|Agrega un botón de control al cuadro de diálogo.|
|[CFileDialog::AddComboBox](#addcombobox)|Agrega un cuadro combinado al cuadro de diálogo.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Agrega un elemento a un control contenedor en el cuadro de diálogo.|
|[CFileDialog::AddEditBox](#addeditbox)|Agrega un cuadro de edición al cuadro de diálogo.|
|[CFileDialog::AddMenu](#addmenu)|Agrega un menú al cuadro de diálogo.|
|[CFileDialog::AddPlace](#addplace)|Sobrecargado. Agrega una carpeta a la lista de ubicaciones disponibles para que el usuario abra o guarde los elementos.|
|[CFileDialog::AddPushButton](#addpushbutton)|Agrega un botón al cuadro de diálogo.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Agrega un botón de opción (también denominado botón de radio) al cuadro de diálogo.|
|[CFileDialog::AddSeparator](#addseparator)|Agrega un separador al cuadro de diálogo.|
|[CFileDialog::AddText](#addtext)|Agrega contenido de texto al cuadro de diálogo.|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Actualiza el estado de `CFileDialog` para que coincida con los parámetros y las marcas almacenadas en la `m_ofn` variable miembro.|
|[CFileDialog::DoModal](#domodal)|Muestra el cuadro de diálogo y permite al usuario realizar una selección.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Habilita una lista desplegable en el botón **abrir** o **Guardar** del cuadro de diálogo.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Detiene la adición de elementos a un grupo visual en el cuadro de diálogo.|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Obtiene el estado actual de un botón de comprobación (casilla) en el cuadro de diálogo.|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Obtiene el estado actual de un elemento de un control contenedor que se encuentra en el cuadro de diálogo.|
|[CFileDialog::GetControlState](#getcontrolstate)|Obtiene la visibilidad actual y los Estados habilitados de un control determinado.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Obtiene el texto actual en un control de cuadro de edición.|
|[CFileDialog::GetFileExt](#getfileext)|Devuelve la extensión del archivo seleccionado.|
|[CFileDialog::GetFileName](#getfilename)|Devuelve el nombre de archivo del archivo seleccionado.|
|[CFileDialog::GetFileTitle](#getfiletitle)|Devuelve el título del archivo seleccionado.|
|[CFileDialog::GetFolderPath](#getfolderpath)|Recupera la ruta de acceso de la carpeta o el directorio actualmente abierto para un cuadro de diálogo **abrir** o **Guardar como** común en el explorador.|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Recupera el objeto com interno de un objeto personalizado `CFileDialog` .|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Recupera el objeto com interno para un `CFileDialog` que se usa como cuadro de diálogo **abrir** archivo.|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Recupera el objeto com interno para un `CFileDialog` que se usa como cuadro de diálogo **Guardar** archivo.|
|[CFileDialog::GetNextPathName](#getnextpathname)|Devuelve la ruta de acceso completa del siguiente archivo seleccionado.|
|[CFileDialog::GetOFN](#getofn)|Recupera la `OPENFILENAME` estructura `CFileDialog` del objeto.|
|[CFileDialog::GetPathName](#getpathname)|Devuelve la ruta de acceso completa del archivo seleccionado.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Devuelve el estado de solo lectura del archivo seleccionado.|
|[CFileDialog::GetResult](#getresult)|Obtiene la opción que el usuario realizó en el cuadro de diálogo.|
|[CFileDialog::GetResults](#getresults)|Obtiene las opciones del usuario en un cuadro de diálogo que permite la selección múltiple.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Obtiene un elemento determinado de los controles de contenedor especificados en el cuadro de diálogo.|
|[CFileDialog::GetStartPosition](#getstartposition)|Devuelve la posición del primer elemento de la lista de nombres de archivo.|
|[CFileDialog::HideControl](#hidecontrol)|Oculta el control especificado en un cuadro de diálogo **abrir** o **Guardar como** común en el explorador.|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Determina si el cuadro de diálogo actual en el modo de selector de carpetas.|
|[CFileDialog::MakeProminent](#makeprominent)|Coloca un control en el cuadro de diálogo para que destaque en comparación con otros controles agregados.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Quita un elemento de un control contenedor en el cuadro de diálogo.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Establece el estado actual de un botón de comprobación (casilla) en el cuadro de diálogo.|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Establece el estado actual de un elemento de un control contenedor que se encuentra en el cuadro de diálogo.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Establece el texto de un elemento de control. Por ejemplo, el texto que acompaña a un botón de radio o a un elemento de un menú.|
|[CFileDialog::SetControlLabel](#setcontrollabel)|Establece el texto asociado a un control, como texto de botón o una etiqueta de cuadro de edición.|
|[CFileDialog::SetControlState](#setcontrolstate)|Establece la visibilidad actual y los Estados habilitados de un control determinado.|
|[CFileDialog::SetControlText](#setcontroltext)|Establece el texto para el control especificado en un cuadro de diálogo **abrir** o **Guardar como** común en el estilo del explorador.|
|[CFileDialog::SetDefExt](#setdefext)|Establece la extensión de nombre de archivo predeterminada para un cuadro de diálogo de tipo de explorador **abrir** o **Guardar como** común.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Establece el texto actual en un control de cuadro de edición.|
|[CFileDialog::SetProperties](#setproperties)|Proporciona un almacén de propiedades que define los valores predeterminados que se van a usar para el elemento que se está guardando.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Establece el estado seleccionado de un elemento determinado de un grupo de botones de opción o un cuadro combinado que se encuentra en el cuadro de diálogo.|
|[CFileDialog::SetTemplate](#settemplate)|Establece la plantilla de cuadro de diálogo `CFileDialog` para el objeto.|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Declara un grupo visual en el cuadro de diálogo. Las llamadas subsiguientes a cualquier método "Add" agregan esos elementos a este grupo.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Actualiza los datos almacenados en la `m_ofn` variable miembro para que coincidan con el estado actual del cuadro de diálogo de archivo.|

### <a name="protected-methods"></a>Métodos protegidos

|NOMBRE|DESCRIPCIÓN|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Llamado cuando se hace clic en el botón.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Se llama cuando la casilla está activada o desactivada.|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Se llama cuando el control está activo.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Controla el mensaje WM_NOTIFY CDN_SELCHANGE.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|Valida el nombre de archivo especificado en el cuadro de diálogo.|
|[CFileDialog::OnFolderChange](#onfolderchange)|Controla el mensaje WM_NOTIFY CDN_FOLDERCHANGE.|
|[CFileDialog::OnInitDone](#oninitdone)|Controla el mensaje WM_NOTIFY CDN_INITDONE.|
|[CFileDialog::OnItemSelected](#onitemselected)|Se le llama cuando se selecciona el elemento contenedor.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Permite realizar acciones personalizadas cuando cambia la selección de archivos.|
|[CFileDialog::OnShareViolation](#onshareviolation)|Controla las infracciones de recursos compartidos.|
|[CFileDialog::OnTypeChange](#ontypechange)|Controla el mensaje WM_NOTIFY CDN_TYPECHANGE.|

### <a name="public-data-members"></a>Miembros de datos públicos

|NOMBRE|DESCRIPCIÓN|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|Estructura de `OPENFILENAME` Windows. Proporciona acceso a los parámetros básicos del cuadro de diálogo de archivo.|

## <a name="remarks"></a>Comentarios

Los cuadros de diálogo de archivos comunes permiten implementar cuadros de diálogo de selección de archivos, por ejemplo, **Abrir archivo** y **Guardar como**, de manera coherente con los estándares de Windows.

Puede usar `CFileDialog` tal y como está con el constructor proporcionado, o puede derivar su propia clase de cuadro `CFileDialog` de diálogo de y escribir un constructor para que se adapte a sus necesidades. En cualquier caso, estos cuadros de diálogo se comportarán como los cuadros de diálogo de MFC estándar, ya que se derivan de la [clase CCommonDialog](../../mfc/reference/ccommondialog-class.md). `CFileDialog`se basa en el COMMDLG. Archivo DLL que se incluye en Windows.

La apariencia y la funcionalidad de `CFileDialog` con Windows Vista o posterior difieren de las versiones anteriores de Windows. El valor `CFileDialog` predeterminado utiliza automáticamente el nuevo estilo de Windows Vista o posterior sin cambios de código si un programa se compila y se ejecuta en Windows Vista o posterior. Use el parámetro *bVistaStyle* en el constructor para invalidar manualmente esta actualización automática. La excepción a los cuadros de diálogo de actualización automática es personalizada. No se convertirán al nuevo estilo. Para obtener más información acerca del constructor, vea [CFileDialog:: CFileDialog](#cfiledialog).

> [!NOTE]
>  El sistema de ID. de control difiere en Windows Vista o posterior de versiones anteriores de Windows cuando `CFileDialog`se usa un. Debe actualizar todas las referencias a `CFileDialog` los controles en el código antes de poder trasladar el proyecto a una versión anterior de Windows.

Algunos `CFileDialog` métodos no se admiten en Windows Vista o posterior. Consulte el tema sobre el método individual para obtener información sobre si se admite el método. Además, las siguientes funciones heredadas no se admiten en Windows Vista o posterior:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

Los mensajes de Windows para `CFileDialog` la clase varían en función del sistema operativo que se use. Por ejemplo, Windows XP no admite [CDialog:: OnCancel](../../mfc/reference/cdialog-class.md#oncancel) y [CDialog:: onok](../../mfc/reference/cdialog-class.md#onok) para la `CFileDialog` clase. Sin embargo, Windows Vista y los sistemas operativos posteriores los admiten. Para obtener más información sobre los diferentes mensajes que se generan y el orden en que se reciben, vea [ejemplo de CFileDialog: Orden](../../overview/visual-cpp-samples.md)de los eventos de registro.

Para usar un `CFileDialog` objeto, primero debe crear el objeto mediante el `CFileDialog` constructor. Una vez construido el cuadro de diálogo, puede establecer o modificar los valores de la estructura [CFileDialog:: m_ofn](#m_ofn) para inicializar los valores o los Estados de los controles de cuadro de diálogo. La `m_ofn` estructura es de tipo `OPENFILENAME`. Para obtener más información, vea la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) en el Windows SDK.

Después de inicializar los controles de cuadro de diálogo, llame al método [CFileDialog::D omodal](#domodal) para mostrar el cuadro de diálogo para que el usuario pueda escribir la ruta de acceso y el nombre de archivo. `DoModal`Devuelve si el usuario hizo clic en el botón Aceptar (IDOK) o cancelar (IDCANCEL). Si `DoModal` devuelve IDOK, puede usar una de las `CFileDialog` funciones miembro públicas para recuperar la información colocada por el usuario.

> [!NOTE]
> En Windows Vista o posterior, varias llamadas a [IFileDialog:: SetFileTypes](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) provocan un error. La segunda llamada a `SetFileTypes` para cualquier instancia de un `CFileDialog` devolverá E_UNEXPECTED en Windows Vista o posterior. Algunas `CFileDialog` funciones de método `SetFileTypes`llaman a. Por ejemplo, dos llamadas a `CFileDialog::DoModal` para la misma instancia de un `CFileDialog` genera una [aserción](diagnostic-services.md#assert).

`CFileDialog`incluye varios miembros protegidos que permiten realizar un control personalizado de las infracciones de recursos compartidos, la validación de nombres de archivo y la notificación de cambios de cuadro de lista. Estos miembros protegidos son funciones de devolución de llamada que la mayoría de las aplicaciones no tienen que usar porque el control predeterminado se realiza automáticamente. Las entradas de mapa de mensajes para estas funciones no son necesarias porque son funciones virtuales estándar.

Puede usar la función [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) de Windows para determinar si se ha producido un error durante la inicialización del cuadro de diálogo y para obtener más información sobre el error.

La destrucción de `CFileDialog` objetos se controla automáticamente. No es necesario llamar a [CDialog:: EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Para permitir que el usuario seleccione varios archivos, establezca la marca OFN_ALLOWMULTISELECT antes de `DoModal`llamar a. Debe proporcionar su propio búfer de nombre de archivo para acomodar la lista devuelta de varios nombres de archivo. Para ello, reemplace `m_ofn.lpstrFile` por un puntero a un búfer que haya asignado, después de construir, `CFileDialog`pero antes de llamar a `DoModal`.

Además, debe establecer `m_ofn.nMaxFile` utilizando el número de caracteres del búfer `m_ofn.lpstrFile`al que apunta. Si establece el número máximo de archivos que se van a seleccionar `n`, el tamaño de búfer necesario `n * (_MAX_PATH + 1) + 1`es. El primer elemento devuelto en el búfer es la ruta de acceso a la carpeta donde se seleccionaron los archivos. En el caso de los cuadros de diálogo de estilo de Windows Vista o posterior, las cadenas de nombre de archivo y de directorio están terminadas en null, con un carácter nulo adicional después del último nombre de archivo. Este formato permite a los cuadros de diálogo de estilo del explorador devolver nombres de archivo largos que incluyen espacios. En los cuadros de diálogo de estilo antiguo, las cadenas de nombre de archivo y de directorio se separan mediante espacios y la función usa nombres de archivo cortos para los nombres de archivo con espacios.

En el ejemplo siguiente se muestra cómo utilizar un búfer para recuperar y enumerar varios nombres de archivo.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Para cambiar el tamaño del búfer en respuesta al usuario que selecciona varios nombres de archivo, debe derivar una nueva `CFileDialog` clase de e invalidar el método [CFileDialog:: OnFileNameChange](#onfilenamechange) .

Si deriva una nueva clase de `CFileDialog`, puede usar un mapa de mensajes para controlar los mensajes. Para extender el control de mensajes predeterminado, derive una clase `CFileDialog`de, agregue un mapa de mensajes a la nueva clase y proporcione funciones miembro para los nuevos mensajes. No es necesario proporcionar una función de enlace para personalizar el cuadro de diálogo.

Para personalizar el cuadro de diálogo, derive una clase `CFileDialog`de, proporcione una plantilla de cuadro de diálogo personalizada y agregue un mapa de mensajes para procesar los mensajes de notificación de los controles extendidos. Pase los mensajes no procesados a la clase base. No es necesario personalizar la función de enlace.

Cuando se usa el estilo Windows Vista o posterior de `CFileDialog`, no se pueden utilizar mapas de mensajes y plantillas de cuadro de diálogo. En su lugar, debe usar las interfaces COM para una funcionalidad similar.

Para obtener más información sobre cómo usar `CFileDialog`, vea [clases de cuadro de diálogo comunes](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Jerarquía de herencia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Requisitos

**Encabezado:** afxdlgs. h

##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton

Agrega un botón de control al cuadro de diálogo.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del botón de comprobación que se va a agregar.

*strLabel*<br/>
Nombre del botón de comprobación.

*bChecked*<br/>
Valor booleano que indica el estado actual del botón de comprobación. TRUE si se activa; FALSE en caso contrario

### <a name="remarks"></a>Comentarios

##  <a name="addcombobox"></a>  CFileDialog::AddComboBox

Agrega un cuadro combinado al cuadro de diálogo.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del cuadro combinado que se va a agregar.

### <a name="remarks"></a>Comentarios

##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem

Agrega un elemento a un control contenedor en el cuadro de diálogo.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control contenedor al que se va a agregar el elemento.

*dwIDItem*<br/>
IDENTIFICADOR del elemento.

*strLabel*<br/>
Texto del elemento.

### <a name="remarks"></a>Comentarios

##  <a name="addeditbox"></a>  CFileDialog::AddEditBox

Agrega un cuadro de edición al cuadro de diálogo.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del cuadro de edición que se va a agregar.

*strText*<br/>
Nombre del cuadro de edición.

### <a name="remarks"></a>Comentarios

##  <a name="addmenu"></a>  CFileDialog::AddMenu

Agrega un menú al cuadro de diálogo.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del menú que se va a agregar.

*strLabel*<br/>
Nombre del menú.

### <a name="remarks"></a>Comentarios

##  <a name="addplace"></a>  CFileDialog::AddPlace

Agrega una carpeta a la lista de ubicaciones disponibles para que el usuario abra o guarde los elementos.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Parámetros

*lpszFolder*<br/>
Ruta de acceso a la carpeta que se va a poner a disposición del usuario. Solo puede ser una carpeta.

*fdap*<br/>
Especifica dónde se coloca la carpeta en la lista.

*psi*<br/>
Un puntero a un IShellItem que representa la carpeta que se va a poner a disposición del usuario. Solo puede ser una carpeta.

### <a name="remarks"></a>Comentarios

##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton

Agrega un botón al cuadro de diálogo.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del botón que se va a agregar.

*strLabel*<br/>
Nombre del botón.

### <a name="remarks"></a>Comentarios

##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList

Agrega un botón de opción (también denominado botón de radio) al cuadro de diálogo.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del grupo de botones de opción que se va a agregar.

### <a name="remarks"></a>Comentarios

##  <a name="addseparator"></a>  CFileDialog::AddSeparator

Agrega un separador al cuadro de diálogo.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del separador que se va a agregar.

### <a name="remarks"></a>Comentarios

##  <a name="addtext"></a>  CFileDialog::AddText

Agrega texto al cuadro de diálogo.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del texto que se va a agregar.

*strText*<br/>
Nombre del texto.

### <a name="remarks"></a>Comentarios

##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog

Actualiza el estado actual del [CFileDialog](../../mfc/reference/cfiledialog-class.md) en función de los valores almacenados en la `m_ofn` estructura de datos.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Comentarios

En las versiones de Windows anteriores a Windows Vista, la estructura de datos de [OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) del miembro se sincronizó `CFileDialog`continuamente con el estado de. Cualquier cambio que se realice en la variable miembro [m_ofn](#m_ofn) se reflejará inmediatamente en el estado del cuadro de diálogo. Además, cualquier cambio en el estado del cuadro de diálogo actualiza inmediatamente la `m_ofn` variable miembro.

En Windows Vista o posterior, no `m_ofn` `CFileDialog` se garantiza que los valores de la variable miembro y el estado de estén sincronizados. Esta función fuerza el estado del `CFileDialog` que se va a actualizar para que coincida con la `m_ofn` estructura. Windows llama automáticamente a esta función durante [CFileDialog::D omodal](#domodal).

Para obtener más información sobre cómo usar la `CFileDialog` clase en Windows Vista o posterior, vea [CFileDialog (clase](../../mfc/reference/cfiledialog-class.md)).

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog).

##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog

Llame a esta función para construir un cuadro de diálogo de archivo estándar de Windows.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Parámetros

*bOpenFileDialog*<br/>
de Parámetro que especifica el tipo de cuadro de diálogo que se va a crear. Establézcalo en TRUE para construir un cuadro de diálogo **Abrir archivo** . Establézcalo en FALSE para construir un cuadro de diálogo **Guardar como archivo** .

*lpszDefExt*<br/>
de La extensión de nombre de archivo predeterminada. Si el usuario no incluye una extensión conocida (una que tenga una asociación en el equipo del usuario) en el cuadro Nombre de archivo, la extensión especificada por *lpszDefExt* se anexa automáticamente al nombre de archivo. Si este parámetro es NULL, no se anexa ninguna extensión.

*lpszFileName*<br/>
de El nombre de archivo inicial que aparece en el cuadro Nombre de archivo. Si es NULL, no aparece ningún nombre de archivo inicial.

*dwFlags*<br/>
de Combinación de una o varias marcas que puede usar para personalizar el cuadro de diálogo. Para obtener una descripción de estas marcas, consulte la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) en el Windows SDK. Si modifica el miembro `m_ofn.Flags` de la estructura, utilice un operador OR bit a bit en los cambios para mantener el comportamiento predeterminado intacto.

*lpszFilter*<br/>
de Una serie de pares de cadena que especifican filtros que se pueden aplicar al archivo. Si especifica filtros de archivo, solo aparecerán en la lista de archivos los archivos que coincidan con los criterios de filtro. Vea la sección Comentarios para obtener más información sobre cómo trabajar con filtros de archivo.

*pParentWnd*<br/>
de Puntero a la ventana primaria o propietaria del cuadro de diálogo de archivo.

*dwSize*<br/>
de Tamaño de la `OPENFILENAME` estructura. Este valor depende de la versión del sistema operativo. MFC utilizó este parámetro para determinar el tipo adecuado de cuadro de diálogo que se va a crear. El tamaño predeterminado de 0 significa que el código MFC determinará el tamaño de cuadro de diálogo correcto que se utilizará en función de la versión del sistema operativo en la que se ejecuta el programa.

*bVistaStyle*<br/>
de **Nota:** Este parámetro está disponible en Visual Studio 2008 y versiones posteriores, y hace que el cuadro de diálogo nuevo estilo se use solo si se ejecuta en Windows Vista o posterior.

Parámetro que especifica el estilo del cuadro de diálogo de archivo. Establézcalo en TRUE para usar los cuadros de diálogo nuevos archivos de estilo de vista. De lo contrario, se utilizará el estilo antiguo de cuadros de diálogo. Vea la sección Comentarios para obtener más información acerca de la ejecución en vista.

### <a name="remarks"></a>Comentarios

Se crea un cuadro de diálogo **Abrir archivo** o **Guardar archivo como** , dependiendo del valor de *bOpenFileDialog*.

Si se especifica una extensión predeterminada mediante *lpszDefExt* , puede que no se produzca el comportamiento que se espera, porque rara vez es predecible qué extensiones tienen asociaciones de archivo en el equipo del usuario. Si necesita más control sobre la anexión de una extensión predeterminada, puede derivar su propia clase de e invalidar el `CFileDialog` `CFileDialog::OnFileNameOK` método para realizar su propio control de la extensión.

Para permitir al usuario seleccionar varios archivos, establezca la marca OFN_ALLOWMULTISELECT antes de llamar a [DoModal](#domodal). Debe proporcionar su propio búfer de nombre de archivo para almacenar la lista devuelta de varios nombres de archivo. Para ello, reemplace `m_ofn.lpstrFile` por un puntero a un búfer que haya asignado, después de construir el [CFileDialog](../../mfc/reference/cfiledialog-class.md), pero antes de llamar `DoModal`a. Además, debe establecer `m_ofn.nMaxFile` con el número de caracteres del búfer `m_ofn.lpstrFile`al que apunta. Si establece el número máximo de archivos que se van a seleccionar en *n*, el tamaño de búfer `n`necesario es * (_ MAX_PATH + 1) + 1. Por ejemplo:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Para permitir al usuario cambiar el tamaño de un cuadro de diálogo de estilo del explorador mediante el mouse o el teclado, establezca la marca OFN_ENABLESIZING. La configuración de esta marca solo es necesaria si se proporciona un procedimiento de enlace o una plantilla personalizada. La marca solo funciona con un cuadro de diálogo de estilo Explorador; no se puede cambiar el tamaño de los cuadros de diálogo de estilo antiguo.

El parámetro *lpszFilter* se usa para determinar el tipo de nombre de archivo que debe tener un archivo para que se muestre en la lista de archivos. La primera cadena del par de cadenas describe el filtro; la segunda cadena indica la extensión de nombre de archivo que se va a usar. Se pueden especificar varias extensiones mediante el uso de un punto y coma (el carácter '; ') como delimitador. La cadena termina con dos caracteres&#124;' ', seguidos de un carácter nulo. También puede usar un objeto [CString](../../atl-mfc-shared/using-cstring.md) para este parámetro.

Por ejemplo, Microsoft Excel permite a los usuarios abrir archivos que tienen extensiones. XLC (gráfico) o. xls (hoja de cálculo), entre otros. El filtro de Excel se podría escribir de la siguiente manera:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Sin embargo, si tiene previsto usar esta cadena para actualizar directamente la `OPENFILENAME` estructura, debe delimitar las cadenas con el carácter nulo, ' \ 0 ', en lugar de las barras verticales (&#124;' ').

El parámetro *bVistaStyle* solo es aplicable cuando se ejecuta en Windows Vista o posterior. En versiones anteriores de Windows, este parámetro se omite. Si *bVistaStyle* se establece en true, al compilar un programa con Visual Studio 2008 o una versión posterior, se usará el **cuadro de diálogo nuevo archivo** de estilo vista. De lo contrario, se utilizará el **cuadro de diálogo archivo** de estilo MFC anterior.

No se admiten plantillas de cuadro de diálogo en los cuadros de diálogo basados en *bVistaStyle*

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog::D omodal](#domodal).

##  <a name="domodal"></a>  CFileDialog::DoModal

Llame a esta función para mostrar el cuadro de diálogo archivo común de Windows y permitir que el usuario examine archivos y directorios, y escriba un nombre de archivo.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Valor devuelto

IDOK o IDCANCEL. Si se devuelve IDCANCEL, llame a la función [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) de Windows para determinar si se ha producido un error.

IDOK y IDCANCEL son constantes que indican si el usuario seleccionó el botón Aceptar o cancelar.

### <a name="remarks"></a>Comentarios

Si desea inicializar las distintas opciones de cuadro de diálogo de archivo estableciendo los miembros de `m_ofn` la estructura, debe hacerlo antes de llamar `DoModal`a, pero después de que se construya el objeto de cuadro de diálogo.

Por ejemplo, si desea permitir que el usuario seleccione varios archivos, establezca la marca OFN_ALLOWMULTISELECT antes de llamar a `DoModal`, tal y como se muestra en el ejemplo de código de este tema.

Cuando el usuario hace clic en los botones aceptar o cancelar del cuadro de diálogo, o selecciona la opción cerrar en el menú de control del cuadro de diálogo, se devuelve el control a la aplicación. Después, puede llamar a otras funciones miembro para recuperar la configuración o la información que el usuario introduce en el cuadro de diálogo.

`DoModal`es una función virtual invalidada a `CDialog`partir de la clase.

### <a name="example"></a>Ejemplo

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown

Habilita una lista desplegable en el botón abrir o guardar del cuadro de diálogo.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR de la lista desplegable.

### <a name="remarks"></a>Comentarios

##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup

Detiene la adición de elementos a un grupo visual en el cuadro de diálogo.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Valor devuelto

Devuelve S_OK si se realiza correctamente; un valor de error en caso contrario.

### <a name="remarks"></a>Comentarios

##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState

Recupera el estado actual de un botón de comprobación (casilla) en el cuadro de diálogo.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR de la casilla.

*bChecked*<br/>
Estado de la casilla. TRUE indica Checked; FALSE indica que no está activada.

### <a name="remarks"></a>Comentarios

##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState

Recupera el estado actual de un elemento de un control contenedor que se encuentra en el cuadro de diálogo.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control contenedor.

*dwIDItem*<br/>
IDENTIFICADOR del elemento.

*dwState*<br/>
Referencia a una variable que recibe uno o más valores de la enumeración CDCONTROLSTATE que indica el estado actual del control.

### <a name="remarks"></a>Comentarios

##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState

Recupera la visibilidad actual y los Estados habilitados de un control determinado.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control.

*dwState*<br/>
Referencia a una variable que recibe uno o más valores de la enumeración CDCONTROLSTATE que indica el estado actual del control.

### <a name="remarks"></a>Comentarios

##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText

Recupera el texto actual en un control de cuadro de edición.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del cuadro de edición.

*strText*<br/>
Valor de texto.

### <a name="remarks"></a>Comentarios

##  <a name="getfileext"></a>  CFileDialog::GetFileExt

Llame a esta función para recuperar la extensión del nombre de archivo especificado en el cuadro de diálogo.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Valor devuelto

La extensión del nombre de archivo.

### <a name="remarks"></a>Comentarios

Por ejemplo, si el nombre del archivo especificado es DATA. TXT, `GetFileExt` devuelve "txt".

Si `m_ofn.Flags` tiene establecida la marca OFN_ALLOWMULTISELECT, esta cadena contiene una secuencia de cadenas terminadas en null, donde la primera cadena es la ruta de acceso del directorio del grupo de archivos seleccionado, seguido de los nombres de todos los archivos seleccionados por el usuario. Para recuperar las rutas de acceso de archivo, use las funciones miembro [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) .

##  <a name="getfilename"></a>  CFileDialog::GetFileName

Llame a esta función para recuperar el nombre del nombre de archivo especificado en el cuadro de diálogo.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Valor devuelto

Nombre del archivo.

### <a name="remarks"></a>Comentarios

El nombre del archivo incluye tanto el prefijo como la extensión. Por ejemplo, `GetFileName` devolverá "Text. DAT "para el archivo C:\FILES\TEXT.DAT.

Si `m_ofn.Flags` tiene establecida `OFN_ALLOWMULTISELECT` la marca, debe llamar a [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) para recuperar un archivo de ruta de acceso.

##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle

Llame a esta función para recuperar el título del archivo especificado en el cuadro de diálogo.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Valor devuelto

Título del archivo.

### <a name="remarks"></a>Comentarios

El título del archivo incluye solo su prefijo, sin la ruta de acceso ni la extensión. Por ejemplo, `GetFileTitle` devolverá "Text" para el archivo C:\FILES\TEXT.dat.

Si `m_ofn.Flags` tiene establecida la marca OFN_ALLOWMULTISELECT, esta cadena contiene una secuencia de cadenas terminadas en null, donde la primera cadena es la ruta de acceso del directorio del grupo de archivos seleccionado, seguido de los nombres de todos los archivos seleccionados por el usuario. Por esta razón, use las funciones miembro [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) para recuperar el siguiente nombre de archivo de la lista.

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog::D omodal](#domodal).

##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath

Llame a esta función miembro para recuperar la ruta de acceso de la carpeta o el directorio abierto actualmente para un cuadro de diálogo de tipo de explorador abrir o guardar como común.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Valor devuelto

Objeto [CString](../../atl-mfc-shared/reference/cstringt-class.md) que contiene la carpeta o el directorio abierto actualmente.

### <a name="remarks"></a>Comentarios

El cuadro de diálogo se debe haber creado con el estilo OFN_EXPLORER; de lo contrario, se producirá un error en el método con una aserción.

Solo puede llamar a este método mientras se muestra el cuadro de diálogo. Una vez cerrado el cuadro de diálogo, esta función dejará de funcionar y se producirá un error en el método con una aserción.

##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize

Recupera un puntero al objeto COM interno para un [CFileDialog](../../mfc/reference/cfiledialog-class.md)determinado.

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto COM interno para `CFileDialog`. Es su responsabilidad liberar este puntero adecuadamente.

### <a name="remarks"></a>Comentarios

Use esta función solo en Windows Vista o posterior con un objeto que tenga *bVistaStyle* establecido en true. Si usa esta función cuando *bVistaStyle* es false, devolverá null en modo de versión y producirá una aserción en modo de depuración.

Para obtener más información sobre `IFileDialogCustomize` la interfaz, vea [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Ejemplo

En este ejemplo se recupera el objeto COM interno. Para ejecutar este ejemplo de código, debe compilarlo en Windows Vista o posterior.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog

Recupera un puntero al objeto COM interno para un determinado `CFileDialog`.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto COM interno para `CFileDialog`. Es su responsabilidad liberar este puntero adecuadamente.

### <a name="remarks"></a>Comentarios

Use esta función solo en Windows Vista o posterior con un objeto que tenga *bVistaStyle* establecido en true. Esta función devuelve NULL si `CFileDialog` no es un cuadro de diálogo **abierto** o si *bVistaStyle* está establecido en false. En este último caso, la función solo devuelve NULL en modo de versión en modo de depuración y generará una aserción.

Para obtener más información sobre `IFileOpenDialog` la interfaz, vea [IFileOpenDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Ejemplo

En este ejemplo se recupera el objeto COM interno. Para ejecutar este código, debe compilarlo en Windows Vista o posterior.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog

Recupera un puntero al objeto COM interno para un determinado `CFileDialog`.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Valor devuelto

Puntero al objeto COM interno para `CFileDialog`. Es su responsabilidad liberar este puntero adecuadamente.

### <a name="remarks"></a>Comentarios

Use esta función solo en Windows Vista o posterior con un objeto que tenga *bVistaStyle* establecido en true. Esta función devolverá null si `CFileDialog` el no es un cuadro de diálogo **Guardar** o si *bVistaStyle* está establecido en false. En este último caso, la función solo devuelve NULL en modo de versión en modo de depuración y generará una aserción.

Para obtener más información sobre `IFileSaveDialog` la interfaz, vea [IFileSaveDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Ejemplo

En este ejemplo se recupera el objeto COM interno. Para ejecutar este ejemplo de código, debe compilarlo en Windows Vista o posterior.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName

Llame a esta función para recuperar el siguiente nombre de archivo del grupo seleccionado en el cuadro de diálogo.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Parámetros

*pos*<br/>
Referencia a un valor de posición devuelto por una `GetNextPathName` llamada `GetStartPosition` de función o anterior. NULL si se ha alcanzado el final de la lista.

### <a name="return-value"></a>Valor devuelto

Ruta de acceso completa del archivo.

### <a name="remarks"></a>Comentarios

La ruta de acceso del nombre de archivo incluye el título del archivo más toda la ruta de acceso del directorio. Por ejemplo, `GetNextPathName` devolverá "C:\FILES\TEXT. DAT "para el archivo C:\FILES\TEXT.DAT. Puede utilizar `GetNextPathName` en un bucle de iteración hacia delante si establece la posición inicial con una llamada `GetStartPosition`a.

Si la selección se compone de un solo archivo, se devolverá ese nombre de archivo.

##  <a name="getofn"></a>  CFileDialog::GetOFN

Recupera la estructura asociada `OPENFILENAME` .

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Valor devuelto

Una estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) .

### <a name="remarks"></a>Comentarios

Use la segunda versión de esta función para inicializar la apariencia de un **archivo abrir** o **archivo guardar como** cuadro de diálogo después de construirlo, pero antes de que `DoModal` se muestre con la función miembro. Por ejemplo, puede establecer el `lpstrTitle` miembro de `m_ofn` en el título que desee que tenga el cuadro de diálogo.

##  <a name="getpathname"></a>  CFileDialog::GetPathName

Llame a esta función para recuperar la ruta de acceso completa del archivo especificado en el cuadro de diálogo.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Valor devuelto

Ruta de acceso completa del archivo.

### <a name="remarks"></a>Comentarios

La ruta de acceso del nombre de archivo incluye el título del archivo más toda la ruta de acceso del directorio. Por ejemplo, `GetPathName` devolverá "C:\FILES\TEXT. DAT "para el archivo C:\FILES\TEXT.DAT.

Si `m_ofn.Flags` tiene establecida la marca OFN_ALLOWMULTISELECT, esta cadena contiene una secuencia de cadenas teminated null, donde la primera cadena es la ruta de acceso del directorio del grupo de archivos seleccionado, seguido de los nombres de todos los archivos seleccionados por el usuario. Por esta razón, use las funciones miembro [GetStartPosition](#getstartposition) y [GetNextPathName](#getnextpathname) para recuperar el siguiente nombre de archivo de la lista.

### <a name="example"></a>Ejemplo

  Vea el ejemplo de [CFileDialog::D omodal](#domodal).

##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref

Llame a esta función para determinar si la casilla de solo lectura está activada en los cuadros de diálogo Abrir archivo estándar de Windows y guardar archivo como.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la casilla de solo lectura del cuadro de diálogo está seleccionada; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

Puede ocultar la casilla solo lectura si establece el estilo OFN_HIDEREADONLY en el `CFileDialog` constructor.

> [!NOTE]
> Los objetos de estilo `CFileDialog` de Windows Vista o versiones posteriores no admiten esta función. Si intenta usar esta función en un estilo `CFileDialog` de Windows Vista o posterior, se producirá [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="getresult"></a>  CFileDialog::GetResult

Recupera la opción que el usuario realizó en el cuadro de diálogo.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Valor devuelto

Un puntero a un IShellItem que representa la elección del usuario.

### <a name="remarks"></a>Comentarios

##  <a name="getresults"></a>  CFileDialog::GetResults

Recupera las opciones del usuario en un cuadro de diálogo que permite la selección múltiple.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Valor devuelto

Un puntero a un IShellItemArray a través del cual se puede obtener acceso a los elementos seleccionados en el cuadro de diálogo.

### <a name="remarks"></a>Comentarios

##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem

Recupera un elemento determinado del control contenedor especificado en el cuadro de diálogo.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control contenedor.

*dwIDItem*<br/>
IDENTIFICADOR del elemento que el usuario seleccionó en el control.

### <a name="remarks"></a>Comentarios

##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition

Llame a esta función miembro para recuperar la posición de la primera ruta de acceso de archivo en `m_ofn.Flags` la lista, si tiene establecida la marca OFN_ALLOWMULTISELECT.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Valor devuelto

Valor de posición que se puede utilizar para la iteración; Es NULL si la lista está vacía.

##  <a name="hidecontrol"></a>  CFileDialog::HideControl

Llame a esta función miembro para ocultar el control especificado en un cuadro de diálogo para abrir o guardar como estilo del explorador.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
IDENTIFICADOR del control que se va a ocultar.

### <a name="remarks"></a>Comentarios

El cuadro de diálogo se debe haber creado con el estilo OFN_EXPLORER; de lo contrario, se producirá un error en la función con una aserción.

##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode

Determina si el cuadro de diálogo actual está en modo de selector de carpetas.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Valor devuelto

TRUE si el cuadro de diálogo está en modo de selector de carpetas; en caso contrario, FALSE.

### <a name="remarks"></a>Comentarios

##  <a name="m_ofn"></a>  CFileDialog::m_ofn

`m_ofn`es una estructura de tipo `OPENFILENAME`. Los datos de esta estructura representan el estado actual de `CFileDialog`.

### <a name="remarks"></a>Comentarios

Use esta estructura para inicializar la apariencia de un **archivo abrir** o **archivo guardar como** cuadro de diálogo después de crearlo, pero antes de mostrarlo con el método [DoModal](#domodal) . Por ejemplo, puede establecer el miembro *lpstrTitle* de `m_ofn` en el título que desee que tenga el cuadro de diálogo.

Con el estilo de Windows Vista o posterior de [CFileDialog](../../mfc/reference/cfiledialog-class.md), no se garantiza que `m_ofn` siempre coincida con el estado del cuadro de diálogo. Se sincroniza con el cuadro de diálogo de versiones anteriores de Windows. Vea [CFileDialog:: ApplyOFNToShellDialog](#applyofntoshelldialog) y [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog) para obtener más información sobre la `m_ofn` sincronización de la `CFileDialog` estructura y el estado en Windows Vista o posterior.

Los cuadros de diálogo de archivo de estilo de Windows Vista o posterior no admiten determinados `CFileDialog`miembros y marcas de. Como resultado, estos no tendrán ningún efecto.

A continuación se muestra una lista de los miembros que no son compatibles con Windows Vista o versiones posteriores:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

Las marcas siguientes no se admiten y, por lo tanto, no tienen ningún efecto cuando se usa el `CFileDialog`estilo de Windows Vista o posterior de:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES: siempre en Windows Vista o posterior

- OFN_NOLONGNAMES: siempre en Windows Vista o versiones posteriores

- OFN_NONETWORKBUTTON: siempre en Windows Vista o posterior

- OFN_READONLY

- OFN_SHOWHELP

Para obtener más información sobre esta estructura, vea la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) en el Windows SDK.

##  <a name="makeprominent"></a>  CFileDialog::MakeProminent

Coloca un control en el cuadro de diálogo para que destaque en comparación con otros controles.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control.

### <a name="remarks"></a>Comentarios

##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked

Llamado cuando se hace clic en el botón.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del botón.

### <a name="remarks"></a>Comentarios

##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled

Se le llama cuando la casilla está activada o desactivada.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR de la casilla.

*bChecked*<br/>
Activado o desactivado.

### <a name="remarks"></a>Comentarios

##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating

Se le llama cuando se activa el control.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control.

### <a name="remarks"></a>Comentarios

##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange

Invalide este método si desea controlar el mensaje WM_NOTIFY CDN_SELCHANGE.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Comentarios

El sistema envía el mensaje CDN_SELCHANGE cuando el usuario selecciona un nuevo archivo o carpeta en la lista de archivos del cuadro de diálogo **abrir** o **Guardar como** . Invalide este método si desea realizar cualquier acción en respuesta a este mensaje.

El sistema envía este mensaje solo si el cuadro de diálogo se creó con la marca OFN_EXPLORER activada. Para obtener más información sobre la notificación, vea [CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange). Para obtener información sobre la marca OFN_EXPLORER, consulte la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) y los [cuadros de diálogo abrir y guardar como](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK

Invalide esta función solo si desea proporcionar una validación personalizada de los nombres de archivo que se escriben en un cuadro de diálogo de archivo común.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Valor devuelto

1 si el nombre de archivo no es un nombre de archivo válido; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

Esta función permite rechazar un nombre de archivo para cualquier motivo específico de la aplicación. Normalmente, no es necesario usar esta función porque el marco de trabajo proporciona la validación predeterminada de nombres de archivo y muestra un cuadro de mensaje si se especifica un nombre de archivo no válido.

Si se devuelve 1, el cuadro de diálogo seguirá mostrándose para que el usuario escriba otro nombre de archivo. El procedimiento del cuadro de diálogo descarta el cuadro de diálogo si el valor devuelto es 0. Otros valores devueltos distintos de cero están actualmente reservados y no deben usarse.

##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange

Invalide esta función para controlar el mensaje WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Comentarios

El mensaje de notificación se envía cuando se abre una nueva carpeta en el cuadro de diálogo abrir o guardar como.

La notificación se envía solo si el cuadro de diálogo se creó con el estilo OFN_EXPLORER. Para obtener más información sobre la notificación, vea [CDN_FOLDERCHANGE](/windows/win32/dlgbox/cdn-folderchange). Para obtener información sobre el estilo OFN_EXPLORER, consulte la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) y los [cuadros de diálogo abrir y guardar como](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="oninitdone"></a>  CFileDialog::OnInitDone

Invalide esta función para controlar el mensaje WM_NOTIFY CDN_INITDONE.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Comentarios

El sistema envía este mensaje de notificación cuando el sistema ha terminado de organizar los controles en el cuadro de diálogo **abrir** o **Guardar como** para dejar espacio a los controles del cuadro de diálogo secundario.

El sistema solo lo envía si el cuadro de diálogo se creó con el estilo OFN_EXPLORER. Para obtener más información sobre la notificación, vea [CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone). Para obtener información sobre el estilo OFN_EXPLORER, consulte la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) y los [cuadros de diálogo abrir y guardar como](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

> [!NOTE]
> Los cuadros de diálogo de archivo de estilo de Windows Vista o posterior no admiten esta función. Si intenta usar esta función en un cuadro de diálogo de archivo de estilo de Windows Vista o posterior, se producirá [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected

Se le llama cuando se selecciona el elemento contenedor.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control contenedor.

*dwIDItem*<br/>
IDENTIFICADOR del elemento.

### <a name="remarks"></a>Comentarios

##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify

Se llama a esta función cada vez que la selección actual de un cuadro de lista está a punto de cambiar.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Parámetros

*nIDBox*<br/>
IDENTIFICADOR del cuadro de lista o cuadro combinado en el que se produjo la selección.

*iCurSel*<br/>
Índice de la selección actual.

*nCode*<br/>
Código de notificación del control. Este parámetro debe tener uno de los valores siguientes:

- CD_LBSELCHANGE especifica *iCurSel* es el elemento seleccionado en un cuadro de lista de selección única.

- CD_LBSELSUB especifica que *iCurSel* ya no está seleccionado en un cuadro de lista de selección.

- CD_LBSELADD especifica que *iCurSel* está seleccionado en un cuadro de lista de selección.

- CD_LBSELNOITEMS especifica que no existe ninguna selección en un cuadro de lista de selección.

### <a name="remarks"></a>Comentarios

Invalide esta función para proporcionar un control personalizado de los cambios de selección en el cuadro de lista. Por ejemplo, puede usar esta función para mostrar los derechos de acceso o la fecha en que se modificó por última vez de cada archivo que el usuario selecciona.

##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation

Invalide esta función para proporcionar un control personalizado de las infracciones de recursos compartidos.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parámetros

*lpszPathName*<br/>
Ruta de acceso del archivo en el que se produjo la infracción del recurso compartido.

### <a name="return-value"></a>Valor devuelto

Uno de los siguientes valores:

- OFN_SHAREFALLTHROUGH el nombre de archivo se devuelve desde el cuadro de diálogo.

- OFN_SHARENOWARN no es necesario realizar ninguna otra acción.

- OFN_SHAREWARN el usuario recibe el mensaje de advertencia estándar para este error.

### <a name="remarks"></a>Comentarios

Normalmente, no es necesario usar esta función porque el marco de trabajo proporciona una comprobación predeterminada de las infracciones de recursos compartidos y muestra un cuadro de mensaje si se produce una infracción de recurso compartido.

Si desea deshabilitar la comprobación de infracciones de recursos compartidos, utilice el operador OR bit `m_ofn.Flags`a bit para combinar la marca OFN_SHAREAWARE con.

##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange

Invalide esta función para controlar el mensaje WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Comentarios

El mensaje de notificación se envía cuando el usuario selecciona un nuevo tipo de archivo en la lista de tipos de archivo del cuadro de diálogo abrir o guardar como.

La notificación se envía solo si el cuadro de diálogo se creó con el estilo OFN_EXPLORER. Para obtener más información sobre la notificación, vea [CDN_TYPECHANGE](/windows/win32/dlgbox/cdn-typechange). Para obtener información sobre el estilo OFN_EXPLORER, consulte la estructura [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) y los [cuadros de diálogo abrir y guardar como](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem

Quita un elemento de un control contenedor en el cuadro de diálogo.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control contenedor del que se va a quitar el elemento.

*dwIDItem*<br/>
IDENTIFICADOR del elemento.

### <a name="remarks"></a>Comentarios

##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState

Establece el estado actual de un botón de comprobación (casilla) en el cuadro de diálogo.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR de la casilla.

*bChecked*<br/>
Estado de la casilla. TRUE indica Checked; FALSE indica que no está activada.

### <a name="remarks"></a>Comentarios

##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState

Establece el estado actual de un elemento de un control contenedor que se encuentra en el cuadro de diálogo.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control contenedor.

*dwIDItem*<br/>
IDENTIFICADOR del elemento.

*dwState*<br/>
Uno o más valores de la enumeración CDCONTROLSTATE que indican el nuevo estado del control.

### <a name="remarks"></a>Comentarios

##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText

Establece el texto de un elemento de control. Por ejemplo, el texto que acompaña a un botón de radio o a un elemento de un menú.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control contenedor.

*dwIDItem*<br/>
IDENTIFICADOR del elemento.

*strLabel*<br/>
Texto del elemento.

### <a name="remarks"></a>Comentarios

##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel

Establece el texto asociado a un control, como texto de botón o una etiqueta de cuadro de edición.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control.

*strLabel*<br/>
Nombre del control.

### <a name="remarks"></a>Comentarios

##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState

Establece la visibilidad actual y los Estados habilitados de un control determinado.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control.

*dwState*<br/>
Uno o más valores de la enumeración CDCONTROLSTATE que indican el estado actual del control.

### <a name="remarks"></a>Comentarios

##  <a name="setcontroltext"></a>  CFileDialog::SetControlText

Llame a este método para establecer el texto del control especificado en un cuadro de diálogo para **abrir** o **Guardar como** estilo del explorador.

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Parámetros

*nID*<br/>
de IDENTIFICADOR del control para el que se va a establecer el texto.

*lpsz*<br/>
de Puntero a la cadena que contiene el texto que se va a establecer para el control.

### <a name="remarks"></a>Comentarios

Ambas versiones de esta función son válidas para las aplicaciones que usan Unicode. Sin embargo, solo la versión con el tipo LPCSTR es válida para las aplicaciones que usan ANSI.

Para usar este método, debe crear el cuadro de diálogo con el estilo OFN_EXPLORER. De lo contrario, se producirá un error en la función con una aserción.

##  <a name="setdefext"></a>  CFileDialog::SetDefExt

Llame a esta función para establecer la extensión de nombre de archivo predeterminada para un cuadro de diálogo abrir o guardar como común en el estilo del explorador.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Parámetros

*lpsz*<br/>
Puntero a una cadena que contiene la extensión predeterminada que se va a utilizar para el objeto de cuadro de diálogo. Esta cadena no debe contener un punto (.).

### <a name="remarks"></a>Comentarios

El cuadro de diálogo se debe haber creado con el estilo OFN_EXPLORER; de lo contrario, se producirá un error en la función con una aserción.

##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText

Establece el texto actual en un control de cuadro de edición.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del cuadro de edición.

*strText*<br/>
Valor de texto.

### <a name="remarks"></a>Comentarios

##  <a name="setproperties"></a>  CFileDialog::SetProperties

Proporciona un almacén de propiedades que define los valores predeterminados que se van a usar para el elemento que se está guardando.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Parámetros

*lpszPropList*<br/>
Lista de propiedades predefinidas separadas por ";". Para obtener una lista de las marcas, consulte la sección flags de [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew).

### <a name="remarks"></a>Comentarios

##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem

Establece el estado seleccionado de un elemento determinado de un grupo de botones de opción o un cuadro combinado que se encuentra en el cuadro de diálogo.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del control contenedor.

*dwIDItem*<br/>
IDENTIFICADOR del elemento que el usuario seleccionó en el control.

### <a name="remarks"></a>Comentarios

##  <a name="settemplate"></a>  CFileDialog::SetTemplate

Establece la plantilla de cuadro de diálogo para el objeto [CFileDialog](../../mfc/reference/cfiledialog-class.md) .

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Parámetros

*nWin3ID*<br/>
de Contiene el número de identificación del recurso de plantilla para el objeto que `CFileDialog` no es de explorador. Esta plantilla solo se utiliza en Windows NT 3,51 o cuando el estilo OFN_EXPLORER no está presente.

*nWin4ID*<br/>
de Contiene el número de identificación del recurso de plantilla para el `CFileDialog` objeto de explorador. Esta plantilla solo se utiliza en Windows NT 4,0 y versiones posteriores, Windows 95 y versiones posteriores, o cuando el estilo OFN_EXPLORER está presente.

*lpWin3ID*<br/>
de Contiene el nombre del recurso de plantilla para el objeto que no `CFileDialog` es de explorador. Esta plantilla solo se utiliza en Windows NT 3,51 o cuando el estilo OFN_EXPLORER no está presente.

*lpWin4ID*<br/>
de Contiene el nombre del recurso de plantilla del objeto Explorer `CFileDialog` . Esta plantilla solo se utiliza en Windows NT 4,0 y versiones posteriores, Windows 95 y versiones posteriores, o cuando el estilo OFN_EXPLORER está presente.

### <a name="remarks"></a>Comentarios

El sistema usará solo una de las plantillas especificadas. El sistema determina la plantilla que se va a usar en función de la presencia del estilo OFN_EXPLORER y el sistema operativo en el que se ejecuta la aplicación. Al especificar una plantilla de estilo Explorador y que no es de explorador, es fácil admitir Windows NT 3,51, Windows NT 4,0 y versiones posteriores, y Windows 95 y versiones posteriores.

> [!NOTE]
> Los cuadros de diálogo de archivo de estilo de Windows Vista o posterior no admiten esta función. Si intenta usar esta función en un cuadro de diálogo de archivo de estilo de Windows Vista o posterior, se producirá [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Una alternativa es usar un cuadro de diálogo personalizado. Para obtener más información sobre el uso `CFileDialog`de un personalizado, vea [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup

Declara un grupo visual en el cuadro de diálogo. Las llamadas subsiguientes a cualquier método "Add" agregan esos elementos a este grupo.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parámetros

*dwIDCtl*<br/>
IDENTIFICADOR del grupo visual.

*strLabel*<br/>
Nombre del grupo.

### <a name="remarks"></a>Comentarios

##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog

Actualiza la `m_ofn` estructura de datos de [CFileDialog](../../mfc/reference/cfiledialog-class.md) basándose en el estado actual del objeto interno.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Comentarios

En las versiones de Windows anteriores a Windows Vista, la estructura de datos de [OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) del miembro se sincronizó `CFileDialog`continuamente con el estado de. Cualquier cambio en la variable miembro [m_ofn](#m_ofn) afecta directamente al estado del cuadro de diálogo. Además, cualquier cambio en el estado del cuadro de diálogo actualizó inmediatamente la variable miembro m_ofn.

En Windows Vista o posterior, la `m_ofn` estructura de datos no se actualiza automáticamente. Para garantizar la precisión de los datos de la `m_ofn` variable miembro, debe llamar a la `UpdateOFNFromShellDialog` función antes de tener acceso a los datos. Windows llama a esta función automáticamente durante el procesamiento de [IFileDialog:: OnFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Para obtener más información sobre cómo usar la `CFileDialog` clase en Windows Vista o posterior, vea [CFileDialog (clase](../../mfc/reference/cfiledialog-class.md)).

### <a name="example"></a>Ejemplo

En este ejemplo se `CFileDialog` actualiza antes de mostrarlo. Antes de actualizar `m_ofn` la variable miembro, es necesario sincronizarla con el estado actual del cuadro de diálogo.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Vea también

[CCommonDialog (clase)](../../mfc/reference/ccommondialog-class.md)<br/>
[Gráfico de jerarquías](../../mfc/hierarchy-chart.md)
