---
title: Clase COleClientItem
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: ce321c9709b752602a664142f283884f4d17b50b
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753961"
---
# <a name="coleclientitem-class"></a>Clase COleClientItem

Define la interfaz del contenedor a elementos de OLE.

## <a name="syntax"></a>Sintaxis

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Miembros

### <a name="public-constructors"></a>Constructores públicos

|Nombre|Descripción|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Construye un objeto `COleClientItem`.|

### <a name="public-methods"></a>Métodos públicos

|Nombre|Descripción|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|Abre el elemento OLE para una operación y, a continuación, ejecuta el verbo especificado.|
|[COleClientItem::ActivateAs](#activateas)|Activa el elemento como otro tipo.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Tiene acceso a los datos del objeto OLE.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Indica si una aplicación contenedora puede crear un objeto incrustado.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Indica si una aplicación contenedora puede crear un objeto vinculado.|
|[COleClientItem::CanPaste](#canpaste)|Indica si el Portapapeles contiene un elemento OLE incrustado o estático.|
|[COleClientItem::CanPasteLink](#canpastelink)|Indica si el Portapapeles contiene un elemento OLE enlazable.|
|[COleClientItem::Close](#close)|Cierra un vínculo a un servidor, pero no destruye el elemento OLE.|
|[COleClientItem::ConvertTo](#convertto)|Convierte el elemento a otro tipo.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Copia el elemento OLE en el Portapapeles.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Crea un duplicado de un elemento existente.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Crea un elemento incrustado desde el Portapapeles.|
|[COleClientItem::CreateFromData](#createfromdata)|Crea un elemento incrustado a partir de un objeto de datos.|
|[COleClientItem::CreateFromFile](#createfromfile)|Crea un elemento incrustado a partir de un archivo.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Crea un elemento vinculado a partir del Portapapeles.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Crea un elemento vinculado a partir de un objeto de datos.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Crea un elemento vinculado a partir de un archivo.|
|[COleClientItem::CreateNewItem](#createnewitem)|Crea un nuevo elemento incrustado iniciando la aplicación de servidor.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Crea un elemento estático desde el Portapapeles.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Crea un elemento estático a partir de un objeto de datos.|
|[COleClientItem::Deactivate](#deactivate)|Desactiva el elemento.|
|[COleClientItem::DeactivateUI](#deactivateui)|Restaura la interfaz de usuario de la aplicación contenedora a su estado original.|
|[COleClientItem::Delete](#delete)|Elimina o cierra el elemento OLE si era un elemento vinculado.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Realiza una operación de arrastrar y colocar.|
|[COleClientItem::DoVerb](#doverb)|Ejecuta el verbo especificado.|
|[COleClientItem::Draw](#draw)|Dibuja el elemento OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Obtiene la vista en la que el elemento está activado en su lugar.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Devuelve los límites del rectángulo del elemento OLE.|
|[COleClientItem::GetClassID](#getclassid)|Obtiene el identificador de clase del elemento actual.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Obtiene los datos que se colocarían en `CopyToClipboard` el Portapapeles mediante una llamada a la función miembro.|
|[COleClientItem::GetDocument](#getdocument)|Devuelve `COleDocument` el objeto que contiene el elemento actual.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Obtiene la vista actual del elemento para la representación.|
|[COleClientItem::GetExtent](#getextent)|Devuelve los límites del rectángulo del elemento OLE.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Recupera un identificador de un icono asociado al servidor de un CLSID determinado.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Obtiene el metarchivo utilizado para dibujar el icono del elemento.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Devuelve un puntero a la ventana de edición in situ del elemento.|
|[COleClientItem::GetItemState](#getitemstate)|Obtiene el estado actual del elemento.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Devuelve el estado de la última operación OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Devuelve el modo de actualización de un elemento vinculado (característica avanzada).|
|[COleClientItem::GetType](#gettype)|Devuelve el tipo (incrustado, vinculado o estático) del elemento OLE.|
|[COleClientItem::GetUserType](#getusertype)|Obtiene una cadena que describe el tipo del elemento.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Devuelve TRUE si el elemento está activo en el lugar.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Devuelve TRUE si un elemento vinculado está actualizado con su documento de origen.|
|[COleClientItem::IsModified](#ismodified)|Devuelve TRUE si el elemento se ha modificado desde la última vez que se guardó.|
|[COleClientItem::IsOpen](#isopen)|Devuelve TRUE si el elemento está abierto actualmente en la aplicación de servidor.|
|[COleClientItem::IsRunning](#isrunning)|Devuelve TRUE si se está ejecutando la aplicación de servidor del elemento.|
|[COleClientItem::OnActivate](#onactivate)|Llamado por el marco de trabajo para notificar al elemento que está activado.|
|[COleClientItem::OnActivateUI](#onactivateui)|Llamado por el marco de trabajo para notificar al elemento que está activado y debe mostrar su interfaz de usuario.|
|[COleClientItem::OnChange](#onchange)|Se llama cuando el servidor cambia el elemento OLE. Se requiere implementación.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Llamado por el marco de trabajo cuando se desactiva un elemento.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Llamado por el marco de trabajo cuando el servidor ha quitado su interfaz de usuario en el lugar.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Llamado por el marco de trabajo para obtener los datos que se van a copiar en el Portapapeles.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Llamado por el marco de trabajo para crear un menú compuesto.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Llamado por el marco de trabajo para quitar los menús del contenedor de un menú compuesto.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Llamado por el marco de trabajo para instalar y quitar un menú compuesto.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Llamado por el marco de trabajo para mostrar y ocultar las barras de control.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Llamado por el marco de trabajo para actualizar la barra de título de la ventana de marco.|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Reactiva el elemento y deshace la última operación de edición in situ.|
|[COleClientItem::Release](#release)|Libera la conexión a un elemento vinculado OLE y la cierra si estaba abierta. No destruye el elemento de cliente.|
|[COleClientItem::Reload](#reload)|Vuelve a cargar el `ActivateAs`elemento después de una llamada a .|
|[COleClientItem::Ejecutar](#run)|Ejecuta la aplicación asociada al elemento.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Establece la vista actual del elemento para la representación.|
|[COleClientItem::SetExtent](#setextent)|Establece el rectángulo delimitador del elemento OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Establece los nombres que muestra el servidor al editar el elemento OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Almacena en caché el metarchivo utilizado para dibujar el icono del elemento.|
|[COleClientItem::SetItemRects](#setitemrects)|Establece el rectángulo delimitador del elemento.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Establece el modo de actualización de un elemento vinculado (función avanzada).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Establece el dispositivo de destino de impresión para este elemento de cliente.|
|[COleClientItem::UpdateLink](#updatelink)|Actualiza la caché de presentación de un elemento.|

### <a name="protected-methods"></a>Métodos protegidos

|Nombre|Descripción|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Llamado por el marco de trabajo para determinar si se permite la activación en contexto.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Llamado por el marco de trabajo cuando cambia la posición de un elemento.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Llamado por el marco de trabajo para deshacer después de la activación.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Llamado por el marco de trabajo para descartar la información de estado de deshacer del elemento.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Llamado por el marco de trabajo para obtener las coordenadas del rectángulo de recorte del elemento.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Llamado por el marco de trabajo para obtener la posición del elemento en relación con la vista.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Llamado por el marco de trabajo cuando un elemento se activa en su lugar.|
|[COleClientItem::OnScrollBy](#onscrollby)|Llamado por el marco de trabajo para desplazar el elemento a la vista.|
|[COleClientItem::OnShowItem](#onshowitem)|Llamado por el marco de trabajo para mostrar el elemento OLE.|

## <a name="remarks"></a>Observaciones

Un elemento OLE representa los datos, creados y mantenidos por una aplicación de servidor, que se pueden incorporar "sin problemas" en un documento para que parezca que el usuario es un único documento. El resultado es un "documento compuesto" compuesto por el elemento OLE y un documento contenedor.

Un elemento OLE puede estar incrustado o vinculado. Si está incrustado, sus datos se almacenan como parte del documento compuesto. Si está vinculado, sus datos se almacenan como parte de un archivo independiente creado por la aplicación de servidor y solo se almacena un vínculo a ese archivo en el documento compuesto. Todos los elementos OLE contienen información que especifica la aplicación de servidor que se debe llamar para editarlos.

`COleClientItem`define varias funciones reemplazables que se llaman en respuesta a las solicitudes de la aplicación de servidor; estos overridables suelen actuar como notificaciones. Esto permite a la aplicación de servidor informar al contenedor de los cambios que realiza el usuario al editar el elemento OLE o recuperar la información necesaria durante la edición.

`COleClientItem`se puede utilizar con la clase [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)o [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) . Para `COleClientItem`usar , derive una clase de ella e implemente la función miembro [OnChange,](#onchange) que define cómo responde el contenedor a los cambios realizados en el elemento. Para admitir la activación en contexto, reemplace la [OnGetItemPosition](#ongetitemposition) función miembro. Esta función proporciona información sobre la posición mostrada del elemento OLE.

Para obtener más información sobre el uso de la interfaz de contenedor, vea los artículos [Contenedores: implementación](../../mfc/containers-implementing-a-container.md) de un contenedor y [activación](../../mfc/activation-cpp.md).

> [!NOTE]
> El Windows SDK hace referencia a elementos incrustados y vinculados como "objetos" y hace referencia a tipos de elementos como "clases." Esta referencia utiliza el término "elemento" para distinguir la entidad OLE del objeto C++ correspondiente y el término "type" para distinguir la categoría OLE de la clase C++.

## <a name="inheritance-hierarchy"></a>Jerarquía de herencia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Requisitos

**Encabezado:** afxole.h

## <a name="coleclientitemactivate"></a><a name="activate"></a>COleClientItem::Activate

Llame a esta función para ejecutar el verbo especificado en lugar de [DoVerb](#doverb) para que pueda realizar su propio procesamiento cuando se produce una excepción.

```cpp
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parámetros

*nVerb*<br/>
Especifica el verbo que se va a ejecutar. Puede tener uno de los valores siguientes:

|Value|Significado|Símbolo|
|-----------|-------------|------------|
|- 0|verbo principal|OLEIVERB_PRIMARY|
|- 1|Verbo secundario|(Ninguna)|
|- 1|Mostrar elemento para editar|OLEIVERB_SHOW|
|- 2|Editar elemento en una ventana separada|OLEIVERB_OPEN|
|- 3|Ocultar artículo|OLEIVERB_HIDE|

El valor -1 suele ser un alias para otro verbo. Si no se admite la edición abierta, -2 tiene el mismo efecto que -1. Para obtener valores adicionales, vea [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) en el Windows SDK.

*pView*<br/>
Puntero a la ventana de vista contenedora que contiene el elemento OLE; esto es utilizado por la aplicación de servidor para la activación en contexto. Este parámetro debe ser NULL si el contenedor no admite la activación en contexto.

*lpMsg*<br/>
Puntero al mensaje que provocó la activación del elemento.

### <a name="remarks"></a>Observaciones

Si la aplicación de servidor se escribió mediante la biblioteca Microsoft Foundation `COleServerItem` Class, esta función hace que se ejecute la función miembro [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) del objeto correspondiente.

Si el verbo principal es Editar y se especifica cero en el parámetro *nVerb,* se inicia la aplicación de servidor para permitir que se edite el elemento OLE. Si la aplicación contenedora admite la activación in situ, la edición se puede realizar en su lugar. Si el contenedor no admite la activación in situ (o si se especifica el verbo Abrir), el servidor se inicia en una ventana independiente y la edición se puede realizar allí. Normalmente, cuando el usuario de la aplicación contenedora hace doble clic en el elemento OLE, el valor del verbo principal en el *nVerb* parámetro determina qué acción puede realizar el usuario. Sin embargo, si el servidor solo admite una acción, realiza esa acción, independientemente del valor especificado en el parámetro *nVerb.*

Para obtener más información, vea [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) en el Windows SDK.

## <a name="coleclientitemactivateas"></a><a name="activateas"></a>COleClientItem::ActivateAs

Utiliza las facilidades de conversión de objetos de OLE para activar el elemento como si fuera un elemento del tipo especificado por *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parámetros

*lpszUserType*<br/>
Puntero a una cadena que representa el tipo de usuario de destino, como "Documento de Word."

*clsidOld*<br/>
Una referencia al identificador de clase actual del elemento. El identificador de clase debe representar el tipo del objeto real, tal como se almacena, a menos que sea un vínculo. En ese caso, debe ser el CLSID del elemento al que hace referencia el vínculo. El [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) proporciona automáticamente el identificador de clase correcto para el elemento.

*clsidNew*<br/>
Una referencia al identificador de clase de destino.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Esto es llamado automáticamente por [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Por lo general, no se llama directamente.

## <a name="coleclientitemattachdataobject"></a><a name="attachdataobject"></a>COleClientItem::AttachDataObject

Llame a esta función para inicializar un [COleDataObject](../../mfc/reference/coledataobject-class.md) para tener acceso a los datos en el elemento OLE.

```cpp
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parámetros

*rDataObject*<br/>
Referencia a `COleDataObject` un objeto que se inicializará para permitir el acceso a los datos en el elemento OLE.

## <a name="coleclientitemcanactivate"></a><a name="canactivate"></a>COleClientItem::CanActivate

Llamado por el marco de trabajo cuando el usuario solicita la activación en contexto del elemento OLE; El valor devuelto de esta función determina si se permite la activación in situ.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se permite la activación in situ; de lo contrario 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada permite la activación en contexto si el contenedor tiene una ventana válida. Reemplace esta función para implementar una lógica especial para aceptar o rechazar la solicitud de activación. Por ejemplo, se puede rechazar una solicitud de activación si el elemento OLE es demasiado pequeño o no está visible actualmente.

Para obtener más información, vea [IOleInPlaceSite::CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) en el Windows SDK.

## <a name="coleclientitemcancreatefromdata"></a><a name="cancreatefromdata"></a>COleClientItem::CanCreateFromData

Comprueba si una aplicación contenedora puede crear `COleDataObject` un objeto incrustado a partir del objeto especificado.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero al objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) desde el que se va a crear el elemento OLE.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el contenedor puede `COleDataObject` crear un objeto incrustado a partir del objeto; de lo contrario 0.

### <a name="remarks"></a>Observaciones

La `COleDataObject` clase se utiliza en las transferencias de datos para recuperar datos en varios formatos desde el Portapapeles, a través de arrastrar y colocar, o desde un elemento OLE incrustado.

Los contenedores pueden utilizar esta función para decidir habilitar o deshabilitar sus comandos Editar pegar y editar pegar especial.

Para obtener más información, vea el artículo Objetos de datos y orígenes de [datos (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcancreatelinkfromdata"></a><a name="cancreatelinkfromdata"></a>COleClientItem::CanCreateLinkFromData

Comprueba si una aplicación contenedora puede crear `COleDataObject` un objeto vinculado a partir del objeto especificado.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero al objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) desde el que se va a crear el elemento OLE.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el contenedor `COleDataObject` puede crear un objeto vinculado a partir del objeto.

### <a name="remarks"></a>Observaciones

La `COleDataObject` clase se utiliza en las transferencias de datos para recuperar datos en varios formatos desde el Portapapeles, a través de arrastrar y colocar, o desde un elemento OLE incrustado.

Los contenedores pueden utilizar esta función para decidir habilitar o deshabilitar los comandos Editar pegado especial y Editar pegar vínculo.

Para obtener más información, vea el artículo Objetos de datos y orígenes de [datos (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcanpaste"></a><a name="canpaste"></a>COleClientItem::CanPaste

Llame a esta función para ver si un elemento OLE incrustado se puede pegar desde el Portapapeles.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si un elemento OLE incrustado se puede pegar desde el Portapapeles; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Para obtener más información, vea [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) y [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) en el Windows SDK.

## <a name="coleclientitemcanpastelink"></a><a name="canpastelink"></a>COleClientItem::CanPasteLink

Llame a esta función para ver si un elemento OLE vinculado se puede pegar desde el Portapapeles.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si un elemento OLE vinculado se puede pegar desde el Portapapeles; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Para obtener más información, vea [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) y [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) en el Windows SDK.

## <a name="coleclientitemclose"></a><a name="close"></a>COleClientItem::Close

Llame a esta función para cambiar el estado de un elemento OLE del estado de ejecución al estado cargado, es decir, cargado con su controlador en memoria pero con el servidor no en ejecución.

```cpp
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parámetros

*dwCloseOption*<br/>
Marcar especificando en qué circunstancias se guarda el elemento OLE cuando vuelve al estado cargado. Puede tener uno de los siguientes valores:

- OLECLOSE_SAVEIFDIRTY Guardar el elemento OLE.

- OLECLOSE_NOSAVE No guarde el elemento OLE.

- OLECLOSE_PROMPTSAVE Preguntar al usuario si desea guardar el elemento OLE.

### <a name="remarks"></a>Observaciones

Esta función no tiene ningún efecto cuando el elemento OLE no se está ejecutando.

Para obtener más información, vea [IOleObject::Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) en el Windows SDK.

## <a name="coleclientitemcoleclientitem"></a><a name="coleclientitem"></a>COleClientItem::COleClientItem

Construye un `COleClientItem` objeto y lo agrega a la colección de elementos de documento del documento del documento contenedor, que construye solo el objeto C++ y no realiza ninguna inicialización OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parámetros

*pContainerDoc*<br/>
Puntero al documento contenedor que contendrá este elemento. Puede ser cualquier [COleDocument](../../mfc/reference/coledocument-class.md) derivado.

### <a name="remarks"></a>Observaciones

Si pasa un puntero NULL, no se realiza ninguna adición al documento contenedor. Debe llamar explícitamente [a COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).

Debe llamar a una de las siguientes funciones miembro de creación antes de usar el elemento OLE:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

## <a name="coleclientitemconvertto"></a><a name="convertto"></a>COleClientItem::ConvertTo

Llame a esta función miembro para convertir el elemento al tipo especificado por *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parámetros

*clsidNew*<br/>
El identificador de clase del tipo de destino.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Esto es llamado automáticamente por [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). No es necesario llamarlo directamente.

## <a name="coleclientitemcopytoclipboard"></a><a name="copytoclipboard"></a>COleClientItem::CopyToClipboard

Llame a esta función para copiar el elemento OLE en el Portapapeles.

```cpp
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parámetros

*bIncludeLink*<br/>
TRUESi la información del vínculo se debe copiar en el Portapapeles, lo que permite pegar un elemento vinculado; de lo contrario FALSO.

### <a name="remarks"></a>Observaciones

Normalmente, se llama a esta función al escribir controladores de mensajes para los comandos Copiar o Cortar desde el menú Editar. Debe implementar la selección de elementos en la aplicación contenedora si desea implementar los comandos Copiar o Cortar.

Para obtener más información, vea [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) en el Windows SDK.

## <a name="coleclientitemcreateclonefrom"></a><a name="createclonefrom"></a>COleClientItem::CreateCloneFrom

Llame a esta función para crear una copia del elemento OLE especificado.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parámetros

*pSrcItem*<br/>
Puntero al elemento OLE que se va a duplicar.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

La copia es idéntica al elemento de origen. Puede utilizar esta función para admitir operaciones de deshacer.

## <a name="coleclientitemcreatefromclipboard"></a><a name="createfromclipboard"></a>COleClientItem::CreateFromClipboard

Llame a esta función para crear un elemento incrustado a partir del contenido del Portapapeles.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*Render*<br/>
Marcador que especifica cómo el servidor representará el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *el renderizado* está OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del Portapapeles especificado por *cfFormat*. Si omite este parámetro, se utilizan valores predeterminados para los demás campos de la `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Normalmente se llama a esta función desde el controlador de mensajes para el comando Pegar en el menú Editar. (El comando Pegar está habilitado por el marco de trabajo si la función miembro [CanPaste](#canpaste) devuelve distinto de cero.)

Para obtener más información, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

## <a name="coleclientitemcreatefromdata"></a><a name="createfromdata"></a>COleClientItem::CreateFromData

Llame a esta función para `COleDataObject` crear un elemento incrustado a partir de un objeto.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero al objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) desde el que se va a crear el elemento OLE.

*Render*<br/>
Marcador que especifica cómo el servidor representará el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *el renderizado* está OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del Portapapeles especificado por *cfFormat*. Si omite este parámetro, se utilizan valores predeterminados para los demás campos de la `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Las operaciones de transferencia de datos, como pegar desde `COleDataObject` el Portapapeles o arrastrar y colocar, proporcionan objetos que contienen la información ofrecida por una aplicación de servidor. Normalmente se utiliza en la invalidación de [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).

Para obtener más información, vea [OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

## <a name="coleclientitemcreatefromfile"></a><a name="createfromfile"></a>COleClientItem::CreateFromFile

Llame a esta función para crear un elemento OLE incrustado a partir de un archivo.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*lpszFileName*<br/>
Puntero al nombre del archivo desde el que se va a crear el elemento OLE.

*clsid*<br/>
Reservado para uso futuro.

*Render*<br/>
Marcador que especifica cómo el servidor representará el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *el renderizado* está OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del Portapapeles especificado por *cfFormat*. Si omite este parámetro, se utilizan valores predeterminados para los demás campos de la `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

El marco de trabajo llama a esta función desde [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) si el usuario elige Aceptar desde el Insertar objeto cuadro de diálogo cuando el crear desde archivo botón está seleccionado.

Para obtener más información, vea [OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

## <a name="coleclientitemcreatelinkfromclipboard"></a><a name="createlinkfromclipboard"></a>COleClientItem::CreateLinkFromClipboard

Llame a esta función para crear un elemento vinculado a partir del contenido del Portapapeles.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*Render*<br/>
Marcador que especifica cómo el servidor representará el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *el renderizado* está OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del Portapapeles especificado por *cfFormat*. Si omite este parámetro, se utilizan valores predeterminados para los demás campos de la `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Normalmente se llama a esta función desde el controlador de mensajes para el comando Pegar vínculo en el menú Editar. (El comando Pegar vínculo está habilitado en la implementación predeterminada de [COleDocument](../../mfc/reference/coledocument-class.md) si el Portapapeles contiene un elemento OLE al que se puede vincular.)

Para obtener más información, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

## <a name="coleclientitemcreatelinkfromdata"></a><a name="createlinkfromdata"></a>COleClientItem::CreateLinkFromData

Llame a esta función para `COleDataObject` crear un elemento vinculado a partir de un objeto.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero al objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) desde el que se va a crear el elemento OLE.

*Render*<br/>
Marcador que especifica cómo el servidor representará el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *el renderizado* está OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del Portapapeles especificado por *cfFormat*. Si omite este parámetro, se utilizan valores predeterminados para los demás campos de la `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Llame a esto durante una operación de caída cuando el usuario indica que se debe crear un vínculo. También se puede utilizar para controlar el comando Editar pegar. Se llama por el `COleClientItem::CreateLinkFromClipboard` marco de trabajo en y en [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) cuando se ha seleccionado la opción vínculo.

Para obtener más información, vea [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

## <a name="coleclientitemcreatelinkfromfile"></a><a name="createlinkfromfile"></a>COleClientItem::CreateLinkFromFile

Llame a esta función para crear un elemento OLE vinculado a partir de un archivo.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*lpszFileName*<br/>
Puntero al nombre del archivo desde el que se va a crear el elemento OLE.

*Render*<br/>
Marcador que especifica cómo el servidor representará el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *el renderizado* está OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del Portapapeles especificado por *cfFormat*. Si omite este parámetro, se utilizan valores predeterminados para los demás campos de la `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

El marco de trabajo llama a esta función si el usuario elige Aceptar en el cuadro de diálogo Insertar objeto cuando se selecciona el botón Crear desde archivo y la casilla de verificación Vínculo. Se llama desde [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Para obtener más información, vea [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

## <a name="coleclientitemcreatenewitem"></a><a name="createnewitem"></a>COleClientItem::CreateNewItem

Llame a esta función para crear un elemento incrustado; esta función inicia la aplicación de servidor que permite al usuario crear el elemento OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*clsid*<br/>
Identificador que identifica de forma única el tipo de elemento OLE que se va a crear.

*Render*<br/>
Marcador que especifica cómo el servidor representará el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *el renderizado* está OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del Portapapeles especificado por *cfFormat*. Si omite este parámetro, se utilizan valores predeterminados para los demás campos de la `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

El marco de trabajo llama a esta función si el usuario elige Aceptar en el cuadro de diálogo Insertar objeto cuando se selecciona el botón Crear nuevo.

Para obtener más información, vea [OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

## <a name="coleclientitemcreatestaticfromclipboard"></a><a name="createstaticfromclipboard"></a>COleClientItem::CreateStaticFromClipboard

Llame a esta función para crear un elemento estático a partir del contenido del Portapapeles.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*Render*<br/>
Marcador que especifica cómo el servidor representará el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *el renderizado* está OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del Portapapeles especificado por *cfFormat*. Si omite este parámetro, se utilizan valores predeterminados para los demás campos de la `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Un elemento estático contiene los datos de presentación, pero no los datos nativos; por lo tanto, no se puede editar. Normalmente se llama a esta función si el [CreateFromClipboard](#createfromclipboard) función miembro produce un error.

Para obtener más información, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

## <a name="coleclientitemcreatestaticfromdata"></a><a name="createstaticfromdata"></a>COleClientItem::CreateStaticFromData

Llame a esta función para `COleDataObject` crear un elemento estático a partir de un objeto.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero al objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) desde el que se va a crear el elemento OLE.

*Render*<br/>
Marcador que especifica cómo el servidor representará el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *el renderizado* está OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del Portapapeles especificado por *cfFormat*. Si omite este parámetro, se utilizan valores predeterminados para los demás campos de la `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Un elemento estático contiene los datos de presentación, pero no los datos nativos; en consecuencia, no se puede editar. Esto es esencialmente lo mismo que [CreateStaticFromClipboard](#createstaticfromclipboard) excepto que un `COleDataObject`elemento estático se puede crear a partir de un arbitrario, no sólo desde el Portapapeles.

Se utiliza en [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) cuando se selecciona Estático.

Para obtener más información, vea [OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

## <a name="coleclientitemdeactivate"></a><a name="deactivate"></a>COleClientItem::Deactivate

Llame a esta función para desactivar el elemento OLE y liberar los recursos asociados.

```cpp
void Deactivate();
```

### <a name="remarks"></a>Observaciones

Normalmente se desactiva un elemento OLE activo in situ cuando el usuario hace clic en el mouse en el área de cliente fuera de los límites del elemento. Tenga en cuenta que la desactivación del elemento OLE descartará su estado de deshacer, lo que hace imposible llamar a la [ReactivateAndUndo](#reactivateandundo) función miembro.

Si la aplicación admite deshacer, `Deactivate`no llame a ; en su lugar, llame a [DeactivateUI](#deactivateui).

Para obtener más información, vea [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) en el Windows SDK.

## <a name="coleclientitemdeactivateui"></a><a name="deactivateui"></a>COleClientItem::DeactivateUI

Llame a esta función cuando el usuario desactive un elemento que se activó en su lugar.

```cpp
void DeactivateUI();
```

### <a name="remarks"></a>Observaciones

Esta función restaura la interfaz de usuario de la aplicación contenedora a su estado original, ocultando los menús y otros controles que se crearon para la activación en contexto.

Esta función no vacía la información de estado de deshacer para el elemento. Esa información se conserva para que [ReactivateAndUndo](#reactivateandundo) se pueda utilizar más adelante para ejecutar un comando de deshacer en la aplicación de servidor, en caso de que el comando de deshacer del contenedor se elija inmediatamente después de desactivar el elemento.

Para obtener más información, vea [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) en el Windows SDK.

## <a name="coleclientitemdelete"></a><a name="delete"></a>COleClientItem::Delete

Llame a esta función para eliminar el elemento OLE del documento contenedor.

```cpp
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parámetros

*bAutoDelete*<br/>
Especifica si el elemento se va a quitar del documento.

### <a name="remarks"></a>Observaciones

Esta función llama a la [Release](#release) función miembro, que a su vez elimina el C + + objeto para el elemento, quitando permanentemente el elemento OLE del documento. Si el elemento OLE está incrustado, se eliminan los datos nativos del elemento. Siempre cierra un servidor en ejecución; por lo tanto, si el elemento es un vínculo abierto, esta función lo cierra.

## <a name="coleclientitemdodragdrop"></a><a name="dodragdrop"></a>COleClientItem::DoDragDrop

Llame `DoDragDrop` a la función miembro para realizar una operación de arrastrar y colocar.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parámetros

*lpItemRect*<br/>
Rectángulo del elemento en la pantalla en coordenadas de cliente (píxeles).

*ptOffset*<br/>
Desplazamiento de *lpItemRect* donde estaba la posición del mouse en el momento del arrastre.

*bIncludeLink*<br/>
Establezca esta configuración en TRUE si los datos del vínculo se deben copiar en el Portapapeles. Establézcalo en FALSE si la aplicación de servidor no admite vínculos.

*dwEffects*<br/>
Determina los efectos que el origen de arrastre permitirá en la operación de arrastre.

*lpRectStartDrag*<br/>
Puntero al rectángulo que define dónde comienza realmente el arrastre. Para obtener más información, vea la sección Comentarios que se muestra más adelante.

### <a name="return-value"></a>Valor devuelto

Un valor DROPEFFECT. Si se DROPEFFECT_MOVE, se deben eliminar los datos originales.

### <a name="remarks"></a>Observaciones

La operación de arrastrar y colocar no se inicia inmediatamente. Espera hasta que el cursor del mouse deja el rectángulo especificado por *lpRectStartDrag* o hasta que haya pasado un número especificado de milisegundos. Si *lpRectStartDrag* es NULL, el tamaño del rectángulo es un píxel.

El tiempo de retardo se especifica mediante una configuración de clave del Registro. Puede cambiar la hora de retardo llamando a [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) o [CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Si no especifica el tiempo de retardo, se utiliza un valor predeterminado de 200 milisegundos. El tiempo de retardo de arrastre se almacena de la siguiente manera:

- El tiempo de retardo de arrastre de Windows NT se almacena en HKEY_LOCAL_MACHINE,SOFTWARE, Microsoft, Windows, NT, CurrentVersion, IniFileMapping, win.ini, Windows y DragDelay.

- Windows 3.x El tiempo de retardo de arrastre se almacena en el WIN. INI, en la sección [Windows.

- Windows 95/98 El tiempo de retardo de arrastre se almacena en una versión almacenada en caché de WIN. Ini.

Para obtener más información sobre cómo se almacena la información de retardo de arrastre en el registro o en el archivo . INI, vea [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) en el Windows SDK.

## <a name="coleclientitemdoverb"></a><a name="doverb"></a>COleClientItem::DoVerb

Llame `DoVerb` para ejecutar el verbo especificado.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parámetros

*nVerb*<br/>
Especifica el verbo que se va a ejecutar. Puede incluir uno de los siguientes:

|Value|Significado|Símbolo|
|-----------|-------------|------------|
|- 0|verbo principal|OLEIVERB_PRIMARY|
|- 1|Verbo secundario|(Ninguna)|
|- 1|Mostrar elemento para editar|OLEIVERB_SHOW|
|- 2|Editar elemento en una ventana separada|OLEIVERB_OPEN|
|- 3|Ocultar artículo|OLEIVERB_HIDE|

El valor -1 suele ser un alias para otro verbo. Si no se admite la edición abierta, -2 tiene el mismo efecto que -1. Para obtener valores adicionales, vea [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) en el Windows SDK.

*pView*<br/>
Puntero a la ventana de vista; esto es utilizado por el servidor para la activación en contexto. Este parámetro debe ser NULL si la aplicación contenedora no permite la activación en contexto.

*lpMsg*<br/>
Puntero al mensaje que provocó la activación del elemento.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el verbo se ejecutó correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Esta función llama a la [función](#activate) miembro Activate para ejecutar el verbo. También detecta excepciones y muestra un cuadro de mensaje al usuario si se produce uno.

Si el verbo principal es Editar y se especifica cero en el parámetro *nVerb,* se inicia la aplicación de servidor para permitir que se edite el elemento OLE. Si la aplicación contenedora admite la activación in situ, la edición se puede realizar en su lugar. Si el contenedor no admite la activación in situ (o si se especifica el verbo Abrir), el servidor se inicia en una ventana independiente y la edición se puede realizar allí. Normalmente, cuando el usuario de la aplicación contenedora hace doble clic en el elemento OLE, el valor del verbo principal en el *nVerb* parámetro determina qué acción puede realizar el usuario. Sin embargo, si el servidor solo admite una acción, realiza esa acción, independientemente del valor especificado en el parámetro *nVerb.*

## <a name="coleclientitemdraw"></a><a name="draw"></a>COleClientItem::Draw

Llame a esta función para dibujar el elemento OLE en el rectángulo delimitador especificado mediante el contexto de dispositivo especificado.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Puntero a un objeto [CDC](../../mfc/reference/cdc-class.md) utilizado para dibujar el elemento OLE.

*lpBounds*<br/>
Puntero a un [CRect](../../atl-mfc-shared/reference/crect-class.md) objeto o `RECT` estructura que define el rectángulo delimitador en el que se va a dibujar el elemento OLE (en unidades lógicas determinadas por el contexto del dispositivo).

*nDrawAspect*<br/>
Especifica el aspecto del elemento OLE, es decir, cómo se debe mostrar. Si *nDrawAspect* es -1, se utiliza el último aspecto establecido mediante [SetDrawAspect.](#setdrawaspect) Para obtener más información acerca de los valores posibles para esta marca, vea [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

La función puede utilizar la representación de metarchivo del `COleServerItem`elemento OLE creado por la función miembro [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) de .

Normalmente se `Draw` utiliza para la visualización de pantalla, pasando el contexto del dispositivo de pantalla como *pDC*. En este caso, debe especificar solo los dos primeros parámetros.

El parámetro *lpBounds* identifica el rectángulo en el contexto del dispositivo de destino (en relación con su modo de asignación actual). La representación puede implicar la escala de la imagen y puede ser utilizada por las aplicaciones contenedoras para imponer una vista que se escala entre la vista mostrada y la imagen impresa final.

Para obtener más información, vea [IViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) en el Windows SDK.

## <a name="coleclientitemgetactiveview"></a><a name="getactiveview"></a>COleClientItem::GetActiveView

Devuelve la vista en la que el elemento está activado in situ.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Valor devuelto

Un puntero a la vista; DE lo contrario NULL si el elemento no está activado en contexto.

## <a name="coleclientitemgetcachedextent"></a><a name="getcachedextent"></a>COleClientItem::GetCachedExtent

Llame a esta función para recuperar el tamaño del elemento OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parámetros

*lpSize*<br/>
Puntero a `SIZE` una estructura o un [CSize](../../atl-mfc-shared/reference/csize-class.md) objeto que recibirá la información de tamaño.

*nDrawAspect*<br/>
Especifica el aspecto del elemento OLE cuyos límites se van a recuperar. Para ver los valores posibles, consulte [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 si el elemento OLE está en blanco.

### <a name="remarks"></a>Observaciones

Esta función proporciona la misma información que [GetExtent](#getextent). Sin embargo, `GetCachedExtent` puede llamar para obtener información de extensión durante el procesamiento de otros controladores OLE, como [OnChange](#onchange). Las cotas están en unidades MM_HIMETRIC.

Esto es `GetCachedExtent` posible porque utiliza la interfaz [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) en lugar de usar la interfaz [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) para obtener la extensión de este elemento. El `IViewObject2` objeto COM almacena en caché la información de extensión utilizada en la llamada anterior a [IViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Para obtener más información, vea [IViewObject2::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) en el Windows SDK.

## <a name="coleclientitemgetclassid"></a><a name="getclassid"></a>COleClientItem::GetClassID

Devuelve el identificador de clase del elemento en la memoria a la que apunta *pClassID*.

```cpp
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parámetros

*pClassID*<br/>
Puntero a un identificador de tipo [CLSID](/windows/win32/com/clsid-key-hklm) para recuperar el identificador de clase. Para obtener información sobre CLSID, consulte el Windows SDK.

### <a name="remarks"></a>Observaciones

El identificador de clase es un número de 128 bits que identifica de forma única la aplicación que edita el elemento.

Para obtener más información, vea [IPersist::GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) en el Windows SDK.

## <a name="coleclientitemgetclipboarddata"></a><a name="getclipboarddata"></a>COleClientItem::GetClipboardData

Llame a esta `COleDataSource` función para obtener un objeto que contiene todos los datos que se colocarían en el Portapapeles mediante una llamada a la [CopyToClipboard](#copytoclipboard) función miembro.

```cpp
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataSource*<br/>
Puntero a un [COleDataSource](../../mfc/reference/coledatasource-class.md) objeto que recibirá los datos contenidos en el elemento OLE.

*bIncludeLink*<br/>
TRUESi se deben incluir datos de vínculo; de lo contrario FALSO.

*lpOffset*<br/>
Desplazamiento del cursor del ratón desde el origen del objeto en píxeles.

*lpSize*<br/>
El tamaño del objeto en píxeles.

### <a name="remarks"></a>Observaciones

`GetClipboardData`se llama como la implementación predeterminada de [OnGetClipboardData](#ongetclipboarddata). Invalide `OnGetClipboardData` sólo si desea ofrecer formatos de `CopyToClipboard`datos además de los ofrecidos por . Coloque esos formatos en `COleDataSource` el `CopyToClipboard`objeto antes `COleDataSource` o después de llamar y, a continuación, pase el objeto a la [Función COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) . Por ejemplo, si desea que la posición del elemento OLE en su documento contenedor lo acompañe en el `COleDataSource` Portapapeles, definiría su propio formato para pasar esa información y la colocaría en el antes de llamar. `CopyToClipboard`

## <a name="coleclientitemgetdocument"></a><a name="getdocument"></a>COleClientItem::GetDocument

Llame a esta función para obtener un puntero al documento que contiene el elemento OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Valor devuelto

Puntero al documento que contiene el elemento OLE. NULL si el elemento no forma parte de un documento.

### <a name="remarks"></a>Observaciones

Este puntero permite `COleDocument` el acceso al objeto que `COleClientItem` pasó como argumento al constructor.

## <a name="coleclientitemgetdrawaspect"></a><a name="getdrawaspect"></a>COleClientItem::GetDrawAspect

Llame `GetDrawAspect` a la función miembro para determinar el "aspecto" o vista actual del elemento.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Valor devuelto

Valor de la enumeración DVASPECT, cuyos valores se enumeran en la referencia de [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Observaciones

El aspecto especifica cómo se va a representar el elemento.

## <a name="coleclientitemgetextent"></a><a name="getextent"></a>COleClientItem::GetExtent

Llame a esta función para recuperar el tamaño del elemento OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parámetros

*lpSize*<br/>
Puntero a `SIZE` una `CSize` estructura o un objeto que recibirá la información de tamaño.

*nDrawAspect*<br/>
Especifica el aspecto del elemento OLE cuyos límites se van a recuperar. Para ver los valores posibles, consulte [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 si el elemento OLE está en blanco.

### <a name="remarks"></a>Observaciones

Si la aplicación de servidor se escribió mediante la biblioteca Microsoft Foundation `COleServerItem` Class, esta función hace que se llame a la función miembro [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) del objeto correspondiente. Tenga en cuenta que el tamaño recuperado puede diferir del último tamaño establecido por el [SetExtent](#setextent) función miembro; el tamaño especificado `SetExtent` por se trata como una sugerencia. Las cotas están en unidades MM_HIMETRIC.

> [!NOTE]
> No llame `GetExtent` durante el procesamiento de un controlador OLE, como [OnChange](#onchange). Llame a [GetCachedExtent](#getcachedextent) en su lugar.

Para obtener más información, vea [IOleObject::GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) en el Windows SDK.

## <a name="coleclientitemgeticonfromregistry"></a><a name="geticonfromregistry"></a>COleClientItem::GetIconFromRegistry

Llame a esta función miembro para recuperar un identificador de un recurso de icono asociado con el servidor de un CLSID determinado.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parámetros

*clsid*<br/>
Una referencia al CLSID para el servidor asociado con el icono.

### <a name="return-value"></a>Valor devuelto

No se puede encontrar un identificador válido para el recurso de icono, o NULL si no se encuentra el icono del servidor, o un icono predeterminado.

### <a name="remarks"></a>Observaciones

Esta función miembro no iniciará el servidor ni obtendrá un icono dinámicamente, incluso si el servidor ya se está ejecutando. En su lugar, esta función miembro abre la imagen ejecutable del servidor y recupera el icono estático asociado con el servidor tal como se registró.

## <a name="coleclientitemgeticonicmetafile"></a><a name="geticonicmetafile"></a>COleClientItem::GetIconicMetafile

Recupera el metarchivo utilizado para dibujar el icono del elemento.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Valor devuelto

Un identificador del metarchivo si se realiza correctamente; NULL.

### <a name="remarks"></a>Observaciones

Si no hay ningún icono actual, se devuelve un icono predeterminado. Esto se llama automáticamente por los cuadros de diálogo MFC/OLE y normalmente no se llama directamente.

Esta función también llama a [SetIconicMetafile](#seticonicmetafile) para almacenar en caché el metarchivo para su uso posterior.

## <a name="coleclientitemgetinplacewindow"></a><a name="getinplacewindow"></a>COleClientItem::GetInPlaceWindow

Llame `GetInPlaceWindow` a la función miembro para obtener un puntero a la ventana en la que se ha abierto el elemento para la edición in situ.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Valor devuelto

Un puntero a la ventana de edición in situ del elemento; NULL si el elemento no está activo o si su servidor no está disponible.

### <a name="remarks"></a>Observaciones

Esta función debe llamarse solo para los elementos que están activos en el lugar.

## <a name="coleclientitemgetitemstate"></a><a name="getitemstate"></a>COleClientItem::GetItemState

Llame a esta función para obtener el estado actual del elemento OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Valor devuelto

Un `COleClientItem::ItemState` valor enumerado, que puede ser `emptyState` `loadedState`uno `openState` `activeState`de `activeUIState`los siguientes: , , , , . Para obtener información acerca de estos estados, vea el artículo [Contenedores: Estados de elementos](../../mfc/containers-client-item-states.md)de cliente .

### <a name="remarks"></a>Observaciones

Para recibir una notificación cuando cambia el estado del elemento OLE, utilice la [OnChange](#onchange) función miembro.

Para obtener más información, consulte el artículo [Contenedores: Estados de elementos](../../mfc/containers-client-item-states.md)de cliente .

## <a name="coleclientitemgetlaststatus"></a><a name="getlaststatus"></a>COleClientItem::GetLastStatus

Devuelve el código de estado de la última operación OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Valor devuelto

Un valor SCODE.

### <a name="remarks"></a>Observaciones

Para las funciones miembro que devuelven un valor BOOL `GetLastStatus` de FALSE u otras funciones miembro que devuelven NULL, devuelve información de error más detallada. Tenga en cuenta que la mayoría de las funciones miembro OLE producen excepciones para errores más graves. La información específica sobre la interpretación de la SCODE depende de la llamada OLE subyacente que devolvió por última vez un SCODE valor.

Para obtener más información sobre SCODE, consulte [Estructura de códigos de error COM](/windows/win32/com/structure-of-com-error-codes) en la documentación de Windows SDK.

## <a name="coleclientitemgetlinkupdateoptions"></a><a name="getlinkupdateoptions"></a>COleClientItem::GetLinkUpdateOptions

Llame a esta función para obtener el valor actual de la opción de actualización de vínculos para el elemento OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Valor devuelto

Uno de los valores siguientes:

- OLEUPDATE_ALWAYS Actualice el elemento vinculado siempre que sea posible. Esta opción admite el botón de opción Actualización automática de vínculos en el cuadro de diálogo Vínculos.

- OLEUPDATE_ONCALL Actualizar el elemento vinculado solo a petición de la aplicación contenedora (cuando se llama a la [updateLink](#updatelink) función miembro). Esta opción admite el botón de opción Actualización manual de vínculos en el cuadro de diálogo Vínculos.

### <a name="remarks"></a>Observaciones

Esta es una operación avanzada.

Esta función se llama automáticamente por la [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) clase.

Para obtener más información, vea [IOleLink::GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) en el Windows SDK.

## <a name="coleclientitemgettype"></a><a name="gettype"></a>COleClientItem::GetType

Llame a esta función para determinar si el elemento OLE está incrustado o vinculado, o estático.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Valor devuelto

Un entero sin signo con uno de los siguientes valores:

- OT_LINK El elemento OLE es un vínculo.

- OT_EMBEDDED se incrusta el elemento OLE.

- OT_STATIC El elemento OLE es estático, es decir, contiene solo datos de presentación, no datos nativos y, por lo tanto, no se puede editar.

## <a name="coleclientitemgetusertype"></a><a name="getusertype"></a>COleClientItem::GetUserType

Llame a esta función para obtener la cadena visible para el usuario que describe el tipo del elemento OLE, como "documento de Word."

```cpp
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parámetros

*nUserClassType*<br/>
Valor que indica la variante deseada de la cadena que describe el tipo del elemento OLE. Esto puede tener uno de los siguientes valores:

- USERCLASSTYPE_FULL El nombre de tipo completo que se muestra al usuario.

- USERCLASSTYPE_SHORT Un nombre corto (máximo de 15 caracteres) para su uso en los menús emergentes y el cuadro de diálogo Editar vínculos.

- USERCLASSTYPE_APPNAME Nombre de la aplicación que da servicio a la clase.

*rString*<br/>
Una referencia a un [CString](../../atl-mfc-shared/reference/cstringt-class.md) objeto al que se va a devolver la cadena que describe el tipo del elemento OLE.

### <a name="remarks"></a>Observaciones

Esta es a menudo la entrada en la base de datos de registro del sistema.

Si se solicita el nombre de tipo completo pero no está disponible, se utiliza el nombre corto en su lugar. Si no se encuentra ninguna entrada para el tipo de elemento OLE en la base de datos de registro, o si no hay ningún tipo de usuario registrado para el tipo de elemento OLE, se usa el tipo de usuario almacenado actualmente en el elemento OLE. Si ese nombre de tipo de usuario es una cadena vacía, se utiliza "Objeto desconocido".

Para obtener más información, vea [IOleObject::GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) en el Windows SDK.

## <a name="coleclientitemisinplaceactive"></a><a name="isinplaceactive"></a>COleClientItem::IsInPlaceActive

Llame a esta función para ver si el elemento OLE está activo en el lugar.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE está activo en el lugar; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Es común ejecutar una lógica diferente dependiendo de si el elemento se está editando en su lugar. La función comprueba si el estado del `activeState` elemento `activeUIState`actual es igual al archivo .

## <a name="coleclientitemislinkuptodate"></a><a name="islinkuptodate"></a>COleClientItem::IsLinkUpToDate

Llame a esta función para ver si el elemento OLE está actualizado.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE está actualizado; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Un elemento vinculado puede estar desactualizado si se ha actualizado su documento de origen. Un elemento incrustado que contiene vínculos dentro de él puede quedar desactualizado. La función realiza una comprobación recursiva del elemento OLE. Tenga en cuenta que determinar si un elemento OLE está desactualizado puede ser tan costoso como realizar realmente una actualización.

Esto se llama automáticamente por el [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) implementación.

Para obtener más información, vea [IOleObject::IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) en el Windows SDK.

## <a name="coleclientitemismodified"></a><a name="ismodified"></a>COleClientItem::IsModified

Llame a esta función para ver si el elemento OLE está sucio (modificado desde la última vez que se guardó).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE está sucio; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Para obtener más información, vea [IPersistStorage::IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) en el Windows SDK.

## <a name="coleclientitemisopen"></a><a name="isopen"></a>COleClientItem::IsOpen

Llame a esta función para ver si el elemento OLE está abierto; es decir, se abre en una instancia de la aplicación de servidor que se ejecuta en una ventana independiente.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE está abierto; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Se utiliza para determinar cuándo dibujar el objeto con un patrón de sombreado. Un objeto abierto debe tener un patrón de sombreado dibujado en cima del objeto. Puede usar un [CRectTracker](../../mfc/reference/crecttracker-class.md) objeto para lograr esto.

## <a name="coleclientitemisrunning"></a><a name="isrunning"></a>COleClientItem::IsRunning

Llame a esta función para ver si el elemento OLE se está ejecutando; es decir, si el elemento se carga y se ejecuta en la aplicación de servidor.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE se está ejecutando; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Para obtener más información, consulte [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) en el Windows SDK.

## <a name="coleclientitemonactivate"></a><a name="onactivate"></a>COleClientItem::OnActivate

Llamado por el marco de trabajo para notificar al elemento que se acaba de activar en su lugar.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Observaciones

Tenga en cuenta que esta función se llama para indicar que el servidor se está ejecutando, no para indicar que su interfaz de usuario se ha instalado en la aplicación contenedora. En este momento, el objeto no tiene una `activeUIState`interfaz de usuario activa (no lo es ). No ha instalado sus menús o barra de herramientas. El [OnActivateUI](#onactivateui) se llama a la función miembro cuando eso sucede.

La implementación predeterminada llama a la [OnChange](#onchange) función miembro con OLE_CHANGEDSTATE como un parámetro. Reemplace esta función para realizar un procesamiento personalizado cuando un elemento se active in situ.

## <a name="coleclientitemonactivateui"></a><a name="onactivateui"></a>COleClientItem::OnActivateUI

El marco `OnActivateUI` de trabajo llama cuando el objeto ha entrado en el estado de interfaz de usuario activa.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Observaciones

El objeto ha instalado ahora la barra de herramientas y los menús.

La implementación predeterminada recuerda el HWND `GetServerWindow` del servidor para llamadas posteriores.

## <a name="coleclientitemonchange"></a><a name="onchange"></a>COleClientItem::OnChange

Llamado por el marco de trabajo cuando el usuario modifica, guarda o cierra el elemento OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parámetros

*nCódigo*<br/>
La razón por la que el servidor cambió este elemento. Puede tener uno de los siguientes valores:

- OLE_CHANGED La apariencia del elemento OLE ha cambiado.

- OLE_SAVED se ha guardado el elemento OLE.

- OLE_CLOSED se ha cerrado el elemento OLE.

- OLE_CHANGED_STATE el elemento OLE ha cambiado de un estado a otro.

*dwParam*<br/>
Si *nCode* es OLE_SAVED o OLE_CLOSED, no se utiliza este parámetro. Si *nCode* se OLE_CHANGED, este parámetro especifica el aspecto del elemento OLE que ha cambiado. Para ver los valores posibles, consulte el parámetro *dwParam* de [COleClientItem::Draw](#draw). Si *nCode* se OLE_CHANGED_STATE, `COleClientItem::ItemState` este parámetro es un valor enumerado y describe el estado que se está introduciendo. Puede tener uno de los `emptyState` `loadedState`siguientes `openState` `activeState`valores: `activeUIState`, , , , o .

### <a name="remarks"></a>Observaciones

(Si la aplicación de servidor se escribe mediante la biblioteca microsoft `Notify` Foundation `COleServerDoc` Class, se llama a esta función en respuesta a las funciones miembro de o `COleServerItem`.) La implementación predeterminada marca el documento contenedor como modificado si *nCode* está OLE_CHANGED o OLE_SAVED.

Por OLE_CHANGED_STATE, el estado actual devuelto desde [GetItemState](#getitemstate) seguirá siendo el estado antiguo, lo que significa que el estado que era actual antes de este cambio de estado.

Invalide esta función para responder a los cambios en el estado del elemento OLE. Normalmente se actualiza la apariencia del elemento invalidando el área en la que se muestra el elemento. Llame a la implementación de la clase base al principio de la invalidación.

## <a name="coleclientitemonchangeitemposition"></a><a name="onchangeitemposition"></a>COleClientItem::OnChangeItemPosition

Llamado por el marco de trabajo para notificar al contenedor que la extensión del elemento OLE ha cambiado durante la activación en contexto.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parámetros

*rectPos*<br/>
Indica la posición del elemento en relación con el área de cliente de la aplicación contenedora.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la posición del elemento se cambia correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada determina el nuevo rectángulo visible del elemento OLE y llama a [SetItemRects](#setitemrects) con los nuevos valores. La implementación predeterminada calcula el rectángulo visible para el elemento y pasa esa información al servidor.

Reemplace esta función para aplicar reglas especiales a la operación de cambio de tamaño/movimiento. Si la aplicación se escribe en MFC, esta llamada se produce porque el servidor denominado [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

## <a name="coleclientitemondeactivate"></a><a name="ondeactivate"></a>COleClientItem::OnDeactivate

Llamado por el marco de trabajo cuando el elemento `activeState`OLE pasa del estado activo en contexto ( ) al estado cargado, lo que significa que se desactiva después de una activación en contexto.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Observaciones

Tenga en cuenta que esta función se llama para indicar que el elemento OLE está cerrado, no que su interfaz de usuario se ha quitado de la aplicación contenedora. Cuando eso sucede, el [OnDeactivateUI](#ondeactivateui) se llama a la función miembro.

La implementación predeterminada llama a la [OnChange](#onchange) función miembro con OLE_CHANGEDSTATE como un parámetro. Reemplace esta función para realizar un procesamiento personalizado cuando se desactiva un elemento activo in situ. Por ejemplo, si admite el comando undo en la aplicación contenedora, puede invalidar esta función para descartar el estado de deshacer, lo que indica que la última operación realizada en el elemento OLE no se puede deshacer una vez que se desactiva el elemento.

## <a name="coleclientitemondeactivateandundo"></a><a name="ondeactivateandundo"></a>COleClientItem::OnDeactivateAndUndo

Llamado por el marco de trabajo cuando el usuario invoca el comando undo después de activar el elemento OLE en su lugar.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada llama a [DeactivateUI](#deactivateui) para desactivar la interfaz de usuario del servidor. Invalide esta función si está implementando el comando undo en la aplicación contenedora. En la invalidación, llame a la versión de la clase base de la función y, a continuación, deshaga el último comando ejecutado en la aplicación.

Para obtener más información, vea [IOleInPlaceSite::DeactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) en el Windows SDK.

## <a name="coleclientitemondeactivateui"></a><a name="ondeactivateui"></a>COleClientItem::OnDeactivateUI

Se llama cuando el usuario desactiva un elemento que se activó en su lugar.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parámetros

*bUndoable*<br/>
Especifica si los cambios de edición son no realizables.

### <a name="remarks"></a>Observaciones

Esta función restaura la interfaz de usuario de la aplicación contenedora a su estado original, ocultando los menús y otros controles que se crearon para la activación en contexto.

Si *bUndoable* es FALSE, el contenedor debe deshabilitar el comando undo, descartando de hecho el estado de deshacer del contenedor, porque indica que la última operación realizada por el servidor no se puede deshacer.

## <a name="coleclientitemondiscardundostate"></a><a name="ondiscardundostate"></a>COleClientItem::OnDiscardUndoState

Llamado por el marco de trabajo cuando el usuario realiza una acción que descarta el estado de deshacer al editar el elemento OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Observaciones

La implementación predeterminada no hace nada. Invalide esta función si está implementando el comando undo en la aplicación contenedora. En la invalidación, deseche el estado de deshacer de la aplicación contenedora.

Si el servidor se ha escrito con la biblioteca Microsoft Foundation Class, el servidor puede hacer que se llame a esta función llamando a [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Para obtener más información, vea [IOleInPlaceSite::DiscardUndoState](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) en el Windows SDK.

## <a name="coleclientitemongetclipboarddata"></a><a name="ongetclipboarddata"></a>COleClientItem::OnGetClipboardData

Llamado por el marco `COleDataSource` de trabajo para obtener un objeto que contiene todos los datos que se colocarían en el Portapapeles mediante una llamada a la [CopyToClipboard](#copytoclipboard) o el [DoDragDrop](#dodragdrop) función miembro.

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parámetros

*bIncludeLink*<br/>
Establezca esta configuración en TRUE si los datos de vínculo se deben copiar en el Portapapeles. Establezca esta configuración en FALSE si la aplicación de servidor no admite vínculos.

*lpOffset*<br/>
Puntero al desplazamiento del cursor del ratón desde el origen del objeto en píxeles.

*lpSize*<br/>
Puntero al tamaño del objeto en píxeles.

### <a name="return-value"></a>Valor devuelto

Un puntero a un [COleDataSource](../../mfc/reference/coledatasource-class.md) objeto que contiene el Portapapeles datos.

### <a name="remarks"></a>Observaciones

La implementación predeterminada de esta función llama a [GetClipboardData](#getclipboarddata).

## <a name="coleclientitemongetcliprect"></a><a name="ongetcliprect"></a>COleClientItem::OnGetClipRect

El marco `OnGetClipRect` de trabajo llama a la función miembro para obtener las coordenadas de rectángulo de recorte del elemento que se está editando en su lugar.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parámetros

*rClipRect*<br/>
Puntero a un objeto de la clase [CRect](../../atl-mfc-shared/reference/crect-class.md) que contendrá las coordenadas del rectángulo delimitador del elemento.

### <a name="remarks"></a>Observaciones

Las coordenadas están en píxeles en relación con el área de cliente de la ventana de aplicación contenedora.

La implementación predeterminada simplemente devuelve el rectángulo de cliente de la vista en la que el elemento está activo en el lugar.

## <a name="coleclientitemongetitemposition"></a><a name="ongetitemposition"></a>COleClientItem::OnGetItemPosition

El marco `OnGetItemPosition` de trabajo llama a la función miembro para obtener las coordenadas del elemento que se está editando en su lugar.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parámetros

*rPosición*<br/>
Referencia al objeto [CRect](../../atl-mfc-shared/reference/crect-class.md) que contendrá las coordenadas de posición del elemento.

### <a name="remarks"></a>Observaciones

Las coordenadas están en píxeles en relación con el área de cliente de la ventana de aplicación contenedora.

La implementación predeterminada de esta función no hace nada. Las aplicaciones que admiten la edición in situ requieren su implementación.

## <a name="coleclientitemongetwindowcontext"></a><a name="ongetwindowcontext"></a>COleClientItem::OnGetWindowContext

Llamado por el marco de trabajo cuando un elemento se activa en su lugar.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parámetros

*ppMainFrame*<br/>
Puntero a un puntero a la ventana de marco principal.

*ppDocFrame*<br/>
Puntero a un puntero a la ventana de marco de documento.

*lpFrameInfo*<br/>
Puntero a una estructura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) que recibirá información de ventana de marco.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Esta función se utiliza para recuperar información sobre la ventana primaria del elemento OLE.

Si el contenedor es una aplicación MDI, la implementación predeterminada devuelve un puntero al objeto [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) en *ppMainFrame* y un puntero al objeto [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) activo en *ppDocFrame*. Si el contenedor es una aplicación SDI, la implementación predeterminada devuelve un puntero al objeto [CFrameWnd](../../mfc/reference/cframewnd-class.md) en *ppMainFrame* y devuelve NULL en *ppDocFrame*. La implementación predeterminada también rellena los miembros de *lpFrameInfo*.

Invalide esta función solo si la implementación predeterminada no se adapta a la aplicación; por ejemplo, si la aplicación tiene un paradigma de interfaz de usuario que difiere de SDI o MDI. Este es un avanzado reemplazable.

Para obtener más información, vea [IOleInPlaceSite::GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) y la estructura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) en el Windows SDK.

## <a name="coleclientitemoninsertmenus"></a><a name="oninsertmenus"></a>COleClientItem::OnInsertMenus

Llamado por el marco de trabajo durante la activación en contexto para insertar los menús de la aplicación contenedora en un menú vacío.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parámetros

*pMenuShared*<br/>
Apunta a un menú vacío.

*lpMenuWidths*<br/>
Apunta a una matriz de seis valores LONG que indica cuántos menús hay en cada uno de los siguientes grupos de menús: Archivo, Editar, Contenedor, Objeto, Ventana, Ayuda. La aplicación contenedora es responsable de los grupos de menú Archivo, Contenedor y Ventana, correspondientes a los elementos 0, 2 y 4 de esta matriz.

### <a name="remarks"></a>Observaciones

A continuación, este menú se pasa al servidor, que inserta sus propios menús, creando un menú compuesto. Esta función se puede llamar repetidamente para crear varios menús compuestos.

La implementación predeterminada inserta en *pMenuShared* los menús contenedor in situ; es decir, los grupos de menú Archivo, Contenedor y Ventana. [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) se utiliza para establecer este recurso de menú. La implementación predeterminada también asigna los valores adecuados a los elementos 0, 2 y 4 en *lpMenuWidths*, dependiendo del recurso de menú. Invalide esta función si la implementación predeterminada no es adecuada para la aplicación; por ejemplo, si la aplicación no utiliza plantillas de documento para asociar recursos con tipos de documento. Si invalida esta función, también debe invalidar [OnSetMenu](#onsetmenu) y [OnRemoveMenus](#onremovemenus). Este es un avanzado reemplazable.

Para obtener más información, vea [IOleInPlaceFrame::InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) en el Windows SDK.

## <a name="coleclientitemonremovemenus"></a><a name="onremovemenus"></a>COleClientItem::OnRemoveMenus

Llamado por el marco de trabajo para quitar los menús del contenedor del menú compuesto especificado cuando finaliza la activación en contexto.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parámetros

*pMenuShared*<br/>
Apunta al menú compuesto construido por llamadas a la [OnInsertMenus](#oninsertmenus) función miembro.

### <a name="remarks"></a>Observaciones

La implementación predeterminada quita de *pMenuShared* los menús de contenedor en el lugar, es decir, los grupos de menús Archivo, Contenedor y Ventana. Invalide esta función si la implementación predeterminada no es adecuada para la aplicación; por ejemplo, si la aplicación no utiliza plantillas de documento para asociar recursos con tipos de documento. Si invalida esta función, probablemente debería invalidar [OnInsertMenus](#oninsertmenus) y [OnSetMenu](#onsetmenu) también. Este es un avanzado reemplazable.

Los submenús de *pMenuShared* pueden ser compartidos por más `OnInsertMenus`de un menú compuesto si el servidor ha llamado repetidamente . Por lo tanto, no debe eliminar `OnRemoveMenus`ningún submenú en la invalidación de ; sólo debe separarlos.

Para obtener más información, vea [IOleInPlaceFrame::RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) en el Windows SDK.

## <a name="coleclientitemonscrollby"></a><a name="onscrollby"></a>COleClientItem::OnScrollBy

Llamado por el marco de trabajo para desplazar el elemento OLE en respuesta a las solicitudes del servidor.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parámetros

*sizeExtent*<br/>
Especifica las distancias, en píxeles, para desplazarse en las direcciones x e y.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento se ha desplazado; 0 si no se pudo desplazar el elemento.

### <a name="remarks"></a>Observaciones

Por ejemplo, si el elemento OLE es parcialmente visible y el usuario se mueve fuera de la región visible mientras realiza la edición in situ, se llama a esta función para mantener el cursor visible. La implementación predeterminada no hace nada. Reemplace esta función para desplazar el elemento por la cantidad especificada. Tenga en cuenta que, como resultado del desplazamiento, la parte visible del elemento OLE puede cambiar. Llame a [SetItemRects](#setitemrects) para actualizar el rectángulo visible del elemento.

Para obtener más información, vea [IOleInPlaceSite::Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) en el Windows SDK.

## <a name="coleclientitemonsetmenu"></a><a name="onsetmenu"></a>COleClientItem::OnSetMenu

Llamado por el marco de trabajo dos veces cuando la activación en contexto comienza y termina; la primera vez que se instala el menú compuesto y la segunda vez (con *holemenu* igual a NULL) para eliminarlo.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parámetros

*pMenuShared*<br/>
Puntero al menú compuesto construido mediante llamadas a la `InsertMenu` [OnInsertMenus](#oninsertmenus) función miembro y la función.

*holemenu*<br/>
Controlar el descriptor de `OleCreateMenuDescriptor` menú devuelto por la función, o NULL si se va a quitar el código de distribución.

*hwndActiveObject*<br/>
Controle la ventana de edición del elemento OLE. Esta es la ventana que recibirá comandos de edición de OLE.

### <a name="remarks"></a>Observaciones

La implementación predeterminada instala o quita el menú compuesto y, a continuación, llama a la función [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) para instalar o quitar el código de distribución. Invalide esta función si la implementación predeterminada no es adecuada para la aplicación. Si invalida esta función, probablemente debería reemplazar [OnInsertMenus](#oninsertmenus) y [OnRemoveMenus](#onremovemenus) también. Este es un avanzado reemplazable.

Para obtener más información, vea [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)y [IOleInPlaceFrame::SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) en el Windows SDK .

## <a name="coleclientitemonshowcontrolbars"></a><a name="onshowcontrolbars"></a>COleClientItem::OnShowControlBars

Llamado por el marco de trabajo para mostrar y ocultar las barras de control de la aplicación contenedora.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parámetros

*pFrameWnd*<br/>
Puntero a la ventana de marco de la aplicación contenedora. Puede ser una ventana de marco principal o una ventana secundaria MDI.

*bMostrar*<br/>
Especifica si las barras de control deben mostrarse u ocultarse.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada de función provoca un cambio en el estado de las barras de control; 0 si la llamada no provoca ningún cambio, o si *pFrameWnd* no apunta a la ventana de marco del contenedor.

### <a name="remarks"></a>Observaciones

Esta función devuelve 0 si las barras de control ya están en el estado especificado por *bShow.* Esto ocurriría, por ejemplo, si las barras de control están ocultas y *bShow* es FALSE.

La implementación predeterminada quita la barra de herramientas de la ventana de marco de nivel superior.

## <a name="coleclientitemonshowitem"></a><a name="onshowitem"></a>COleClientItem::OnShowItem

Llamado por el marco de trabajo para mostrar el elemento OLE, por lo que es totalmente visible durante la edición.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Observaciones

Se utiliza cuando la aplicación contenedora admite vínculos a elementos incrustados (es decir, si ha derivado la clase de documento de [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Esta función se llama durante la activación en contexto o cuando el elemento OLE es un origen de vínculo y el usuario desea editarlo. La implementación predeterminada activa la primera vista en el documento contenedor. Invalide esta función para desplazar el documento para que el elemento OLE esté visible.

## <a name="coleclientitemonupdateframetitle"></a><a name="onupdateframetitle"></a>COleClientItem::OnUpdateFrameTitle

Llamado por el marco de trabajo durante la activación en contexto para actualizar la barra de título de la ventana de marco.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si esta función actualizó correctamente el título del fotograma, de lo contrario cero.

### <a name="remarks"></a>Observaciones

La implementación predeterminada no cambia el título de la ventana de marco. Invalide esta función si desea un título de marco diferente para la aplicación, por ejemplo "*elemento* de *aplicación* - de servidor en *docname*" (como en, "Microsoft Excel - hoja de cálculo en INFORME. DOC"). Este es un avanzado reemplazable.

## <a name="coleclientitemreactivateandundo"></a><a name="reactivateandundo"></a>COleClientItem::ReactivateAndUndo

Llame a esta función para reactivar el elemento OLE y deshacer la última operación realizada por el usuario durante la edición in situ.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Si la aplicación contenedora admite el comando undo, llame a esta función si el usuario elige el comando undo inmediatamente después de desactivar el elemento OLE.

Si la aplicación de servidor se escribe con las bibliotecas de clase de Microsoft Foundation, esta función hace que el servidor llame a [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Para obtener más información, vea [IOleInPlaceObject::ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) en el Windows SDK.

## <a name="coleclientitemrelease"></a><a name="release"></a>COleClientItem::Release

Llame a esta función para limpiar los recursos utilizados por el elemento OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parámetros

*dwCloseOption*<br/>
Marcar especificando en qué circunstancias se guarda el elemento OLE cuando vuelve al estado cargado. Para obtener una lista de valores posibles, vea [COleClientItem::Close](#close).

### <a name="remarks"></a>Observaciones

`Release`es llamado `COleClientItem` por el destructor.

Para obtener más información, vea [IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) en el Windows SDK.

## <a name="coleclientitemreload"></a><a name="reload"></a>COleClientItem::Reload

Cierra y vuelve a cargar el elemento.

```
BOOL Reload();
```

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Llame `Reload` a la función después de activar el elemento como un elemento de otro tipo mediante una llamada a [ActivateAs](#activateas).

## <a name="coleclientitemrun"></a><a name="run"></a>COleClientItem::Ejecutar

Ejecuta la aplicación asociada a este elemento.

```cpp
void Run();
```

### <a name="remarks"></a>Observaciones

Llame `Run` a la función miembro para iniciar la aplicación de servidor antes de activar el elemento. Esto se hace automáticamente por [Activate](#activate) y [DoVerb](#doverb), por lo que normalmente no es necesario llamar a esta función. Llame a esta función si es necesario ejecutar el servidor para establecer un atributo de elemento, como [SetExtent](#setextent), antes de ejecutar [DoVerb](#doverb).

## <a name="coleclientitemsetdrawaspect"></a><a name="setdrawaspect"></a>COleClientItem::SetDrawAspect

Llame `SetDrawAspect` a la función miembro para establecer el "aspecto", o vista, del elemento.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parámetros

*nDrawAspect*<br/>
Valor de la enumeración DVASPECT. Este parámetro puede tener uno de los valores siguientes:

- DVASPECT_CONTENT Item se representa de tal manera que se puede mostrar como un objeto incrustado dentro de su contenedor.

- DVASPECT_THUMBNAIL elemento se representa en una representación "en miniatura" para que se pueda mostrar en una herramienta de exploración.

- DVASPECT_ICON elemento se representa mediante un icono.

- DVASPECT_DOCPRINT Elemento se representa como si se imprimiera mediante el comando Imprimir del menú Archivo.

### <a name="remarks"></a>Observaciones

El aspecto especifica cómo se va a representar el elemento mediante [Draw](#draw) cuando se utiliza el valor predeterminado para el argumento *nDrawAspect* de esa función.

Esta función se llama automáticamente por el icono de cambio (y otros cuadros de diálogo que llaman directamente al cuadro de diálogo Cambiar icono) para habilitar el aspecto de visualización icónico cuando lo solicite el usuario.

## <a name="coleclientitemsetextent"></a><a name="setextent"></a>COleClientItem::SetExtent

Llame a esta función para especificar cuánto espacio está disponible para el elemento OLE.

```cpp
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parámetros

*size*<br/>
Un [CSize](../../atl-mfc-shared/reference/csize-class.md) objeto que contiene la información de tamaño.

*nDrawAspect*<br/>
Especifica el aspecto del elemento OLE cuyos límites se van a establecer. Para ver los valores posibles, consulte [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Observaciones

Si la aplicación de servidor se escribió mediante la biblioteca Microsoft Foundation `COleServerItem` Class, esto hace que se llame a la función miembro [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) del objeto correspondiente. A continuación, el elemento OLE puede ajustar su visualización en consecuencia. Las dimensiones deben estar en unidades MM_HIMETRIC. Llame a esta función cuando el usuario cambia el tamaño del elemento OLE o si admite algún tipo de negociación de diseño.

Para obtener más información, vea [IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) en el Windows SDK.

## <a name="coleclientitemsethostnames"></a><a name="sethostnames"></a>COleClientItem::SetHostNames

Llame a esta función para especificar el nombre de la aplicación contenedora y el nombre del contenedor para un elemento OLE incrustado.

```cpp
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parámetros

*lpszHost*<br/>
Puntero al nombre visible del usuario de la aplicación contenedora.

*lpszHostObj*<br/>
Puntero a una cadena de identificación del contenedor que contiene el elemento OLE.

### <a name="remarks"></a>Observaciones

Si la aplicación de servidor se escribió mediante la biblioteca Microsoft Foundation `COleServerDoc` Class, esta función llama a la [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) función miembro del documento que contiene el elemento OLE. Esta información se utiliza en los títulos de ventana cuando se está editando el elemento OLE. Cada vez que se carga un documento contenedor, el marco de trabajo llama a esta función para todos los elementos OLE en el documento. `SetHostNames`es aplicable sólo a los elementos incrustados. No es necesario llamar a esta función cada vez que se activa un elemento OLE incrustado para su edición.

También se llama automáticamente con el nombre de la aplicación y el nombre del documento cuando se carga un objeto o cuando se guarda un archivo con un nombre diferente. Por lo que, por lo general, no es necesario llamar a esta función directamente.

Para obtener más información, vea [IOleObject::SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) en el Windows SDK.

## <a name="coleclientitemseticonicmetafile"></a><a name="seticonicmetafile"></a>COleClientItem::SetIconicMetafile

Almacena en caché el metarchivo utilizado para dibujar el icono del elemento.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parámetros

*hMetaPict*<br/>
Identificador del metarchivo utilizado para dibujar el icono del elemento.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Observaciones

Utilice [GetIconicMetafile](#geticonicmetafile) para recuperar el metarchivo.

El parámetro *hMetaPict* se copia en el elemento; por lo tanto, *hMetaPict* debe ser liberado por el autor de la llamada.

## <a name="coleclientitemsetitemrects"></a><a name="setitemrects"></a>COleClientItem::SetItemRects

Llame a esta función para establecer el rectángulo delimitador o el rectángulo visible del elemento OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parámetros

*lprcPosRect*<br/>
Puntero al rectángulo que contiene los límites del elemento OLE en relación con su ventana primaria, en coordenadas de cliente.

*lprcClipRect*<br/>
Puntero al rectángulo que contiene los límites de la parte visible del elemento OLE en relación con su ventana primaria, en coordenadas de cliente.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; de lo contrario, 0.

### <a name="remarks"></a>Observaciones

La implementación predeterminada de la función miembro [OnChangeItemPosition](#onchangeitemposition) llama a esta función. Debe llamar a esta función siempre que cambie la posición o la parte visible del elemento OLE. Normalmente, esto significa que se llama desde la vista [OnSize](../../mfc/reference/cwnd-class.md#onsize) y [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) funciones miembro.

Para obtener más información, vea [IOleInPlaceObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) en el Windows SDK.

## <a name="coleclientitemsetlinkupdateoptions"></a><a name="setlinkupdateoptions"></a>COleClientItem::SetLinkUpdateOptions

Llame a esta función para establecer la opción de actualización de vínculos para la presentación del elemento vinculado especificado.

```cpp
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parámetros

*dwUpdateOpt*<br/>
El valor de la opción de actualización de vínculos para este elemento. Este valor debe ser uno de los siguientes:

- OLEUPDATE_ALWAYS Actualice el elemento vinculado siempre que sea posible. Esta opción admite el botón de opción Actualización automática de vínculos en el cuadro de diálogo Vínculos.

- OLEUPDATE_ONCALL Actualizar el elemento vinculado solo a petición de la aplicación contenedora (cuando se llama a la [updateLink](#updatelink) función miembro). Esta opción admite el botón de opción Actualización manual de vínculos en el cuadro de diálogo Vínculos.

### <a name="remarks"></a>Observaciones

Normalmente, no debe cambiar las opciones de actualización elegidas por el usuario en el cuadro de diálogo Vínculos.

Para obtener más información, vea [IOleLink::SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) en el Windows SDK.

## <a name="coleclientitemsetprintdevice"></a><a name="setprintdevice"></a>COleClientItem::SetPrintDevice

Llame a esta función para cambiar el dispositivo de destino de impresión de este elemento.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parámetros

*Dpt*<br/>
Puntero a una estructura de datos [DVTARGETDEVICE,](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) que contiene información sobre el nuevo dispositivo de destino de impresión. Puede ser NULL.

*Ppd*<br/>
Puntero a una estructura de datos [PRINTDLG,](/windows/win32/api/commdlg/ns-commdlg-printdlga) que contiene información sobre el nuevo dispositivo de destino de impresión. Puede ser NULL.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la función se realizó correctamente; de lo contrario 0.

### <a name="remarks"></a>Observaciones

Esta función actualiza el dispositivo de destino de impresión para el elemento, pero no actualiza la caché de presentación. Para actualizar la caché de presentación de un elemento, llame a [UpdateLink](#updatelink).

Los argumentos de esta función contienen información que el sistema OLE utiliza para identificar el dispositivo de destino. La `PRINTDLG` estructura contiene información que Windows utiliza para inicializar el cuadro de diálogo Imprimir común. Después de que el usuario cierra el cuadro de diálogo, Windows devuelve información sobre las selecciones del usuario en esta estructura. El `m_pd` miembro de un [CPrintDialog](../../mfc/reference/cprintdialog-class.md) objeto es una `PRINTDLG` estructura.

Para obtener más información acerca de esta estructura, vea [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) en el Windows SDK.

Para obtener más información, consulte [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) en el Windows SDK.

## <a name="coleclientitemupdatelink"></a><a name="updatelink"></a>COleClientItem::UpdateLink

Llame a esta función para actualizar los datos de presentación del elemento OLE inmediatamente.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero en caso de éxito; en caso contrario, es 0.

### <a name="remarks"></a>Observaciones

Para los elementos vinculados, la función busca el origen de vínculo para obtener una nueva presentación para el elemento OLE. Este proceso puede implicar la ejecución de una o más aplicaciones de servidor, lo que podría llevar mucho tiempo. Para los elementos incrustados, la función funciona de forma recursiva, comprobando si el elemento incrustado contiene vínculos que podrían estar desactualizados y actualizándolos. El usuario también puede actualizar manualmente vínculos individuales mediante el cuadro de diálogo Vínculos.

Para obtener más información, vea [IOleLink::Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) en el Windows SDK.

## <a name="see-also"></a>Vea también

[Ejemplo de MFC MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[Ejemplo de MFC OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[CDocItem (clase)](../../mfc/reference/cdocitem-class.md)<br/>
[Gráfico de jerarquías](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem (clase)](../../mfc/reference/coleserveritem-class.md)
