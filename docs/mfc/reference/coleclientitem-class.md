---
title: COleClientItem (clase)
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 9f97f117f0fd8570855079aca7bdfd7a63118bc5
ms.sourcegitcommit: 180f63704f6ddd07a4172a93b179cf0733fd952d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/06/2019
ms.locfileid: "70740882"
---
# <a name="coleclientitem-class"></a>COleClientItem (clase)

Define la interfaz del contenedor a elementos de OLE.

## <a name="syntax"></a>Sintaxis

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Miembros

### <a name="public-constructors"></a>Constructores públicos

|NOMBRE|DESCRIPCIÓN|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Construye un objeto `COleClientItem`.|

### <a name="public-methods"></a>Métodos públicos

|NOMBRE|DESCRIPCIÓN|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|Abre el elemento OLE para una operación y, a continuación, ejecuta el verbo especificado.|
|[COleClientItem::ActivateAs](#activateas)|Activa el elemento como otro tipo.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Obtiene acceso a los datos del objeto OLE.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Indica si una aplicación contenedora puede crear un objeto incrustado.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Indica si una aplicación contenedora puede crear un objeto vinculado.|
|[COleClientItem::CanPaste](#canpaste)|Indica si el Portapapeles contiene un elemento OLE incrustable o estático.|
|[COleClientItem::CanPasteLink](#canpastelink)|Indica si el Portapapeles contiene un elemento OLE vinculable.|
|[COleClientItem::Close](#close)|Cierra un vínculo a un servidor, pero no destruye el elemento OLE.|
|[COleClientItem::ConvertTo](#convertto)|Convierte el elemento en otro tipo.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Copia el elemento OLE en el portapapeles.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Crea un duplicado de un elemento existente.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Crea un elemento incrustado desde el portapapeles.|
|[COleClientItem::CreateFromData](#createfromdata)|Crea un elemento incrustado a partir de un objeto de datos.|
|[COleClientItem::CreateFromFile](#createfromfile)|Crea un elemento incrustado a partir de un archivo.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Crea un elemento vinculado desde el portapapeles.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Crea un elemento vinculado a partir de un objeto de datos.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Crea un elemento vinculado a partir de un archivo.|
|[COleClientItem::CreateNewItem](#createnewitem)|Crea un nuevo elemento incrustado iniciando la aplicación de servidor.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Crea un elemento estático desde el portapapeles.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Crea un elemento estático a partir de un objeto de datos.|
|[COleClientItem::Deactivate](#deactivate)|Desactiva el elemento.|
|[COleClientItem::DeactivateUI](#deactivateui)|Restaura la interfaz de usuario de la aplicación contenedora a su estado original.|
|[COleClientItem::Delete](#delete)|Elimina o cierra el elemento OLE si se trata de un elemento vinculado.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Realiza una operación de arrastrar y colocar.|
|[COleClientItem::DoVerb](#doverb)|Ejecuta el verbo especificado.|
|[COleClientItem::Draw](#draw)|Dibuja el elemento OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Obtiene la vista en la que se activa el elemento.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Devuelve los límites del rectángulo del elemento OLE.|
|[COleClientItem::GetClassID](#getclassid)|Obtiene el identificador de clase del elemento actual.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Obtiene los datos que se colocarían en el portapapeles `CopyToClipboard` mediante una llamada a la función miembro.|
|[COleClientItem::GetDocument](#getdocument)|Devuelve el `COleDocument` objeto que contiene el elemento presente.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Obtiene la vista actual del elemento para su representación.|
|[COleClientItem::GetExtent](#getextent)|Devuelve los límites del rectángulo del elemento OLE.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Recupera un identificador de un icono asociado al servidor de un CLSID determinado.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Obtiene el metarchivo que se usa para dibujar el icono del elemento.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Devuelve un puntero a la ventana de edición en contexto del elemento.|
|[COleClientItem::GetItemState](#getitemstate)|Obtiene el estado actual del elemento.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Devuelve el estado de la última operación OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Devuelve el modo de actualización de un elemento vinculado (característica avanzada).|
|[COleClientItem::GetType](#gettype)|Devuelve el tipo (incrustado, vinculado o estático) del elemento OLE.|
|[COleClientItem::GetUserType](#getusertype)|Obtiene una cadena que describe el tipo del elemento.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Devuelve TRUE si el elemento está activo en contexto.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Devuelve TRUE si un elemento vinculado está actualizado con su documento de origen.|
|[COleClientItem::IsModified](#ismodified)|Devuelve TRUE si el elemento se ha modificado desde que se guardó por última vez.|
|[COleClientItem::IsOpen](#isopen)|Devuelve TRUE si el elemento está abierto actualmente en la aplicación de servidor.|
|[COleClientItem::IsRunning](#isrunning)|Devuelve TRUE si se está ejecutando la aplicación de servidor del elemento.|
|[COleClientItem::OnActivate](#onactivate)|Lo llama el marco de trabajo para notificar al elemento que está activado.|
|[COleClientItem::OnActivateUI](#onactivateui)|Lo llama el marco de trabajo para notificar al elemento que está activado y mostrar su interfaz de usuario.|
|[COleClientItem::OnChange](#onchange)|Se llama cuando el servidor cambia el elemento OLE. Implementación requerida.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Lo llama el marco de trabajo cuando se desactiva un elemento.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Lo llama el marco de trabajo cuando el servidor ha quitado la interfaz de usuario en contexto.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Lo llama el marco de trabajo para obtener los datos que se van a copiar en el portapapeles.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Lo llama el marco de trabajo para crear un menú compuesto.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Lo llama el marco de trabajo para quitar los menús del contenedor de un menú compuesto.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Lo llama el marco de trabajo para instalar y quitar un menú compuesto.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Lo llama el marco de trabajo para mostrar y ocultar las barras de control.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Lo llama el marco de trabajo para actualizar la barra de título de la ventana de marco.|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Reactiva el elemento y deshace la última operación de edición en contexto.|
|[COleClientItem::Release](#release)|Libera la conexión a un elemento vinculado OLE y lo cierra si estaba abierto. No destruye el elemento de cliente.|
|[COleClientItem::Reload](#reload)|Vuelve a cargar el elemento después de una llamada `ActivateAs`a.|
|[COleClientItem::Run](#run)|Ejecuta la aplicación asociada al elemento.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Establece la vista actual del elemento para su representación.|
|[COleClientItem::SetExtent](#setextent)|Establece el rectángulo delimitador del elemento OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Establece los nombres que el servidor muestra al editar el elemento OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Almacena en caché el metarchivo que se usa para dibujar el icono del elemento.|
|[COleClientItem::SetItemRects](#setitemrects)|Establece el rectángulo delimitador del elemento.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Establece el modo de actualización de un elemento vinculado (característica avanzada).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Establece el dispositivo de destino de impresión para este elemento de cliente.|
|[COleClientItem::UpdateLink](#updatelink)|Actualiza la memoria caché de presentación de un elemento.|

### <a name="protected-methods"></a>Métodos protegidos

|NOMBRE|DESCRIPCIÓN|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Lo llama el marco de trabajo para determinar si se permite la activación en contexto.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Lo llama el marco de trabajo cuando cambia la posición de un elemento.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Lo llama el marco de trabajo para deshacer después de la activación.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Lo llama el marco de trabajo para descartar la información de estado de deshacer del elemento.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Lo llama el marco de trabajo para obtener las coordenadas del rectángulo de recorte del elemento.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Lo llama el marco de trabajo para obtener la posición del elemento en relación con la vista.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Lo llama el marco de trabajo cuando se activa un elemento en su lugar.|
|[COleClientItem::OnScrollBy](#onscrollby)|Lo llama el marco de trabajo para desplazar el elemento a la vista.|
|[COleClientItem::OnShowItem](#onshowitem)|Lo llama el marco de trabajo para mostrar el elemento OLE.|

## <a name="remarks"></a>Comentarios

Un elemento OLE representa datos, creados y mantenidos por una aplicación de servidor, que se puede incorporar sin problemas en un documento para que parezca que el usuario es un documento único. El resultado es un "documento compuesto" compuesto por el elemento OLE y un documento contenedor.

Un elemento OLE puede estar incrustado o vinculado. Si está incrustado, sus datos se almacenan como parte del documento compuesto. Si está vinculado, sus datos se almacenan como parte de un archivo independiente creado por la aplicación de servidor y solo se almacena un vínculo a ese archivo en el documento compuesto. Todos los elementos OLE contienen información que especifica la aplicación de servidor a la que se debe llamar para editarlos.

`COleClientItem`define varias funciones reemplazables a las que se llama en respuesta a las solicitudes de la aplicación de servidor; Estos reemplazables suelen actuar como notificaciones. Esto permite a la aplicación de servidor informar al contenedor de los cambios que realiza el usuario al editar el elemento OLE o recuperar la información necesaria durante la edición.

`COleClientItem`se puede utilizar con la clase [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)o [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) . Para usar `COleClientItem`, derive una clase a partir de ella e implemente la función miembro [onchange](#onchange) , que define el modo en que el contenedor responde a los cambios realizados en el elemento. Para admitir la activación en contexto, invalide la función miembro [OnGetItemPosition](#ongetitemposition) . Esta función proporciona información acerca de la posición mostrada del elemento OLE.

Para obtener más información sobre el uso de la interfaz de contenedor [, vea los artículos contenedores: Implementación de un](../../mfc/containers-implementing-a-container.md) contenedor y [activación](../../mfc/activation-cpp.md).

> [!NOTE]
>  El Windows SDK hace referencia a los elementos incrustados y vinculados como "objetos" y hace referencia a los tipos de elementos como "clases". Esta referencia usa el término "Item" para distinguir la entidad OLE del objeto correspondiente C++ y el término "tipo" para distinguir la categoría OLE de la C++ clase.

## <a name="inheritance-hierarchy"></a>Jerarquía de herencia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Requisitos

**Encabezado:** afxole. h

##  <a name="activate"></a>  COleClientItem::Activate

Llame a esta función para ejecutar el verbo especificado en lugar de [doverb](#doverb) , de modo que pueda realizar su propio procesamiento cuando se produzca una excepción.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parámetros

*nVerb*<br/>
Especifica el verbo que se va a ejecutar. Puede ser uno de los siguientes:

|Valor|Significado|Símbolo|
|-----------|-------------|------------|
|- 0|verbo principal|OLEIVERB_PRIMARY|
|- 1|Verbo secundario|(Ninguno)|
|- 1|Mostrar elemento para editar|OLEIVERB_SHOW|
|- 2|Editar elemento en una ventana independiente|OLEIVERB_OPEN|
|- 3|Ocultar elemento|OLEIVERB_HIDE|

El valor-1 suele ser un alias de otro verbo. Si no se admite la edición abierta,-2 tiene el mismo efecto que-1. Para obtener más valores, vea [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) en el Windows SDK.

*pView*<br/>
Puntero a la ventana de vista del contenedor que contiene el elemento OLE; lo usa la aplicación de servidor para la activación en contexto. Este parámetro debe ser NULL si el contenedor no admite la activación en contexto.

*lpMsg*<br/>
Puntero al mensaje que hizo que se activara el elemento.

### <a name="remarks"></a>Comentarios

Si la aplicación de servidor se escribió utilizando el biblioteca MFC, esta función provoca la ejecución de la función miembro [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) del objeto `COleServerItem` correspondiente.

Si el verbo principal es Edit y se especifica Zero en el parámetro *nVerb* , se inicia la aplicación de servidor para permitir que se edite el elemento OLE. Si la aplicación contenedora admite la activación en contexto, la edición puede realizarse en su lugar. Si el contenedor no admite la activación en contexto (o si se especifica el verbo abierto), el servidor se inicia en una ventana independiente y se puede editar allí. Normalmente, cuando el usuario de la aplicación contenedora hace doble clic en el elemento OLE, el valor del verbo principal en el parámetro *nVerb* determina la acción que puede realizar el usuario. Sin embargo, si el servidor solo admite una acción, toma esa acción, con independencia del valor que se especifique en el parámetro *nVerb* .

Para obtener más información, vea [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) en el Windows SDK.

##  <a name="activateas"></a>  COleClientItem::ActivateAs

Utiliza las funciones de conversión de objetos de OLE para activar el elemento como si fuera un elemento del tipo especificado por *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parámetros

*lpszUserType*<br/>
Puntero a una cadena que representa el tipo de usuario de destino, como "documento de Word".

*clsidOld*<br/>
Referencia al identificador de clase actual del elemento. El identificador de clase debe representar el tipo del objeto real, tal como se almacena, a menos que sea un vínculo. En ese caso, debe ser el CLSID del elemento al que hace referencia el vínculo. [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) proporciona automáticamente el identificador de clase correcto para el elemento.

*clsidNew*<br/>
Referencia al identificador de la clase de destino.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Este método lo llama automáticamente [COleConvertDialog::D oconvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Normalmente no se llama directamente a.

##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject

Llame a esta función para inicializar un [COleDataObject](../../mfc/reference/coledataobject-class.md) para tener acceso a los datos del elemento OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parámetros

*rDataObject*<br/>
Referencia a un `COleDataObject` objeto que se inicializará para permitir el acceso a los datos del elemento OLE.

##  <a name="canactivate"></a>  COleClientItem::CanActivate

Lo llama el marco de trabajo cuando el usuario solicita la activación en contexto del elemento OLE; el valor devuelto de esta función determina si se permite la activación en contexto.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se permite la activación en contexto; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

La implementación predeterminada permite la activación en contexto si el contenedor tiene una ventana válida. Invalide esta función para implementar una lógica especial para aceptar o rechazar la solicitud de activación. Por ejemplo, se puede rechazar una solicitud de activación si el elemento OLE es demasiado pequeño o no es visible actualmente.

Para obtener más información, vea [IOleInPlaceSite:: CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) en el Windows SDK.

##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData

Comprueba si una aplicación contenedora puede crear un objeto incrustado a `COleDataObject` partir del objeto especificado.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero al objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) desde el que se va a crear el elemento OLE.

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si el contenedor puede crear un objeto incrustado a partir del `COleDataObject` objeto; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

La `COleDataObject` clase se utiliza en las transferencias de datos para recuperar datos en varios formatos del portapapeles, a través de la función de arrastrar y colocar, o de un elemento OLE incrustado.

Los contenedores pueden usar esta función para decidir si se habilitan o deshabilitan los comandos pegar y editar pegar y editar.

Para obtener más información, vea el artículo [objetos de datos y orígenes de datos (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData

Comprueba si una aplicación contenedora puede crear un objeto vinculado a `COleDataObject` partir del objeto especificado.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero al objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) desde el que se va a crear el elemento OLE.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el contenedor puede crear un objeto vinculado `COleDataObject` a partir del objeto.

### <a name="remarks"></a>Comentarios

La `COleDataObject` clase se utiliza en las transferencias de datos para recuperar datos en varios formatos del portapapeles, a través de la función de arrastrar y colocar, o de un elemento OLE incrustado.

Los contenedores pueden usar esta función para decidir si se habilitan o deshabilitan los comandos editar pegado especial y editar vínculo de pegado.

Para obtener más información, vea el artículo [objetos de datos y orígenes de datos (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="canpaste"></a>  COleClientItem::CanPaste

Llame a esta función para ver si un elemento OLE incrustado se puede pegar desde el portapapeles.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si un elemento OLE incrustado se puede pegar desde el portapapeles; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

Para obtener más información, consulte [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) y [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) en el Windows SDK.

##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink

Llame a esta función para ver si un elemento OLE vinculado se puede pegar desde el portapapeles.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si un elemento OLE vinculado se puede pegar desde el portapapeles; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

Para obtener más información, consulte [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) y [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) en el Windows SDK.

##  <a name="close"></a>  COleClientItem::Close

Llame a esta función para cambiar el estado de un elemento OLE del estado de ejecución al estado cargado, es decir, cargado con su controlador en memoria, pero con el servidor que no se está ejecutando.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parámetros

*dwCloseOption*<br/>
Marca que especifica en qué circunstancias se guarda el elemento OLE cuando vuelve al estado de carga. Puede tener uno de los siguientes valores:

- OLECLOSE_SAVEIFDIRTY guardar el elemento OLE.

- OLECLOSE_NOSAVE no guarda el elemento OLE.

- OLECLOSE_PROMPTSAVE preguntar al usuario si desea guardar el elemento OLE.

### <a name="remarks"></a>Comentarios

Esta función no tiene ningún efecto cuando el elemento OLE no se está ejecutando.

Para obtener más información, vea [IOleObject:: Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) en el Windows SDK.

##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem

Construye un `COleClientItem` objeto y lo agrega a la colección de elementos de documento del documento contenedor, que construye únicamente el C++ objeto y no realiza ninguna inicialización OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parámetros

*pContainerDoc*<br/>
Puntero al documento contenedor que contendrá este elemento. Puede ser cualquier derivado de [COleDocument](../../mfc/reference/coledocument-class.md) .

### <a name="remarks"></a>Comentarios

Si pasa un puntero nulo, no se realiza ninguna adición en el documento contenedor. Debe llamar explícitamente a [COleDocument:: AddItem](../../mfc/reference/coledocument-class.md#additem).

Debe llamar a una de las siguientes funciones miembro de creación antes de usar el elemento OLE:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>  COleClientItem::ConvertTo

Llame a esta función miembro para convertir el elemento al tipo especificado por *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parámetros

*clsidNew*<br/>
IDENTIFICADOR de clase del tipo de destino.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

[COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)lo llama automáticamente. No es necesario llamarlo directamente.

##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard

Llame a esta función para copiar el elemento OLE en el portapapeles.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parámetros

*bIncludeLink*<br/>
TRUE si la información de vínculo se debe copiar en el portapapeles, lo que permite pegar un elemento vinculado. en caso contrario, FALSE.

### <a name="remarks"></a>Comentarios

Normalmente, se llama a esta función cuando se escriben controladores de mensajes para los comandos copiar o cortar en el menú edición. Debe implementar la selección de elementos en la aplicación contenedora si desea implementar los comandos copiar o cortar.

Para obtener más información, vea [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) en el Windows SDK.

##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom

Llame a esta función para crear una copia del elemento OLE especificado.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parámetros

*pSrcItem*<br/>
Puntero al elemento OLE que se va a duplicar.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

La copia es idéntica al elemento de origen. Puede usar esta función para admitir las operaciones de deshacer.

##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard

Llame a esta función para crear un elemento incrustado a partir del contenido del portapapeles.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*render*<br/>
Marca que especifica cómo el servidor va a representar el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *Render* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del portapapeles especificado por *cfFormat*. Si omite este parámetro, se usarán los valores predeterminados para los demás `FORMATETC` campos de la estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Normalmente, se llama a esta función desde el controlador de mensajes para el comando pegar del menú edición. (El marco de trabajo habilita el comando pegar si la función miembro [CanPaste](#canpaste) devuelve un valor distinto de cero).

Para obtener más información, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

##  <a name="createfromdata"></a>  COleClientItem::CreateFromData

Llame a esta función para crear un elemento incrustado `COleDataObject` a partir de un objeto.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero al objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) desde el que se va a crear el elemento OLE.

*render*<br/>
Marca que especifica cómo el servidor va a representar el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *Render* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del portapapeles especificado por *cfFormat*. Si omite este parámetro, se usarán los valores predeterminados para los demás `FORMATETC` campos de la estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Las operaciones de transferencia de datos, como el pegado desde el portapapeles o las operaciones de `COleDataObject` arrastrar y colocar, proporcionan objetos que contienen la información que ofrece una aplicación de servidor. Normalmente se usa en la invalidación de [CView:: Allocate](../../mfc/reference/cview-class.md#ondrop).

Para obtener más información, vea [OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

##  <a name="createfromfile"></a>  COleClientItem::CreateFromFile

Llame a esta función para crear un elemento OLE incrustado a partir de un archivo.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*lpszFileName*<br/>
Puntero al nombre del archivo del que se va a crear el elemento OLE.

*clsid*<br/>
Reservado para un uso futuro.

*render*<br/>
Marca que especifica cómo el servidor va a representar el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *Render* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del portapapeles especificado por *cfFormat*. Si omite este parámetro, se usarán los valores predeterminados para los demás `FORMATETC` campos de la estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

El marco de trabajo llama a esta función desde [COleInsertDialog:: CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) si el usuario elige aceptar en el cuadro de diálogo Insertar objeto cuando se selecciona el botón crear desde archivo.

Para obtener más información, vea [OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard

Llame a esta función para crear un elemento vinculado a partir del contenido del portapapeles.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*render*<br/>
Marca que especifica cómo el servidor va a representar el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *Render* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del portapapeles especificado por *cfFormat*. Si omite este parámetro, se usarán los valores predeterminados para los demás `FORMATETC` campos de la estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Normalmente, se llama a esta función desde el controlador de mensajes para el comando pegar vínculo en el menú edición. (El comando pegar vínculo está habilitado en la implementación predeterminada de [COleDocument](../../mfc/reference/coledocument-class.md) si el Portapapeles contiene un elemento OLE al que se puede vincular).

Para obtener más información, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData

Llame a esta función para crear un elemento vinculado `COleDataObject` a partir de un objeto.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero al objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) desde el que se va a crear el elemento OLE.

*render*<br/>
Marca que especifica cómo el servidor va a representar el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *Render* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del portapapeles especificado por *cfFormat*. Si omite este parámetro, se usarán los valores predeterminados para los demás `FORMATETC` campos de la estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Se llama a este método durante una operación de colocar cuando el usuario indica que se debe crear un vínculo. También se puede utilizar para controlar el comando Editar y pegar. Lo llama el marco de trabajo en `COleClientItem::CreateLinkFromClipboard` y en [COlePasteSpecialDialog:: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) cuando se ha seleccionado la opción de vínculo.

Para obtener más información, vea [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile

Llame a esta función para crear un elemento OLE vinculado a partir de un archivo.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*lpszFileName*<br/>
Puntero al nombre del archivo del que se va a crear el elemento OLE.

*render*<br/>
Marca que especifica cómo el servidor va a representar el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *Render* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del portapapeles especificado por *cfFormat*. Si omite este parámetro, se usarán los valores predeterminados para los demás `FORMATETC` campos de la estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

El marco de trabajo llama a esta función si el usuario elige aceptar en el cuadro de diálogo Insertar objeto cuando se selecciona el botón crear desde archivo y se activa la casilla de verificación vínculo. Se llama desde [COleInsertDialog:: CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Para obtener más información, vea [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem

Llame a esta función para crear un elemento incrustado; Esta función inicia la aplicación de servidor que permite al usuario crear el elemento OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*clsid*<br/>
IDENTIFICADOR que identifica de forma única el tipo de elemento OLE que se va a crear.

*render*<br/>
Marca que especifica cómo el servidor va a representar el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *Render* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del portapapeles especificado por *cfFormat*. Si omite este parámetro, se usarán los valores predeterminados para los demás `FORMATETC` campos de la estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

El marco de trabajo llama a esta función si el usuario elige aceptar en el cuadro de diálogo Insertar objeto cuando se selecciona el botón Crear nuevo.

Para obtener más información, vea [OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard

Llame a esta función para crear un elemento estático a partir del contenido del portapapeles.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*render*<br/>
Marca que especifica cómo el servidor va a representar el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *Render* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del portapapeles especificado por *cfFormat*. Si omite este parámetro, se usarán los valores predeterminados para los demás `FORMATETC` campos de la estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Un elemento estático contiene los datos de la presentación, pero no los datos nativos; por lo tanto, no se puede editar. Normalmente, se llama a esta función si se produce un error en la función miembro [CreateFromClipboard](#createfromclipboard) .

Para obtener más información, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData

Llame a esta función para crear un elemento estático a `COleDataObject` partir de un objeto.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero al objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) desde el que se va a crear el elemento OLE.

*render*<br/>
Marca que especifica cómo el servidor va a representar el elemento OLE. Para obtener los valores posibles, vea [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) en el Windows SDK.

*cfFormat*<br/>
Especifica el formato de datos del portapapeles que se va a almacenar en caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a una estructura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilizada si *Render* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcione un valor para este parámetro solo si desea especificar información de formato adicional más allá del formato del portapapeles especificado por *cfFormat*. Si omite este parámetro, se usarán los valores predeterminados para los demás `FORMATETC` campos de la estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Un elemento estático contiene los datos de la presentación, pero no los datos nativos; por lo tanto, no se puede editar. Esto es esencialmente el mismo que [CreateStaticFromClipboard](#createstaticfromclipboard) , salvo que un elemento estático se puede crear a partir `COleDataObject`de un arbitrario, no solo desde el portapapeles.

Se usa en [COlePasteSpecialDialog:: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) cuando se selecciona static.

Para obtener más información, vea [OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)y [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en el Windows SDK.

##  <a name="deactivate"></a>  COleClientItem::Deactivate

Llame a esta función para desactivar el elemento OLE y liberar los recursos asociados.

```
void Deactivate();
```

### <a name="remarks"></a>Comentarios

Normalmente, se desactiva un elemento OLE activo en contexto cuando el usuario hace clic con el mouse en el área cliente fuera de los límites del elemento. Tenga en cuenta que al desactivar el elemento OLE se descartará su estado de deshacer, lo que hace imposible llamar a la función miembro [ReactivateAndUndo](#reactivateandundo) .

Si la aplicación admite la operación de deshacer `Deactivate`, no llame a; en su lugar, llame a [DeactivateUI](#deactivateui).

Para obtener más información, vea [IOleInPlaceObject:: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) en el Windows SDK.

##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI

Llame a esta función cuando el usuario desactive un elemento que se activó en contexto.

```
void DeactivateUI();
```

### <a name="remarks"></a>Comentarios

Esta función restaura la interfaz de usuario de la aplicación contenedora a su estado original, ocultando los menús y otros controles que se crearon para la activación en contexto.

Esta función no vacía la información de estado de la operación de deshacer para el elemento. Esa información se conserva para que [ReactivateAndUndo](#reactivateandundo) se pueda usar más adelante para ejecutar un comando Deshacer en la aplicación de servidor, en caso de que el comando Deshacer del contenedor se elija inmediatamente después de desactivar el elemento.

Para obtener más información, vea [IOleInPlaceObject:: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) en el Windows SDK.

##  <a name="delete"></a>  COleClientItem::Delete

Llame a esta función para eliminar el elemento OLE del documento contenedor.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parámetros

*bAutoDelete*<br/>
Especifica si el elemento se va a quitar del documento.

### <a name="remarks"></a>Comentarios

Esta función llama a la función miembro [Release](#release) , que a su vez elimina C++ el objeto del elemento, quitando permanentemente el elemento OLE del documento. Si el elemento OLE está incrustado, se eliminan los datos nativos del elemento. Siempre cierra un servidor en ejecución; por lo tanto, si el elemento es un vínculo abierto, esta función lo cierra.

##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop

Llame a `DoDragDrop` la función miembro para realizar una operación de arrastrar y colocar.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parámetros

*lpItemRect*<br/>
Rectángulo del elemento en la pantalla en coordenadas de cliente (píxeles).

*ptOffset*<br/>
Desplazamiento desde *lpItemRect* donde se encontraba la posición del mouse en el momento de arrastrar.

*bIncludeLink*<br/>
Establézcalo en TRUE si los datos del vínculo se deben copiar en el portapapeles. Establézcalo en FALSE si la aplicación de servidor no admite vínculos.

*dwEffects*<br/>
Determina los efectos que el origen de arrastre permitirá en la operación de arrastre.

*lpRectStartDrag*<br/>
Puntero al rectángulo que define dónde se inicia realmente la acción de arrastrar. Para obtener más información, vea la sección Comentarios que se muestra más adelante.

### <a name="return-value"></a>Valor devuelto

Valor de DROPEFFECT. Si es DROPEFFECT_MOVE, se deben quitar los datos originales.

### <a name="remarks"></a>Comentarios

La operación de arrastrar y colocar no se inicia inmediatamente. Espera hasta que el cursor del mouse salga del rectángulo especificado por *lpRectStartDrag* o hasta que haya transcurrido un número de milisegundos especificado. Si *lpRectStartDrag* es null, el tamaño del rectángulo es un píxel.

El tiempo de retraso se especifica mediante una configuración de clave del registro. Puede cambiar el tiempo de retraso llamando a [CWinApp:: WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) o [CWinApp:: WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Si no especifica el tiempo de retraso, se usa un valor predeterminado de 200 milisegundos. La hora de retraso de arrastre se almacena de la siguiente manera:

- El tiempo de retraso de arrastre de Windows NT se almacena en HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- El tiempo de retraso de arrastre de Windows 3. x se almacena en el archivo WIN. Archivo INI, en la sección [Windows}.

- El tiempo de retraso de arrastre de Windows 95/98 se almacena en una versión almacenada en caché de WIN. INI.

Para obtener más información sobre cómo se almacena la información de retraso de arrastre en el registro o en. Archivo INI, consulte [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) en el Windows SDK.

##  <a name="doverb"></a>  COleClientItem::DoVerb

Llame `DoVerb` a para ejecutar el verbo especificado.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parámetros

*nVerb*<br/>
Especifica el verbo que se va a ejecutar. Puede incluir una de las siguientes opciones:

|Valor|Significado|Símbolo|
|-----------|-------------|------------|
|- 0|verbo principal|OLEIVERB_PRIMARY|
|- 1|Verbo secundario|(Ninguno)|
|- 1|Mostrar elemento para editar|OLEIVERB_SHOW|
|- 2|Editar elemento en una ventana independiente|OLEIVERB_OPEN|
|- 3|Ocultar elemento|OLEIVERB_HIDE|

El valor-1 suele ser un alias de otro verbo. Si no se admite la edición abierta,-2 tiene el mismo efecto que-1. Para obtener más valores, vea [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) en el Windows SDK.

*pView*<br/>
Puntero a la ventana de vista; lo usa el servidor para la activación en contexto. Este parámetro debe ser NULL si la aplicación contenedora no permite la activación en contexto.

*lpMsg*<br/>
Puntero al mensaje que hizo que se activara el elemento.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el verbo se ejecutó correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

Esta función llama a la función miembro de [activación](#activate) para ejecutar el verbo. También detecta las excepciones y muestra un cuadro de mensaje al usuario si se produce una.

Si el verbo principal es Edit y se especifica Zero en el parámetro *nVerb* , se inicia la aplicación de servidor para permitir que se edite el elemento OLE. Si la aplicación contenedora admite la activación en contexto, la edición puede realizarse en su lugar. Si el contenedor no admite la activación en contexto (o si se especifica el verbo abierto), el servidor se inicia en una ventana independiente y se puede editar allí. Normalmente, cuando el usuario de la aplicación contenedora hace doble clic en el elemento OLE, el valor del verbo principal en el parámetro *nVerb* determina la acción que puede realizar el usuario. Sin embargo, si el servidor solo admite una acción, toma esa acción, con independencia del valor que se especifique en el parámetro *nVerb* .

##  <a name="draw"></a>  COleClientItem::Draw

Llame a esta función para dibujar el elemento OLE en el rectángulo delimitador especificado mediante el contexto de dispositivo especificado.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Puntero a un objeto [CDC](../../mfc/reference/cdc-class.md) que se utiliza para dibujar el elemento OLE.

*lpBounds*<br/>
Puntero a un objeto [CRect](../../atl-mfc-shared/reference/crect-class.md) o una estructura `RECT` que define el rectángulo delimitador en el que se va a dibujar el elemento OLE (en unidades lógicas determinadas por el contexto de dispositivo).

*nDrawAspect*<br/>
Especifica el aspecto del elemento OLE, es decir, cómo debe mostrarse. Si *nDrawAspect* es-1, se usa el último conjunto de aspectos mediante [SetDrawAspect](#setdrawaspect) . Para obtener más información sobre los valores posibles de esta marca, vea [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

La función puede usar la representación de metarchivo del elemento OLE creado por la función miembro [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) de `COleServerItem`.

Normalmente se usa `Draw` para la presentación en pantalla y se pasa el contexto de dispositivo de pantalla como *pDC*. En este caso, debe especificar solo los dos primeros parámetros.

El parámetro *lpBounds* identifica el rectángulo en el contexto del dispositivo de destino (en relación con su modo de asignación actual). La representación puede implicar el escalado de la imagen y que las aplicaciones de contenedor puedan utilizarla para imponer una vista que escale entre la vista mostrada y la imagen impresa final.

Para obtener más información, vea [IViewObject::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) en el Windows SDK.

##  <a name="getactiveview"></a>  COleClientItem::GetActiveView

Devuelve la vista en la que el elemento está activado en contexto.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Valor devuelto

Puntero a la vista; de lo contrario, NULL si el elemento no está activado en contexto.

##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent

Llame a esta función para recuperar el tamaño del elemento OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parámetros

*lpSize*<br/>
Puntero a una `SIZE` estructura o a un objeto [CSize](../../atl-mfc-shared/reference/csize-class.md) que recibirá la información de tamaño.

*nDrawAspect*<br/>
Especifica el aspecto del elemento OLE cuyos límites se van a recuperar. Para obtener los valores posibles, vea [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 si el elemento OLE está en blanco.

### <a name="remarks"></a>Comentarios

Esta función proporciona la misma información que [GetExtent](#getextent). Sin embargo, puede llamar `GetCachedExtent` a para obtener información de extensión durante el procesamiento de otros controladores OLE, como [onchange](#onchange). Las dimensiones están en unidades de MM_HIMETRIC.

Esto es posible porque `GetCachedExtent` usa la interfaz [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) en lugar de usar la interfaz [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) para obtener la extensión de este elemento. El `IViewObject2` objeto com almacena en caché la información de extensión usada en la llamada anterior a [IViewObject::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Para obtener más información, vea [IViewObject2:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) en el Windows SDK.

##  <a name="getclassid"></a>  COleClientItem::GetClassID

Devuelve el ID. de clase del elemento en la memoria a la que apunta *pClassID*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parámetros

*pClassID*<br/>
Puntero a un identificador de tipo [CLSID](/windows/win32/com/clsid-key-hklm) para recuperar el identificador de clase. Para obtener información sobre CLSID, vea el Windows SDK.

### <a name="remarks"></a>Comentarios

El identificador de clase es un número de 128 bits que identifica de forma única la aplicación que edita el elemento.

Para obtener más información, vea [IPersist:: GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) en el Windows SDK.

##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData

Llame a esta función para obtener `COleDataSource` un objeto que contenga todos los datos que se colocarían en el portapapeles mediante una llamada a la función miembro [CopyToClipboard](#copytoclipboard) .

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataSource*<br/>
Puntero a un objeto [COleDataSource](../../mfc/reference/coledatasource-class.md) que recibirá los datos contenidos en el elemento OLE.

*bIncludeLink*<br/>
TRUE si se deben incluir los datos de vínculo; en caso contrario, FALSE.

*lpOffset*<br/>
Desplazamiento del cursor del mouse desde el origen del objeto en píxeles.

*lpSize*<br/>
Tamaño del objeto en píxeles.

### <a name="remarks"></a>Comentarios

`GetClipboardData`se llama como la implementación predeterminada de [OnGetClipboardData](#ongetclipboarddata). Invalide `OnGetClipboardData` solo si desea ofrecer formatos de datos además de los que `CopyToClipboard`ofrece. Coloque esos formatos en el `COleDataSource` objeto antes o después de `CopyToClipboard`llamar a y, a `COleDataSource` continuación, pase el objeto a la función [COleDataSource:: SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) . Por ejemplo, si desea que la posición del elemento OLE en su documento contenedor lo acompañe al portapapeles, debe definir su propio formato para pasar esa información y colocarla en `COleDataSource` antes de llamar a. `CopyToClipboard`

##  <a name="getdocument"></a>  COleClientItem::GetDocument

Llame a esta función para obtener un puntero al documento que contiene el elemento OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Valor devuelto

Un puntero al documento que contiene el elemento OLE. Es NULL si el elemento no forma parte de un documento.

### <a name="remarks"></a>Comentarios

Este puntero permite el acceso al `COleDocument` objeto que se pasó como argumento `COleClientItem` al constructor.

##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect

Llame a `GetDrawAspect` la función miembro para determinar el "aspecto" o la vista actual del elemento.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Valor devuelto

Un valor de la enumeración DVASPECT, cuyos valores se enumeran en la referencia de [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Comentarios

El aspecto especifica cómo se va a representar el elemento.

##  <a name="getextent"></a>  COleClientItem::GetExtent

Llame a esta función para recuperar el tamaño del elemento OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parámetros

*lpSize*<br/>
Puntero a una `SIZE` estructura o un `CSize` objeto que recibirá la información de tamaño.

*nDrawAspect*<br/>
Especifica el aspecto del elemento OLE cuyos límites se van a recuperar. Para obtener los valores posibles, vea [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 si el elemento OLE está en blanco.

### <a name="remarks"></a>Comentarios

Si la aplicación de servidor se escribió utilizando el biblioteca MFC, esta función hace que se llame a la función miembro [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) del objeto `COleServerItem` correspondiente. Tenga en cuenta que el tamaño recuperado puede diferir del último tamaño establecido por la función miembro [SetExtent](#setextent) ; el tamaño especificado por `SetExtent` se trata como una sugerencia. Las dimensiones están en unidades de MM_HIMETRIC.

> [!NOTE]
>  No llame a `GetExtent` durante el procesamiento de un controlador OLE, como [onchange](#onchange). Llame a [GetCachedExtent](#getcachedextent) en su lugar.

Para obtener más información, vea [IOleObject:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) en el Windows SDK.

##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry

Llame a esta función miembro para recuperar un identificador de un recurso de icono asociado al servidor de un CLSID determinado.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parámetros

*clsid*<br/>
Referencia al CLSID para el servidor asociado al icono.

### <a name="return-value"></a>Valor devuelto

Identificador válido para el recurso de icono o NULL si no se encuentra el icono del servidor o un icono predeterminado.

### <a name="remarks"></a>Comentarios

Esta función miembro no iniciará el servidor u obtendrá un icono dinámicamente, incluso si el servidor ya se está ejecutando. En su lugar, esta función miembro abre la imagen ejecutable del servidor y recupera el icono estático asociado al servidor a medida que se registró.

##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile

Recupera el metarchivo que se usa para dibujar el icono del elemento.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Valor devuelto

Identificador del metarchivo si es correcto; de lo contrario, NULL.

### <a name="remarks"></a>Comentarios

Si no hay ningún icono actual, se devuelve un icono predeterminado. Los cuadros de diálogo de MFC/OLE llaman a esto automáticamente y normalmente no se llama directamente.

Esta función también llama a [SetIconicMetafile](#seticonicmetafile) para almacenar en caché el metarchivo para su uso posterior.

##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow

Llame a `GetInPlaceWindow` la función miembro para obtener un puntero a la ventana en la que se ha abierto el elemento para la edición en contexto.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Valor devuelto

Puntero a la ventana de edición en contexto del elemento; Es NULL si el elemento no está activo o si el servidor no está disponible.

### <a name="remarks"></a>Comentarios

Solo se debe llamar a esta función para los elementos que están activos en contexto.

##  <a name="getitemstate"></a>  COleClientItem::GetItemState

Llame a esta función para obtener el estado actual del elemento OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Valor devuelto

Un `COleClientItem::ItemState` valor enumerado, que puede ser uno de los siguientes: `emptyState`, `loadedState`, `openState`, `activeState`, `activeUIState`. Para obtener información acerca de estos Estados, consulte [el artículo contenedores: Estados](../../mfc/containers-client-item-states.md)de elemento de cliente.

### <a name="remarks"></a>Comentarios

Para recibir una notificación cuando cambie el estado del elemento OLE, utilice la función miembro [onchange](#onchange) .

Para obtener más información, vea el [artículo contenedores: Estados](../../mfc/containers-client-item-states.md)de elemento de cliente.

##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus

Devuelve el código de estado de la última operación OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Valor devuelto

Valor SCODE.

### <a name="remarks"></a>Comentarios

En el caso de las funciones miembro que devuelven un valor booleano de false, u otras `GetLastStatus` funciones miembro que devuelven null, devuelve información de error más detallada. Tenga en cuenta que la mayoría de las funciones miembro de OLE producen excepciones para errores más graves. La información específica sobre la interpretación del SCODE depende de la llamada OLE subyacente que último devolvió un valor SCODE.

Para obtener más información sobre SCODE, vea [estructura de los códigos de error com](/windows/win32/com/structure-of-com-error-codes) en la documentación de Windows SDK.

##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions

Llame a esta función para obtener el valor actual de la opción Link-Update para el elemento OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Valor devuelto

Uno de los siguientes valores:

- OLEUPDATE_ALWAYS actualice el elemento vinculado siempre que sea posible. Esta opción admite el botón de radio vincular actualización automática en el cuadro de diálogo vínculos.

- OLEUPDATE_ONCALL actualiza el elemento vinculado solo en la solicitud de la aplicación contenedora (cuando se llama a la función miembro [UpdateLink](#updatelink) ). Esta opción admite el botón de radio Link-Update manual en el cuadro de diálogo vínculos.

### <a name="remarks"></a>Comentarios

Se trata de una operación avanzada.

La clase [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) llama automáticamente a esta función.

Para obtener más información, vea [IOleLink:: GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) en el Windows SDK.

##  <a name="gettype"></a>  COleClientItem::GetType

Llame a esta función para determinar si el elemento OLE está incrustado o vinculado, o estático.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Valor devuelto

Un entero sin signo con uno de los valores siguientes:

- OT_LINK el elemento OLE es un vínculo.

- OT_EMBEDDED el elemento OLE está incrustado.

- OT_STATIC el elemento OLE es estático, es decir, solo contiene datos de presentación, no datos nativos, por lo que no se puede editar.

##  <a name="getusertype"></a>  COleClientItem::GetUserType

Llame a esta función para obtener la cadena visible para el usuario que describe el tipo del elemento OLE, como "documento de Word".

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parámetros

*nUserClassType*<br/>
Valor que indica la variante deseada de la cadena que describe el tipo del elemento OLE. Puede tener uno de los siguientes valores:

- USERCLASSTYPE_FULL el nombre de tipo completo que se muestra al usuario.

- USERCLASSTYPE_SHORT un nombre corto (máximo de 15 caracteres) para su uso en los menús emergentes y en el cuadro de diálogo Editar vínculos.

- USERCLASSTYPE_APPNAME nombre de la aplicación que atiende la clase.

*rString*<br/>
Referencia a un objeto [CString](../../atl-mfc-shared/reference/cstringt-class.md) en el que se va a devolver la cadena que describe el tipo del elemento OLE.

### <a name="remarks"></a>Comentarios

Esta suele ser la entrada en la base de datos de registro del sistema.

Si se solicita el nombre de tipo completo, pero no está disponible, se utiliza en su lugar el nombre corto. Si no se encuentra ninguna entrada para el tipo de elemento OLE en la base de datos de registro, o si no hay ningún tipo de usuario registrado para el tipo de elemento OLE, se usa el tipo de usuario almacenado actualmente en el elemento OLE. Si el nombre de tipo de usuario es una cadena vacía, se usa "objeto desconocido".

Para obtener más información, vea [IOleObject:: GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) en el Windows SDK.

##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive

Llame a esta función para ver si el elemento OLE está activo en contexto.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE está activo en contexto; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

Es habitual ejecutar una lógica diferente en función de si el elemento se está editando en contexto. La función comprueba si el estado del elemento actual es igual a `activeState` `activeUIState`o.

##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate

Llame a esta función para ver si el elemento OLE está actualizado.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE está actualizado; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

Un elemento vinculado puede estar obsoleto si su documento de origen se ha actualizado. Un elemento incrustado que contiene vínculos dentro de él puede quedar desactualizado de forma similar. La función realiza una comprobación recursiva del elemento OLE. Tenga en cuenta que determinar si un elemento OLE está obsoleto puede ser tan caro como realizar una actualización.

La implementación de [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) llama a esta función automáticamente.

Para obtener más información, vea [IOleObject:: IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) en el Windows SDK.

##  <a name="ismodified"></a>  COleClientItem::IsModified

Llame a esta función para ver si el elemento OLE está sucio (modificado desde la última vez que se guardó).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE está sucio; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

Para obtener más información, consulte [IPersistStorage:: IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) en el Windows SDK.

##  <a name="isopen"></a>  COleClientItem::IsOpen

Llame a esta función para ver si el elemento OLE está abierto; es decir, se abre en una instancia de la aplicación de servidor que se ejecuta en una ventana independiente.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE está abierto; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

Se utiliza para determinar cuándo se debe dibujar el objeto con un modelo de sombreado. Un objeto abierto debe tener un patrón de trama dibujado encima del objeto. Para ello, puede usar un objeto [CRectTracker](../../mfc/reference/crecttracker-class.md) .

##  <a name="isrunning"></a>  COleClientItem::IsRunning

Llame a esta función para ver si el elemento OLE se está ejecutando; es decir, si el elemento se carga y se ejecuta en la aplicación de servidor.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE se está ejecutando; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

Para obtener más información, vea [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) en el Windows SDK.

##  <a name="onactivate"></a>  COleClientItem::OnActivate

Lo llama el marco de trabajo para notificar al elemento que se acaba de activar en contexto.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Comentarios

Tenga en cuenta que se llama a esta función para indicar que el servidor se está ejecutando, no para indicar que su interfaz de usuario se ha instalado en la aplicación contenedora. En este momento, el objeto no tiene una interfaz de usuario activa (no `activeUIState`es). No ha instalado sus menús o barras de herramientas. Se llama a la función miembro [OnActivateUI](#onactivateui) cuando esto ocurre.

La implementación predeterminada llama a la función miembro [onchange](#onchange) con OLE_CHANGEDSTATE como parámetro. Invalide esta función para realizar el procesamiento personalizado cuando un elemento se activa en contexto.

##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI

El marco de `OnActivateUI` trabajo llama a cuando el objeto ha entrado en el estado activo de la interfaz de usuario.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Comentarios

El objeto ya ha instalado la barra de herramientas y los menús.

La implementación predeterminada recuerda el HWND del servidor para las llamadas posteriores `GetServerWindow` .

##  <a name="onchange"></a>  COleClientItem::OnChange

Lo llama el marco de trabajo cuando el usuario modifica, guarda o cierra el elemento OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parámetros

*nCode*<br/>
Razón por la que el servidor ha cambiado este elemento. Puede tener uno de los siguientes valores:

- OLE_CHANGED el aspecto del elemento OLE ha cambiado.

- OLE_SAVED el elemento OLE se ha guardado.

- OLE_CLOSED el elemento OLE se ha cerrado.

- OLE_CHANGED_STATE el elemento OLE ha cambiado de un estado a otro.

*dwParam*<br/>
Si *nCode* es OLE_SAVED o OLE_CLOSED, no se utiliza este parámetro. Si *nCode* es OLE_CHANGED, este parámetro especifica el aspecto del elemento OLE que ha cambiado. Para ver los valores posibles, vea el parámetro *dwParam* de [COleClientItem::D RAW](#draw). Si *nCode* es OLE_CHANGED_STATE, este parámetro es un `COleClientItem::ItemState` valor enumerado y describe el estado que se va a escribir. Puede tener uno de los siguientes valores: `emptyState`, `loadedState`, `openState`, `activeState`o `activeUIState`.

### <a name="remarks"></a>Comentarios

(Si la aplicación de servidor se escribe utilizando el biblioteca MFC, se llama a esta función como respuesta `Notify` a las funciones `COleServerDoc` miembro `COleServerItem`de o). La implementación predeterminada marca el documento contenedor como modificado si *nCode* es OLE_CHANGED o OLE_SAVED.

En el caso de OLE_CHANGED_STATE, el estado actual devuelto desde [GetItemState](#getitemstate) seguirá siendo el anterior, lo que significa que el estado que era actual antes de este cambio de estado.

Invalide esta función para responder a los cambios en el estado del elemento OLE. Normalmente, la apariencia del elemento se actualiza invalidando el área en la que se muestra el elemento. Llame a la implementación de la clase base al principio de la invalidación.

##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition

Lo llama el marco de trabajo para notificar al contenedor que la extensión del elemento OLE ha cambiado durante la activación en contexto.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parámetros

*rectPos*<br/>
Indica la posición del elemento en relación con el área de cliente de la aplicación contenedora.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la posición del elemento se ha cambiado correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

La implementación predeterminada determina el nuevo rectángulo visible del elemento OLE y llama a [SetItemRects](#setitemrects) con los nuevos valores. La implementación predeterminada calcula el rectángulo visible para el elemento y pasa esa información al servidor.

Invalide esta función para aplicar reglas especiales a la operación de cambio de tamaño o movimiento. Si la aplicación se escribe en MFC, esta llamada se produce porque el servidor llamó a [COleServerDoc:: RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate

Lo llama el marco de trabajo cuando el elemento OLE realiza la transición desde el estado activo en `activeState`contexto () al estado cargado, lo que significa que se desactiva después de una activación en contexto.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Comentarios

Tenga en cuenta que se llama a esta función para indicar que el elemento OLE está cerrado, no que se ha quitado su interfaz de usuario de la aplicación contenedora. Cuando esto sucede, se llama a la función miembro [OnDeactivateUI](#ondeactivateui) .

La implementación predeterminada llama a la función miembro [onchange](#onchange) con OLE_CHANGEDSTATE como parámetro. Invalide esta función para realizar el procesamiento personalizado cuando se desactive un elemento activo en contexto. Por ejemplo, si admite el comando Deshacer en la aplicación contenedora, puede invalidar esta función para descartar el estado de deshacer, lo que indica que la última operación realizada en el elemento OLE no se puede deshacer una vez desactivado el elemento.

##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo

Lo llama el marco de trabajo cuando el usuario invoca el comando Deshacer después de activar el elemento OLE en contexto.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Comentarios

La implementación predeterminada llama a [DeactivateUI](#deactivateui) para desactivar la interfaz de usuario del servidor. Invalide esta función si está implementando el comando Deshacer en la aplicación contenedora. En la invalidación, llame a la versión de la clase base de la función y, a continuación, deshaga el último comando ejecutado en la aplicación.

Para obtener más información, vea [IOleInPlaceSite::D eactivateandundo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) en el Windows SDK.

##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI

Se llama cuando el usuario desactiva un elemento que se activó en contexto.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parámetros

*bUndoable*<br/>
Especifica si los cambios de edición se pueden deshacer.

### <a name="remarks"></a>Comentarios

Esta función restaura la interfaz de usuario de la aplicación contenedora a su estado original, ocultando los menús y otros controles que se crearon para la activación en contexto.

Si *bUndoable* es false, el contenedor debe deshabilitar el comando Undo, en efecto descartando el estado de deshacer del contenedor, ya que indica que no se podrá deshacer la última operación realizada por el servidor.

##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState

Lo llama el marco de trabajo cuando el usuario realiza una acción que descarta el estado de deshacer mientras edita el elemento OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Comentarios

La implementación predeterminada no hace nada. Invalide esta función si está implementando el comando Deshacer en la aplicación contenedora. En la invalidación, descarte el estado de deshacer de la aplicación contenedora.

Si el servidor se ha escrito con el biblioteca MFC, el servidor puede hacer que se llame a esta función llamando a [COleServerDoc::D iscardundostate](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Para obtener más información, vea [IOleInPlaceSite::D iscardundostate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) en el Windows SDK.

##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData

Lo llama el marco de trabajo para `COleDataSource` obtener un objeto que contiene todos los datos que se colocarían en el portapapeles mediante una llamada a la función miembro [CopyToClipboard](#copytoclipboard) o [DoDragDrop](#dodragdrop) .

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parámetros

*bIncludeLink*<br/>
Establézcalo en TRUE si los datos de los vínculos se deben copiar en el portapapeles. Establézcalo en FALSE si la aplicación de servidor no admite vínculos.

*lpOffset*<br/>
Puntero al desplazamiento del cursor del mouse desde el origen del objeto en píxeles.

*lpSize*<br/>
Puntero al tamaño del objeto en píxeles.

### <a name="return-value"></a>Valor devuelto

Un puntero a un objeto [COleDataSource](../../mfc/reference/coledatasource-class.md) que contiene los datos del portapapeles.

### <a name="remarks"></a>Comentarios

La implementación predeterminada de esta función llama a [GetClipboardData](#getclipboarddata).

##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect

El marco de trabajo `OnGetClipRect` llama a la función miembro para obtener las coordenadas del rectángulo de recorte del elemento que se está editando en contexto.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parámetros

*rClipRect*<br/>
Puntero a un objeto de clase [CRect](../../atl-mfc-shared/reference/crect-class.md) que contendrá las coordenadas del rectángulo de recorte del elemento.

### <a name="remarks"></a>Comentarios

Las coordenadas están en píxeles en relación con el área de cliente de la ventana de la aplicación contenedora.

La implementación predeterminada simplemente devuelve el rectángulo de cliente de la vista en la que el elemento está activo en contexto.

##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition

El marco de trabajo `OnGetItemPosition` llama a la función miembro para obtener las coordenadas del elemento que se está editando en contexto.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parámetros

*rPosition*<br/>
Referencia al objeto [CRect](../../atl-mfc-shared/reference/crect-class.md) que contendrá las coordenadas de posición del elemento.

### <a name="remarks"></a>Comentarios

Las coordenadas están en píxeles en relación con el área de cliente de la ventana de la aplicación contenedora.

La implementación predeterminada de esta función no hace nada. Las aplicaciones que admiten la edición en contexto requieren su implementación.

##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext

Lo llama el marco de trabajo cuando se activa un elemento en su lugar.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parámetros

*ppMainFrame*<br/>
Puntero a un puntero a la ventana de marco principal.

*ppDocFrame*<br/>
Puntero a un puntero a la ventana de marco del documento.

*lpFrameInfo*<br/>
Puntero a una estructura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) que recibirá información de la ventana de marco.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esta función se usa para recuperar información acerca de la ventana primaria del elemento OLE.

Si el contenedor es una aplicación MDI, la implementación predeterminada devuelve un puntero al objeto [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) en *ppMainFrame* y un puntero al objeto [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) activo en *ppDocFrame*. Si el contenedor es una aplicación SDI, la implementación predeterminada devuelve un puntero al objeto [CFrameWnd](../../mfc/reference/cframewnd-class.md) en *PPMAINFRAME* y devuelve null en *ppDocFrame*. La implementación predeterminada también rellena los miembros de *lpFrameInfo*.

Invalide esta función solo si la implementación predeterminada no se adapta a su aplicación; por ejemplo, si la aplicación tiene un paradigma de interfaz de usuario que difiere de SDI o MDI. Se trata de un reemplazable avanzado.

Para obtener más información, vea [IOleInPlaceSite:: GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) y la estructura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) en el Windows SDK.

##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus

Lo llama el marco de trabajo durante la activación en contexto para insertar los menús de la aplicación contenedora en un menú vacío.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parámetros

*pMenuShared*<br/>
Apunta a un menú vacío.

*lpMenuWidths*<br/>
Apunta a una matriz de seis valores LONG que indican cuántos menús hay en cada uno de los siguientes grupos de menús: Archivo, edición, contenedor, objeto, ventana, ayuda. La aplicación contenedora es responsable de los grupos de menús de archivos, contenedores y ventanas, correspondientes a los elementos 0, 2 y 4 de esta matriz.

### <a name="remarks"></a>Comentarios

A continuación, este menú se pasa al servidor, que inserta sus propios menús, y crea un menú compuesto. Se puede llamar a esta función varias veces para compilar varios menús compuestos.

La implementación predeterminada inserta en *pMenuShared* los menús del contenedor en contexto; es decir, los grupos de menús archivo, contenedor y ventana. [CDocTemplate:: SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) se usa para establecer este recurso de menú. La implementación predeterminada también asigna los valores adecuados a los elementos 0, 2 y 4 en *lpMenuWidths*, según el recurso de menú. Invalide esta función si la implementación predeterminada no es adecuada para su aplicación; por ejemplo, si la aplicación no usa plantillas de documento para asociar recursos con tipos de documento. Si invalida esta función, también debe invalidar [OnSetMenu](#onsetmenu) y [OnRemoveMenus](#onremovemenus). Se trata de un reemplazable avanzado.

Para obtener más información, vea [IOleInPlaceFrame:: InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) en el Windows SDK.

##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus

Lo llama el marco de trabajo para quitar los menús del contenedor del menú compuesto especificado cuando finaliza la activación en contexto.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parámetros

*pMenuShared*<br/>
Apunta al menú compuesto construido mediante llamadas a la función miembro [OnInsertMenus](#oninsertmenus) .

### <a name="remarks"></a>Comentarios

La implementación predeterminada quita de *pMenuShared* los menús del contenedor en contexto, es decir, los grupos de menús archivo, contenedor y ventana. Invalide esta función si la implementación predeterminada no es adecuada para su aplicación; por ejemplo, si la aplicación no usa plantillas de documento para asociar recursos con tipos de documento. Si invalida esta función, probablemente invalide también [OnInsertMenus](#oninsertmenus) y [OnSetMenu](#onsetmenu) . Se trata de un reemplazable avanzado.

Los submenús de *pMenuShared* pueden ser compartidos por más de un menú compuesto si el servidor se `OnInsertMenus`ha llamado repetidamente. Por lo tanto, no debe eliminar ningún submenú en la invalidación de `OnRemoveMenus`; solo debe desasociarlos.

Para obtener más información, vea [IOleInPlaceFrame:: RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) en el Windows SDK.

##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy

Lo llama el marco de trabajo para desplazar el elemento OLE en respuesta a las solicitudes del servidor.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parámetros

*sizeExtent*<br/>
Especifica las distancias, en píxeles, que se van a desplazar en las direcciones x e y.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se ha desplazado el elemento; 0 si no se pudo desplazar el elemento.

### <a name="remarks"></a>Comentarios

Por ejemplo, si el elemento OLE es parcialmente visible y el usuario se mueve fuera del área visible mientras se realiza la edición en contexto, se llama a esta función para mantener visible el cursor. La implementación predeterminada no hace nada. Invalide esta función para desplazar el elemento en la cantidad especificada. Tenga en cuenta que, como resultado del desplazamiento, la parte visible del elemento OLE puede cambiar. Llame a [SetItemRects](#setitemrects) para actualizar el rectángulo visible del elemento.

Para obtener más información, vea [IOleInPlaceSite:: scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) en el Windows SDK.

##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu

Lo llama el marco de trabajo dos veces cuando comienza y finaliza la activación en contexto; la primera vez que instale el menú compuesto y la segunda vez (con *holemenu* igual a NULL) para quitarlo.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parámetros

*pMenuShared*<br/>
Puntero al menú compuesto construido mediante llamadas a la función miembro [OnInsertMenus](#oninsertmenus) y a la `InsertMenu` función.

*holemenu*<br/>
Identificador del descriptor de menú devuelto por la `OleCreateMenuDescriptor` función, o null si se va a quitar el código de distribución.

*hwndActiveObject*<br/>
Identificador de la ventana de edición para el elemento OLE. Esta es la ventana que recibirá los comandos de edición de OLE.

### <a name="remarks"></a>Comentarios

La implementación predeterminada instala o quita el menú compuesto y, a continuación, llama a la función [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) para instalar o quitar el código de distribución. Invalide esta función si la implementación predeterminada no es adecuada para su aplicación. Si invalida esta función, probablemente invalide también [OnInsertMenus](#oninsertmenus) y [OnRemoveMenus](#onremovemenus) . Se trata de un reemplazable avanzado.

Para obtener más información, vea [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)y [IOleInPlaceFrame:: SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) en el Windows SDK.

##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars

Lo llama el marco de trabajo para mostrar y ocultar las barras de control de la aplicación contenedora.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parámetros

*pFrameWnd*<br/>
Puntero a la ventana de marco de la aplicación contenedora. Puede ser una ventana de marco principal o una ventana secundaria MDI.

*bShow*<br/>
Especifica si se van a mostrar u ocultar las barras de control.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada de función provoca un cambio en el estado de las barras de control; 0 si la llamada no realiza ningún cambio o si *pFrameWnd* no apunta a la ventana de marco del contenedor.

### <a name="remarks"></a>Comentarios

Esta función devuelve 0 si las barras de control ya están en el estado especificado por *bShow.* Esto ocurre, por ejemplo, si las barras de control están ocultas y *bShow* es false.

La implementación predeterminada quita la barra de herramientas de la ventana de marco de nivel superior.

##  <a name="onshowitem"></a>  COleClientItem::OnShowItem

Lo llama el marco de trabajo para mostrar el elemento OLE, lo que lo hace totalmente visible durante la edición.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Comentarios

Se usa cuando la aplicación contenedora admite vínculos a elementos incrustados (es decir, si ha derivado la clase de documento de [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Se llama a esta función durante la activación en contexto o cuando el elemento OLE es un origen de vínculo y el usuario desea editarlo. La implementación predeterminada activa la primera vista en el documento contenedor. Invalide esta función para desplazar el documento de modo que el elemento OLE esté visible.

##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle

Lo llama el marco de trabajo durante la activación en contexto para actualizar la barra de título de la ventana de marco.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Valor devuelto

Es distinto de cero si esta función actualizó correctamente el título del marco; de lo contrario, es cero.

### <a name="remarks"></a>Comentarios

La implementación predeterminada no cambia el título de la ventana de marco. Invalide esta función si desea un título de marco diferente para la aplicación, por ejemplo, "*elemento* de *aplicación* - de servidor en *DocName*" (como en, "Microsoft Excel-hoja de cálculo en el informe. DOC "). Se trata de un reemplazable avanzado.

##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo

Llame a esta función para volver a activar el elemento OLE y deshacer la última operación realizada por el usuario durante la edición en contexto.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Si la aplicación contenedora admite el comando Deshacer, llame a esta función si el usuario elige el comando Deshacer inmediatamente después de desactivar el elemento OLE.

Si la aplicación de servidor se escribe con las bibliotecas de Microsoft Foundation Class, esta función hace que el servidor llame a [COleServerDoc:: OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Para obtener más información, vea [IOleInPlaceObject:: ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) en el Windows SDK.

##  <a name="release"></a>  COleClientItem::Release

Llame a esta función para limpiar los recursos utilizados por el elemento OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parámetros

*dwCloseOption*<br/>
Marca que especifica en qué circunstancias se guarda el elemento OLE cuando vuelve al estado de carga. Para obtener una lista de los valores posibles, vea [COleClientItem:: Close](#close).

### <a name="remarks"></a>Comentarios

`Release`el `COleClientItem` destructor llama a.

Para obtener más información, vea [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) en el Windows SDK.

##  <a name="reload"></a>  COleClientItem::Reload

Cierra y recarga el elemento.

```
BOOL Reload();
```

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Llame a `Reload` la función después de activar el elemento como un elemento de otro tipo mediante una llamada a [activations](#activateas).

##  <a name="run"></a>  COleClientItem::Run

Ejecuta la aplicación asociada a este elemento.

```
void Run();
```

### <a name="remarks"></a>Comentarios

Llame a `Run` la función miembro para iniciar la aplicación de servidor antes de activar el elemento. Esto se hace automáticamente mediante [Activate](#activate) y [doverb](#doverb), por lo que normalmente no es necesario llamar a esta función. Llame a esta función si es necesario ejecutar el servidor para establecer un atributo de elemento, como [SetExtent](#setextent), antes de ejecutar [doverb](#doverb).

##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect

Llame a `SetDrawAspect` la función miembro para establecer el "aspecto" o la vista del elemento.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parámetros

*nDrawAspect*<br/>
Un valor de la enumeración DVASPECT. Este parámetro puede tener uno de los valores siguientes:

- El elemento DVASPECT_CONTENT se representa de tal forma que se puede mostrar como un objeto incrustado dentro de su contenedor.

- El elemento DVASPECT_THUMBNAIL se representa en una representación "en miniatura" para que se pueda mostrar en una herramienta de exploración.

- El elemento DVASPECT_ICON se representa mediante un icono.

- El elemento DVASPECT_DOCPRINT se representa como si se imprimiera con el comando imprimir del menú archivo.

### <a name="remarks"></a>Comentarios

El aspecto especifica cómo se va a representar el elemento mediante [Draw](#draw) cuando se usa el valor predeterminado para el argumento *nDrawAspect* de esa función.

La llamada a esta función se realiza automáticamente mediante el icono de cambio (y otros cuadros de diálogo que llaman directamente al cuadro de diálogo Cambiar icono) para habilitar el aspecto de presentación de iconos cuando lo solicita el usuario.

##  <a name="setextent"></a>  COleClientItem::SetExtent

Llame a esta función para especificar la cantidad de espacio disponible para el elemento OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parámetros

*size*<br/>
Objeto [CSize](../../atl-mfc-shared/reference/csize-class.md) que contiene la información de tamaño.

*nDrawAspect*<br/>
Especifica el aspecto del elemento OLE cuyos límites se van a establecer. Para obtener los valores posibles, vea [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Comentarios

Si la aplicación de servidor se escribió con el biblioteca MFC, esto hace que se llame a la función miembro [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) del objeto `COleServerItem` correspondiente. El elemento OLE puede ajustar su presentación en consecuencia. Las dimensiones deben estar en unidades MM_HIMETRIC. Llame a esta función cuando el usuario cambie el tamaño del elemento OLE o si admite algún tipo de negociación de diseño.

Para obtener más información, consulte [IOleObject:: SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) en el Windows SDK.

##  <a name="sethostnames"></a>  COleClientItem::SetHostNames

Llame a esta función para especificar el nombre de la aplicación contenedora y el nombre del contenedor para un elemento OLE incrustado.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parámetros

*lpszHost*<br/>
Puntero al nombre visible para el usuario de la aplicación contenedora.

*lpszHostObj*<br/>
Puntero a una cadena de identificación del contenedor que contiene el elemento OLE.

### <a name="remarks"></a>Comentarios

Si la aplicación de servidor se escribió utilizando el biblioteca MFC, esta función llama a la función miembro [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) del documento `COleServerDoc` que contiene el elemento OLE. Esta información se utiliza en los títulos de ventana cuando se edita el elemento OLE. Cada vez que se carga un documento contenedor, el marco de trabajo llama a esta función para todos los elementos OLE del documento. `SetHostNames`solo es aplicable a los elementos incrustados. No es necesario llamar a esta función cada vez que se activa un elemento OLE incrustado para su edición.

Esto también se llama automáticamente con el nombre de la aplicación y el nombre del documento cuando se carga un objeto o cuando se guarda un archivo con un nombre diferente. En consecuencia, normalmente no es necesario llamar a esta función directamente.

Para obtener más información, vea [IOleObject:: SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) en el Windows SDK.

##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile

Almacena en caché el metarchivo que se usa para dibujar el icono del elemento.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parámetros

*hMetaPict*<br/>
Identificador del metarchivo que se usa para dibujar el icono del elemento.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Use [GetIconicMetafile](#geticonicmetafile) para recuperar el metarchivo.

El parámetro *hMetaPict* se copia en el elemento; por lo tanto, el llamador debe liberar *hMetaPict* .

##  <a name="setitemrects"></a>  COleClientItem::SetItemRects

Llame a esta función para establecer el rectángulo delimitador o el rectángulo visible del elemento OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parámetros

*lprcPosRect*<br/>
Puntero al rectángulo que contiene los límites del elemento OLE con respecto a su ventana primaria, en coordenadas de cliente.

*lprcClipRect*<br/>
Puntero al rectángulo que contiene los límites de la parte visible del elemento OLE con respecto a su ventana primaria, en coordenadas de cliente.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

La implementación predeterminada de la función miembro [OnChangeItemPosition](#onchangeitemposition) llama a esta función. Debe llamar a esta función cada vez que cambie la posición o la parte visible del elemento OLE. Por lo general, esto significa que se llama desde las funciones miembro de [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) [y de](../../mfc/reference/cwnd-class.md#onsize) la vista.

Para obtener más información, vea [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) en el Windows SDK.

##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions

Llame a esta función para establecer la opción de actualización de vínculo para la presentación del elemento vinculado especificado.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parámetros

*dwUpdateOpt*<br/>
Valor de la opción de actualización de vínculo para este elemento. Este valor debe ser uno de los siguientes:

- OLEUPDATE_ALWAYS actualice el elemento vinculado siempre que sea posible. Esta opción admite el botón de radio vincular actualización automática en el cuadro de diálogo vínculos.

- OLEUPDATE_ONCALL actualiza el elemento vinculado solo en la solicitud de la aplicación contenedora (cuando se llama a la función miembro [UpdateLink](#updatelink) ). Esta opción admite el botón de radio Link-Update manual en el cuadro de diálogo vínculos.

### <a name="remarks"></a>Comentarios

Normalmente, no debe cambiar las opciones de actualización elegidas por el usuario en el cuadro de diálogo vínculos.

Para obtener más información, vea [IOleLink:: SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) en el Windows SDK.

##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice

Llame a esta función para cambiar el dispositivo de destino de impresión para este elemento.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parámetros

*ptd*<br/>
Puntero a una estructura de datos [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , que contiene información sobre el nuevo dispositivo de destino de impresión. Puede ser NULL.

*ppd*<br/>
Puntero a una estructura de datos [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) , que contiene información sobre el nuevo dispositivo de destino de impresión. Puede ser NULL.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la función se realizó correctamente; de lo contrario, es 0.

### <a name="remarks"></a>Comentarios

Esta función actualiza el dispositivo de destino de impresión para el elemento, pero no actualiza la caché de presentación. Para actualizar la memoria caché de presentación de un elemento, llame a [UpdateLink](#updatelink).

Los argumentos de esta función contienen información que el sistema OLE usa para identificar el dispositivo de destino. La `PRINTDLG` estructura contiene información que Windows usa para inicializar el cuadro de diálogo de impresión común. Una vez que el usuario cierra el cuadro de diálogo, Windows devuelve información acerca de las selecciones del usuario en esta estructura. El `m_pd` miembro de un objeto [CPrintDialog](../../mfc/reference/cprintdialog-class.md) es una `PRINTDLG` estructura.

Para obtener más información sobre esta estructura, vea [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) en el Windows SDK.

Para obtener más información, vea [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) en el Windows SDK.

##  <a name="updatelink"></a>  COleClientItem::UpdateLink

Llame a esta función para actualizar los datos de presentación del elemento OLE inmediatamente.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero en caso de éxito; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

En el caso de los elementos vinculados, la función busca el origen del vínculo para obtener una nueva presentación para el elemento OLE. Este proceso puede implicar la ejecución de una o varias aplicaciones de servidor, lo que puede llevar mucho tiempo. En el caso de los elementos incrustados, la función funciona de forma recursiva, comprobando si el elemento incrustado contiene vínculos que podrían no estar actualizados y actualizarlos. El usuario también puede actualizar manualmente los vínculos individuales mediante el cuadro de diálogo vínculos.

Para obtener más información, vea [IOleLink:: Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) en el Windows SDK.

## <a name="see-also"></a>Vea también

[Ejemplo de MFC MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[Ejemplo OCLIENT de MFC](../../overview/visual-cpp-samples.md)<br/>
[CDocItem (clase)](../../mfc/reference/cdocitem-class.md)<br/>
[Gráfico de jerarquías](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem (clase)](../../mfc/reference/coleserveritem-class.md)
