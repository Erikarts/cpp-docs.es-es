---
title: COleClientItem (clase)
ms.date: 11/04/2016
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: cd04b2aa6dd1d539e357a69666bafc80e3ea5eba
ms.sourcegitcommit: fc1de63a39f7fcbfe2234e3f372b5e1c6a286087
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/15/2019
ms.locfileid: "65708156"
---
# <a name="coleclientitem-class"></a>COleClientItem (clase)

Define la interfaz del contenedor a elementos de OLE.

## <a name="syntax"></a>Sintaxis

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Miembros

### <a name="public-constructors"></a>Constructores públicos

|Name|Descripción|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Construye un objeto `COleClientItem`.|

### <a name="public-methods"></a>Métodos públicos

|Name|Descripción|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|Se abre el elemento OLE para una operación y, a continuación, ejecuta el verbo especificado.|
|[COleClientItem::ActivateAs](#activateas)|Activa el elemento como otro tipo.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Tiene acceso a los datos en el objeto OLE.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Indica si una aplicación contenedora puede crear un objeto incrustado.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Indica si una aplicación contenedora puede crear un objeto vinculado.|
|[COleClientItem::CanPaste](#canpaste)|Indica si el Portapapeles contiene un elemento OLE incrustable o estático.|
|[COleClientItem::CanPasteLink](#canpastelink)|Indica si el Portapapeles contiene un elemento OLE vinculable.|
|[COleClientItem::Close](#close)|Cierra un vínculo a un servidor, pero no destruirá el elemento OLE.|
|[COleClientItem::ConvertTo](#convertto)|Convierte el elemento a otro tipo.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Copia el elemento OLE en el Portapapeles.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Crea un duplicado de un elemento existente.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Crea un elemento incrustado desde el Portapapeles.|
|[COleClientItem::CreateFromData](#createfromdata)|Crea un elemento incrustado en un objeto de datos.|
|[COleClientItem::CreateFromFile](#createfromfile)|Crea un elemento incrustado desde un archivo.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Crea un elemento vinculado desde el Portapapeles.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Crea un elemento vinculado desde un objeto de datos.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Crea un elemento vinculado desde un archivo.|
|[COleClientItem::CreateNewItem](#createnewitem)|Crea un nuevo elemento incrustado, inicie la aplicación de servidor.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Crea un elemento estático del Portapapeles.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Crea un elemento estático desde un objeto de datos.|
|[COleClientItem::Deactivate](#deactivate)|Desactiva el elemento.|
|[COleClientItem::DeactivateUI](#deactivateui)|Interfaz de usuario de la aplicación contenedora se restaura a su estado original.|
|[COleClientItem::Delete](#delete)|Elimina o se cierra el elemento OLE si fuese un elemento vinculado.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Realiza una operación de arrastrar y colocar.|
|[COleClientItem::DoVerb](#doverb)|Ejecuta el verbo especificado.|
|[COleClientItem::Draw](#draw)|Dibuja el elemento OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Obtiene la vista que el elemento está activado en su lugar.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Devuelve los límites del rectángulo del elemento OLE.|
|[COleClientItem::GetClassID](#getclassid)|Obtiene el identificador de clase. del elemento presente|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Obtiene los datos que se colocarían en el Portapapeles mediante una llamada a la `CopyToClipboard` función miembro.|
|[COleClientItem::GetDocument](#getdocument)|Devuelve el `COleDocument` objeto que contiene el elemento está presente.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Obtiene la vista actual del elemento para la representación.|
|[COleClientItem::GetExtent](#getextent)|Devuelve los límites del rectángulo del elemento OLE.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Recupera un identificador a un icono asociado con el servidor de CLSID determinado.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Obtiene el metarchivo usado para dibujar el icono del elemento.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Devuelve un puntero a la ventana de edición en contexto del elemento.|
|[COleClientItem::GetItemState](#getitemstate)|Obtiene el estado del elemento actual.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Devuelve el estado de la última operación de OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Devuelve el modo de actualización para un elemento vinculado (característica avanzada).|
|[COleClientItem::GetType](#gettype)|Devuelve el tipo (incrustado, vinculado o estático) del elemento OLE.|
|[COleClientItem::GetUserType](#getusertype)|Obtiene una cadena que describe el tipo del elemento.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Devuelve TRUE si el elemento está activo en contexto.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Devuelve TRUE si un elemento vinculado está actualizado con su documento de origen.|
|[COleClientItem::IsModified](#ismodified)|Devuelve TRUE si el elemento se ha modificado desde la última guarda.|
|[COleClientItem::IsOpen](#isopen)|Devuelve TRUE si el elemento está actualmente abierto en la aplicación de servidor.|
|[COleClientItem::IsRunning](#isrunning)|Devuelve TRUE si se está ejecutando la aplicación de servidor del elemento.|
|[COleClientItem::OnActivate](#onactivate)|Lo llama el marco de trabajo para notificar el elemento que está activado.|
|[COleClientItem::OnActivateUI](#onactivateui)|Lo llama el marco de trabajo para notificar el elemento que se activa y debe mostrar su interfaz de usuario.|
|[COleClientItem::OnChange](#onchange)|Se llama cuando el servidor cambia el elemento OLE. Implementación necesaria.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Lo llama el marco de trabajo cuando se desactiva un elemento.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Lo llama el marco cuando el servidor quitó su interfaz de usuario local.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Lo llama el marco de trabajo para obtener los datos que se va a copiar en el Portapapeles.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Lo llama el marco para crear un menú compuesto.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Lo llama el marco de trabajo para quitar los menús del contenedor de un menú compuesto.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Lo llama el marco de trabajo para instalar y quitar un menú compuesto.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Lo llama el marco de trabajo para mostrar y ocultar las barras de control.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Lo llama el marco de trabajo para actualizar la barra de título de la ventana de marco.|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Vuelve a activar el elemento y deshace la última operación de edición en contexto.|
|[COleClientItem::Release](#release)|Libera la conexión a un elemento vinculado de OLE y se cierra si estaba abierta. No se destruye el elemento de cliente.|
|[COleClientItem::Reload](#reload)|Vuelve a cargar el elemento después de llamar a `ActivateAs`.|
|[COleClientItem::Run](#run)|Se ejecuta la aplicación asociada con el elemento.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Establece la vista actual del elemento para la representación.|
|[COleClientItem::SetExtent](#setextent)|Establece el rectángulo delimitador del elemento OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Establece los nombres del servidor se muestra cuando se edita el elemento OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Almacena en caché el metarchivo usado para dibujar el icono del elemento.|
|[COleClientItem::SetItemRects](#setitemrects)|Establece el rectángulo delimitador del elemento.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Establece el modo de actualización para un elemento vinculado (característica avanzada).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Establece el dispositivo de destino de impresión para este elemento de cliente.|
|[COleClientItem::UpdateLink](#updatelink)|Actualiza la caché de presentación de un elemento.|

### <a name="protected-methods"></a>Métodos protegidos

|Name|Descripción|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Lo llama el marco de trabajo para determinar si se permite la activación en contexto.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Lo llama el marco cuando cambia la posición de un elemento.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Lo llama el marco para deshacer tras la activación.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Lo llama el marco para descartar la información de estado de deshacer del elemento.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Lo llama el marco de trabajo para obtener las coordenadas de rectángulo de recorte del elemento.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Lo llama el marco de trabajo para obtener la posición del elemento con respecto a la vista.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Lo llama el marco de trabajo cuando se activa un elemento en su lugar.|
|[COleClientItem::OnScrollBy](#onscrollby)|Lo llama el marco para desplazar el elemento en la vista.|
|[COleClientItem::OnShowItem](#onshowitem)|Lo llama el marco de trabajo para mostrar el elemento OLE.|

## <a name="remarks"></a>Comentarios

Un elemento OLE representa datos creadas y mantenidas por una aplicación de servidor, puede incorporar "sin problemas" en un documento para que aparezca al usuario a un único documento. El resultado es un "documento compuesto" formado por el elemento OLE y un documento contenedor.

Un elemento OLE puede estar incrustado o vinculado. Si está insertado, sus datos se almacenan como parte del documento compuesto. Si está vinculada, sus datos se almacenan como parte de un archivo independiente creado por la aplicación de servidor, y solo un vínculo a ese archivo se almacena en el documento compuesto. Todos los elementos OLE contienen información que especifica la aplicación de servidor que debe llamarse para editarlos.

`COleClientItem` define varias funciones reemplazables que se llaman en respuesta a solicitudes de la aplicación de servidor; Estas funciones reemplazables suelen actúan como notificaciones. Esto permite que la aplicación de servidor para informar al contenedor de los cambios que realiza el usuario al editar el elemento OLE, o para recuperar la información necesaria durante la edición.

`COleClientItem` puede usarse con ninguno el [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md), o [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) clase. Para usar `COleClientItem`, derivar una clase e implementar el [OnChange](#onchange) función miembro, que define cómo responde el contenedor de los cambios realizados en el elemento. Para admitir la activación en contexto, invalidar el [OnGetItemPosition](#ongetitemposition) función miembro. Esta función proporciona información sobre la posición del elemento OLE mostrada.

Para obtener más información sobre el uso de la interfaz del contenedor, consulte los artículos [contenedores: Implementación de un contenedor](../../mfc/containers-implementing-a-container.md) y [activación](../../mfc/activation-cpp.md).

> [!NOTE]
>  El SDK de Windows hace referencia a elementos vinculados e incrustados como "objetos" y hace referencia a tipos de elementos como "clases". Esta referencia utiliza el término "item" para distinguir la entidad OLE desde el objeto de C++ correspondiente y el término "tipo" para distinguir la categoría OLE de la clase de C++.

## <a name="inheritance-hierarchy"></a>Jerarquía de herencia

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Requisitos

**Encabezado:** afxole.h

##  <a name="activate"></a>  COleClientItem::Activate

Llame a esta función para ejecutar el verbo especificado en lugar de [DoVerb](#doverb) para que pueda realizar su propio procesamiento cuando se produce una excepción.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parámetros

*nVerb*<br/>
Especifica el verbo que se ejecute. Puede ser uno de los siguientes:

|Valor|Significado|Símbolo|
|-----------|-------------|------------|
|- 0|verbo principal|OLEIVERB_PRIMARY|
|- 1|Verbo secundaria|(Ninguno)|
|- 1|Elemento de presentación para su edición|OLEIVERB_SHOW|
|- 2|Editar elemento en una ventana independiente|OLEIVERB_OPEN|
|- 3|Ocultar elementos|OLEIVERB_HIDE|

Normalmente, el valor-1 es un alias para otro verbo. Si no se admite la edición abierto, -2 tiene el mismo efecto que -1. Para los valores adicionales, consulte [DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) en el SDK de Windows.

*pView*<br/>
Puntero a la ventana de vista del contenedor que contiene el elemento OLE; se usa la aplicación de servidor para la activación en contexto. Este parámetro debe ser NULL si el contenedor no admite la activación en contexto.

*lpMsg*<br/>
Puntero al mensaje que se originó el elemento se puede activar.

### <a name="remarks"></a>Comentarios

Si la aplicación de servidor se escribió utilizando la biblioteca Microsoft Foundation Class, esta función causa el [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) función miembro de la correspondiente `COleServerItem` objeto que se va a ejecutar.

Si el verbo principal es editar y cero se especifica en el *nVerb* parámetro, la aplicación de servidor se inicia para permitir que el elemento OLE para editarse. Si la aplicación admite la activación en contexto, la edición puede realizarse en su lugar. Si el contenedor no es compatible con la activación en contexto (o si se especifica el verbo Open), el servidor se inicia en una ventana independiente y edición puede realizarse allí. Normalmente, cuando el usuario de la aplicación contenedora hace doble clic en el elemento OLE, el valor para el verbo principal en el *nVerb* parámetro determina la acción que el usuario puede llevar a cabo. Sin embargo, si el servidor admite sólo una acción, toma esa acción, con independencia de qué valor se especifica en el *nVerb* parámetro.

Para obtener más información, consulte [DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) en el SDK de Windows.

##  <a name="activateas"></a>  COleClientItem::ActivateAs

Funciones de conversión de objeto de OLE se utiliza para activar el elemento como si fuese un elemento del tipo especificado por *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parámetros

*lpszUserType*<br/>
Puntero a una cadena que representa el tipo de usuario de destino, como "Documento de Word".

*clsidOld*<br/>
Identificador de una referencia a la clase del elemento actual. El identificador de clase debe representar el tipo del objeto real, tal como está almacenado, a menos que sea un vínculo. En ese caso, debe ser el CLSID del elemento al que hace referencia el vínculo. El [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) proporciona automáticamente el identificador de clase correcto para el elemento.

*clsidNew*<br/>
Una referencia al identificador de clase de destino.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esto se llama de forma automática [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). No se suele llama directamente.

##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject

Llame a esta función para inicializar un [COleDataObject](../../mfc/reference/coledataobject-class.md) para tener acceso a los datos en el elemento OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parámetros

*rDataObject*<br/>
Hacer referencia a un `COleDataObject` objeto que se inicializará para permitir el acceso a los datos en el elemento OLE.

##  <a name="canactivate"></a>  COleClientItem::CanActivate

Lo llama el marco cuando el usuario solicita la activación en contexto del elemento OLE; valor devuelto de la función determina si se permite la activación en contexto.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se permite la activación en contexto; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

La implementación predeterminada permite la activación en contexto si el contenedor tiene una ventana válida. Reemplace esta función para implementar una lógica especial para aceptar o rechazar la solicitud de activación. Por ejemplo, se puede rechazar una solicitud de activación si el elemento OLE es demasiado pequeño o no es visible actualmente.

Para obtener más información, consulte [IOleInPlaceSite::CanInPlaceActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) en el SDK de Windows.

##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData

Comprueba si una aplicación contenedora puede crear un objeto incrustado desde el determinado `COleDataObject` objeto.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero a la [COleDataObject](../../mfc/reference/coledataobject-class.md) objeto desde el que se creará el elemento OLE.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el contenedor puede crear un objeto incrustado desde el `COleDataObject` objeto; en caso contrario, 0.

### <a name="remarks"></a>Comentarios

La `COleDataObject` clase se utiliza en las transferencias de datos para recuperar datos en diversos formatos del Portapapeles, mediante arrastrar y colocar, o desde un elemento OLE incrustado.

Contenedores pueden usar esta función para decidir habilitar o deshabilitar los comandos Pegar y editar Pegado especial.

Para obtener más información, vea el artículo [objetos de datos y orígenes de datos (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData

Comprueba si una aplicación contenedora puede crear un objeto vinculado desde el determinado `COleDataObject` objeto.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero a la [COleDataObject](../../mfc/reference/coledataobject-class.md) objeto desde el que se creará el elemento OLE.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el contenedor puede crear un objeto vinculado desde la `COleDataObject` objeto.

### <a name="remarks"></a>Comentarios

La `COleDataObject` clase se utiliza en las transferencias de datos para recuperar datos en diversos formatos del Portapapeles, mediante arrastrar y colocar, o desde un elemento OLE incrustado.

Contenedores pueden usar esta función para decidir habilitar o deshabilitar los comandos de edición especial de pegar y editar vínculo de pegar.

Para obtener más información, vea el artículo [objetos de datos y orígenes de datos (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="canpaste"></a>  COleClientItem::CanPaste

Llame a esta función para ver si se puede pegar un elemento OLE incrustado desde el Portapapeles.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se puede pegar un elemento OLE incrustado desde el Portapapeles; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Para obtener más información, consulte [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard) y [OleQueryCreateFromData](/windows/desktop/api/ole2/nf-ole2-olequerycreatefromdata) en el SDK de Windows.

##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink

Llame a esta función para ver si se puede pegar un elemento OLE vinculado desde el Portapapeles.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se puede pegar un elemento OLE vinculado desde el Portapapeles; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Para obtener más información, consulte [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard) y [OleQueryLinkFromData](/windows/desktop/api/ole2/nf-ole2-olequerylinkfromdata) en el SDK de Windows.

##  <a name="close"></a>  COleClientItem::Close

Llame a esta función para cambiar el estado de un elemento OLE del estado de ejecución al estado cargado, es decir, cargado con su controlador en la memoria, pero con el servidor no se está ejecutando.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parámetros

*dwCloseOption*<br/>
Marca que especifica en qué circunstancias se guarda el elemento OLE cuando vuelve al estado cargado. Puede tener uno de los valores siguientes:

- Elemento OLECLOSE_SAVEIFDIRTY guardar la OLE.

- OLECLOSE_NOSAVE no guarde el elemento OLE.

- OLECLOSE_PROMPTSAVE preguntar al usuario si desea guardar el elemento OLE.

### <a name="remarks"></a>Comentarios

Esta función no tiene ningún efecto cuando el elemento OLE no se está ejecutando.

Para obtener más información, consulte [IOleObject::Close](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-close) en el SDK de Windows.

##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem

Construye un `COleClientItem` objeto y lo agrega a la colección del documento contenedor de elementos de documento, que construye sólo el objeto de C++ y no lleva a cabo cualquier inicialización de OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parámetros

*pContainerDoc*<br/>
Puntero en el documento contenedor que contendrá este elemento. Esto puede ser cualquiera [COleDocument](../../mfc/reference/coledocument-class.md) derivado.

### <a name="remarks"></a>Comentarios

Si se pasa un puntero nulo, no se realiza ninguna suma para el documento contenedor. Debe llamar explícitamente a [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).

Debe llamar a una de las siguientes funciones miembro de creación antes de usar el elemento OLE:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>  COleClientItem::ConvertTo

Llame a esta función miembro para convertir el elemento en el tipo especificado por *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parámetros

*clsidNew*<br/>
El identificador de clase del tipo de destino.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esto se llama de forma automática [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). No es necesario llamarlo directamente.

##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard

Llame a esta función para copiar el elemento OLE en el Portapapeles.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parámetros

*bIncludeLink*<br/>
TRUE si se debe copiar información del vínculo en el Portapapeles, lo que permite un elemento vinculado se peguen; en caso contrario, FALSE.

### <a name="remarks"></a>Comentarios

Normalmente, se llama a esta función al escribir controladores de mensajes para los comandos Copiar o cortar en el menú Edición. Debe implementar selección de elementos en la aplicación contenedora, si desea implementar los comandos Copiar o Cortar.

Para obtener más información, consulte [OleSetClipboard](/windows/desktop/api/ole2/nf-ole2-olesetclipboard) en el SDK de Windows.

##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom

Llame a esta función para crear una copia del elemento OLE especificado.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parámetros

*pSrcItem*<br/>
Puntero en el elemento OLE se dupliquen.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

La copia es idéntica al elemento de origen. Puede usar esta función para admitir las operaciones de deshacer.

##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard

Llame a esta función para crear un elemento incrustado desde el contenido del Portapapeles.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*render*<br/>
Marca que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) en el SDK de Windows.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estructura utilizada si *representar* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcionar un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por *cfFormat*. Si se omite este parámetro, se usan los valores predeterminados para los demás campos en el `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Se suele llamar a esta función desde el controlador de mensajes para el comando Pegar en el menú Edición. (El comando Pegar se habilita el marco de trabajo si el [CanPaste](#canpaste) función miembro devuelve distinto de cero.)

Para obtener más información, consulte [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) y [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) en el SDK de Windows.

##  <a name="createfromdata"></a>  COleClientItem::CreateFromData

Llame a esta función para crear un elemento incrustado desde un `COleDataObject` objeto.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero a la [COleDataObject](../../mfc/reference/coledataobject-class.md) objeto desde el que se creará el elemento OLE.

*render*<br/>
Marca que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) en el SDK de Windows.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estructura utilizada si *representar* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcionar un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por *cfFormat*. Si se omite este parámetro, se usan los valores predeterminados para los demás campos en el `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Operaciones de transferencia de datos, como pegar desde el Portapapeles o las operaciones de arrastrar y colocar, proporcionan `COleDataObject` objetos que contiene la información que ofrece una aplicación de servidor. Normalmente se utiliza en el reemplazo de [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).

Para obtener más información, consulte [OleCreateFromData](/windows/desktop/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), y [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) en el SDK de Windows.

##  <a name="createfromfile"></a>  COleClientItem::CreateFromFile

Llame a esta función para crear un elemento OLE incrustado desde un archivo.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*lpszFileName*<br/>
Puntero al nombre de archivo desde el que se creará el elemento OLE.

*clsid*<br/>
Reservado para un uso futuro.

*render*<br/>
Marca que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) en el SDK de Windows.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estructura utilizada si *representar* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcionar un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por *cfFormat*. Si se omite este parámetro, se usan los valores predeterminados para los demás campos en el `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

El marco de trabajo llama a esta función desde [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) si el usuario elige Aceptar en el cuadro de diálogo Insertar objeto cuando se selecciona la creación de botón de archivo.

Para obtener más información, consulte [OleCreateFromFile](/windows/desktop/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), y [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) en el SDK de Windows.

##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard

Llame a esta función para crear un elemento vinculado a partir del contenido del Portapapeles.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*render*<br/>
Marca que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) en el SDK de Windows.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estructura utilizada si *representar* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcionar un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por *cfFormat*. Si se omite este parámetro, se usan los valores predeterminados para los demás campos en el `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Se suele llamar a esta función desde el controlador de mensajes para el comando Pegar vínculo en el menú Edición. (El comando Pegar vínculo está habilitado en la implementación predeterminada de [COleDocument](../../mfc/reference/coledocument-class.md) si el Portapapeles contiene un elemento OLE que se puede vincular a.)

Para obtener más información, consulte [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) y [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) en el SDK de Windows.

##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData

Llame a esta función para crear un elemento vinculado desde un `COleDataObject` objeto.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero a la [COleDataObject](../../mfc/reference/coledataobject-class.md) objeto desde el que se creará el elemento OLE.

*render*<br/>
Marca que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) en el SDK de Windows.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estructura utilizada si *representar* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcionar un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por *cfFormat*. Si se omite este parámetro, se usan los valores predeterminados para los demás campos en el `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Llámela durante una operación de colocar cuando el usuario indica que se debe crear un vínculo. También puede usarse para controlar el comando Pegar del menú. Lo llama el marco de trabajo en `COleClientItem::CreateLinkFromClipboard` y en [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) cuando se ha seleccionado la opción de vínculo.

Para obtener más información, consulte [OleCreateLinkFromData](/windows/desktop/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), y [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) en el SDK de Windows.

##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile

Llame a esta función para crear un elemento OLE vinculado desde un archivo.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*lpszFileName*<br/>
Puntero al nombre de archivo desde el que se creará el elemento OLE.

*render*<br/>
Marca que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) en el SDK de Windows.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estructura utilizada si *representar* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcionar un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por *cfFormat*. Si se omite este parámetro, se usan los valores predeterminados para los demás campos en el `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

El marco de trabajo llama a esta función si el usuario elige Aceptar en el cuadro de diálogo Insertar objeto cuando se selecciona la creación de botón de archivo y está activada la casilla de verificación de vínculo. Se llama desde [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Para obtener más información, consulte [OleCreateLinkToFile](/windows/desktop/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), y [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) en el SDK de Windows.

##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem

Llame a esta función para crear un elemento incrustado; Esta función inicia la aplicación de servidor que permite al usuario crear el elemento OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*clsid*<br/>
Id. que identifica el tipo de elemento OLE para crear.

*render*<br/>
Marca que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) en el SDK de Windows.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estructura utilizada si *representar* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcionar un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por *cfFormat*. Si se omite este parámetro, se usan los valores predeterminados para los demás campos en el `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

El marco de trabajo llama a esta función si el usuario elige Aceptar en el cuadro de diálogo Insertar objeto cuando se selecciona el botón Crear nuevo.

Para obtener más información, consulte [OleCreate](/windows/desktop/api/ole/nf-ole-olecreate), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), y [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) en el SDK de Windows.

##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard

Llame a esta función para crear un elemento estático del contenido del Portapapeles.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*render*<br/>
Marca que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) en el SDK de Windows.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estructura utilizada si *representar* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcionar un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por *cfFormat*. Si se omite este parámetro, se usan los valores predeterminados para los demás campos en el `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Un elemento estático contiene los datos de presentación, pero no los datos nativos; por lo tanto no se puede editar. Se suele llamar a esta función si la [CreateFromClipboard](#createfromclipboard) se produce un error en la función miembro.

Para obtener más información, consulte [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) y [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) en el SDK de Windows.

##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData

Llame a esta función para crear un elemento estático desde un `COleDataObject` objeto.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataObject*<br/>
Puntero a la [COleDataObject](../../mfc/reference/coledataobject-class.md) objeto desde el que se creará el elemento OLE.

*render*<br/>
Marca que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) en el SDK de Windows.

*cfFormat*<br/>
Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.

*lpFormatEtc*<br/>
Puntero a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estructura utilizada si *representar* es OLERENDER_FORMAT o OLERENDER_DRAW. Proporcionar un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por *cfFormat*. Si se omite este parámetro, se usan los valores predeterminados para los demás campos en el `FORMATETC` estructura.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Un elemento estático contiene los datos de presentación, pero no los datos nativos; por lo tanto, no se puede editar. Esto es básicamente el mismo que [CreateStaticFromClipboard](#createstaticfromclipboard) , salvo que se puede crear un elemento estático desde arbitrario `COleDataObject`, no solo desde el Portapapeles.

Utilizado en [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) cuando se selecciona estático.

Para obtener más información, consulte [OleCreateStaticFromData](/windows/desktop/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), y [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) en el SDK de Windows.

##  <a name="deactivate"></a>  COleClientItem::Deactivate

Llame a esta función para desactivar el elemento OLE y liberar todos los recursos asociados.

```
void Deactivate();
```

### <a name="remarks"></a>Comentarios

Normalmente, se desactiva un elemento OLE en contexto activo cuando el usuario hace clic en el mouse en el área de cliente fuera de los límites del elemento. Tenga en cuenta que desactivar el elemento OLE se descartará su estado de deshacer, que no se pueda llamar a la [ReactivateAndUndo](#reactivateandundo) función miembro.

Si la aplicación es compatible con la fase de reversión, no llame a `Deactivate`; en su lugar, llame a [DeactivateUI](#deactivateui).

Para obtener más información, consulte [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) en el SDK de Windows.

##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI

Llame a esta función cuando el usuario desactiva un elemento que se ha activado en su lugar.

```
void DeactivateUI();
```

### <a name="remarks"></a>Comentarios

Esta función restaura la interfaz de usuario de la aplicación contenedora en su estado original, ocultar los menús y otros controles que se crearon para la activación en contexto.

Esta función no vuelca la información de estado de deshacer para el elemento. Que se conserva la información para que [ReactivateAndUndo](#reactivateandundo) más adelante puede utilizarse para ejecutar un comando de deshacer en la aplicación de servidor, en caso de que se elige el comando de deshacer del contenedor inmediatamente después de desactivar el elemento.

Para obtener más información, consulte [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) en el SDK de Windows.

##  <a name="delete"></a>  COleClientItem::Delete

Llame a esta función para eliminar el elemento OLE del documento contenedor.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parámetros

*bAutoDelete*<br/>
Especifica si el elemento se quitará del documento.

### <a name="remarks"></a>Comentarios

Esta función llama a la [versión](#release) función miembro, lo que a su vez se elimina el objeto de C++ para el elemento, de forma permanente quitando el elemento OLE del documento. Si se incrusta el elemento OLE, se eliminan los datos nativos para el elemento. Siempre se cierra un servidor en ejecución; por lo tanto, si el elemento es abrir el vínculo, esta función lo cierra.

##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop

Llame a la `DoDragDrop` la función miembro para realizar una operación de arrastrar y colocar.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parámetros

*lpItemRect*<br/>
Rectángulo del elemento en la pantalla en coordenadas de cliente (píxeles).

*ptOffset*<br/>
El desplazamiento desde *lpItemRect* que era la posición del mouse en el momento de la operación de arrastrar.

*bIncludeLink*<br/>
Establezca esta opción en TRUE si el vínculo de datos deben copiarse en el Portapapeles. Establézcalo en FALSE si la aplicación de servidor no admite vínculos.

*dwEffects*<br/>
Determina los efectos que permitirá que el origen de arrastre en la operación de arrastre.

*lpRectStartDrag*<br/>
Puntero al rectángulo que define el donde realmente comienza la operación de arrastrar. Para obtener más información, vea la sección Comentarios que se muestra más adelante.

### <a name="return-value"></a>Valor devuelto

Un valor EFECTOCOLOCAR. Si es DROPEFFECT_MOVE, deben quitarse los datos originales.

### <a name="remarks"></a>Comentarios

No se inicie inmediatamente la operación de arrastrar y colocar. Espera hasta que el cursor del mouse sale del rectángulo especificado por *lpRectStartDrag* o hasta que un número especificado de milisegundos que ha pasado. Si *lpRectStartDrag* es NULL, el tamaño del rectángulo es un píxel.

El tiempo de retraso especificado por un valor de clave del registro. Puede cambiar el tiempo de retraso mediante una llamada a [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) o [CWinApp:: Writeprofileint](../../mfc/reference/cwinapp-class.md#writeprofileint). Si no especifica el tiempo de retraso, se usa el valor predeterminado es 200 milisegundos. Tiempo de retraso de arrastre se almacena como sigue:

- Tiempo de retraso de arrastre de Windows NT se almacena en HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- Retrasar hora de Windows 3.x arrastrar se almacena en el archivo WIN. Archivo INI, la sección [Windows}.

- Tiempo de retraso de arrastre de Windows 95/98 se almacena en una versión en caché de WIN. INI.

Para obtener más información acerca de cómo arrastrar se almacena información sobre los retrasos en el registro o el. Archivo INI, consulte [WriteProfileString](/windows/desktop/api/winbase/nf-winbase-writeprofilestringa) en el SDK de Windows.

##  <a name="doverb"></a>  COleClientItem::DoVerb

Llame a `DoVerb` para ejecutar el verbo especificado.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parámetros

*nVerb*<br/>
Especifica el verbo que se ejecute. Puede incluir uno de los siguientes:

|Valor|Significado|Símbolo|
|-----------|-------------|------------|
|- 0|verbo principal|OLEIVERB_PRIMARY|
|- 1|Verbo secundaria|(Ninguno)|
|- 1|Elemento de presentación para su edición|OLEIVERB_SHOW|
|- 2|Editar elemento en una ventana independiente|OLEIVERB_OPEN|
|- 3|Ocultar elementos|OLEIVERB_HIDE|

Normalmente, el valor-1 es un alias para otro verbo. Si no se admite la edición abierto, -2 tiene el mismo efecto que -1. Para los valores adicionales, consulte [DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) en el SDK de Windows.

*pView*<br/>
Puntero a la ventana de vista; se usa el servidor de activación en contexto. Este parámetro debe ser NULL si la aplicación no permite la activación en contexto.

*lpMsg*<br/>
Puntero al mensaje que se originó el elemento se puede activar.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el verbo se ejecutó correctamente; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Esta función llama a la [activar](#activate) función miembro para ejecutar el verbo. También detecta las excepciones y muestra un cuadro de mensaje al usuario si se ha producido una.

Si el verbo principal es editar y cero se especifica en el *nVerb* parámetro, la aplicación de servidor se inicia para permitir que el elemento OLE para editarse. Si la aplicación admite la activación en contexto, la edición puede realizarse en su lugar. Si el contenedor no es compatible con la activación en contexto (o si se especifica el verbo Open), el servidor se inicia en una ventana independiente y edición puede realizarse allí. Normalmente, cuando el usuario de la aplicación contenedora hace doble clic en el elemento OLE, el valor para el verbo principal en el *nVerb* parámetro determina la acción que el usuario puede llevar a cabo. Sin embargo, si el servidor admite sólo una acción, toma esa acción, con independencia de qué valor se especifica en el *nVerb* parámetro.

##  <a name="draw"></a>  COleClientItem::Draw

Llame a esta función para dibujar el elemento OLE en el rectángulo delimitador especificado utilizando el contexto de dispositivo especificado.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parámetros

*pDC*<br/>
Puntero a un [CDC](../../mfc/reference/cdc-class.md) objeto usado para dibujar el elemento OLE.

*lpBounds*<br/>
Puntero a un [CRect](../../atl-mfc-shared/reference/crect-class.md) objeto o `RECT` estructura que define el rectángulo delimitador en el que se va a dibujar el elemento OLE (en unidades lógicas que determine el contexto de dispositivo).

*nDrawAspect*<br/>
Especifica el aspecto de OLE de elementos, es decir, cómo debe mostrarse. Si *nDrawAspect* es -1, el último aspecto establecer mediante [SetDrawAspect](#setdrawaspect) se utiliza. Para obtener más información acerca de los valores posibles para esta marca, vea [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

La función puede usar la representación del metarchivo del elemento OLE creado por el [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) función miembro de `COleServerItem`.

Normalmente se usa `Draw` para presentación en pantalla, pasando el contexto de dispositivo de pantalla como *pDC*. En este caso, deberá especificar solo los dos primeros parámetros.

El *lpBounds* parámetro identifica el rectángulo en el contexto de dispositivo de destino (con respecto a su modo de asignación actual). Representación puede implicar la escala de la imagen y se puede usar las aplicaciones de contenedor para imponer una vista que se puede escalar entre la vista mostrada y la imagen impresa final.

Para obtener más información, consulte [IViewObject::Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw) en el SDK de Windows.

##  <a name="getactiveview"></a>  COleClientItem::GetActiveView

Devuelve la vista en el que el elemento está activado en contexto.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Valor devuelto

Un puntero a la vista; en caso contrario, es NULL si el elemento no está activado en el contexto.

##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent

Llame a esta función para recuperar el tamaño del elemento OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parámetros

*lpSize*<br/>
Puntero a un `SIZE` estructura o un [CSize](../../atl-mfc-shared/reference/csize-class.md) objeto que recibirá la información de tamaño.

*nDrawAspect*<br/>
Especifica el aspecto del producto OLE cuyos límites se van a recuperar. Para los valores posibles, vea [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 si el elemento OLE está en blanco.

### <a name="remarks"></a>Comentarios

Esta función proporciona la misma información que [GetExtent](#getextent). Sin embargo, puede llamar a `GetCachedExtent` para obtener información de extensión durante el procesamiento de otros controladores de OLE, como [OnChange](#onchange). Las dimensiones están en unidades MM_HIMETRIC.

Esto es posible porque `GetCachedExtent` usa el [IViewObject2](/windows/desktop/api/oleidl/nn-oleidl-iviewobject2) interfaz en lugar de utilizar el [IOleObject](/windows/desktop/api/oleidl/nn-oleidl-ioleobject) interfaz para obtener el alcance de este elemento. El `IViewObject2` objeto COM almacena en caché la información de la extensión utilizada en la llamada anterior a [IViewObject::Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw).

Para obtener más información, consulte [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) en el SDK de Windows.

##  <a name="getclassid"></a>  COleClientItem::GetClassID

Devuelve el identificador de clase del elemento en la memoria que apunta *pClassID*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parámetros

*pClassID*<br/>
Puntero a un identificador de tipo [CLSID](/windows/desktop/com/clsid-key-hklm) para recuperar el identificador de clase. Para obtener información sobre el CLSID, consulte el SDK de Windows.

### <a name="remarks"></a>Comentarios

El identificador de clase es un número de 128 bits que identifica la aplicación que edita el elemento.

Para obtener más información, consulte [IPersist:: GetClassID](/windows/desktop/api/objidl/nf-objidl-ipersist-getclassid) en el SDK de Windows.

##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData

Llame a esta función para obtener un `COleDataSource` objeto que contiene todos los datos que se colocarían en el Portapapeles mediante una llamada a la [CopyToClipboard](#copytoclipboard) función miembro.

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parámetros

*pDataSource*<br/>
Puntero a un [COleDataSource](../../mfc/reference/coledatasource-class.md) objeto que recibirá los datos contenidos en el elemento OLE.

*bIncludeLink*<br/>
TRUE si deben incluirse los datos del vínculo; en caso contrario, FALSE.

*lpOffset*<br/>
El desplazamiento del cursor del mouse desde el origen del objeto en píxeles.

*lpSize*<br/>
El tamaño del objeto en píxeles.

### <a name="remarks"></a>Comentarios

`GetClipboardData` se llama como la implementación predeterminada de [OnGetClipboardData](#ongetclipboarddata). Invalidar `OnGetClipboardData` sólo si desea ofrecer a los formatos de datos además de los que ofrecen `CopyToClipboard`. Colocar estos formatos en el `COleDataSource` objeto antes o después de llamar a `CopyToClipboard`y, a continuación, pase el `COleDataSource` de objeto para el [COleDataSource:: SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) función. Por ejemplo, si desea que la posición del elemento OLE en su documento de contenedor para acompañar a él en el Portapapeles, definir su propio formato para pasar esa información y colóquelo en el `COleDataSource` antes de llamar a `CopyToClipboard`.

##  <a name="getdocument"></a>  COleClientItem::GetDocument

Llame a esta función para obtener un puntero al documento que contiene el elemento OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Valor devuelto

Un puntero al documento que contiene el elemento OLE. Es NULL si el elemento no forma parte de un documento.

### <a name="remarks"></a>Comentarios

This (puntero) permite el acceso a la `COleDocument` objeto pasado como argumento a la `COleClientItem` constructor.

##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect

Llame a la `GetDrawAspect` la función miembro para determinar el "aspecto" actual o la vista del elemento.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Valor devuelto

Un valor de la enumeración DVASPECT, cuyos valores se muestran en la referencia para [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Comentarios

El aspecto especifica cómo se representará el elemento.

##  <a name="getextent"></a>  COleClientItem::GetExtent

Llame a esta función para recuperar el tamaño del elemento OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parámetros

*lpSize*<br/>
Puntero a un `SIZE` estructura o un `CSize` objeto que recibirá la información de tamaño.

*nDrawAspect*<br/>
Especifica el aspecto del producto OLE cuyos límites se van a recuperar. Para los valores posibles, vea [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; 0 si el elemento OLE está en blanco.

### <a name="remarks"></a>Comentarios

Si la aplicación de servidor se escribió utilizando la biblioteca Microsoft Foundation Class, esta función causa el [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) función miembro de la correspondiente `COleServerItem` objeto que se llama. Tenga en cuenta que el tamaño recuperado puede diferir el tamaño establecido por última vez por la [SetExtent](#setextent) función miembro; el tamaño especificado por `SetExtent` se trata como una sugerencia. Las dimensiones están en unidades MM_HIMETRIC.

> [!NOTE]
>  No llame a `GetExtent` durante el procesamiento de un controlador de OLE, como [OnChange](#onchange). Llame a [GetCachedExtent](#getcachedextent) en su lugar.

Para obtener más información, consulte [IOleObject::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getextent) en el SDK de Windows.

##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry

Llame a esta función miembro para recuperar un identificador de un recurso de icono asociado con el servidor de CLSID determinado.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parámetros

*clsid*<br/>
Una referencia al CLSID para el servidor asociado al icono.

### <a name="return-value"></a>Valor devuelto

Válido controlar para el recurso de icono, o NULL si el icono del servidor o un icono predeterminado, no se encuentra.

### <a name="remarks"></a>Comentarios

Esta función miembro no iniciar el servidor ni obtener un icono de forma dinámica, incluso si ya se está ejecutando el servidor. En su lugar, esta función miembro abre imagen ejecutable del servidor y recupera el icono estático asociado con el servidor porque se ha registrado.

##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile

Recupera el metarchivo usado para dibujar el icono del elemento.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Valor devuelto

Un identificador del metarchivo si se realiza correctamente; en caso contrario, es NULL.

### <a name="remarks"></a>Comentarios

Si no hay ningún icono actual, se devuelve un icono predeterminado. Esto se denomina automáticamente en los cuadros de diálogo MFC/OLE y no se suele llamar directamente.

También se llama esta función [SetIconicMetafile](#seticonicmetafile) para almacenar en caché el metarchivo para su uso posterior.

##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow

Llame a la `GetInPlaceWindow` la función miembro para obtener un puntero a la ventana en la que el elemento se ha abierto para edición en contexto.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Valor devuelto

Un puntero a la ventana de edición del elemento local; NULL si el elemento no está activo o si su servidor no está disponible.

### <a name="remarks"></a>Comentarios

Esta función debe llamarse únicamente para los elementos que están activos en contexto.

##  <a name="getitemstate"></a>  COleClientItem::GetItemState

Llame a esta función para obtener el estado actual del elemento OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Valor devuelto

Un `COleClientItem::ItemState` enumerado valor, que puede ser uno de los siguientes: `emptyState`, `loadedState`, `openState`, `activeState`, `activeUIState`. Para obtener información acerca de estos Estados, consulte el artículo [contenedores: Estados de elementos de cliente](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Comentarios

Para recibir una notificación cuando cambia el estado del elemento OLE, utilice el [OnChange](#onchange) función miembro.

Para obtener más información, vea el artículo [contenedores: Estados de elementos de cliente](../../mfc/containers-client-item-states.md).

##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus

Devuelve el código de estado de la última operación de OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Valor devuelto

Un valor SCODE.

### <a name="remarks"></a>Comentarios

Para las funciones miembro que devuelven un valor booleano FALSE o de otro miembro de funciones que devuelven valores NULL, `GetLastStatus` devuelve información de error más detallada. Tenga en cuenta que la mayoría de las funciones de miembro OLE produce excepciones para los errores más graves. La información específica sobre la interpretación de lo SCODE depende de la llamada OLE subyacente que devuelve un valor SCODE de por última vez.

Para obtener más información sobre SCODE, consulte [estructura de códigos de Error COM](/windows/desktop/com/structure-of-com-error-codes) en la documentación del SDK de Windows.

##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions

Llame a esta función para obtener el valor actual de la opción de actualización de los vínculos para el elemento OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Valor devuelto

Uno de los siguientes valores:

- OLEUPDATE_ALWAYS actualizar el elemento vinculado siempre que sea posible. Esta opción es compatible con el botón de opción de actualización automática de los vínculos en el cuadro de diálogo de vínculos.

- OLEUPDATE_ONCALL actualizar el elemento vinculado solo en la solicitud de la aplicación de contenedor (cuando el [UpdateLink](#updatelink) se llama a la función miembro). Esta opción es compatible con el botón de opción de actualización Manual de los vínculos en el cuadro de diálogo de vínculos.

### <a name="remarks"></a>Comentarios

Se trata de una operación avanzada.

Esta función llama de forma automática el [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) clase.

Para obtener más información, consulte [IOleLink::GetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-getupdateoptions) en el SDK de Windows.

##  <a name="gettype"></a>  COleClientItem::GetType

Llame a esta función para determinar si el elemento OLE se incrustados o vinculado o static.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Valor devuelto

Un entero sin signo con uno de los siguientes valores:

- Elemento OT_LINK The OLE es un vínculo.

- El elemento OT_EMBEDDED The OLE está incrustado.

- Elemento OT_STATIC The OLE es estático, es decir, contiene solo los datos de presentación, los datos no nativos y, por tanto, no se puede editar.

##  <a name="getusertype"></a>  COleClientItem::GetUserType

Llame a esta función para obtener la cadena visible para el usuario que describe el tipo del elemento OLE, por ejemplo, "Documento de Word".

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parámetros

*nUserClassType*<br/>
Un valor que indica la variante de la cadena que describe el tipo del elemento OLE deseada. Esto puede tener uno de los valores siguientes:

- USERCLASSTYPE_FULL muestra al usuario el nombre de tipo completo.

- USERCLASSTYPE_SHORT un nombre corto (15 caracteres como máximo) para su uso en los menús emergentes y en el cuadro de diálogo Editar vínculos.

- USERCLASSTYPE_APPNAME el nombre de la aplicación de la clase de servicio.

*rString*<br/>
Una referencia a un [CString](../../atl-mfc-shared/reference/cstringt-class.md) objeto al que se va a devolver la cadena que describe el tipo del elemento OLE.

### <a name="remarks"></a>Comentarios

Esto suele ser la entrada en la base de datos de registro del sistema.

Si el nombre de tipo completo es solicitado pero no está disponible, el nombre corto se utiliza en su lugar. Si se encuentra ninguna entrada para el tipo de elemento OLE en la base de datos de registro, o si no hay ningún tipo de usuario registrado para el tipo de elemento OLE, a continuación, el tipo de usuario almacenados actualmente en el elemento OLE se utiliza. Si ese nombre de tipo de usuario es una cadena vacía, se utiliza "Objeto desconocido".

Para obtener más información, consulte [IOleObject::GetUserType](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getusertype) en el SDK de Windows.

##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive

Llame a esta función para ver si el elemento OLE en contexto activo.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE en contexto activo; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Resulta común ejecutar una lógica diferente dependiendo de si el elemento se está editando en su lugar. La función comprueba si el estado del elemento actual es igual a la `activeState` o `activeUIState`.

##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate

Llame a esta función para ver si el elemento OLE está actualizado.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE está actualizado; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Un elemento vinculado puede estar obsoleto si se ha actualizado su documento de origen. Un elemento incrustado que contiene los vínculos dentro de él de forma similar puede convertirse en obsoleto. La función realiza una comprobación de recursiva del elemento OLE. Tenga en cuenta que puede ser más costoso que realmente realiza una actualización determinar si un elemento OLE está obsoleto.

Esto se llama de forma automática el [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) implementación.

Para obtener más información, consulte [IOleObject::IsUpToDate](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-isuptodate) en el SDK de Windows.

##  <a name="ismodified"></a>  COleClientItem::IsModified

Llame a esta función para ver si el elemento OLE está desfasado (modificado desde que se guardó por última vez).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE se ha modificado; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Para obtener más información, consulte [IPersistStorage::IsDirty](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-isdirty) en el SDK de Windows.

##  <a name="isopen"></a>  COleClientItem::IsOpen

Llame a esta función para ver si está abierto; el elemento OLE es decir, se abre en una instancia de la aplicación de servidor que se ejecuta en una ventana independiente.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE está abierto; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Sirve para determinar cuándo se va a dibujar el objeto con un modelo de sombreado. Un objeto abierto debe tener un patrón de trama dibujado en la parte superior del objeto. Puede usar un [CRectTracker](../../mfc/reference/crecttracker-class.md) objeto para realizar esta acción.

##  <a name="isrunning"></a>  COleClientItem::IsRunning

Llame a esta función para ver si el elemento OLE se está ejecutando; es decir, si el elemento está cargado y en ejecución en la aplicación de servidor.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si el elemento OLE se está ejecutando; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Para obtener más información, consulte [OleIsRunning](/windows/desktop/api/ole2/nf-ole2-oleisrunning) en el SDK de Windows.

##  <a name="onactivate"></a>  COleClientItem::OnActivate

Lo llama el marco de trabajo para notificar a los elementos que solo se ha activado en su lugar.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Comentarios

Tenga en cuenta que esta función se llama para indicar que el servidor se está ejecutando, no para indicar que se ha instalado su interfaz de usuario de la aplicación contenedora. En este momento, el objeto no tiene una interfaz de usuario activas (no es `activeUIState`). No lo ha instalado su menús o barra de herramientas. El [OnActivateUI](#onactivateui) función miembro se llama cuando esto ocurre.

La implementación predeterminada llama el [OnChange](#onchange) función miembro con OLE_CHANGEDSTATE como un parámetro. Reemplace esta función para realizar un procesamiento personalizado cuando un elemento se vuelva activo en contexto.

##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI

Las llamadas de framework `OnActivateUI` cuando el objeto ha entrado en el estado activo de la interfaz de usuario.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Comentarios

El objeto ya ha instalado su barra de herramientas y menús.

La implementación predeterminada recuerda el HWND del servidor para su uso posterior `GetServerWindow` llamadas.

##  <a name="onchange"></a>  COleClientItem::OnChange

Lo llama el marco cuando el usuario modifica, guarda o cierra el elemento OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parámetros

*nCode*<br/>
El motivo por el servidor puede cambiar este elemento. Puede tener uno de los valores siguientes:

- Apariencia del OLE_CHANGED The OLE elemento ha cambiado.

- Se ha guardado el elemento OLE_SAVED The OLE.

- Se ha cerrado el elemento OLE_CLOSED The OLE.

- Elemento OLE_CHANGED_STATE The OLE ha cambiado de un estado a otro.

*dwParam*<br/>
Si *nCode* es OLE_SAVED o OLE_CLOSED, no se utiliza este parámetro. Si *nCode* es OLE_CHANGED, este parámetro especifica el aspecto del elemento OLE que ha cambiado. Para los valores posibles, vea el *dwParam* parámetro de [COleClientItem::Draw](#draw). Si *nCode* es OLE_CHANGED_STATE, este parámetro es un `COleClientItem::ItemState` valor enumerado y se describe el estado que se escribió. Puede tener uno de los siguientes valores: `emptyState`, `loadedState`, `openState`, `activeState`, o `activeUIState`.

### <a name="remarks"></a>Comentarios

(Si la aplicación de servidor se escribe mediante la biblioteca Microsoft Foundation Class, se llama a esta función en respuesta a la `Notify` funciones miembro de `COleServerDoc` o `COleServerItem`.) La implementación predeterminada marca el documento contenedor como modificado si *nCode* es OLE_CHANGED o OLE_SAVED.

Para OLE_CHANGED_STATE, se devuelve el estado actual de [GetItemState](#getitemstate) seguirá siendo el estado antiguo, lo que significa que el estado que era actual antes de realizar este cambio de estado.

Reemplace esta función para responder a los cambios de estado del elemento OLE. Normalmente, actualizar la apariencia del elemento que se invalide el área en la que se muestra el elemento. Llame a la implementación de la clase base al principio de la invalidación.

##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition

Lo llama el marco de trabajo para notificar al contenedor que ha cambiado la extensión del elemento OLE durante la activación en contexto.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parámetros

*rectPos*<br/>
Indica la posición del elemento respecto al área de cliente de la aplicación contenedora.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la posición del elemento se ha cambiado correctamente; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

La implementación predeterminada determina el nuevo rectángulo visible del elemento OLE y las llamadas [SetItemRects](#setitemrects) con los nuevos valores. La implementación predeterminada calcula el rectángulo visible para el elemento y pasa esa información al servidor.

Reemplace esta función para que aplique reglas especiales para la operación de cambio de tamaño o mover. Si la aplicación está escrita en MFC, esta llamada se produce porque el servidor llama [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate

Lo llama el marco cuando el elemento OLE pasa desde el estado activo en contexto ( `activeState`) al estado cargado, lo que significa que se está desactivado después de una activación en contexto.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Comentarios

Tenga en cuenta que esta función se llama para indicar que el elemento OLE se cierra, no que se ha quitado su interfaz de usuario de la aplicación contenedora. Cuando esto ocurre, el [OnDeactivateUI](#ondeactivateui) se llama a la función miembro.

La implementación predeterminada llama el [OnChange](#onchange) función miembro con OLE_CHANGEDSTATE como un parámetro. Reemplace esta función para realizar un procesamiento personalizado cuando se desactiva un elemento activo en contexto. Por ejemplo, si admite el comando Deshacer en la aplicación de contenedor, puede reemplazar esta función para descartar el estado de deshacer, que indica que la última operación realizada en el elemento OLE no se puede deshacer una vez que el elemento está desactivado.

##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo

Lo llama el marco cuando el usuario invoca el comando Deshacer después de activar el elemento OLE en su lugar.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Comentarios

La implementación predeterminada llama [DeactivateUI](#deactivateui) para desactivar la interfaz de usuario del servidor. Reemplace esta función si está implementando el comando Deshacer en la aplicación contenedora. En la invalidación, llame a la versión de la clase base de la función y, a continuación, deshacer el último comando ejecutado en la aplicación.

Para obtener más información, consulte [IOleInPlaceSite::DeactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) en el SDK de Windows.

##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI

Se llama cuando el usuario desactiva un elemento que se ha activado en su lugar.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parámetros

*bUndoable*<br/>
Especifica si se puede deshacer los cambios de edición.

### <a name="remarks"></a>Comentarios

Esta función restaura la interfaz de usuario de la aplicación contenedora en su estado original, ocultar los menús y otros controles que se crearon para la activación en contexto.

Si *bUndoable* es FALSE, el contenedor debe deshabilitar el comando Deshacer, descartando vigente el estado de deshacer del contenedor, ya que indica que la última operación realizada por el servidor no es que se puede deshacer.

##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState

Lo llama el marco cuando el usuario realiza una acción que se descarta el estado de deshacer mientras se edita el elemento OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Comentarios

La implementación predeterminada no hace nada. Reemplace esta función si está implementando el comando Deshacer en la aplicación contenedora. En la invalidación, descartar el estado de deshacer de la aplicación contenedora.

Si el servidor se ha escrito con la biblioteca Microsoft Foundation Class, el servidor puede producir esta función llamar a [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Para obtener más información, consulte [IOleInPlaceSite::DiscardUndoState](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) en el SDK de Windows.

##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData

Lo llama el marco para obtener un `COleDataSource` objeto que contiene todos los datos que se colocarían en el Portapapeles mediante una llamada a la [CopyToClipboard](#copytoclipboard) o [DoDragDrop](#dodragdrop) función miembro.

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parámetros

*bIncludeLink*<br/>
Establezca esta opción en TRUE si se deben copiar los datos del vínculo en el Portapapeles. Establézcalo en FALSE si el servidor de aplicación no admite vínculos.

*lpOffset*<br/>
Puntero al desplazamiento del cursor del mouse desde el origen del objeto en píxeles.

*lpSize*<br/>
Puntero al tamaño del objeto en píxeles.

### <a name="return-value"></a>Valor devuelto

Un puntero a un [COleDataSource](../../mfc/reference/coledatasource-class.md) objeto que contiene los datos del Portapapeles.

### <a name="remarks"></a>Comentarios

La implementación predeterminada de esta función llama [GetClipboardData](#getclipboarddata).

##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect

Las llamadas de framework la `OnGetClipRect` función miembro para obtener las coordenadas del rectángulo de recorte del elemento que se está editando en su lugar.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parámetros

*rClipRect*<br/>
Puntero a un objeto de clase [CRect](../../atl-mfc-shared/reference/crect-class.md) que va a contener las coordenadas del rectángulo de recorte del elemento.

### <a name="remarks"></a>Comentarios

Las coordenadas están en píxeles con respecto al área de cliente de la ventana de aplicación de contenedor.

La implementación predeterminada simplemente devuelve el rectángulo de cliente de la vista en el que el elemento está activo en contexto.

##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition

Las llamadas de framework la `OnGetItemPosition` función miembro para obtener las coordenadas del elemento que se está editando en su lugar.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parámetros

*rPosition*<br/>
Hacer referencia a la [CRect](../../atl-mfc-shared/reference/crect-class.md) objeto que contiene las coordenadas de posición del elemento.

### <a name="remarks"></a>Comentarios

Las coordenadas están en píxeles con respecto al área de cliente de la ventana de aplicación de contenedor.

La implementación predeterminada de esta función no hace nada. Las aplicaciones que admiten la edición en contexto requieren su implementación.

##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext

Lo llama el marco de trabajo cuando se activa un elemento en su lugar.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parámetros

*ppMainFrame*<br/>
Puntero a un puntero a la ventana de marco principal.

*ppDocFrame*<br/>
Puntero a un puntero a la ventana de marco de documento.

*lpFrameInfo*<br/>
Puntero a un [OLEINPLACEFRAMEINFO](/windows/desktop/api/oleidl/ns-oleidl-tagoifi) estructura que recibirá la información de la ventana de marco.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Esta función se usa para recuperar información acerca de la ventana del elemento primario del elemento OLE.

Si el contenedor es una aplicación MDI, la implementación predeterminada devuelve un puntero a la [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) objeto *ppMainFrame* y un puntero a activo [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)objeto *ppDocFrame*. Si el contenedor es una aplicación SDI, la implementación predeterminada devuelve un puntero a la [CFrameWnd](../../mfc/reference/cframewnd-class.md) objeto *ppMainFrame* y devuelve NULL en *ppDocFrame*. También llena la implementación predeterminada de los miembros de *lpFrameInfo*.

Reemplace esta función sólo si la implementación predeterminada no se ajusten a su aplicación; Por ejemplo, si la aplicación tiene un paradigma de interfaz de usuario que difiere de SDI o MDI. Esto es un avanzado que se puede invalidar.

Para obtener más información, consulte [IOleInPlaceSite::GetWindowContext](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) y [OLEINPLACEFRAMEINFO](/windows/desktop/api/oleidl/ns-oleidl-tagoifi) estructura en el SDK de Windows.

##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus

Lo llama el marco de trabajo durante la activación en contexto para insertar los menús de la aplicación contenedora en un menú vacío.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parámetros

*pMenuShared*<br/>
Apunta a un menú vacío.

*lpMenuWidths*<br/>
Apunta a una matriz de seis valores LONG que indica cuántos de los menús están en cada uno de los siguientes grupos de menú: Archivo, edición, contenedor, objeto, ventana, ayuda. La aplicación es responsable de los grupos de menú archivo, el contenedor y la ventana, correspondientes a los elementos 0, 2 y 4 de esta matriz.

### <a name="remarks"></a>Comentarios

Este menú, a continuación, se pasa al servidor, que inserta sus propios menús, crear un menú compuesto. Esta función se puede llamar varias veces para crear varios menús compuestos.

Inserta la implementación predeterminada *pMenuShared* los menús en contexto contenedor; es decir, los grupos de menú archivo, el contenedor y ventana. [CDocTemplate:: SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) se usa para establecer este recurso de menú. La implementación predeterminada también asigna los valores adecuados a los elementos 0, 2 y 4 en *lpMenuWidths*, según el recurso de menú. Reemplace esta función si la implementación predeterminada no es adecuada para su aplicación; Por ejemplo, si la aplicación no usa plantillas de documento para asociar recursos a los tipos de documento. Si reemplaza esta función, también debe invalidar [OnSetMenu](#onsetmenu) y [OnRemoveMenus](#onremovemenus). Esto es un avanzado que se puede invalidar.

Para obtener más información, consulte [IOleInPlaceFrame::InsertMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) en el SDK de Windows.

##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus

Lo llama el marco de trabajo para quitar los menús del contenedor en el menú compuesto especificado cuando finaliza la activación en contexto.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parámetros

*pMenuShared*<br/>
Apunta al menú compuesto construido mediante llamadas a la [OnInsertMenus](#oninsertmenus) función miembro.

### <a name="remarks"></a>Comentarios

Quita de la implementación predeterminada de *pMenuShared* los menús en contexto contenedor, que es, los grupos de menú archivo, el contenedor y ventana. Reemplace esta función si la implementación predeterminada no es adecuada para su aplicación; Por ejemplo, si la aplicación no usa plantillas de documento para asociar recursos a los tipos de documento. Si reemplaza esta función, debe reemplazar probablemente [OnInsertMenus](#oninsertmenus) y [OnSetMenu](#onsetmenu) también. Esto es un avanzado que se puede invalidar.

Los submenús *pMenuShared* pueda ser compartido por más de un menú compuesto si el servidor se llama repetidamente `OnInsertMenus`. Por lo tanto, no debe eliminar cualquier submenús en el reemplazo de `OnRemoveMenus`; solo debe separarlas.

Para obtener más información, consulte [IOleInPlaceFrame::RemoveMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) en el SDK de Windows.

##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy

Lo llama el marco para desplazar el elemento OLE en respuesta a las solicitudes del servidor.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parámetros

*sizeExtent*<br/>
Especifica la distancia, en píxeles, para desplazarse por las direcciones de x e y.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se ha desplazado el elemento; 0 si no se pudo desplazar el elemento.

### <a name="remarks"></a>Comentarios

Por ejemplo, si el elemento OLE está parcialmente visible y el usuario se mueve fuera del área visible mientras se realiza la edición en contexto, se llama a esta función para mantener visible el cursor. La implementación predeterminada no hace nada. Reemplace esta función para desplazar el elemento en la cantidad especificada. Tenga en cuenta que como resultado de desplazamiento, puede cambiar la parte visible del elemento OLE. Llame a [SetItemRects](#setitemrects) actualizar rectángulo visible del elemento.

Para obtener más información, consulte [IOleInPlaceSite::Scroll](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-scroll) en el SDK de Windows.

##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu

Lo llama el marco de trabajo dos veces cuando la activación en contexto comienza y finaliza; la primera vez para instalar el menú compuesto y la segunda vez (con *holemenu* igual a NULL) para quitarlo.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parámetros

*pMenuShared*<br/>
Puntero al menú compuesto construido mediante llamadas a la [OnInsertMenus](#oninsertmenus) función miembro y el `InsertMenu` función.

*holemenu*<br/>
Identificador del descriptor de menú devuelto por la `OleCreateMenuDescriptor` función, o NULL si el código de distribución se va a quitar.

*hwndActiveObject*<br/>
Identificador de la ventana de edición para el elemento OLE. Esta es la ventana que recibirá los comandos de edición de OLE.

### <a name="remarks"></a>Comentarios

La implementación predeterminada instala o quita el menú compuesto y, a continuación, llama a la [OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor) función para instalar o quitar el código de distribución. Reemplace esta función si la implementación predeterminada no es adecuada para su aplicación. Si reemplaza esta función, debe reemplazar probablemente [OnInsertMenus](#oninsertmenus) y [OnRemoveMenus](#onremovemenus) también. Esto es un avanzado que se puede invalidar.

Para obtener más información, consulte [OleCreateMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor), y [IOleInPlaceFrame:: SetMenu](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) en el SDK de Windows.

##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars

Lo llama el marco de trabajo para mostrar y ocultar las barras de control de la aplicación contenedora.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parámetros

*pFrameWnd*<br/>
Puntero a la ventana de marco de la aplicación contenedora. Puede tratarse de una ventana de marco principal o una ventana secundaria MDI.

*bShow*<br/>
Especifica si las barras de control se puede mostrar u ocultar.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la llamada de función provoca un cambio en el estado de las barras de control. 0 si la llamada produce ningún cambio, o si *pFrameWnd* no apunta a la ventana de marco del contenedor.

### <a name="remarks"></a>Comentarios

Esta función devuelve 0 si las barras de controles ya están en el estado especificado por *bMostrar.* Esto podría ocurrir, por ejemplo, si se ocultan las barras de control y *bMostrar* es FALSE.

La implementación predeterminada, quita la barra de herramientas de la ventana de marco de nivel superior.

##  <a name="onshowitem"></a>  COleClientItem::OnShowItem

Lo llama el marco de trabajo para mostrar el elemento OLE, de forma que sea totalmente visible durante la edición.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Comentarios

Se utiliza cuando la aplicación de contenedor es compatible con vínculos a los elementos incrustados (es decir, si ha derivado de la clase de documento [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Esta función se invoca durante la activación en contexto, o si el elemento OLE es un origen de vínculo y el usuario desea editarlo. La implementación predeterminada activa la primera vista en el documento contenedor. Reemplace esta función para desplazar el documento para que el elemento OLE esté visible.

##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle

Lo llama el marco de trabajo durante la activación en contexto para actualizar la barra de título de la ventana de marco.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero si esta función actualizó correctamente el título del marco, en caso contrario, cero.

### <a name="remarks"></a>Comentarios

La implementación predeterminada no cambia el título de la ventana de marco. Reemplace esta función si desea que el título de un marco diferente para la aplicación, por ejemplo " *aplicación server* - *elemento* en *NombreMéd*" (como en "Microsoft Excel - hoja de cálculo en el informe. DOC"). Esto es un avanzado que se puede invalidar.

##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo

Llame a esta función para volver a activar el elemento OLE y deshacer la última operación realizada por el usuario durante la edición en contexto.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Si la aplicación de contenedor es compatible con el comando Deshacer, llame a esta función si el usuario elige el comando Deshacer inmediatamente después de desactivar el elemento OLE.

Si se escribe la aplicación de servidor con las bibliotecas de clases de Microsoft Foundation, esta función hace que el servidor llamar a [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Para obtener más información, consulte [IOleInPlaceObject::ReactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) en el SDK de Windows.

##  <a name="release"></a>  COleClientItem::Release

Llame a esta función para limpiar los recursos utilizados por el elemento OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parámetros

*dwCloseOption*<br/>
Marca que especifica en qué circunstancias se guarda el elemento OLE cuando vuelve al estado cargado. Para obtener una lista de valores posibles, vea [COleClientItem::Close](#close).

### <a name="remarks"></a>Comentarios

`Release` llama a la `COleClientItem` destructor.

Para obtener más información, consulte [IUnknown:: Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) en el SDK de Windows.

##  <a name="reload"></a>  COleClientItem::Reload

Cierra y vuelve a cargar el elemento.

```
BOOL Reload();
```

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Llame a la `Reload` función después de activar el elemento como un elemento de otro tipo mediante una llamada a [ActivateAs](#activateas).

##  <a name="run"></a>  COleClientItem::Run

Se ejecuta la aplicación asociada con este elemento.

```
void Run();
```

### <a name="remarks"></a>Comentarios

Llame a la `Run` la función miembro para iniciar la aplicación de servidor antes de activar el elemento. Esto se realiza automáticamente [activar](#activate) y [DoVerb](#doverb), por lo que normalmente no es necesario llamar a esta función. Llame a esta función si es necesario ejecutar el servidor con el fin de establecer un atributo del elemento, tales como [SetExtent](#setextent), antes de ejecutar [DoVerb](#doverb).

##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect

Llame a la `SetDrawAspect` la función miembro para establecer el "aspecto" o la vista del elemento.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parámetros

*nDrawAspect*<br/>
Un valor de la enumeración DVASPECT. Este parámetro puede tener uno de los valores siguientes:

- Elemento DVASPECT_CONTENT se representa de manera que puede mostrarse como un objeto incrustado dentro de su contenedor.

- DVASPECT_THUMBNAIL se representa en una representación de "miniatura" para que se puede mostrar en una herramienta de exploración.

- Elemento DVASPECT_ICON se representa mediante un icono.

- Elemento DVASPECT_DOCPRINT se representa como si se imprimiera utilizando el comando de impresión en el menú archivo.

### <a name="remarks"></a>Comentarios

El aspecto especifica cómo se va a representar el elemento [dibujar](#draw) cuando el valor predeterminado para esa función *nDrawAspect* se usa el argumento.

Esta función se llama automáticamente mediante el icono de cambio (y otros cuadros de diálogo que llaman directamente el cuadro de diálogo Cambiar icono) para habilitar el aspecto de pantalla icónica cuando lo solicite el usuario.

##  <a name="setextent"></a>  COleClientItem::SetExtent

Llame a esta función para especificar cuánto espacio hay disponible para el elemento OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parámetros

*size*<br/>
Un [CSize](../../atl-mfc-shared/reference/csize-class.md) objeto que contiene la información de tamaño.

*nDrawAspect*<br/>
Especifica el aspecto del elemento OLE cuyos límites que se van a establecer. Para los valores posibles, vea [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Comentarios

Si la aplicación de servidor se escribió utilizando la biblioteca Microsoft Foundation Class, esto hace que el [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) función miembro de la correspondiente `COleServerItem` objeto que se llama. El elemento OLE en consecuencia, a continuación, puede ajustar su presentación. Las dimensiones deben ser en unidades MM_HIMETRIC. Llame a esta función cuando el usuario cambia el tamaño del elemento OLE o si admite alguna forma de negociación de diseño.

Para obtener más información, consulte [IOleObject:: SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent) en el SDK de Windows.

##  <a name="sethostnames"></a>  COleClientItem::SetHostNames

Llame a esta función para especificar el nombre de la aplicación de contenedor y el nombre del contenedor para un elemento OLE incrustado.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parámetros

*lpszHost*<br/>
Puntero al nombre de usuario visible de la aplicación contenedora.

*lpszHostObj*<br/>
Puntero a una cadena de identificación del contenedor que contiene el elemento OLE.

### <a name="remarks"></a>Comentarios

Si la aplicación de servidor se escribió utilizando la biblioteca Microsoft Foundation Class, esta función llama a la [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) función miembro de la `COleServerDoc` documento que contiene el elemento OLE. Esta información se utiliza en los títulos de ventana cuando se está editando el elemento OLE. Cada vez que se carga un documento del contenedor, el marco llama a esta función para todos los elementos OLE del documento. `SetHostNames` solo es aplicable a los elementos incrustados. No es necesario llamar a esta función cada vez que se activa un elemento OLE incrustado para su edición.

Esto también se denomina automáticamente con el nombre de la aplicación y el nombre del documento cuando se carga un objeto o cuando se guarda un archivo con un nombre diferente. En consecuencia, no es normalmente necesario llamar directamente a esta función.

Para obtener más información, consulte [IOleObject::SetHostNames](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-sethostnames) en el SDK de Windows.

##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile

Almacena en caché el metarchivo usado para dibujar el icono del elemento.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parámetros

*hMetaPict*<br/>
Identificador del metarchivo que se usa para dibujar el icono del elemento.

### <a name="return-value"></a>Valor devuelto

Si es correcta, su valor es distinto de cero. En caso contrario, es cero.

### <a name="remarks"></a>Comentarios

Use [GetIconicMetafile](#geticonicmetafile) para recuperar el metarchivo.

El *hMetaPict* parámetro se copia en el elemento; por lo tanto, *hMetaPict* debe ser liberado por el llamador.

##  <a name="setitemrects"></a>  COleClientItem::SetItemRects

Llame a esta función para establecer el rectángulo delimitador o el rectángulo visible del elemento OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parámetros

*lprcPosRect*<br/>
Puntero al rectángulo que contiene los límites del elemento OLE en relación con su ventana primaria, en coordenadas de cliente.

*lprcClipRect*<br/>
Puntero al rectángulo que contiene los límites de la parte visible del elemento OLE en relación con su ventana primaria, en coordenadas de cliente.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si se realiza correctamente; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Esta función se llama a la implementación predeterminada de la [OnChangeItemPosition](#onchangeitemposition) función miembro. Debe llamar a esta función siempre que los cambios del elemento de la posición o la parte visible de OLE. Normalmente, esto significa que se llama desde la vista [OnSize](../../mfc/reference/cwnd-class.md#onsize) y [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) funciones miembro.

Para obtener más información, consulte [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) en el SDK de Windows.

##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions

Llame a esta función para establecer la opción de actualización de los vínculos para la presentación del elemento vinculado especificado.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parámetros

*dwUpdateOpt*<br/>
El valor de la opción de actualización de los vínculos de este elemento. Este valor debe ser uno de los siguientes:

- OLEUPDATE_ALWAYS actualizar el elemento vinculado siempre que sea posible. Esta opción es compatible con el botón de opción de actualización automática de los vínculos en el cuadro de diálogo de vínculos.

- OLEUPDATE_ONCALL actualizar el elemento vinculado solo en la solicitud de la aplicación de contenedor (cuando el [UpdateLink](#updatelink) se llama a la función miembro). Esta opción es compatible con el botón de opción de actualización Manual de los vínculos en el cuadro de diálogo de vínculos.

### <a name="remarks"></a>Comentarios

Por lo general, no debe cambiar las opciones de actualización elegidas por el usuario en el cuadro de diálogo de vínculos.

Para obtener más información, consulte [IOleLink::SetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-setupdateoptions) en el SDK de Windows.

##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice

Llame a esta función para cambiar el dispositivo de destino de impresión para este elemento.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parámetros

*ptd*<br/>
Puntero a un [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) estructuras de datos que contiene información sobre el nuevo dispositivo de destino de impresión. Puede ser NULL.

*ppd*<br/>
Puntero a un [PRINTDLG](/windows/desktop/ms646940) estructuras de datos que contiene información sobre el nuevo dispositivo de destino de impresión. Puede ser NULL.

### <a name="return-value"></a>Valor devuelto

Distinto de cero si la función se realizó correctamente; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Esta función actualiza el dispositivo de destino de impresión para el elemento pero no actualiza la caché de presentación. Para actualizar la memoria caché de presentación para un elemento, llame a [UpdateLink](#updatelink).

Los argumentos a esta función contienen información que el sistema OLE se utiliza para identificar el dispositivo de destino. El `PRINTDLG` estructura contiene información que Windows usa para inicializar el cuadro de diálogo de impresión comunes. Después de que el usuario cierra el cuadro de diálogo, Windows devuelve información acerca de las selecciones del usuario en esta estructura. El `m_pd` miembro de un [CPrintDialog](../../mfc/reference/cprintdialog-class.md) objeto es un `PRINTDLG` estructura.

Para obtener más información acerca de esta estructura, vea [PRINTDLG](/windows/desktop/api/commdlg/ns-commdlg-tagpda) en el SDK de Windows.

Para obtener más información, consulte [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) en el SDK de Windows.

##  <a name="updatelink"></a>  COleClientItem::UpdateLink

Llame a esta función para actualizar inmediatamente los datos de presentación del elemento OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Valor devuelto

Distinto de cero en caso de éxito; en caso contrario, es 0.

### <a name="remarks"></a>Comentarios

Para los elementos vinculados, la función no encuentra el origen del vínculo para obtener una nueva presentación para el elemento OLE. Este proceso puede implicar uno o más aplicaciones de servidor, lo que sería mucho tiempo de ejecución. Para los elementos incrustados, la función funciona de forma recursiva, comprobando si el elemento incrustado contiene vínculos que podrían estar obsoletos y actualizarlos. El usuario también puede actualizar manualmente los vínculos individuales mediante el cuadro de diálogo de vínculos.

Para obtener más información, consulte [IOleLink::Update](/windows/desktop/api/oleidl/nf-oleidl-iolelink-update) en el SDK de Windows.

## <a name="see-also"></a>Vea también

[Ejemplo de MFC MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[Ejemplo MFC OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[CDocItem (clase)](../../mfc/reference/cdocitem-class.md)<br/>
[Gráfico de jerarquías](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem (clase)](../../mfc/reference/coleserveritem-class.md)
