---
title: CRowset (Clase)
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: e67e385a8ce0eb9a6b041d4a4f0d43e2db551c79
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/24/2020
ms.locfileid: "80211294"
---
# <a name="crowset-class"></a>CRowset (Clase)

Encapsula un objeto de conjunto de filas OLE DB y varias interfaces relacionadas y proporciona métodos de manipulación para los datos del conjunto de filas.

## <a name="syntax"></a>Sintaxis

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parámetros

*TAccessor*<br/>
Una clase de descriptor de acceso. El valor predeterminado es `CAccessorBase`.

## <a name="requirements"></a>Requisitos

**Encabezado:** atldbcli.h

## <a name="members"></a>Members

### <a name="methods"></a>Métodos

|||
|-|-|
|[AddRefRows](#addrefrows)|Incrementa el recuento de referencias asociado a la fila actual.|
|[Close](#close)|Libera filas y la interfaz `IRowset` actual.|
|[Comparar](#compare)|Compara dos marcadores mediante [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Crea un nuevo objeto `CRowset` y, opcionalmente, lo asocia a una interfaz `IRowset` proporcionada como parámetro.|
|[Eliminar](#delete)|Elimina filas del conjunto de filas mediante [IRowsetChange: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Busca la siguiente fila coincidente después del marcador especificado.|
|[GetApproximatePosition](#getapproximateposition)|Devuelve la posición aproximada de una fila correspondiente a un marcador.|
|[GetData](#getdata)|Recupera los datos desde la copia del conjunto de filas de la fila.|
|[GetDataHere](#getdatahere)|Recupera los datos del búfer especificado.|
|[GetOriginalData](#getoriginaldata)|Recupera los datos capturados más recientemente del origen de datos o transmitidos al mismo, omitiendo los cambios pendientes.|
|[GetRowStatus](#getrowstatus)|Devuelve el estado de todas las filas.|
|[Insertar](#insert)|Crea e inserta una nueva fila con [IRowsetChange: InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85)).|
|[IsSameRow](#issamerow)|Compara la fila especificada con la fila actual.|
|[MoveFirst](#movefirst)|Cambia la ubicación de la siguiente captura a la posición inicial.|
|[MoveLast](#movelast)|Se desplaza al último registro.|
|[MoveNext](#movenext)|Recupera los datos de la siguiente fila secuencial o un número especificado de posiciones más allá de la siguiente fila.|
|[Plaza](#moveprev)|Se desplaza al registro anterior.|
|[MoveToBookmark](#movetobookmark)|Captura la fila marcada por un marcador o la fila en un desplazamiento especificado de ese marcador.|
|[MoveToRatio](#movetoratio)|Captura las filas a partir de una posición fraccionaria en el conjunto de filas.|
|[ReleaseRows](#releaserows)|Llama a [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) para liberar el identificador de fila actual.|
|[SetData](#setdata)|Establece los valores de datos en una o varias columnas de una fila mediante [IRowsetChange: SetData](/previous-versions/windows/desktop/ms721232(v=vs.85)).|
|[Deshacer](#undo)|Deshace los cambios realizados en una fila desde la última recuperación o [actualización](../../data/oledb/crowset-update.md).|
|[Actualizar](#update)|Transmite los cambios pendientes realizados en la fila actual desde la última recuperación o actualización.|
|[UpdateAll](#updateall)|Transmite los cambios pendientes realizados en todas las filas desde la última recuperación o actualización.|

## <a name="remarks"></a>Observaciones

En OLE DB, un conjunto de filas es el objeto a través del cual un programa establece y recupera los datos.

Esta clase no está diseñada para que se cree una instancia, sino que se pasa como parámetro de plantilla a `CTable` o `CCommand` (`CRowset` es el valor predeterminado).

## <a name="crowsetaddrefrows"></a><a name="addrefrows"></a>CRowset:: AddRefRows

Llama a [IRowset:: AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) para incrementar (en uno) el recuento de referencias asociado al identificador de fila actual.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Este método incrementa el recuento de referencias para el identificador de fila actual. Llame a [ReleaseRows](../../data/oledb/crowset-releaserows.md) para reducir el recuento. Las filas devueltas por los métodos Move tienen un recuento de referencias de una.

## <a name="crowsetclose"></a><a name="close"></a>CRowset:: Close

Libera filas y la interfaz [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) actual.

### <a name="syntax"></a>Sintaxis

```cpp
void Close() throw();
```

### <a name="remarks"></a>Observaciones

Este método libera todas las filas que se encuentran actualmente en el conjunto de filas.

## <a name="crowsetcompare"></a><a name="compare"></a>CRowset:: Compare

Compara dos marcadores mediante [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parámetros

*Bookmark1*<br/>
de Primer marcador que se va a comparar.

*Bookmark2*<br/>
de Segundo marcador que se va a comparar.

*pComparison*<br/>
enuncia Puntero al resultado de la comparación.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Este método requiere la interfaz opcional `IRowsetLocate`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetLocate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

Para obtener información sobre el uso de marcadores en consumidores, vea [uso de marcadores](../../data/oledb/using-bookmarks.md).

## <a name="crowsetcrowset"></a><a name="crowset"></a>CRowset:: CRowset

Crea un nuevo objeto `CRowset` y, opcionalmente, lo asocia a una interfaz [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) proporcionada como parámetro.

### <a name="syntax"></a>Sintaxis

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parámetros

*pRowset*<br/>
de Puntero a una interfaz `IRowset` que se va a asociar a esta clase.

## <a name="crowsetdelete"></a><a name="delete"></a>CRowset::D iminar

Llama a [IRowsetChange::D eleterows](/previous-versions/windows/desktop/ms724362(v=vs.85)) para eliminar la fila actual del conjunto de filas.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

## <a name="crowsetfindnextrow"></a><a name="findnextrow"></a>CRowset:: FindNextRow

Busca la siguiente fila coincidente después del marcador especificado.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parámetros

*operador*<br/>
de Operación que se va a usar para comparar los valores de fila. Para ver los valores, vea [IRowsetFind:: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
de Puntero al valor que se va a comparar.

*wType*<br/>
de Indica el tipo de datos de la parte de valor del búfer. Para obtener información sobre los indicadores de tipo, vea [tipos de datos](/previous-versions/windows/desktop/ms723969(v=vs.85)) en la *Referencia del programador de OLE DB* en el Windows SDK.

*nLength*<br/>
de La longitud, en bytes, de la estructura de datos del consumidor asignada para el valor de datos. Para obtener más información, vea la descripción de `cbMaxLen` en [estructuras DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) en la *Referencia del programador de OLE DB.*

*bPrecision*<br/>
de Precisión máxima utilizada al obtener datos. Se usa solo si *wType* es DBTYPE_NUMERIC. Para obtener más información, vea [conversiones que impliquen DBTYPE_NUMERIC o DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) en la *Referencia del programador de OLE DB*.

*bScale*<br/>
de Escala que se usa al obtener datos. Se usa solo si *wType* es DBTYPE_NUMERIC o DBTYPE_DECIMAL. Para obtener más información, vea [conversiones que impliquen DBTYPE_NUMERIC o DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) en la *Referencia del programador de OLE DB*.

*bSkipCurrent*<br/>
de Número de filas del marcador en el que se va a iniciar una búsqueda.

*pBookmark*<br/>
de Marcador de posición en el que se va a iniciar una búsqueda.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Este método requiere la interfaz opcional `IRowsetFind`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetFind` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

Para obtener información sobre el uso de marcadores en consumidores, vea [uso de marcadores](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetapproximateposition"></a><a name="getapproximateposition"></a>CRowset:: GetApproximatePosition

Devuelve la posición aproximada de una fila correspondiente a un marcador.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parámetros

*pBookmark*<br/>
de Un puntero a un marcador que identifica la fila cuya posición se va a buscar. NULL si solo se requiere el recuento de filas.

*pPosition*<br/>
enuncia Puntero a la ubicación donde `GetApproximatePosition` devuelve la posición de la fila. Es NULL si no se requiere la posición.

*pcRows*<br/>
enuncia Puntero a la ubicación donde `GetApproximatePosition` devuelve el número total de filas. Es NULL si no se requiere el recuento de filas.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Este método requiere la interfaz opcional `IRowsetScroll`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetScroll` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

Para obtener información sobre el uso de marcadores en consumidores, vea [uso de marcadores](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetdata"></a><a name="getdata"></a>CRowset:: GetData

Recupera los datos desde la copia del conjunto de filas de la fila.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parámetros

*nAccessor*<br/>
de Número de índice (desplazamiento cero) del descriptor de acceso que se va a utilizar para obtener acceso a los datos.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Si especifica un descriptor de acceso que no es un autoscriptor en [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), use este método para obtener los datos explícitamente pasando el número de descriptor de acceso.

## <a name="crowsetgetdatahere"></a><a name="getdatahere"></a>CRowset:: GetDataHere

Recupera los datos de la fila actual y los coloca en el búfer especificado.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parámetros

*nAccessor*<br/>
de Número de índice del descriptor de acceso que se va a utilizar para obtener acceso a los datos.

*pBuffer*<br/>
enuncia Búfer en el que se colocan los datos para el registro actual.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Para obtener un ejemplo de cómo usar esta función, vea el [ejemplo de MultiRead](../../overview/visual-cpp-samples.md).

## <a name="crowsetgetoriginaldata"></a><a name="getoriginaldata"></a>CRowset:: GetOriginalData

Llama a `IRowsetUpdate::GetOriginalData` para recuperar los datos capturados más recientemente del origen de datos o transmitidos al mismo.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Este método recupera los datos capturados más recientemente del origen de datos o transmitidos al mismo; no recupera los valores en función de los cambios pendientes.

Este método requiere la interfaz opcional `IRowsetUpdate`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetUpdate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

## <a name="crowsetgetrowstatus"></a><a name="getrowstatus"></a>CRowset:: GetRowStatus

Devuelve el estado de todas las filas.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parámetros

*pStatus*<br/>
enuncia Puntero a una ubicación donde `GetRowStatus` devuelve el valor de estado. Vea DBPENDINGSTATUS en la referencia del programador de OLE DB.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Este método requiere la interfaz opcional `IRowsetUpdate`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetUpdate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

## <a name="crowsetinsert"></a><a name="insert"></a>CRowset:: Insert

Crea e inicializa una nueva fila con datos del descriptor de acceso.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parámetros

*nAccessor*<br/>
de Número del descriptor de acceso que se va a usar para insertar los datos.

*bGetHRow*<br/>
de Indica si se recupera el identificador de la fila insertada.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Este método requiere la interfaz opcional `IRowsetChange`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetChange` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

La inserción podría producir un error si no se puede escribir en una o más columnas. Modifique la asignación del cursor para corregirlo.

### <a name="example"></a>Ejemplo

En el ejemplo siguiente se muestra cómo obtener acceso a un origen de datos a través de un conjunto de filas y, a continuación, insertar una cadena mediante una tabla en ese conjunto de filas.

En primer lugar, cree una clase de tabla insertando un nuevo objeto ATL en el proyecto. Por ejemplo, haga clic con el botón derecho en el proyecto en el panel del área de trabajo y seleccione **nuevo objeto ATL**. En la categoría **acceso a datos** , seleccione **consumidor**. Cree un objeto de consumidor de tipo **tabla**. (Seleccionar **tabla** crea un conjunto de filas directamente desde la tabla; si selecciona **comando** , se crea un conjunto de filas mediante un comando SQL). Seleccione un origen de datos, especificando una tabla a través de la cual obtener acceso a ese origen de datos. Si se llama al objeto de consumidor **CCustomerTable**, se implementará el código de inserción de la siguiente manera:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="crowsetissamerow"></a><a name="issamerow"></a>CRowset:: IsSameRow

Compara la fila especificada con la fila actual.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parámetros

*hRow*<br/>
de Identificador de la fila que se va a comparar con la fila actual.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar. S_OK indica que las filas son las mismas. Para otros valores, vea [IRowsetIndentity:: IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) en la *Referencia del programador de OLE DB* en el Windows SDK.

## <a name="crowsetmovefirst"></a><a name="movefirst"></a>CRowset:: MoveFirst

Mueve el cursor a la posición inicial y recupera la fila inicial.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Llama a [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) para cambiar la posición de la siguiente ubicación de la captura a la posición inicial (la posición en la que se produjo la siguiente recuperación cuando se creó el conjunto de filas) y recupera la fila inicial.

## <a name="crowsetmovelast"></a><a name="movelast"></a>CRowset:: MoveLast

Mueve el cursor a la última fila.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Llama a [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) para cambiar la posición de la ubicación siguiente de la captura a la última posición y recupera la última fila.

Este método requiere que se establezca `DBPROP_CANSCROLLBACKWARDS` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas. (Para mejorar el rendimiento, también puede establecer `DBPROP_QUICKRESTART` en VARIANT_TRUE).

## <a name="crowsetmovenext"></a><a name="movenext"></a>CRowset:: MoveNext

Mueve el cursor al siguiente registro.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parámetros

*lSkip*<br/>
de Número de filas que se van a omitir antes de la captura.

*bForward*<br/>
de Pase **true** para avanzar al siguiente registro, **false** para retroceder.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar. Cuando se alcanza el final del conjunto de filas, devuelve DB_S_ENDOFROWSET.

### <a name="remarks"></a>Observaciones

Recupera la siguiente fila secuencial del objeto `CRowset`, recordar la posición anterior. Opcionalmente, puede optar por omitir las filas de *lSkip* o desplazarse hacia atrás.

Este método requiere que establezca las siguientes propiedades antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas:

- `DBPROP_CANSCROLLBACKWARDS` debe ser VARIANT_TRUE si *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` debe ser VARIANT_TRUE si *bForward* = false

En caso contrario (si *lSkip* > = 0 y *bForward* = true), no es necesario establecer ninguna propiedad adicional.

## <a name="crowsetmoveprev"></a><a name="moveprev"></a>CRowset:: MovePrev

Mueve el cursor al registro anterior.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Este método requiere que se establezca `DBPROP_CANFETCHBACKWARDS` o `DBPROP_CANSCROLLBACKWARDS` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

## <a name="crowsetmovetobookmark"></a><a name="movetobookmark"></a>CRowset:: MoveToBookmark

Captura la fila marcada por un marcador o la fila en un desplazamiento especificado (*lSkip*) de ese marcador.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parámetros

*Marcador*<br/>
de Marcador que marca la ubicación desde la que se van a capturar los datos.

*lSkip*<br/>
de Número de filas del marcador a la fila de destino. Si *lSkip* es cero, la primera fila capturada es la fila marcada. Si *lSkip* es 1, la primera fila capturada es la fila que se encuentra después de la fila marcada. Si *lSkip* es-1, la primera fila capturada es la fila anterior a la fila marcada.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Este método requiere la interfaz opcional `IRowsetLocate`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetLocate` en VARIANT_TRUE y establecer `DBPROP_CANFETCHBACKWARDS` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

Para obtener información sobre el uso de marcadores en consumidores, vea [uso de marcadores](../../data/oledb/using-bookmarks.md).

## <a name="crowsetmovetoratio"></a><a name="movetoratio"></a>CRowset:: MoveToRatio

Captura las filas a partir de una posición fraccionaria en el conjunto de filas.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parámetros

*nNumerator*<br/>
de El numerador utilizado para determinar la posición fraccionaria desde la que se van a capturar los datos.

*nDenominator*<br/>
de El denominador que se usa para determinar la posición fraccionaria desde la que se van a capturar los datos.

*bForward*<br/>
de Indica si se va a desplazar hacia delante o hacia atrás. El valor predeterminado es reenviar.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

`MoveToRatio` captura las filas según la fórmula siguiente:

`(nNumerator *  RowsetSize ) / nDenominator`

donde `RowsetSize` es el tamaño del conjunto de filas, medido en filas. La precisión de esta fórmula depende del proveedor concreto. Para obtener más información, vea [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Este método requiere la interfaz opcional `IRowsetScroll`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetScroll` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

## <a name="crowsetreleaserows"></a><a name="releaserows"></a>CRowset:: ReleaseRows

Llama a [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) para liberar el identificador de fila actual.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

## <a name="crowsetsetdata"></a><a name="setdata"></a>CRowset:: SetData

Establece los valores de datos en una o varias columnas de una fila.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parámetros

*nAccessor*<br/>
de Número del descriptor de acceso que se va a utilizar para obtener acceso a los datos.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Para el `SetData` formulario que no acepta argumentos, se usan todos los descriptores de acceso para la actualización. Normalmente, se llama a `SetData` para establecer los valores de datos en las columnas de una fila y, después, llamar a [Update](../../data/oledb/crowset-update.md) para transmitir esos cambios.

Este método requiere la interfaz opcional `IRowsetChange`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetChange` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

Se puede producir un error en la operación de configuración si no se puede escribir en una o más columnas. Modifique la asignación del cursor para corregirlo.

## <a name="crowsetundo"></a><a name="undo"></a>CRowset:: Undo

Deshace los cambios realizados en una fila desde la última recuperación o [actualización](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parámetros

*pcRows*<br/>
enuncia Puntero a la ubicación donde `Undo` devuelve el número de filas que se intentó deshacer si es necesario.

*phRow*<br/>
enuncia Puntero a la ubicación en la que `Undo` devuelve una matriz de identificadores para todas las filas que intentó deshacer si es necesario.

*pStatus*<br/>
enuncia Puntero a la ubicación donde `Undo` devuelve el valor de estado de fila. No se devuelve ningún estado si *pStatus* es NULL.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Este método requiere la interfaz opcional `IRowsetUpdate`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetUpdate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

## <a name="crowsetupdate"></a><a name="update"></a>CRowset:: Update

Transmite los cambios pendientes realizados en la fila actual desde la última vez que se recuperó la llamada o `Update`.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parámetros

*pcRows*<br/>
enuncia Puntero a la ubicación en la que `Update` devuelve el número de filas que intentó actualizar, si es necesario.

*phRow*<br/>
enuncia Puntero a la ubicación donde `Update` devuelve el identificador de la fila que intentó actualizar. No se devuelve ningún identificador si *phRow* es NULL.

*pStatus*<br/>
enuncia Puntero a la ubicación donde `Update` devuelve el valor de estado de fila. No se devuelve ningún estado si *pStatus* es NULL.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

### <a name="remarks"></a>Observaciones

Transmite los cambios pendientes realizados en la fila actual desde la última vez que se recuperó o actualizó la fila (mediante `Update` o [UpdateAll](../../data/oledb/crowset-updateall.md)). Normalmente, se llama a [SetData](../../data/oledb/crowset-setdata.md) para establecer los valores de datos en las columnas de una fila y, después, llamar a `Update` para transmitir esos cambios.

Este método requiere la interfaz opcional `IRowsetUpdate`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetUpdate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

## <a name="crowsetupdateall"></a><a name="updateall"></a>CRowset:: UpdateAll

Transmite cualquier cambio pendiente que se realice en todas las filas desde la última vez que se recuperó la llamada o `Update`.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parámetros

*pcRows*<br/>
enuncia Puntero a la ubicación en la que `UpdateAll` devuelve el número de filas que intentó actualizar, si es necesario.

*pphRow*<br/>
enuncia Puntero a la memoria en la que `UpdateAll` devuelve el identificador de la fila que intentó actualizar. No se devuelve ningún identificador si *pphRow* es NULL.

*ppStatus*<br/>
enuncia Puntero a la ubicación donde `Update` devuelve el valor de estado de fila. No se devuelve ningún estado si *ppStatus* es NULL.

### <a name="remarks"></a>Observaciones

Transmite los cambios pendientes realizados en todas las filas desde la última vez que se recuperaron o actualizaron las filas mediante [Update](../../data/oledb/crowset-update.md) o `UpdateAll`. `UpdateAll` actualizará cada fila modificada, independientemente de si todavía tiene el identificador de las mismas (vea *pphRow*) o no.

Por ejemplo, si usó `Insert` para insertar cinco filas en un conjunto de filas, puede llamar a `Update` cinco veces o llamar a `UpdateAll` una vez para actualizarlas todas.

Este método requiere la interfaz opcional `IRowsetUpdate`, que podría no ser compatible con todos los proveedores; Si es así, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetUpdate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o comando que contiene el conjunto de filas.

### <a name="return-value"></a>Valor devuelto

HRESULT estándar.

## <a name="see-also"></a>Consulte también

[Ejemplo DBViewer](../../overview/visual-cpp-samples.md)<br/>
[Ejemplo de lectura MultiRead](../../overview/visual-cpp-samples.md)<br/>
[Ejemplo de atributos de lectura MultiRead](../../overview/visual-cpp-samples.md)<br/>
[Plantillas de consumidor OLE DB](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Referencia de plantillas de consumidor OLE DB](../../data/oledb/ole-db-consumer-templates-reference.md)
