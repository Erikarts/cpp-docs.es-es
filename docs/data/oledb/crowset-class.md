---
title: CRowset (Clase)
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: 4a24dada2f1211138449e65a8865810a46230970
ms.sourcegitcommit: c1f646c8b72f330fa8cf5ddb0f8f261ba10d16f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/21/2019
ms.locfileid: "58329018"
---
# <a name="crowset-class"></a>CRowset (Clase)

Encapsula un objeto de conjunto de filas de OLE DB y varios relacionados con las interfaces y proporciona métodos de manipulación de datos del conjunto de filas.

## <a name="syntax"></a>Sintaxis

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parámetros

*TAccessor*<br/>
Una clase de descriptor de acceso. De manera predeterminada, es `CAccessorBase`.

## <a name="requirements"></a>Requisitos

**Encabezado:** atldbcli.h

## <a name="members"></a>Miembros

### <a name="methods"></a>Métodos

|||
|-|-|
|[AddRefRows](#addrefrows)|Incrementa el recuento de referencias asociadas con la fila actual.|
|[Cerrar](#close)|Libera las filas y la actual `IRowset` interfaz.|
|[Compare](#compare)|Compara dos marcadores utilizando [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Crea un nuevo `CRowset` objeto y lo asocia a (opcionalmente) un `IRowset` interfaz proporcionada como un parámetro.|
|[Eliminar](#delete)|Elimina las filas del conjunto de filas mediante [IRowsetChange:DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Busca la siguiente fila coincidente después del marcador especificado.|
|[GetApproximatePosition](#getapproximateposition)|Devuelve la posición aproximada de una fila correspondiente a un marcador.|
|[GetData](#getdata)|Recupera datos de copia del conjunto de filas de la fila.|
|[GetDataHere](#getdatahere)|Recupera los datos desde el búfer especificado.|
|[GetOriginalData](#getoriginaldata)|Recupera los datos desde más recientemente o transmitida al origen de datos, pasando por alto los cambios pendientes.|
|[GetRowStatus](#getrowstatus)|Devuelve el estado de todas las filas.|
|[Insertar](#insert)|Crea e inserta una nueva fila usando [IRowsetChange:InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85)).|
|[IsSameRow](#issamerow)|Compara la fila especificada con la fila actual.|
|[MoveFirst](#movefirst)|Cambia la ubicación de la siguiente captura de posición en la posición inicial.|
|[MoveLast](#movelast)|Se desplaza al último registro.|
|[MoveNext](#movenext)|Captura los datos de la siguiente fila secuencial o un número especificado de posiciones más allá de la fila siguiente.|
|[MovePrev](#moveprev)|Se desplaza al registro anterior.|
|[MoveToBookmark](#movetobookmark)|Recupera la fila en un desplazamiento especificado o la fila marcada con un marcador de marcador.|
|[MoveToRatio](#movetoratio)|Captura las filas a partir de una posición en el conjunto de filas fraccionaria.|
|[ReleaseRows](#releaserows)|Las llamadas [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) para liberar el identificador de fila actual.|
|[SetData](#setdata)|Establece los valores de datos en una o varias columnas de una fila mediante [IRowsetChange:SetData](/previous-versions/windows/desktop/ms721232(v=vs.85)).|
|[Undo](#undo)|Deshace los cambios realizados en una fila desde la última captura o [actualización](../../data/oledb/crowset-update.md).|
|[Actualizar](#update)|Los cambios realizados en la fila actual desde la última captura o actualización pendientes transmite.|
|[UpdateAll](#updateall)|Los cambios realizados en todas las filas desde la última captura o actualización pendientes transmite.|

## <a name="remarks"></a>Comentarios

En OLE DB, un conjunto de filas es el objeto a través del cual un programa establece y recupera los datos.

Esta clase no pretende ser crea una instancia, pero en su lugar se pasa como un parámetro de plantilla `CTable` o `CCommand` (`CRowset` es el valor predeterminado).

## <a name="addrefrows"></a> CRowset::AddRefRows

Las llamadas [IRowset::AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) para incrementar (en uno) el recuento de referencias asociada con el identificador de fila actual.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Este método aumenta el recuento de referencias para el identificador de fila actual. Llame a [ReleaseRows](../../data/oledb/crowset-releaserows.md) para reducir el recuento. Filas devueltas por los métodos move tienen un recuento de referencias de uno.

## <a name="close"></a> CRowset::Close

Libera las filas y la actual [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) interfaz.

### <a name="syntax"></a>Sintaxis

```cpp
void Close() throw();
```

### <a name="remarks"></a>Comentarios

Este método libera todas las filas actualmente en el conjunto de filas.

## <a name="compare"></a> CRowset::Compare

Compara dos marcadores utilizando [IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parámetros

*Bookmark1*<br/>
[in] Primer marcador que se va a comparar.

*Bookmark2*<br/>
[in] El segundo marcador para comparar.

*pComparison*<br/>
[out] Un puntero al resultado de la comparación.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Este método requiere la interfaz opcional `IRowsetLocate`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetLocate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

Para obtener información sobre el uso de marcadores de los consumidores, consulte [utilizar marcadores](../../data/oledb/using-bookmarks.md).

## <a name="crowset"></a> CRowset::CRowset

Crea un nuevo `CRowset` objeto y lo asocia a (opcionalmente) un [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) interfaz proporcionada como un parámetro.

### <a name="syntax"></a>Sintaxis

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parámetros

*pRowset*<br/>
[in] Un puntero a un `IRowset` interfaz va a asociar a esta clase.

## <a name="delete"></a> CRowset::Delete

Las llamadas [IRowsetChange:: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)) para eliminar la fila actual del conjunto de filas.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

## <a name="findnextrow"></a> CRowset::FindNextRow

Busca la siguiente fila coincidente después del marcador especificado.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parámetros

*op*<br/>
[in] La operación que se usará en la comparación de valores de fila. Para los valores, vea [irowsetfind:: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
[in] Un puntero al valor que se debe coincidir.

*wType*<br/>
[in] Indica el tipo de datos de la parte del valor del búfer. Para obtener información acerca de los indicadores de tipo, consulte [tipos de datos](/previous-versions/windows/desktop/ms723969(v=vs.85)) en el *referencia del programador de OLE DB* en el SDK de Windows.

*nLength*<br/>
[in] La longitud, en bytes, de la estructura de datos del consumidor asignada para el valor de datos. Para obtener más información, vea la descripción de `cbMaxLen` en [estructuras DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) en el *referencia del programador de OLE DB.*

*bPrecision*<br/>
[in] La precisión máxima que se usa al obtener los datos. Sólo se usa si *wType* es DBTYPE_NUMERIC. Para obtener más información, consulte [conversiones que afectan a DBTYPE_NUMERIC o DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) en el *referencia del programador de OLE DB*.

*bScale*<br/>
[in] La escala que se usa al obtener los datos. Sólo se usa si *wType* es DBTYPE_NUMERIC o DBTYPE_DECIMAL. Para obtener más información, consulte [conversiones que afectan a DBTYPE_NUMERIC o DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) en el *referencia del programador de OLE DB*.

*bSkipCurrent*<br/>
[in] El número de filas desde el marcador en el que se va a iniciar una búsqueda.

*pBookmark*<br/>
[in] El marcador de posición en la que se va a iniciar una búsqueda.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Este método requiere la interfaz opcional `IRowsetFind`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetFind` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

Para obtener información sobre el uso de marcadores de los consumidores, consulte [utilizar marcadores](../../data/oledb/using-bookmarks.md).

## <a name="getapproximateposition"></a> CRowset::GetApproximatePosition

Devuelve la posición aproximada de una fila correspondiente a un marcador.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parámetros

*pBookmark*<br/>
[in] Un puntero a un marcador que identifica la fila cuya posición se va a calcular. Es NULL si solo se requiere el recuento de filas.

*pPosition*<br/>
[out] Un puntero a la ubicación donde `GetApproximatePosition` devuelve la posición de la fila. Es NULL si la posición no es necesaria.

*pcRows*<br/>
[out] Un puntero a la ubicación donde `GetApproximatePosition` devuelve el número total de filas. Es NULL si el recuento de filas no es necesario.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Este método requiere la interfaz opcional `IRowsetScroll`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetScroll` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

Para obtener información sobre el uso de marcadores de los consumidores, consulte [utilizar marcadores](../../data/oledb/using-bookmarks.md).

## <a name="getdata"></a> CRowset::GetData

Recupera datos de copia del conjunto de filas de la fila.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parámetros

*nAccessor*<br/>
[in] El número de índice (desplazamiento cero) del descriptor de acceso que se usará para acceder a los datos.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Si especifica un descriptor de acceso que no sea autoaccessor en [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), use este método para obtener explícitamente los datos, pasando el número de descriptor de acceso.

## <a name="getdatahere"></a> CRowset::GetDataHere

Recupera los datos de la fila actual y lo coloca en el búfer especificado.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parámetros

*nAccessor*<br/>
[in] El número de índice del descriptor de acceso que se usará para acceder a los datos.

*pBuffer*<br/>
[out] Un búfer en el que se va a colocar los datos para el registro actual.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Para obtener un ejemplo de cómo usar esta función, vea el [ejemplo MultiRead](../../visual-cpp-samples.md).

## <a name="getoriginaldata"></a> CRowset::GetOriginalData

Las llamadas `IRowsetUpdate::GetOriginalData` para recuperar los datos desde más recientemente o transmitida al origen de datos.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Este método recupera los datos que se han capturado recientemente desde o transmitida al origen de datos; no recupera los valores según los cambios pendientes.

Este método requiere la interfaz opcional `IRowsetUpdate`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetUpdate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

## <a name="getrowstatus"></a> CRowset::GetRowStatus

Devuelve el estado de todas las filas.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parámetros

*pStatus*<br/>
[out] Un puntero a una ubicación donde `GetRowStatus` devuelve el valor de estado. Consulte DBPENDINGSTATUS en referencia del programador OLE DB.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Este método requiere la interfaz opcional `IRowsetUpdate`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetUpdate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

## <a name="insert"></a> CRowset::Insert

Crea e inicializa una nueva fila con datos del descriptor de acceso.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parámetros

*nAccessor*<br/>
[in] El número del descriptor de acceso que se usará para insertar los datos.

*bGetHRow*<br/>
[in] Indica si se recupera el identificador de la fila insertada.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Este método requiere la interfaz opcional `IRowsetChange`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetChange` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

INSERT puede producir un error si no se puede escribir una o varias columnas. Modifique la asignación del cursor para corregirlo.

### <a name="example"></a>Ejemplo

El ejemplo siguiente muestra cómo obtener acceso a un origen de datos a través de un conjunto de filas y, a continuación, inserte una cadena con una tabla en ese conjunto de filas.

En primer lugar, cree una clase de tabla mediante la inserción de un nuevo objeto ATL en el proyecto. Por ejemplo, haga clic en el proyecto en el panel de área de trabajo y seleccione **nuevo objeto ATL**. Desde el **acceso a datos** categoría, seleccione **consumidor**. Crear un objeto de consumidor de tipo **tabla**. (Seleccionar **tabla** crea un conjunto de filas directamente de la tabla; seleccionar **comando** crea un conjunto de filas a través de un comando SQL.) Seleccione un origen de datos, especificar una tabla a través de la que se va a obtener acceso a ese origen de datos. Si se llama a su objeto de consumidor **CCustomerTable**, a continuación, podría implementar el código de inserción como sigue:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="issamerow"></a> CRowset::IsSameRow

Compara la fila especificada con la fila actual.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parámetros

*hRow*<br/>
[in] Identificador de la fila que se va a comparar con la fila actual.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar. S_OK indica que las filas son los mismos. Para otros valores, vea [IRowsetIndentity::IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) en el *referencia del programador de OLE DB* en el SDK de Windows.

## <a name="movefirst"></a> CRowset::MoveFirst

Mueve el cursor a la posición inicial y recupera la fila inicial.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Las llamadas [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) para cambiar la posición de la ubicación de la siguiente captura a la posición inicial (es decir, la posición que era la ubicación de la siguiente captura cuando se creó el conjunto de filas) y recupera la fila inicial.

## <a name="movelast"></a> CRowset::MoveLast

Mueve el cursor a la última fila.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Las llamadas [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) para cambiar la posición de la ubicación de la siguiente captura a la última posición y recupera la última fila.

Este método requiere que establezca `DBPROP_CANSCROLLBACKWARDS` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas. (Para mejorar el rendimiento, también puede establecer `DBPROP_QUICKRESTART` en VARIANT_TRUE.)

## <a name="movenext"></a> CRowset::MoveNext

Mueve el cursor al siguiente registro.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parámetros

*lSkip*<br/>
[in] El número de filas que se van a omitir antes de obtener.

*bForward*<br/>
[in] Pasar **true** para avanzar al siguiente registro **false** para desplazarse hacia atrás.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar. Cuando se alcanza el final del conjunto de filas, devuelve DB_S_ENDOFROWSET.

### <a name="remarks"></a>Comentarios

Recopila la siguiente fila secuencial desde el `CRowset` objeto, recordando la posición anterior. Si lo desea, puede elegir omitir *lSkip* filas o desplazarse hacia atrás.

Este método requiere que establezca las propiedades siguientes antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas:

- `DBPROP_CANSCROLLBACKWARDS` debe ser VARIANT_TRUE si *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` debe ser VARIANT_TRUE si *bForward* = false

En caso contrario (si *lSkip* > = 0 y *bForward* = true), no es necesario establecer las propiedades adicionales.

## <a name="moveprev"></a> CRowset::MovePrev

Mueve el cursor al registro anterior.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Este método requiere que se establezca `DBPROP_CANFETCHBACKWARDS` o `DBPROP_CANSCROLLBACKWARDS` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

## <a name="movetobookmark"></a> CRowset::MoveToBookmark

Recopila la fila marcada por fila en un desplazamiento especificado o un marcador (*lSkip*) desde ese marcador.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parámetros

*bookmark*<br/>
[in] Un marcador de marcar la ubicación desde la que desea capturar datos.

*lSkip*<br/>
[in] El recuento de número de filas desde el marcador para la fila de destino. Si *lSkip* es cero, la primera fila es la fila marcada. Si *lSkip* es 1, la primera fila es la fila después de la fila marcada. Si *lSkip* es -1, la primera fila es la fila antes de la fila marcada.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Este método requiere la interfaz opcional `IRowsetLocate`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetLocate` en VARIANT_TRUE y establezca `DBPROP_CANFETCHBACKWARDS` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

Para obtener información sobre el uso de marcadores de los consumidores, consulte [utilizar marcadores](../../data/oledb/using-bookmarks.md).

## <a name="movetoratio"></a> CRowset::MoveToRatio

Captura las filas a partir de una posición en el conjunto de filas fraccionaria.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parámetros

*nNumerator*<br/>
[in] El numerador usa para determinar las fracciones posicionales desde el que se va a capturar datos.

*nDenominator*<br/>
[in] El denominador que se usa para determinar las fracciones posicionales desde el que se va a capturar datos.

*bForward*<br/>
[in] Indica si se debe avanzar o retroceder. El valor predeterminado es hacia delante.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

`MoveToRatio` recupera filas aproximadamente de acuerdo con la siguiente fórmula:

`(nNumerator *  RowsetSize ) / nDenominator`

Donde `RowsetSize` es el tamaño del conjunto de filas, medido en filas. El proveedor específico depende de la precisión de esta fórmula. Para obtener más información, consulte [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Este método requiere la interfaz opcional `IRowsetScroll`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetScroll` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

## <a name="releaserows"></a> CRowset::ReleaseRows

Las llamadas [IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) para liberar el identificador de fila actual.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

## <a name="setdata"></a> CRowset::SetData

Establece los valores de datos en una o más columnas de una fila.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parámetros

*nAccessor*<br/>
[in] El número del descriptor de acceso que se usará para acceder a los datos.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Para el `SetData` que acepta ningún argumento, todos los descriptores de acceso se utilizan para actualizar. Se suele llamar a `SetData` para establecer los valores de datos en columnas de una fila, a continuación, llame a [actualización](../../data/oledb/crowset-update.md) para transmitir los cambios.

Este método requiere la interfaz opcional `IRowsetChange`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetChange` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

La operación de configuración puede producir un error si no se puede escribir una o varias columnas. Modifique la asignación del cursor para corregirlo.

## <a name="undo"></a> CRowset::Undo

Deshace los cambios realizados en una fila desde la última captura o [actualización](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parámetros

*pcRows*<br/>
[out] Un puntero a la ubicación donde `Undo` devuelve el número de filas que se ha intentado deshacer si es necesario.

*phRow*<br/>
[out] Un puntero a la ubicación donde `Undo` devuelve una matriz de identificadores para todas las filas que se ha intentado deshacer si es necesario.

*pStatus*<br/>
[out] Un puntero a la ubicación donde `Undo` devuelve el valor de estado de fila. Estado no se devuelve si *pStatus* es null.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Este método requiere la interfaz opcional `IRowsetUpdate`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetUpdate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

## <a name="update"></a> CRowset::Update

Los cambios realizados en la fila actual desde la última recuperación de cambios pendientes transmite o `Update` llamar en ella.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parámetros

*pcRows*<br/>
[out] Un puntero a la ubicación donde `Update` devuelve el número de filas que se ha intentado actualizar, si es necesario.

*phRow*<br/>
[out] Un puntero a la ubicación donde `Update` devuelve el identificador de la fila intentó actualizar. No hay ningún identificador se devuelve si *phRow* es null.

*pStatus*<br/>
[out] Un puntero a la ubicación donde `Update` devuelve el valor de estado de fila. Estado no se devuelve si *pStatus* es null.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

### <a name="remarks"></a>Comentarios

Los cambios pendientes realizados en la fila actual desde esa fila se recuperan o se actualizó por última vez transmite (mediante `Update` o [UpdateAll](../../data/oledb/crowset-updateall.md)). Se suele llamar a [SetData](../../data/oledb/crowset-setdata.md) establecer valores de datos en columnas de una fila y, a continuación, llamar a `Update` para transmitir los cambios.

Este método requiere la interfaz opcional `IRowsetUpdate`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetUpdate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

## <a name="updateall"></a> CRowset::UpdateAll

Los cambios realizados en todas las filas desde la última recuperación de cambios pendientes transmite o `Update` llamar en ella.

### <a name="syntax"></a>Sintaxis

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parámetros

*pcRows*<br/>
[out] Un puntero a la ubicación donde `UpdateAll` devuelve el número de filas que se ha intentado actualizar, si es necesario.

*pphRow*<br/>
[out] Un puntero a memoria en el que `UpdateAll` devuelve el identificador de la fila intentó actualizar. No hay ningún identificador se devuelve si *pphRow* es null.

*ppStatus*<br/>
[out] Un puntero a la ubicación donde `Update` devuelve el valor de estado de fila. Estado no se devuelve si *ppStatus* es null.

### <a name="remarks"></a>Comentarios

Los cambios pendientes realizados en todas las filas, ya que las filas se capturó en último lugar o actualizan utilizando transmite [actualización](../../data/oledb/crowset-update.md) o `UpdateAll`. `UpdateAll` se actualizarán todas las filas que se ha modificado, independientemente de si todavía tiene el identificador para ellos (consulte *pphRow*) o no.

Por ejemplo, si ha usado `Insert` para insertar cinco filas en un conjunto de filas, se podría llamar a `Update` cinco veces o llamada `UpdateAll` una vez para actualizar todos ellos.

Este método requiere la interfaz opcional `IRowsetUpdate`, que es posible que no se admite en todos los proveedores; si este es el caso, el método devuelve E_NOINTERFACE. También debe establecer `DBPROP_IRowsetUpdate` en VARIANT_TRUE antes de llamar a `Open` en la tabla o un comando que contiene el conjunto de filas.

### <a name="return-value"></a>Valor devuelto

Un HRESULT estándar.

## <a name="see-also"></a>Vea también

[Ejemplo DBViewer](../../visual-cpp-samples.md)<br/>
[Ejemplo multiRead](../../visual-cpp-samples.md)<br/>
[Ejemplo de atributos multiRead](../../visual-cpp-samples.md)<br/>
[Plantillas de consumidor OLE DB](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Referencia de plantillas de consumidor OLE DB](../../data/oledb/ole-db-consumer-templates-reference.md)